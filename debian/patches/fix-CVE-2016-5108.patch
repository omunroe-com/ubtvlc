Description: reject invalid QuickTime IMA files
 Buffer overflow in the DecodeAdpcmImaQT function in modules/codec/adpcm.c
 in VideoLAN VLC media player before 2.2.4 allows remote attackers to cause
 a denial of service (crash) or possibly execute arbitrary code via a
 crafted QuickTime IMA file.
 .
 This fixes CVE-2016-5108.
Author: Rafaël Carré <funman@videolan.org>
Origin: upstream
Applied-Upstream: 458ed62bbeb9d1bddf7b8df104e14936408a3db9
Last-Update: 2017-07-07
--- a/modules/codec/adpcm.c
+++ b/modules/codec/adpcm.c
@@ -171,6 +171,12 @@ static int OpenDecoder( vlc_object_t *p_
     switch( p_dec->fmt_in.i_codec )
     {
         case VLC_FOURCC('i','m','a', '4'): /* IMA ADPCM */
+            if (p_dec->fmt_in.audio.i_channels > 2) {
+                free(p_sys);
+                msg_Err(p_dec, "Invalid number of channels %i",
+                        p_dec->fmt_in.audio.i_channels );
+                return VLC_EGENERIC;
+            }
             p_sys->codec = ADPCM_IMA_QT;
             break;
         case VLC_CODEC_ADPCM_IMA_WAV: /* IMA ADPCM */
