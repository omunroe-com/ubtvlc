From 953263bf5839054b162fe114db6b132521747bf7 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?R=C3=A9mi=20Denis-Courmont?= <remi@remlab.net>
Date: Fri, 21 Oct 2016 16:08:25 +0300
Subject: [PATCH 5/5] skins2: do not generate (broken) default.vlt on error

(cherry picked from commit 096c3544b55a88ca07ece9a5624671484e362945)
---
 share/Makefile.am | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

--- a/share/Makefile.am
+++ b/share/Makefile.am
@@ -78,10 +78,12 @@
 
 skins2/default.vlt: $(skins2_default_vlt_FILES)
 	$(AM_V_at)mkdir -p skins2
+	$(AM_V_at)rm -f -- skins2/default.vlt.tmp
 	$(AM_V_GEN)GZIP=--no-name \
-	tar cvvzf skins2/default.vlt \
+	tar cvvzf skins2/default.vlt.tmp \
 		--owner=root --group=root --directory="$(srcdir)/skins2" \
 		default/
+	$(AM_V_at)mv -f -- skins2/default.vlt.tmp skins2/default.vlt
 
 #
 # LUA
