diff -uNr vlc-0.8.6-svn20060918.debian/activex/axvlc.idl vlc-0.8.6-svn20061008.debian/activex/axvlc.idl
--- vlc-0.8.6-svn20060918.debian/activex/axvlc.idl	2006-09-18 06:28:02.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/activex/axvlc.idl	2006-10-04 09:47:07.000000000 -0400
@@ -1,7 +1,7 @@
 /*****************************************************************************
  * axvlc.idl: ActiveX control for VLC
  *****************************************************************************
- * Copyright (C) 2005 the VideoLAN team
+ * Copyright (C) 2006 the VideoLAN team
  *
  * Authors: Damien Fouilleul <Damien.Fouilleul@laposte.net>
  *
@@ -23,20 +23,27 @@
 //comments terminated by [t] are by tonsofpcs, regarding the string review.  April 02, 2006. [t]
 //Possibly change all instances of "the current playlist" to "the playlist" and "current playlist" to "the playlist" [t]
 
+import "oaidl.idl";
+
 [
   uuid(DF2BBE39-40A8-433b-A279-073F48DA94B6),
   version(1.0),
-  helpstring("VideoLAN VLC ActiveX Plugin"),
+  helpstring("VideoLAN VLC ActiveX Plugin")
 ]
 library AXVLC
 {
-    importlib("stdole2.tlb");
-
     // Forward declare all types defined in this typelib
     interface IVLCControl;
+    interface IVLCAudio;
+    interface IVLCInput;
+    interface IVLCPlaylist;
+    interface IVLCVideo;
+    interface IVLCControl2;
     dispinterface DVLCEvents;
 
-    enum VLCPlaylistMode
+    importlib("stdole2.tlb");
+
+    typedef [public] enum VLCPlaylistMode
     {
         VLCPlayListInsert       =  1,
         VLCPlayListInsertAndGo  =  9,
@@ -45,7 +52,7 @@
         VLCPlayListAppend       =  4,
         VLCPlayListAppendAndGo  = 12,
         VLCPlayListCheckInsert  = 16
-    };
+    } eVLCPlaylistMode;
 
     // playlist target position
     const int VLCPlayListEnd    = -666;
@@ -60,11 +67,13 @@
     const int DISPID_MRL        = 106;
     const int DISPID_AutoPlay   = 107;
     const int DISPID_AutoLoop   = 108;
+    const int DISPID_StartTime  = 109;
+    const int DISPID_BaseURL    = 110;
 
     [
       odl,
       uuid(C2FA41D0-B113-476e-AC8C-9BD14999C1C1),
-      helpstring("VLC Control"),
+      helpstring("VLC Control (deprecated)"),
       dual,
       hidden,
       oleautomation
@@ -83,9 +92,9 @@
         HRESULT stop();
         [id(DISPID_Playing), hidden, propget, helpstring("Returns a value that determines whether VLC is currently playing.")]
         HRESULT Playing([out, retval] VARIANT_BOOL* isPlaying);
-        [id(DISPID_Position), propget, helpstring("Returns/sets playback position within the current item.  Position is a relative value ranging from 0.0 to 1.0.")]
+        [id(DISPID_Position), propget, helpstring("Returns/sets playback position within the current item. Position is a relative value ranging from 0.0 to 1.0.")]
         HRESULT Position([out, retval] float* position);
-        [id(DISPID_Position), propput, helpstring("Returns/sets playback position within the current item.  Position is a relative value ranging from 0.0 to 1.0.")]
+        [id(DISPID_Position), propput, helpstring("Returns/sets playback position within the current item. Position is a relative value ranging from 0.0 to 1.0.")]
         HRESULT Position([in] float position);
         [id(DISPID_Time), propget, helpstring("Returns/sets playback time relative to the start of the current item.")]
         HRESULT Time([out, retval] int* seconds);
@@ -167,13 +176,210 @@
     };
 
     [
+      odl,
+      uuid(9E0BD17B-2D3C-4656-B94D-03084F3FD9D4),
+      helpstring("VLC Audio APIs"),
+      dual,
+      oleautomation
+    ]
+    interface IVLCAudio : IDispatch
+    {
+        [propget, helpstring("Returns/sets the audio mute state.")]
+        HRESULT mute([out, retval] VARIANT_BOOL* muted);
+        [propput, helpstring("Returns/sets the audio mute state.")]
+        HRESULT mute([in] VARIANT_BOOL muted);
+
+        [propget, helpstring("Returns/sets audio volume as a percent value.")]
+        HRESULT volume([out, retval] int* volume);
+        [propput, helpstring("Returns/sets audio volume as a percent value.")]
+        HRESULT volume([in] int volume);
+
+        [helpstring("Mute/unmute audio playback.")]
+        HRESULT toggleMute();
+    };
+
+    [
+      odl,
+      uuid(49E0DBD1-9440-466C-9C97-95C67190C603),
+      helpstring("VLC Input APIs"),
+      dual,
+      oleautomation
+    ]
+    interface IVLCInput : IDispatch
+    {
+        [propget, helpstring("Returns the clip length, in milliseconds.")]
+        HRESULT length([out, retval] double* length);
+
+        [propget, helpstring("Returns/sets playback position in current clip.  Position is ranging from 0.0 to 1.0.")]
+        HRESULT position([out, retval] float* position);
+        [propput, helpstring("Returns/sets playback position in the current clip.  Position ranging from 0.0 to 1.0.")]
+        HRESULT position([in] float position);
+
+        [propget, helpstring("Returns/sets playback time in current clip, in milliseconds.")]
+        HRESULT time([out, retval] double* time);
+        [propput, helpstring("Returns/sets playback time in the current clip, in milliseconds.")]
+        HRESULT time([in] double time);
+
+        [propget, helpstring("Returns current playback state.")]
+        HRESULT state([out, retval] int* state);
+
+        [propget, helpstring("Returns/sets current playback rate, normal rate is 1.0 ")]
+        HRESULT rate([out, retval] float* rate);
+        [propput, helpstring("Returns/sets current playback rate, normal rate is 1.0.")]
+        HRESULT rate([in] float rate);
+
+        [propget, helpstring("Returns current playback frames per seconds if available.")]
+        HRESULT fps([out, retval] float* fps);
+
+        [propget, helpstring("Returns whether current playback displays video.")]
+        HRESULT hasVout([out, retval] VARIANT_BOOL* hasVout);
+    };
+
+    [
+      odl,
+      uuid(54613049-40BF-4035-9E70-0A9312C0188D),
+      helpstring("VLC Playlist APIs"),
+      dual,
+      oleautomation
+    ]
+    interface IVLCPlaylist : IDispatch
+    {
+        [propget, helpstring("Returns number of items in playlist.")]
+        HRESULT itemCount([out, retval] int* count);
+
+        [propget, helpstring("Returns whether playback displays video.")]
+        HRESULT isPlaying([out, retval] VARIANT_BOOL* playing);
+
+        [helpstring("Add a playlist item.")]
+        HRESULT add([in] BSTR uri, [in, optional] VARIANT name, [in, optional] VARIANT options, [out, retval] int* item);
+
+        [helpstring("Play/Resume the playlist.")]
+        HRESULT play();
+
+        [helpstring("Play item in playlist.")]
+        HRESULT playItem([in] int item);
+
+        [helpstring("Play/Pause current clip.")]
+        HRESULT togglePause();
+
+        [helpstring("Stop current clip.")]
+        HRESULT stop();
+
+        [helpstring("Advance to next item in playlist.")]
+        HRESULT next();
+
+        [helpstring("Advance to previous item in playlist.")]
+        HRESULT prev();
+
+        [helpstring("Remove all items from playlist.")]
+        HRESULT clear();
+
+        [helpstring("remove item from playlist.")]
+        HRESULT removeItem([in] int item);
+    };
+
+    [
+      odl,
+      uuid(0AAEDF0B-D333-4B27-A0C6-BBF31413A42E),
+      helpstring("VLC Video APIs"),
+      dual,
+      oleautomation
+    ]
+    interface IVLCVideo : IDispatch
+    {
+        [propget, helpstring("Returns/sets the fullscreen state.")]
+        HRESULT fullscreen([out, retval] VARIANT_BOOL* fullscreen);
+        [propput, helpstring("Returns/sets the fullscreen state.")]
+        HRESULT fullscreen([in] VARIANT_BOOL fullscreen);
+
+        [propget, helpstring("Returns video original width.")]
+        HRESULT width([out, retval] int* width);
+
+        [propget, helpstring("Returns video original height.")]
+        HRESULT height([out, retval] int* height);
+    };
+
+    [
+      odl,
+      uuid(2D719729-5333-406C-BF12-8DE787FD65E3),
+      helpstring("VLC Control"),
+      dual,
+      oleautomation
+    ]
+    interface IVLCControl2 : IDispatch
+    {
+        [id(DISPID_AutoLoop), propget, helpstring("Returns/sets a value that determines whether the playlist is looped")]
+        HRESULT AutoLoop([out, retval] VARIANT_BOOL* autoloop);
+        [id(DISPID_AutoLoop), propput, helpstring("Returns/sets a value that determines whether the playlist is looped")]
+        HRESULT AutoLoop([in] VARIANT_BOOL autoloop);
+
+        [id(DISPID_AutoPlay), propget, helpstring("Returns/sets a value that determines whether the playlist is played on startup")]
+        HRESULT AutoPlay([out, retval] VARIANT_BOOL* autoplay);
+        [id(DISPID_AutoPlay), propput, helpstring("Returns/Sets a value that determines whether the playlist is played on startup")]
+        HRESULT AutoPlay([in] VARIANT_BOOL autoplay);
+
+        [id(DISPID_BaseURL), propget, helpstring("Returns/sets the base URL for relative paths")]
+        HRESULT BaseURL([out, retval] BSTR* url);
+        [id(DISPID_BaseURL), propput, helpstring("Returns/sets the base URL for relative paths")]
+        HRESULT BaseURL([in] BSTR url);
+
+        [id(DISPID_StartTime), propget, helpstring("Returns/sets playback start time of URL.")]
+        HRESULT StartTime([out, retval] int* seconds);
+        [id(DISPID_StartTime), propput, helpstring("Returns/sets playback start time of URL.")]
+        HRESULT StartTime([in] int seconds);
+
+        [id(DISPID_MRL), propget, helpstring("Returns/sets the default MRL in playlist")]
+        HRESULT MRL([out, retval] BSTR* mrl);
+        [id(DISPID_MRL), propput, helpstring("Returns/sets the default MRL in playlist")]
+        HRESULT MRL([in] BSTR mrl);
+
+        [propget, helpstring("Returns VLC Version.")]
+        HRESULT VersionInfo([out, retval] BSTR* version);
+
+        [id(DISPID_Visible), propget, helpstring("Returns/sets a value that determines whether viewing area is visible or hidden.")]
+        HRESULT Visible([out, retval] VARIANT_BOOL* visible);
+        [id(DISPID_Visible), propput, helpstring("Returns/sets a value that determines whether viewing area is visible or hidden.")]
+        HRESULT Visible([in] VARIANT_BOOL visible);
+
+        [id(DISPID_Volume), propget, helpstring("Returns/sets default audio volume.")]
+        HRESULT Volume([out, retval] int* volume);
+        [id(DISPID_Volume), propput, helpstring("Returns/sets default audio volume.")]
+        HRESULT Volume([in] int volume);
+
+        [propget, helpstring("Returns the audio object.")]
+        HRESULT audio([out, retval] IVLCAudio** obj);
+
+        [propget, helpstring("Returns the audio object.")]
+        HRESULT input([out, retval] IVLCInput** obj);
+
+        [propget, helpstring("Returns the playlist object.")]
+        HRESULT playlist([out, retval] IVLCPlaylist** obj);
+
+        [propget, helpstring("Returns the audio object.")]
+        HRESULT video([out, retval] IVLCVideo** obj);
+    };
+
+    [
       uuid(E23FE9C6-778E-49D4-B537-38FCDE4887D8),
-      helpstring("VLC control"),
+      helpstring("VLC control (deprecated)"),
       control
     ]
     coclass VLCPlugin
     {
         [default] interface IVLCControl;
+        interface IVLCControl2;
+        [default, source] dispinterface DVLCEvents;
+    };
+
+    [
+      uuid(9BE31822-FDAD-461B-AD51-BE1D1C159921),
+      helpstring("VLC control"),
+      control
+    ]
+    coclass VLCPlugin2
+    {
+        [default] interface IVLCControl2;
+        interface IVLCControl;
         [default, source] dispinterface DVLCEvents;
     };
 };
diff -uNr vlc-0.8.6-svn20060918.debian/activex/axvlc_idl.c vlc-0.8.6-svn20061008.debian/activex/axvlc_idl.c
--- vlc-0.8.6-svn20060918.debian/activex/axvlc_idl.c	2006-09-18 06:28:02.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/activex/axvlc_idl.c	2006-10-04 09:47:07.000000000 -0400
@@ -1,53 +1,26 @@
-/* this file contains the actual definitions of */
-/* the IIDs and CLSIDs */
+/*** Autogenerated by WIDL 0.9.20 from axvlc.idl - Do not edit ***/
 
-/* link this file in with the server and any clients */
+#include <rpc.h>
+#include <rpcndr.h>
 
+#define INITGUID
+#include <guiddef.h>
 
-/* File created by MIDL compiler version 5.01.0164 */
-/* at Sun Apr 02 19:22:45 2006
- */
-/* Compiler settings for axvlc.idl:
-    Oicf (OptLev=i2), W1, Zp8, env=Win32, ms_ext, c_ext
-    error checks: allocation ref bounds_check enum stub_data 
-*/
-//@@MIDL_FILE_HEADING(  )
 #ifdef __cplusplus
-extern "C"{
-#endif 
-
-
-#ifndef __IID_DEFINED__
-#define __IID_DEFINED__
-
-typedef struct _IID
-{
-    unsigned long x;
-    unsigned short s1;
-    unsigned short s2;
-    unsigned char  c[8];
-} IID;
-
-#endif // __IID_DEFINED__
-
-#ifndef CLSID_DEFINED
-#define CLSID_DEFINED
-typedef IID CLSID;
-#endif // CLSID_DEFINED
-
-const IID LIBID_AXVLC = {0xDF2BBE39,0x40A8,0x433b,{0xA2,0x79,0x07,0x3F,0x48,0xDA,0x94,0xB6}};
-
-
-const IID IID_IVLCControl = {0xC2FA41D0,0xB113,0x476e,{0xAC,0x8C,0x9B,0xD1,0x49,0x99,0xC1,0xC1}};
-
-
-const IID DIID_DVLCEvents = {0xDF48072F,0x5EF8,0x434e,{0x9B,0x40,0xE2,0xF3,0xAE,0x75,0x9B,0x5F}};
-
-
-const CLSID CLSID_VLCPlugin = {0xE23FE9C6,0x778E,0x49D4,{0xB5,0x37,0x38,0xFC,0xDE,0x48,0x87,0xD8}};
+extern "C" {
+#endif
 
+DEFINE_GUID(LIBID_AXVLC, 0xdf2bbe39, 0x40a8, 0x433b, 0xa2,0x79, 0x07,0x3f,0x48,0xda,0x94,0xb6);
+DEFINE_GUID(IID_IVLCControl, 0xc2fa41d0, 0xb113, 0x476e, 0xac,0x8c, 0x9b,0xd1,0x49,0x99,0xc1,0xc1);
+DEFINE_GUID(DIID_DVLCEvents, 0xdf48072f, 0x5ef8, 0x434e, 0x9b,0x40, 0xe2,0xf3,0xae,0x75,0x9b,0x5f);
+DEFINE_GUID(IID_IVLCAudio, 0x9e0bd17b, 0x2d3c, 0x4656, 0xb9,0x4d, 0x03,0x08,0x4f,0x3f,0xd9,0xd4);
+DEFINE_GUID(IID_IVLCInput, 0x49e0dbd1, 0x9440, 0x466c, 0x9c,0x97, 0x95,0xc6,0x71,0x90,0xc6,0x03);
+DEFINE_GUID(IID_IVLCPlaylist, 0x54613049, 0x40bf, 0x4035, 0x9e,0x70, 0x0a,0x93,0x12,0xc0,0x18,0x8d);
+DEFINE_GUID(IID_IVLCVideo, 0x0aaedf0b, 0xd333, 0x4b27, 0xa0,0xc6, 0xbb,0xf3,0x14,0x13,0xa4,0x2e);
+DEFINE_GUID(IID_IVLCControl2, 0x2d719729, 0x5333, 0x406c, 0xbf,0x12, 0x8d,0xe7,0x87,0xfd,0x65,0xe3);
+DEFINE_GUID(CLSID_VLCPlugin, 0xe23fe9c6, 0x778e, 0x49d4, 0xb5,0x37, 0x38,0xfc,0xde,0x48,0x87,0xd8);
+DEFINE_GUID(CLSID_VLCPlugin2, 0x9be31822, 0xfdad, 0x461b, 0xad,0x51, 0xbe,0x1d,0x1c,0x15,0x99,0x21);
 
 #ifdef __cplusplus
 }
 #endif
-
diff -uNr vlc-0.8.6-svn20060918.debian/activex/axvlc_idl.h vlc-0.8.6-svn20061008.debian/activex/axvlc_idl.h
--- vlc-0.8.6-svn20060918.debian/activex/axvlc_idl.h	2006-09-18 06:28:02.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/activex/axvlc_idl.h	2006-10-04 09:47:07.000000000 -0400
@@ -1,1050 +1,1999 @@
-/* this ALWAYS GENERATED file contains the definitions for the interfaces */
-
-
-/* File created by MIDL compiler version 5.01.0164 */
-/* at Sun Apr 02 19:22:45 2006
- */
-/* Compiler settings for axvlc.idl:
-    Oicf (OptLev=i2), W1, Zp8, env=Win32, ms_ext, c_ext
-    error checks: allocation ref bounds_check enum stub_data 
-*/
-//@@MIDL_FILE_HEADING(  )
-
-
-/* verify that the <rpcndr.h> version is high enough to compile this file*/
-#ifndef __REQUIRED_RPCNDR_H_VERSION__
-#define __REQUIRED_RPCNDR_H_VERSION__ 440
-#endif
-
-#include "rpc.h"
-#include "rpcndr.h"
-
-#ifndef __axvlc_idl_h__
-#define __axvlc_idl_h__
+/*** Autogenerated by WIDL 0.9.20 from axvlc.idl - Do not edit ***/
+#include <rpc.h>
+#include <rpcndr.h>
 
+#ifndef __WIDL_AXVLC_IDL_H
+#define __WIDL_AXVLC_IDL_H
 #ifdef __cplusplus
-extern "C"{
-#endif 
+extern "C" {
+#endif
+#include <oaidl.h>
 
-/* Forward Declarations */ 
+DEFINE_GUID(LIBID_AXVLC, 0xdf2bbe39, 0x40a8, 0x433b, 0xa2,0x79, 0x07,0x3f,0x48,0xda,0x94,0xb6);
 
 #ifndef __IVLCControl_FWD_DEFINED__
 #define __IVLCControl_FWD_DEFINED__
 typedef interface IVLCControl IVLCControl;
-#endif 	/* __IVLCControl_FWD_DEFINED__ */
-
-
-#ifndef __DVLCEvents_FWD_DEFINED__
-#define __DVLCEvents_FWD_DEFINED__
-typedef interface DVLCEvents DVLCEvents;
-#endif 	/* __DVLCEvents_FWD_DEFINED__ */
-
-
-#ifndef __VLCPlugin_FWD_DEFINED__
-#define __VLCPlugin_FWD_DEFINED__
-
-#ifdef __cplusplus
-typedef class VLCPlugin VLCPlugin;
-#else
-typedef struct VLCPlugin VLCPlugin;
-#endif /* __cplusplus */
-
-#endif 	/* __VLCPlugin_FWD_DEFINED__ */
-
-
-void __RPC_FAR * __RPC_USER MIDL_user_allocate(size_t);
-void __RPC_USER MIDL_user_free( void __RPC_FAR * ); 
-
-
-#ifndef __AXVLC_LIBRARY_DEFINED__
-#define __AXVLC_LIBRARY_DEFINED__
-
-/* library AXVLC */
-/* [helpstring][version][uuid] */ 
+#endif
 
+#ifndef __IVLCAudio_FWD_DEFINED__
+#define __IVLCAudio_FWD_DEFINED__
+typedef interface IVLCAudio IVLCAudio;
+#endif
 
+#ifndef __IVLCInput_FWD_DEFINED__
+#define __IVLCInput_FWD_DEFINED__
+typedef interface IVLCInput IVLCInput;
+#endif
 
+#ifndef __IVLCPlaylist_FWD_DEFINED__
+#define __IVLCPlaylist_FWD_DEFINED__
+typedef interface IVLCPlaylist IVLCPlaylist;
+#endif
 
-enum VLCPlaylistMode
-    {	VLCPlayListInsert	= 1,
-	VLCPlayListInsertAndGo	= 9,
-	VLCPlayListReplace	= 2,
-	VLCPlayListReplaceAndGo	= 10,
-	VLCPlayListAppend	= 4,
-	VLCPlayListAppendAndGo	= 12,
-	VLCPlayListCheckInsert	= 16
-    };
-#define	VLCPlayListEnd	( -666 )
+#ifndef __IVLCVideo_FWD_DEFINED__
+#define __IVLCVideo_FWD_DEFINED__
+typedef interface IVLCVideo IVLCVideo;
+#endif
 
-#define	DISPID_Visible	( 100 )
+#ifndef __IVLCControl2_FWD_DEFINED__
+#define __IVLCControl2_FWD_DEFINED__
+typedef interface IVLCControl2 IVLCControl2;
+#endif
 
-#define	DISPID_Playing	( 101 )
+#ifndef __DVLCEvents_FWD_DEFINED__
+#define __DVLCEvents_FWD_DEFINED__
+typedef interface DVLCEvents DVLCEvents;
+#endif
 
-#define	DISPID_Position	( 102 )
+typedef enum VLCPlaylistMode {
+    VLCPlayListInsert = 1,
+    VLCPlayListInsertAndGo = 9,
+    VLCPlayListReplace = 2,
+    VLCPlayListReplaceAndGo = 10,
+    VLCPlayListAppend = 4,
+    VLCPlayListAppendAndGo = 12,
+    VLCPlayListCheckInsert = 16
+} eVLCPlaylistMode;
+#define VLCPlayListEnd (-666)
 
-#define	DISPID_Time	( 103 )
+#define DISPID_Visible (100)
 
-#define	DISPID_Length	( 104 )
+#define DISPID_Playing (101)
 
-#define	DISPID_Volume	( 105 )
+#define DISPID_Position (102)
 
-#define	DISPID_MRL	( 106 )
+#define DISPID_Time (103)
 
-#define	DISPID_AutoPlay	( 107 )
+#define DISPID_Length (104)
 
-#define	DISPID_AutoLoop	( 108 )
+#define DISPID_Volume (105)
 
-#define	DISPID_PlayEvent	( 100 )
+#define DISPID_MRL (106)
 
-#define	DISPID_PauseEvent	( 101 )
+#define DISPID_AutoPlay (107)
 
-#define	DISPID_StopEvent	( 102 )
+#define DISPID_AutoLoop (108)
 
+#define DISPID_StartTime (109)
 
-EXTERN_C const IID LIBID_AXVLC;
+#define DISPID_BaseURL (110)
 
+/*****************************************************************************
+ * IVLCControl interface
+ */
 #ifndef __IVLCControl_INTERFACE_DEFINED__
 #define __IVLCControl_INTERFACE_DEFINED__
 
-/* interface IVLCControl */
-/* [object][oleautomation][hidden][dual][helpstring][uuid] */ 
-
-
-EXTERN_C const IID IID_IVLCControl;
-
+DEFINE_GUID(IID_IVLCControl, 0xc2fa41d0, 0xb113, 0x476e, 0xac,0x8c, 0x9b,0xd1,0x49,0x99,0xc1,0xc1);
 #if defined(__cplusplus) && !defined(CINTERFACE)
-    
-    MIDL_INTERFACE("C2FA41D0-B113-476e-AC8C-9BD14999C1C1")
-    IVLCControl : public IDispatch
-    {
-    public:
-        virtual /* [helpstring][bindable][propget][id] */ HRESULT STDMETHODCALLTYPE get_Visible( 
-            /* [retval][out] */ VARIANT_BOOL __RPC_FAR *visible) = 0;
-        
-        virtual /* [helpstring][bindable][propput][id] */ HRESULT STDMETHODCALLTYPE put_Visible( 
-            /* [in] */ VARIANT_BOOL visible) = 0;
-        
-        virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE play( void) = 0;
-        
-        virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE pause( void) = 0;
-        
-        virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE stop( void) = 0;
-        
-        virtual /* [helpstring][propget][hidden][id] */ HRESULT STDMETHODCALLTYPE get_Playing( 
-            /* [retval][out] */ VARIANT_BOOL __RPC_FAR *isPlaying) = 0;
-        
-        virtual /* [helpstring][propget][id] */ HRESULT STDMETHODCALLTYPE get_Position( 
-            /* [retval][out] */ float __RPC_FAR *position) = 0;
-        
-        virtual /* [helpstring][propput][id] */ HRESULT STDMETHODCALLTYPE put_Position( 
-            /* [in] */ float position) = 0;
-        
-        virtual /* [helpstring][propget][id] */ HRESULT STDMETHODCALLTYPE get_Time( 
-            /* [retval][out] */ int __RPC_FAR *seconds) = 0;
-        
-        virtual /* [helpstring][propput][id] */ HRESULT STDMETHODCALLTYPE put_Time( 
-            /* [in] */ int seconds) = 0;
-        
-        virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE shuttle( 
-            /* [in] */ int seconds) = 0;
-        
-        virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE fullscreen( void) = 0;
-        
-        virtual /* [helpstring][hidden][propget][id] */ HRESULT STDMETHODCALLTYPE get_Length( 
-            /* [retval][out] */ int __RPC_FAR *seconds) = 0;
-        
-        virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE playFaster( void) = 0;
-        
-        virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE playSlower( void) = 0;
-        
-        virtual /* [helpstring][propget][id] */ HRESULT STDMETHODCALLTYPE get_Volume( 
-            /* [retval][out] */ int __RPC_FAR *volume) = 0;
-        
-        virtual /* [helpstring][propput][id] */ HRESULT STDMETHODCALLTYPE put_Volume( 
-            /* [in] */ int volume) = 0;
-        
-        virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE toggleMute( void) = 0;
-        
-        virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE setVariable( 
-            /* [in] */ BSTR name,
-            /* [in] */ VARIANT value) = 0;
-        
-        virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE getVariable( 
-            /* [in] */ BSTR name,
-            /* [retval][out] */ VARIANT __RPC_FAR *value) = 0;
-        
-        virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE addTarget( 
-            /* [in] */ BSTR uri,
-            /* [in] */ VARIANT options,
-            /* [in] */ enum VLCPlaylistMode mode,
-            /* [in] */ int position) = 0;
-        
-        virtual /* [helpstring][propget] */ HRESULT STDMETHODCALLTYPE get_PlaylistIndex( 
-            /* [retval][out] */ int __RPC_FAR *index) = 0;
-        
-        virtual /* [helpstring][propget] */ HRESULT STDMETHODCALLTYPE get_PlaylistCount( 
-            /* [retval][out] */ int __RPC_FAR *index) = 0;
-        
-        virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE playlistNext( void) = 0;
-        
-        virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE playlistPrev( void) = 0;
-        
-        virtual /* [helpstring] */ HRESULT STDMETHODCALLTYPE playlistClear( void) = 0;
-        
-        virtual /* [helpstring][hidden][propget] */ HRESULT STDMETHODCALLTYPE get_VersionInfo( 
-            /* [retval][out] */ BSTR __RPC_FAR *version) = 0;
-        
-        virtual /* [helpstring][propget][id] */ HRESULT STDMETHODCALLTYPE get_MRL( 
-            /* [retval][out] */ BSTR __RPC_FAR *mrl) = 0;
-        
-        virtual /* [helpstring][propput][id] */ HRESULT STDMETHODCALLTYPE put_MRL( 
-            /* [in] */ BSTR mrl) = 0;
-        
-        virtual /* [helpstring][propget][id] */ HRESULT STDMETHODCALLTYPE get_AutoPlay( 
-            /* [retval][out] */ VARIANT_BOOL __RPC_FAR *autoplay) = 0;
-        
-        virtual /* [helpstring][propput][id] */ HRESULT STDMETHODCALLTYPE put_AutoPlay( 
-            /* [in] */ VARIANT_BOOL autoplay) = 0;
-        
-        virtual /* [helpstring][propget][id] */ HRESULT STDMETHODCALLTYPE get_AutoLoop( 
-            /* [retval][out] */ VARIANT_BOOL __RPC_FAR *autoloop) = 0;
-        
-        virtual /* [helpstring][propput][id] */ HRESULT STDMETHODCALLTYPE put_AutoLoop( 
-            /* [in] */ VARIANT_BOOL autoloop) = 0;
-        
-    };
-    
-#else 	/* C style interface */
-
-    typedef struct IVLCControlVtbl
-    {
-        BEGIN_INTERFACE
-        
-        HRESULT ( STDMETHODCALLTYPE __RPC_FAR *QueryInterface )( 
-            IVLCControl __RPC_FAR * This,
-            /* [in] */ REFIID riid,
-            /* [iid_is][out] */ void __RPC_FAR *__RPC_FAR *ppvObject);
-        
-        ULONG ( STDMETHODCALLTYPE __RPC_FAR *AddRef )( 
-            IVLCControl __RPC_FAR * This);
-        
-        ULONG ( STDMETHODCALLTYPE __RPC_FAR *Release )( 
-            IVLCControl __RPC_FAR * This);
-        
-        HRESULT ( STDMETHODCALLTYPE __RPC_FAR *GetTypeInfoCount )( 
-            IVLCControl __RPC_FAR * This,
-            /* [out] */ UINT __RPC_FAR *pctinfo);
-        
-        HRESULT ( STDMETHODCALLTYPE __RPC_FAR *GetTypeInfo )( 
-            IVLCControl __RPC_FAR * This,
-            /* [in] */ UINT iTInfo,
-            /* [in] */ LCID lcid,
-            /* [out] */ ITypeInfo __RPC_FAR *__RPC_FAR *ppTInfo);
-        
-        HRESULT ( STDMETHODCALLTYPE __RPC_FAR *GetIDsOfNames )( 
-            IVLCControl __RPC_FAR * This,
-            /* [in] */ REFIID riid,
-            /* [size_is][in] */ LPOLESTR __RPC_FAR *rgszNames,
-            /* [in] */ UINT cNames,
-            /* [in] */ LCID lcid,
-            /* [size_is][out] */ DISPID __RPC_FAR *rgDispId);
-        
-        /* [local] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *Invoke )( 
-            IVLCControl __RPC_FAR * This,
-            /* [in] */ DISPID dispIdMember,
-            /* [in] */ REFIID riid,
-            /* [in] */ LCID lcid,
-            /* [in] */ WORD wFlags,
-            /* [out][in] */ DISPPARAMS __RPC_FAR *pDispParams,
-            /* [out] */ VARIANT __RPC_FAR *pVarResult,
-            /* [out] */ EXCEPINFO __RPC_FAR *pExcepInfo,
-            /* [out] */ UINT __RPC_FAR *puArgErr);
-        
-        /* [helpstring][bindable][propget][id] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *get_Visible )( 
-            IVLCControl __RPC_FAR * This,
-            /* [retval][out] */ VARIANT_BOOL __RPC_FAR *visible);
-        
-        /* [helpstring][bindable][propput][id] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *put_Visible )( 
-            IVLCControl __RPC_FAR * This,
-            /* [in] */ VARIANT_BOOL visible);
-        
-        /* [helpstring] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *play )( 
-            IVLCControl __RPC_FAR * This);
-        
-        /* [helpstring] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *pause )( 
-            IVLCControl __RPC_FAR * This);
-        
-        /* [helpstring] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *stop )( 
-            IVLCControl __RPC_FAR * This);
-        
-        /* [helpstring][propget][hidden][id] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *get_Playing )( 
-            IVLCControl __RPC_FAR * This,
-            /* [retval][out] */ VARIANT_BOOL __RPC_FAR *isPlaying);
-        
-        /* [helpstring][propget][id] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *get_Position )( 
-            IVLCControl __RPC_FAR * This,
-            /* [retval][out] */ float __RPC_FAR *position);
-        
-        /* [helpstring][propput][id] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *put_Position )( 
-            IVLCControl __RPC_FAR * This,
-            /* [in] */ float position);
-        
-        /* [helpstring][propget][id] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *get_Time )( 
-            IVLCControl __RPC_FAR * This,
-            /* [retval][out] */ int __RPC_FAR *seconds);
-        
-        /* [helpstring][propput][id] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *put_Time )( 
-            IVLCControl __RPC_FAR * This,
-            /* [in] */ int seconds);
-        
-        /* [helpstring] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *shuttle )( 
-            IVLCControl __RPC_FAR * This,
-            /* [in] */ int seconds);
-        
-        /* [helpstring] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *fullscreen )( 
-            IVLCControl __RPC_FAR * This);
-        
-        /* [helpstring][hidden][propget][id] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *get_Length )( 
-            IVLCControl __RPC_FAR * This,
-            /* [retval][out] */ int __RPC_FAR *seconds);
-        
-        /* [helpstring] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *playFaster )( 
-            IVLCControl __RPC_FAR * This);
-        
-        /* [helpstring] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *playSlower )( 
-            IVLCControl __RPC_FAR * This);
-        
-        /* [helpstring][propget][id] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *get_Volume )( 
-            IVLCControl __RPC_FAR * This,
-            /* [retval][out] */ int __RPC_FAR *volume);
-        
-        /* [helpstring][propput][id] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *put_Volume )( 
-            IVLCControl __RPC_FAR * This,
-            /* [in] */ int volume);
-        
-        /* [helpstring] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *toggleMute )( 
-            IVLCControl __RPC_FAR * This);
-        
-        /* [helpstring] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *setVariable )( 
-            IVLCControl __RPC_FAR * This,
-            /* [in] */ BSTR name,
-            /* [in] */ VARIANT value);
-        
-        /* [helpstring] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *getVariable )( 
-            IVLCControl __RPC_FAR * This,
-            /* [in] */ BSTR name,
-            /* [retval][out] */ VARIANT __RPC_FAR *value);
-        
-        /* [helpstring] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *addTarget )( 
-            IVLCControl __RPC_FAR * This,
-            /* [in] */ BSTR uri,
-            /* [in] */ VARIANT options,
-            /* [in] */ enum VLCPlaylistMode mode,
-            /* [in] */ int position);
-        
-        /* [helpstring][propget] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *get_PlaylistIndex )( 
-            IVLCControl __RPC_FAR * This,
-            /* [retval][out] */ int __RPC_FAR *index);
-        
-        /* [helpstring][propget] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *get_PlaylistCount )( 
-            IVLCControl __RPC_FAR * This,
-            /* [retval][out] */ int __RPC_FAR *index);
-        
-        /* [helpstring] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *playlistNext )( 
-            IVLCControl __RPC_FAR * This);
-        
-        /* [helpstring] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *playlistPrev )( 
-            IVLCControl __RPC_FAR * This);
-        
-        /* [helpstring] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *playlistClear )( 
-            IVLCControl __RPC_FAR * This);
-        
-        /* [helpstring][hidden][propget] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *get_VersionInfo )( 
-            IVLCControl __RPC_FAR * This,
-            /* [retval][out] */ BSTR __RPC_FAR *version);
-        
-        /* [helpstring][propget][id] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *get_MRL )( 
-            IVLCControl __RPC_FAR * This,
-            /* [retval][out] */ BSTR __RPC_FAR *mrl);
-        
-        /* [helpstring][propput][id] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *put_MRL )( 
-            IVLCControl __RPC_FAR * This,
-            /* [in] */ BSTR mrl);
-        
-        /* [helpstring][propget][id] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *get_AutoPlay )( 
-            IVLCControl __RPC_FAR * This,
-            /* [retval][out] */ VARIANT_BOOL __RPC_FAR *autoplay);
-        
-        /* [helpstring][propput][id] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *put_AutoPlay )( 
-            IVLCControl __RPC_FAR * This,
-            /* [in] */ VARIANT_BOOL autoplay);
-        
-        /* [helpstring][propget][id] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *get_AutoLoop )( 
-            IVLCControl __RPC_FAR * This,
-            /* [retval][out] */ VARIANT_BOOL __RPC_FAR *autoloop);
-        
-        /* [helpstring][propput][id] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *put_AutoLoop )( 
-            IVLCControl __RPC_FAR * This,
-            /* [in] */ VARIANT_BOOL autoloop);
-        
-        END_INTERFACE
-    } IVLCControlVtbl;
-
-    interface IVLCControl
-    {
-        CONST_VTBL struct IVLCControlVtbl __RPC_FAR *lpVtbl;
-    };
-
-    
-
-#ifdef COBJMACROS
-
-
-#define IVLCControl_QueryInterface(This,riid,ppvObject)	\
-    (This)->lpVtbl -> QueryInterface(This,riid,ppvObject)
-
-#define IVLCControl_AddRef(This)	\
-    (This)->lpVtbl -> AddRef(This)
-
-#define IVLCControl_Release(This)	\
-    (This)->lpVtbl -> Release(This)
-
-
-#define IVLCControl_GetTypeInfoCount(This,pctinfo)	\
-    (This)->lpVtbl -> GetTypeInfoCount(This,pctinfo)
-
-#define IVLCControl_GetTypeInfo(This,iTInfo,lcid,ppTInfo)	\
-    (This)->lpVtbl -> GetTypeInfo(This,iTInfo,lcid,ppTInfo)
-
-#define IVLCControl_GetIDsOfNames(This,riid,rgszNames,cNames,lcid,rgDispId)	\
-    (This)->lpVtbl -> GetIDsOfNames(This,riid,rgszNames,cNames,lcid,rgDispId)
+interface IVLCControl : public IDispatch
+{
+    virtual HRESULT STDMETHODCALLTYPE get_Visible(
+        VARIANT_BOOL* visible) = 0;
 
-#define IVLCControl_Invoke(This,dispIdMember,riid,lcid,wFlags,pDispParams,pVarResult,pExcepInfo,puArgErr)	\
-    (This)->lpVtbl -> Invoke(This,dispIdMember,riid,lcid,wFlags,pDispParams,pVarResult,pExcepInfo,puArgErr)
+    virtual HRESULT STDMETHODCALLTYPE put_Visible(
+        VARIANT_BOOL visible) = 0;
 
+    virtual HRESULT STDMETHODCALLTYPE play(
+        ) = 0;
 
-#define IVLCControl_get_Visible(This,visible)	\
-    (This)->lpVtbl -> get_Visible(This,visible)
+    virtual HRESULT STDMETHODCALLTYPE pause(
+        ) = 0;
 
-#define IVLCControl_put_Visible(This,visible)	\
-    (This)->lpVtbl -> put_Visible(This,visible)
+    virtual HRESULT STDMETHODCALLTYPE stop(
+        ) = 0;
 
-#define IVLCControl_play(This)	\
-    (This)->lpVtbl -> play(This)
+    virtual HRESULT STDMETHODCALLTYPE get_Playing(
+        VARIANT_BOOL* isPlaying) = 0;
 
-#define IVLCControl_pause(This)	\
-    (This)->lpVtbl -> pause(This)
+    virtual HRESULT STDMETHODCALLTYPE get_Position(
+        float* position) = 0;
 
-#define IVLCControl_stop(This)	\
-    (This)->lpVtbl -> stop(This)
+    virtual HRESULT STDMETHODCALLTYPE put_Position(
+        float position) = 0;
 
-#define IVLCControl_get_Playing(This,isPlaying)	\
-    (This)->lpVtbl -> get_Playing(This,isPlaying)
+    virtual HRESULT STDMETHODCALLTYPE get_Time(
+        int* seconds) = 0;
 
-#define IVLCControl_get_Position(This,position)	\
-    (This)->lpVtbl -> get_Position(This,position)
+    virtual HRESULT STDMETHODCALLTYPE put_Time(
+        int seconds) = 0;
 
-#define IVLCControl_put_Position(This,position)	\
-    (This)->lpVtbl -> put_Position(This,position)
+    virtual HRESULT STDMETHODCALLTYPE shuttle(
+        int seconds) = 0;
 
-#define IVLCControl_get_Time(This,seconds)	\
-    (This)->lpVtbl -> get_Time(This,seconds)
+    virtual HRESULT STDMETHODCALLTYPE fullscreen(
+        ) = 0;
 
-#define IVLCControl_put_Time(This,seconds)	\
-    (This)->lpVtbl -> put_Time(This,seconds)
+    virtual HRESULT STDMETHODCALLTYPE get_Length(
+        int* seconds) = 0;
 
-#define IVLCControl_shuttle(This,seconds)	\
-    (This)->lpVtbl -> shuttle(This,seconds)
+    virtual HRESULT STDMETHODCALLTYPE playFaster(
+        ) = 0;
 
-#define IVLCControl_fullscreen(This)	\
-    (This)->lpVtbl -> fullscreen(This)
+    virtual HRESULT STDMETHODCALLTYPE playSlower(
+        ) = 0;
 
-#define IVLCControl_get_Length(This,seconds)	\
-    (This)->lpVtbl -> get_Length(This,seconds)
+    virtual HRESULT STDMETHODCALLTYPE get_Volume(
+        int* volume) = 0;
 
-#define IVLCControl_playFaster(This)	\
-    (This)->lpVtbl -> playFaster(This)
+    virtual HRESULT STDMETHODCALLTYPE put_Volume(
+        int volume) = 0;
 
-#define IVLCControl_playSlower(This)	\
-    (This)->lpVtbl -> playSlower(This)
+    virtual HRESULT STDMETHODCALLTYPE toggleMute(
+        ) = 0;
 
-#define IVLCControl_get_Volume(This,volume)	\
-    (This)->lpVtbl -> get_Volume(This,volume)
+    virtual HRESULT STDMETHODCALLTYPE setVariable(
+        BSTR name,
+        VARIANT value) = 0;
 
-#define IVLCControl_put_Volume(This,volume)	\
-    (This)->lpVtbl -> put_Volume(This,volume)
+    virtual HRESULT STDMETHODCALLTYPE getVariable(
+        BSTR name,
+        VARIANT* value) = 0;
 
-#define IVLCControl_toggleMute(This)	\
-    (This)->lpVtbl -> toggleMute(This)
+    virtual HRESULT STDMETHODCALLTYPE addTarget(
+        BSTR uri,
+        VARIANT options,
+        enum VLCPlaylistMode mode,
+        int position) = 0;
 
-#define IVLCControl_setVariable(This,name,value)	\
-    (This)->lpVtbl -> setVariable(This,name,value)
+    virtual HRESULT STDMETHODCALLTYPE get_PlaylistIndex(
+        int* index) = 0;
 
-#define IVLCControl_getVariable(This,name,value)	\
-    (This)->lpVtbl -> getVariable(This,name,value)
+    virtual HRESULT STDMETHODCALLTYPE get_PlaylistCount(
+        int* index) = 0;
 
-#define IVLCControl_addTarget(This,uri,options,mode,position)	\
-    (This)->lpVtbl -> addTarget(This,uri,options,mode,position)
+    virtual HRESULT STDMETHODCALLTYPE playlistNext(
+        ) = 0;
 
-#define IVLCControl_get_PlaylistIndex(This,index)	\
-    (This)->lpVtbl -> get_PlaylistIndex(This,index)
+    virtual HRESULT STDMETHODCALLTYPE playlistPrev(
+        ) = 0;
 
-#define IVLCControl_get_PlaylistCount(This,index)	\
-    (This)->lpVtbl -> get_PlaylistCount(This,index)
+    virtual HRESULT STDMETHODCALLTYPE playlistClear(
+        ) = 0;
 
-#define IVLCControl_playlistNext(This)	\
-    (This)->lpVtbl -> playlistNext(This)
+    virtual HRESULT STDMETHODCALLTYPE get_VersionInfo(
+        BSTR* version) = 0;
 
-#define IVLCControl_playlistPrev(This)	\
-    (This)->lpVtbl -> playlistPrev(This)
+    virtual HRESULT STDMETHODCALLTYPE get_MRL(
+        BSTR* mrl) = 0;
 
-#define IVLCControl_playlistClear(This)	\
-    (This)->lpVtbl -> playlistClear(This)
+    virtual HRESULT STDMETHODCALLTYPE put_MRL(
+        BSTR mrl) = 0;
 
-#define IVLCControl_get_VersionInfo(This,version)	\
-    (This)->lpVtbl -> get_VersionInfo(This,version)
+    virtual HRESULT STDMETHODCALLTYPE get_AutoPlay(
+        VARIANT_BOOL* autoplay) = 0;
 
-#define IVLCControl_get_MRL(This,mrl)	\
-    (This)->lpVtbl -> get_MRL(This,mrl)
+    virtual HRESULT STDMETHODCALLTYPE put_AutoPlay(
+        VARIANT_BOOL autoplay) = 0;
 
-#define IVLCControl_put_MRL(This,mrl)	\
-    (This)->lpVtbl -> put_MRL(This,mrl)
+    virtual HRESULT STDMETHODCALLTYPE get_AutoLoop(
+        VARIANT_BOOL* autoloop) = 0;
 
-#define IVLCControl_get_AutoPlay(This,autoplay)	\
-    (This)->lpVtbl -> get_AutoPlay(This,autoplay)
-
-#define IVLCControl_put_AutoPlay(This,autoplay)	\
-    (This)->lpVtbl -> put_AutoPlay(This,autoplay)
-
-#define IVLCControl_get_AutoLoop(This,autoloop)	\
-    (This)->lpVtbl -> get_AutoLoop(This,autoloop)
-
-#define IVLCControl_put_AutoLoop(This,autoloop)	\
-    (This)->lpVtbl -> put_AutoLoop(This,autoloop)
-
-#endif /* COBJMACROS */
-
-
-#endif 	/* C style interface */
+    virtual HRESULT STDMETHODCALLTYPE put_AutoLoop(
+        VARIANT_BOOL autoloop) = 0;
 
+};
+#else
+typedef struct IVLCControlVtbl {
+    BEGIN_INTERFACE
 
+    /*** IUnknown methods ***/
+    HRESULT (STDMETHODCALLTYPE *QueryInterface)(
+        IVLCControl* This,
+        REFIID riid,
+        void** ppvObject);
+
+    ULONG (STDMETHODCALLTYPE *AddRef)(
+        IVLCControl* This);
+
+    ULONG (STDMETHODCALLTYPE *Release)(
+        IVLCControl* This);
+
+    /*** IDispatch methods ***/
+    HRESULT (STDMETHODCALLTYPE *GetTypeInfoCount)(
+        IVLCControl* This,
+        UINT* pctinfo);
+
+    HRESULT (STDMETHODCALLTYPE *GetTypeInfo)(
+        IVLCControl* This,
+        UINT iTInfo,
+        LCID lcid,
+        ITypeInfo** ppTInfo);
+
+    HRESULT (STDMETHODCALLTYPE *GetIDsOfNames)(
+        IVLCControl* This,
+        REFIID riid,
+        LPOLESTR* rgszNames,
+        UINT cNames,
+        LCID lcid,
+        DISPID* rgDispId);
+
+    HRESULT (STDMETHODCALLTYPE *Invoke)(
+        IVLCControl* This,
+        DISPID dispIdMember,
+        REFIID riid,
+        LCID lcid,
+        WORD wFlags,
+        DISPPARAMS* pDispParams,
+        VARIANT* pVarResult,
+        EXCEPINFO* pExcepInfo,
+        UINT* puArgErr);
+
+    /*** IVLCControl methods ***/
+    HRESULT (STDMETHODCALLTYPE *get_Visible)(
+        IVLCControl* This,
+        VARIANT_BOOL* visible);
+
+    HRESULT (STDMETHODCALLTYPE *put_Visible)(
+        IVLCControl* This,
+        VARIANT_BOOL visible);
+
+    HRESULT (STDMETHODCALLTYPE *play)(
+        IVLCControl* This);
+
+    HRESULT (STDMETHODCALLTYPE *pause)(
+        IVLCControl* This);
+
+    HRESULT (STDMETHODCALLTYPE *stop)(
+        IVLCControl* This);
+
+    HRESULT (STDMETHODCALLTYPE *get_Playing)(
+        IVLCControl* This,
+        VARIANT_BOOL* isPlaying);
+
+    HRESULT (STDMETHODCALLTYPE *get_Position)(
+        IVLCControl* This,
+        float* position);
+
+    HRESULT (STDMETHODCALLTYPE *put_Position)(
+        IVLCControl* This,
+        float position);
+
+    HRESULT (STDMETHODCALLTYPE *get_Time)(
+        IVLCControl* This,
+        int* seconds);
+
+    HRESULT (STDMETHODCALLTYPE *put_Time)(
+        IVLCControl* This,
+        int seconds);
+
+    HRESULT (STDMETHODCALLTYPE *shuttle)(
+        IVLCControl* This,
+        int seconds);
+
+    HRESULT (STDMETHODCALLTYPE *fullscreen)(
+        IVLCControl* This);
+
+    HRESULT (STDMETHODCALLTYPE *get_Length)(
+        IVLCControl* This,
+        int* seconds);
+
+    HRESULT (STDMETHODCALLTYPE *playFaster)(
+        IVLCControl* This);
+
+    HRESULT (STDMETHODCALLTYPE *playSlower)(
+        IVLCControl* This);
+
+    HRESULT (STDMETHODCALLTYPE *get_Volume)(
+        IVLCControl* This,
+        int* volume);
+
+    HRESULT (STDMETHODCALLTYPE *put_Volume)(
+        IVLCControl* This,
+        int volume);
+
+    HRESULT (STDMETHODCALLTYPE *toggleMute)(
+        IVLCControl* This);
+
+    HRESULT (STDMETHODCALLTYPE *setVariable)(
+        IVLCControl* This,
+        BSTR name,
+        VARIANT value);
+
+    HRESULT (STDMETHODCALLTYPE *getVariable)(
+        IVLCControl* This,
+        BSTR name,
+        VARIANT* value);
+
+    HRESULT (STDMETHODCALLTYPE *addTarget)(
+        IVLCControl* This,
+        BSTR uri,
+        VARIANT options,
+        enum VLCPlaylistMode mode,
+        int position);
+
+    HRESULT (STDMETHODCALLTYPE *get_PlaylistIndex)(
+        IVLCControl* This,
+        int* index);
+
+    HRESULT (STDMETHODCALLTYPE *get_PlaylistCount)(
+        IVLCControl* This,
+        int* index);
+
+    HRESULT (STDMETHODCALLTYPE *playlistNext)(
+        IVLCControl* This);
+
+    HRESULT (STDMETHODCALLTYPE *playlistPrev)(
+        IVLCControl* This);
+
+    HRESULT (STDMETHODCALLTYPE *playlistClear)(
+        IVLCControl* This);
+
+    HRESULT (STDMETHODCALLTYPE *get_VersionInfo)(
+        IVLCControl* This,
+        BSTR* version);
+
+    HRESULT (STDMETHODCALLTYPE *get_MRL)(
+        IVLCControl* This,
+        BSTR* mrl);
+
+    HRESULT (STDMETHODCALLTYPE *put_MRL)(
+        IVLCControl* This,
+        BSTR mrl);
+
+    HRESULT (STDMETHODCALLTYPE *get_AutoPlay)(
+        IVLCControl* This,
+        VARIANT_BOOL* autoplay);
+
+    HRESULT (STDMETHODCALLTYPE *put_AutoPlay)(
+        IVLCControl* This,
+        VARIANT_BOOL autoplay);
+
+    HRESULT (STDMETHODCALLTYPE *get_AutoLoop)(
+        IVLCControl* This,
+        VARIANT_BOOL* autoloop);
+
+    HRESULT (STDMETHODCALLTYPE *put_AutoLoop)(
+        IVLCControl* This,
+        VARIANT_BOOL autoloop);
+
+    END_INTERFACE
+} IVLCControlVtbl;
+interface IVLCControl {
+    const IVLCControlVtbl* lpVtbl;
+};
 
-/* [helpstring][bindable][propget][id] */ HRESULT STDMETHODCALLTYPE IVLCControl_get_Visible_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [retval][out] */ VARIANT_BOOL __RPC_FAR *visible);
+#ifdef COBJMACROS
+/*** IUnknown methods ***/
+#define IVLCControl_QueryInterface(p,a,b) (p)->lpVtbl->QueryInterface(p,a,b)
+#define IVLCControl_AddRef(p) (p)->lpVtbl->AddRef(p)
+#define IVLCControl_Release(p) (p)->lpVtbl->Release(p)
+/*** IDispatch methods ***/
+#define IVLCControl_GetTypeInfoCount(p,a) (p)->lpVtbl->GetTypeInfoCount(p,a)
+#define IVLCControl_GetTypeInfo(p,a,b,c) (p)->lpVtbl->GetTypeInfo(p,a,b,c)
+#define IVLCControl_GetIDsOfNames(p,a,b,c,d,e) (p)->lpVtbl->GetIDsOfNames(p,a,b,c,d,e)
+#define IVLCControl_Invoke(p,a,b,c,d,e,f,g,h) (p)->lpVtbl->Invoke(p,a,b,c,d,e,f,g,h)
+/*** IVLCControl methods ***/
+#define IVLCControl_get_Visible(p,a) (p)->lpVtbl->get_Visible(p,a)
+#define IVLCControl_put_Visible(p,a) (p)->lpVtbl->put_Visible(p,a)
+#define IVLCControl_play(p) (p)->lpVtbl->play(p)
+#define IVLCControl_pause(p) (p)->lpVtbl->pause(p)
+#define IVLCControl_stop(p) (p)->lpVtbl->stop(p)
+#define IVLCControl_get_Playing(p,a) (p)->lpVtbl->get_Playing(p,a)
+#define IVLCControl_get_Position(p,a) (p)->lpVtbl->get_Position(p,a)
+#define IVLCControl_put_Position(p,a) (p)->lpVtbl->put_Position(p,a)
+#define IVLCControl_get_Time(p,a) (p)->lpVtbl->get_Time(p,a)
+#define IVLCControl_put_Time(p,a) (p)->lpVtbl->put_Time(p,a)
+#define IVLCControl_shuttle(p,a) (p)->lpVtbl->shuttle(p,a)
+#define IVLCControl_fullscreen(p) (p)->lpVtbl->fullscreen(p)
+#define IVLCControl_get_Length(p,a) (p)->lpVtbl->get_Length(p,a)
+#define IVLCControl_playFaster(p) (p)->lpVtbl->playFaster(p)
+#define IVLCControl_playSlower(p) (p)->lpVtbl->playSlower(p)
+#define IVLCControl_get_Volume(p,a) (p)->lpVtbl->get_Volume(p,a)
+#define IVLCControl_put_Volume(p,a) (p)->lpVtbl->put_Volume(p,a)
+#define IVLCControl_toggleMute(p) (p)->lpVtbl->toggleMute(p)
+#define IVLCControl_setVariable(p,a,b) (p)->lpVtbl->setVariable(p,a,b)
+#define IVLCControl_getVariable(p,a,b) (p)->lpVtbl->getVariable(p,a,b)
+#define IVLCControl_addTarget(p,a,b,c,d) (p)->lpVtbl->addTarget(p,a,b,c,d)
+#define IVLCControl_get_PlaylistIndex(p,a) (p)->lpVtbl->get_PlaylistIndex(p,a)
+#define IVLCControl_get_PlaylistCount(p,a) (p)->lpVtbl->get_PlaylistCount(p,a)
+#define IVLCControl_playlistNext(p) (p)->lpVtbl->playlistNext(p)
+#define IVLCControl_playlistPrev(p) (p)->lpVtbl->playlistPrev(p)
+#define IVLCControl_playlistClear(p) (p)->lpVtbl->playlistClear(p)
+#define IVLCControl_get_VersionInfo(p,a) (p)->lpVtbl->get_VersionInfo(p,a)
+#define IVLCControl_get_MRL(p,a) (p)->lpVtbl->get_MRL(p,a)
+#define IVLCControl_put_MRL(p,a) (p)->lpVtbl->put_MRL(p,a)
+#define IVLCControl_get_AutoPlay(p,a) (p)->lpVtbl->get_AutoPlay(p,a)
+#define IVLCControl_put_AutoPlay(p,a) (p)->lpVtbl->put_AutoPlay(p,a)
+#define IVLCControl_get_AutoLoop(p,a) (p)->lpVtbl->get_AutoLoop(p,a)
+#define IVLCControl_put_AutoLoop(p,a) (p)->lpVtbl->put_AutoLoop(p,a)
+#endif
 
+#endif
 
+HRESULT CALLBACK IVLCControl_get_Visible_Proxy(
+    IVLCControl* This,
+    VARIANT_BOOL* visible);
 void __RPC_STUB IVLCControl_get_Visible_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
-
-
-/* [helpstring][bindable][propput][id] */ HRESULT STDMETHODCALLTYPE IVLCControl_put_Visible_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [in] */ VARIANT_BOOL visible);
-
-
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_put_Visible_Proxy(
+    IVLCControl* This,
+    VARIANT_BOOL visible);
 void __RPC_STUB IVLCControl_put_Visible_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
-
-
-/* [helpstring] */ HRESULT STDMETHODCALLTYPE IVLCControl_play_Proxy( 
-    IVLCControl __RPC_FAR * This);
-
-
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_play_Proxy(
+    IVLCControl* This);
 void __RPC_STUB IVLCControl_play_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
-
-
-/* [helpstring] */ HRESULT STDMETHODCALLTYPE IVLCControl_pause_Proxy( 
-    IVLCControl __RPC_FAR * This);
-
-
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_pause_Proxy(
+    IVLCControl* This);
 void __RPC_STUB IVLCControl_pause_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
-
-
-/* [helpstring] */ HRESULT STDMETHODCALLTYPE IVLCControl_stop_Proxy( 
-    IVLCControl __RPC_FAR * This);
-
-
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_stop_Proxy(
+    IVLCControl* This);
 void __RPC_STUB IVLCControl_stop_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
-
-
-/* [helpstring][propget][hidden][id] */ HRESULT STDMETHODCALLTYPE IVLCControl_get_Playing_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [retval][out] */ VARIANT_BOOL __RPC_FAR *isPlaying);
-
-
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_get_Playing_Proxy(
+    IVLCControl* This,
+    VARIANT_BOOL* isPlaying);
 void __RPC_STUB IVLCControl_get_Playing_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
-
-
-/* [helpstring][propget][id] */ HRESULT STDMETHODCALLTYPE IVLCControl_get_Position_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [retval][out] */ float __RPC_FAR *position);
-
-
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_get_Position_Proxy(
+    IVLCControl* This,
+    float* position);
 void __RPC_STUB IVLCControl_get_Position_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
-
-
-/* [helpstring][propput][id] */ HRESULT STDMETHODCALLTYPE IVLCControl_put_Position_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [in] */ float position);
-
-
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_put_Position_Proxy(
+    IVLCControl* This,
+    float position);
 void __RPC_STUB IVLCControl_put_Position_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
-
-
-/* [helpstring][propget][id] */ HRESULT STDMETHODCALLTYPE IVLCControl_get_Time_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [retval][out] */ int __RPC_FAR *seconds);
-
-
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_get_Time_Proxy(
+    IVLCControl* This,
+    int* seconds);
 void __RPC_STUB IVLCControl_get_Time_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
-
-
-/* [helpstring][propput][id] */ HRESULT STDMETHODCALLTYPE IVLCControl_put_Time_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [in] */ int seconds);
-
-
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_put_Time_Proxy(
+    IVLCControl* This,
+    int seconds);
 void __RPC_STUB IVLCControl_put_Time_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
-
-
-/* [helpstring] */ HRESULT STDMETHODCALLTYPE IVLCControl_shuttle_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [in] */ int seconds);
-
-
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_shuttle_Proxy(
+    IVLCControl* This,
+    int seconds);
 void __RPC_STUB IVLCControl_shuttle_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
-
-
-/* [helpstring] */ HRESULT STDMETHODCALLTYPE IVLCControl_fullscreen_Proxy( 
-    IVLCControl __RPC_FAR * This);
-
-
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_fullscreen_Proxy(
+    IVLCControl* This);
 void __RPC_STUB IVLCControl_fullscreen_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
-
-
-/* [helpstring][hidden][propget][id] */ HRESULT STDMETHODCALLTYPE IVLCControl_get_Length_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [retval][out] */ int __RPC_FAR *seconds);
-
-
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_get_Length_Proxy(
+    IVLCControl* This,
+    int* seconds);
 void __RPC_STUB IVLCControl_get_Length_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
-
-
-/* [helpstring] */ HRESULT STDMETHODCALLTYPE IVLCControl_playFaster_Proxy( 
-    IVLCControl __RPC_FAR * This);
-
-
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_playFaster_Proxy(
+    IVLCControl* This);
 void __RPC_STUB IVLCControl_playFaster_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
-
-
-/* [helpstring] */ HRESULT STDMETHODCALLTYPE IVLCControl_playSlower_Proxy( 
-    IVLCControl __RPC_FAR * This);
-
-
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_playSlower_Proxy(
+    IVLCControl* This);
 void __RPC_STUB IVLCControl_playSlower_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
-
-
-/* [helpstring][propget][id] */ HRESULT STDMETHODCALLTYPE IVLCControl_get_Volume_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [retval][out] */ int __RPC_FAR *volume);
-
-
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_get_Volume_Proxy(
+    IVLCControl* This,
+    int* volume);
 void __RPC_STUB IVLCControl_get_Volume_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_put_Volume_Proxy(
+    IVLCControl* This,
+    int volume);
+void __RPC_STUB IVLCControl_put_Volume_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_toggleMute_Proxy(
+    IVLCControl* This);
+void __RPC_STUB IVLCControl_toggleMute_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_setVariable_Proxy(
+    IVLCControl* This,
+    BSTR name,
+    VARIANT value);
+void __RPC_STUB IVLCControl_setVariable_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_getVariable_Proxy(
+    IVLCControl* This,
+    BSTR name,
+    VARIANT* value);
+void __RPC_STUB IVLCControl_getVariable_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_addTarget_Proxy(
+    IVLCControl* This,
+    BSTR uri,
+    VARIANT options,
+    enum VLCPlaylistMode mode,
+    int position);
+void __RPC_STUB IVLCControl_addTarget_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_get_PlaylistIndex_Proxy(
+    IVLCControl* This,
+    int* index);
+void __RPC_STUB IVLCControl_get_PlaylistIndex_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_get_PlaylistCount_Proxy(
+    IVLCControl* This,
+    int* index);
+void __RPC_STUB IVLCControl_get_PlaylistCount_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_playlistNext_Proxy(
+    IVLCControl* This);
+void __RPC_STUB IVLCControl_playlistNext_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_playlistPrev_Proxy(
+    IVLCControl* This);
+void __RPC_STUB IVLCControl_playlistPrev_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_playlistClear_Proxy(
+    IVLCControl* This);
+void __RPC_STUB IVLCControl_playlistClear_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_get_VersionInfo_Proxy(
+    IVLCControl* This,
+    BSTR* version);
+void __RPC_STUB IVLCControl_get_VersionInfo_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_get_MRL_Proxy(
+    IVLCControl* This,
+    BSTR* mrl);
+void __RPC_STUB IVLCControl_get_MRL_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_put_MRL_Proxy(
+    IVLCControl* This,
+    BSTR mrl);
+void __RPC_STUB IVLCControl_put_MRL_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_get_AutoPlay_Proxy(
+    IVLCControl* This,
+    VARIANT_BOOL* autoplay);
+void __RPC_STUB IVLCControl_get_AutoPlay_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_put_AutoPlay_Proxy(
+    IVLCControl* This,
+    VARIANT_BOOL autoplay);
+void __RPC_STUB IVLCControl_put_AutoPlay_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_get_AutoLoop_Proxy(
+    IVLCControl* This,
+    VARIANT_BOOL* autoloop);
+void __RPC_STUB IVLCControl_get_AutoLoop_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl_put_AutoLoop_Proxy(
+    IVLCControl* This,
+    VARIANT_BOOL autoloop);
+void __RPC_STUB IVLCControl_put_AutoLoop_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
 
+#endif  /* __IVLCControl_INTERFACE_DEFINED__ */
 
-/* [helpstring][propput][id] */ HRESULT STDMETHODCALLTYPE IVLCControl_put_Volume_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [in] */ int volume);
+#define DISPID_PlayEvent (100)
 
+#define DISPID_PauseEvent (101)
 
-void __RPC_STUB IVLCControl_put_Volume_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
+#define DISPID_StopEvent (102)
+
+/*****************************************************************************
+ * DVLCEvents dispinterface
+ */
+#ifndef __DVLCEvents_DISPINTERFACE_DEFINED__
+#define __DVLCEvents_DISPINTERFACE_DEFINED__
 
+DEFINE_GUID(DIID_DVLCEvents, 0xdf48072f, 0x5ef8, 0x434e, 0x9b,0x40, 0xe2,0xf3,0xae,0x75,0x9b,0x5f);
+#if defined(__cplusplus) && !defined(CINTERFACE)
+interface DVLCEvents : public IDispatch
+{
+};
+#else
+typedef struct DVLCEventsVtbl {
+    BEGIN_INTERFACE
 
-/* [helpstring] */ HRESULT STDMETHODCALLTYPE IVLCControl_toggleMute_Proxy( 
-    IVLCControl __RPC_FAR * This);
+    /*** IUnknown methods ***/
+    HRESULT (STDMETHODCALLTYPE *QueryInterface)(
+        DVLCEvents* This,
+        REFIID riid,
+        void** ppvObject);
+
+    ULONG (STDMETHODCALLTYPE *AddRef)(
+        DVLCEvents* This);
+
+    ULONG (STDMETHODCALLTYPE *Release)(
+        DVLCEvents* This);
+
+    /*** IDispatch methods ***/
+    HRESULT (STDMETHODCALLTYPE *GetTypeInfoCount)(
+        DVLCEvents* This,
+        UINT* pctinfo);
+
+    HRESULT (STDMETHODCALLTYPE *GetTypeInfo)(
+        DVLCEvents* This,
+        UINT iTInfo,
+        LCID lcid,
+        ITypeInfo** ppTInfo);
+
+    HRESULT (STDMETHODCALLTYPE *GetIDsOfNames)(
+        DVLCEvents* This,
+        REFIID riid,
+        LPOLESTR* rgszNames,
+        UINT cNames,
+        LCID lcid,
+        DISPID* rgDispId);
+
+    HRESULT (STDMETHODCALLTYPE *Invoke)(
+        DVLCEvents* This,
+        DISPID dispIdMember,
+        REFIID riid,
+        LCID lcid,
+        WORD wFlags,
+        DISPPARAMS* pDispParams,
+        VARIANT* pVarResult,
+        EXCEPINFO* pExcepInfo,
+        UINT* puArgErr);
+
+    END_INTERFACE
+} DVLCEventsVtbl;
+interface DVLCEvents {
+    const DVLCEventsVtbl* lpVtbl;
+};
 
+#ifdef COBJMACROS
+/*** IUnknown methods ***/
+#define DVLCEvents_QueryInterface(p,a,b) (p)->lpVtbl->QueryInterface(p,a,b)
+#define DVLCEvents_AddRef(p) (p)->lpVtbl->AddRef(p)
+#define DVLCEvents_Release(p) (p)->lpVtbl->Release(p)
+/*** IDispatch methods ***/
+#define DVLCEvents_GetTypeInfoCount(p,a) (p)->lpVtbl->GetTypeInfoCount(p,a)
+#define DVLCEvents_GetTypeInfo(p,a,b,c) (p)->lpVtbl->GetTypeInfo(p,a,b,c)
+#define DVLCEvents_GetIDsOfNames(p,a,b,c,d,e) (p)->lpVtbl->GetIDsOfNames(p,a,b,c,d,e)
+#define DVLCEvents_Invoke(p,a,b,c,d,e,f,g,h) (p)->lpVtbl->Invoke(p,a,b,c,d,e,f,g,h)
+#endif
 
-void __RPC_STUB IVLCControl_toggleMute_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
+#endif
 
+#endif  /* __DVLCEvents_DISPINTERFACE_DEFINED__ */
 
-/* [helpstring] */ HRESULT STDMETHODCALLTYPE IVLCControl_setVariable_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [in] */ BSTR name,
-    /* [in] */ VARIANT value);
+/*****************************************************************************
+ * IVLCAudio interface
+ */
+#ifndef __IVLCAudio_INTERFACE_DEFINED__
+#define __IVLCAudio_INTERFACE_DEFINED__
 
+DEFINE_GUID(IID_IVLCAudio, 0x9e0bd17b, 0x2d3c, 0x4656, 0xb9,0x4d, 0x03,0x08,0x4f,0x3f,0xd9,0xd4);
+#if defined(__cplusplus) && !defined(CINTERFACE)
+interface IVLCAudio : public IDispatch
+{
+    virtual HRESULT STDMETHODCALLTYPE get_mute(
+        VARIANT_BOOL* muted) = 0;
 
-void __RPC_STUB IVLCControl_setVariable_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
+    virtual HRESULT STDMETHODCALLTYPE put_mute(
+        VARIANT_BOOL muted) = 0;
 
+    virtual HRESULT STDMETHODCALLTYPE get_volume(
+        int* volume) = 0;
 
-/* [helpstring] */ HRESULT STDMETHODCALLTYPE IVLCControl_getVariable_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [in] */ BSTR name,
-    /* [retval][out] */ VARIANT __RPC_FAR *value);
+    virtual HRESULT STDMETHODCALLTYPE put_volume(
+        int volume) = 0;
 
+    virtual HRESULT STDMETHODCALLTYPE toggleMute(
+        ) = 0;
 
-void __RPC_STUB IVLCControl_getVariable_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
+};
+#else
+typedef struct IVLCAudioVtbl {
+    BEGIN_INTERFACE
 
+    /*** IUnknown methods ***/
+    HRESULT (STDMETHODCALLTYPE *QueryInterface)(
+        IVLCAudio* This,
+        REFIID riid,
+        void** ppvObject);
+
+    ULONG (STDMETHODCALLTYPE *AddRef)(
+        IVLCAudio* This);
+
+    ULONG (STDMETHODCALLTYPE *Release)(
+        IVLCAudio* This);
+
+    /*** IDispatch methods ***/
+    HRESULT (STDMETHODCALLTYPE *GetTypeInfoCount)(
+        IVLCAudio* This,
+        UINT* pctinfo);
+
+    HRESULT (STDMETHODCALLTYPE *GetTypeInfo)(
+        IVLCAudio* This,
+        UINT iTInfo,
+        LCID lcid,
+        ITypeInfo** ppTInfo);
+
+    HRESULT (STDMETHODCALLTYPE *GetIDsOfNames)(
+        IVLCAudio* This,
+        REFIID riid,
+        LPOLESTR* rgszNames,
+        UINT cNames,
+        LCID lcid,
+        DISPID* rgDispId);
+
+    HRESULT (STDMETHODCALLTYPE *Invoke)(
+        IVLCAudio* This,
+        DISPID dispIdMember,
+        REFIID riid,
+        LCID lcid,
+        WORD wFlags,
+        DISPPARAMS* pDispParams,
+        VARIANT* pVarResult,
+        EXCEPINFO* pExcepInfo,
+        UINT* puArgErr);
+
+    /*** IVLCAudio methods ***/
+    HRESULT (STDMETHODCALLTYPE *get_mute)(
+        IVLCAudio* This,
+        VARIANT_BOOL* muted);
+
+    HRESULT (STDMETHODCALLTYPE *put_mute)(
+        IVLCAudio* This,
+        VARIANT_BOOL muted);
+
+    HRESULT (STDMETHODCALLTYPE *get_volume)(
+        IVLCAudio* This,
+        int* volume);
+
+    HRESULT (STDMETHODCALLTYPE *put_volume)(
+        IVLCAudio* This,
+        int volume);
+
+    HRESULT (STDMETHODCALLTYPE *toggleMute)(
+        IVLCAudio* This);
+
+    END_INTERFACE
+} IVLCAudioVtbl;
+interface IVLCAudio {
+    const IVLCAudioVtbl* lpVtbl;
+};
 
-/* [helpstring] */ HRESULT STDMETHODCALLTYPE IVLCControl_addTarget_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [in] */ BSTR uri,
-    /* [in] */ VARIANT options,
-    /* [in] */ enum VLCPlaylistMode mode,
-    /* [in] */ int position);
+#ifdef COBJMACROS
+/*** IUnknown methods ***/
+#define IVLCAudio_QueryInterface(p,a,b) (p)->lpVtbl->QueryInterface(p,a,b)
+#define IVLCAudio_AddRef(p) (p)->lpVtbl->AddRef(p)
+#define IVLCAudio_Release(p) (p)->lpVtbl->Release(p)
+/*** IDispatch methods ***/
+#define IVLCAudio_GetTypeInfoCount(p,a) (p)->lpVtbl->GetTypeInfoCount(p,a)
+#define IVLCAudio_GetTypeInfo(p,a,b,c) (p)->lpVtbl->GetTypeInfo(p,a,b,c)
+#define IVLCAudio_GetIDsOfNames(p,a,b,c,d,e) (p)->lpVtbl->GetIDsOfNames(p,a,b,c,d,e)
+#define IVLCAudio_Invoke(p,a,b,c,d,e,f,g,h) (p)->lpVtbl->Invoke(p,a,b,c,d,e,f,g,h)
+/*** IVLCAudio methods ***/
+#define IVLCAudio_get_mute(p,a) (p)->lpVtbl->get_mute(p,a)
+#define IVLCAudio_put_mute(p,a) (p)->lpVtbl->put_mute(p,a)
+#define IVLCAudio_get_volume(p,a) (p)->lpVtbl->get_volume(p,a)
+#define IVLCAudio_put_volume(p,a) (p)->lpVtbl->put_volume(p,a)
+#define IVLCAudio_toggleMute(p) (p)->lpVtbl->toggleMute(p)
+#endif
 
+#endif
 
-void __RPC_STUB IVLCControl_addTarget_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
+HRESULT CALLBACK IVLCAudio_get_mute_Proxy(
+    IVLCAudio* This,
+    VARIANT_BOOL* muted);
+void __RPC_STUB IVLCAudio_get_mute_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCAudio_put_mute_Proxy(
+    IVLCAudio* This,
+    VARIANT_BOOL muted);
+void __RPC_STUB IVLCAudio_put_mute_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCAudio_get_volume_Proxy(
+    IVLCAudio* This,
+    int* volume);
+void __RPC_STUB IVLCAudio_get_volume_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCAudio_put_volume_Proxy(
+    IVLCAudio* This,
+    int volume);
+void __RPC_STUB IVLCAudio_put_volume_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCAudio_toggleMute_Proxy(
+    IVLCAudio* This);
+void __RPC_STUB IVLCAudio_toggleMute_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
 
+#endif  /* __IVLCAudio_INTERFACE_DEFINED__ */
 
-/* [helpstring][propget] */ HRESULT STDMETHODCALLTYPE IVLCControl_get_PlaylistIndex_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [retval][out] */ int __RPC_FAR *index);
+/*****************************************************************************
+ * IVLCInput interface
+ */
+#ifndef __IVLCInput_INTERFACE_DEFINED__
+#define __IVLCInput_INTERFACE_DEFINED__
 
+DEFINE_GUID(IID_IVLCInput, 0x49e0dbd1, 0x9440, 0x466c, 0x9c,0x97, 0x95,0xc6,0x71,0x90,0xc6,0x03);
+#if defined(__cplusplus) && !defined(CINTERFACE)
+interface IVLCInput : public IDispatch
+{
+    virtual HRESULT STDMETHODCALLTYPE get_length(
+        double* length) = 0;
 
-void __RPC_STUB IVLCControl_get_PlaylistIndex_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
+    virtual HRESULT STDMETHODCALLTYPE get_position(
+        float* position) = 0;
 
+    virtual HRESULT STDMETHODCALLTYPE put_position(
+        float position) = 0;
 
-/* [helpstring][propget] */ HRESULT STDMETHODCALLTYPE IVLCControl_get_PlaylistCount_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [retval][out] */ int __RPC_FAR *index);
+    virtual HRESULT STDMETHODCALLTYPE get_time(
+        double* time) = 0;
 
+    virtual HRESULT STDMETHODCALLTYPE put_time(
+        double time) = 0;
 
-void __RPC_STUB IVLCControl_get_PlaylistCount_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
+    virtual HRESULT STDMETHODCALLTYPE get_state(
+        int* state) = 0;
 
+    virtual HRESULT STDMETHODCALLTYPE get_rate(
+        float* rate) = 0;
 
-/* [helpstring] */ HRESULT STDMETHODCALLTYPE IVLCControl_playlistNext_Proxy( 
-    IVLCControl __RPC_FAR * This);
+    virtual HRESULT STDMETHODCALLTYPE put_rate(
+        float rate) = 0;
 
+    virtual HRESULT STDMETHODCALLTYPE get_fps(
+        float* fps) = 0;
 
-void __RPC_STUB IVLCControl_playlistNext_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
+    virtual HRESULT STDMETHODCALLTYPE get_hasVout(
+        VARIANT_BOOL* hasVout) = 0;
 
+};
+#else
+typedef struct IVLCInputVtbl {
+    BEGIN_INTERFACE
 
-/* [helpstring] */ HRESULT STDMETHODCALLTYPE IVLCControl_playlistPrev_Proxy( 
-    IVLCControl __RPC_FAR * This);
+    /*** IUnknown methods ***/
+    HRESULT (STDMETHODCALLTYPE *QueryInterface)(
+        IVLCInput* This,
+        REFIID riid,
+        void** ppvObject);
+
+    ULONG (STDMETHODCALLTYPE *AddRef)(
+        IVLCInput* This);
+
+    ULONG (STDMETHODCALLTYPE *Release)(
+        IVLCInput* This);
+
+    /*** IDispatch methods ***/
+    HRESULT (STDMETHODCALLTYPE *GetTypeInfoCount)(
+        IVLCInput* This,
+        UINT* pctinfo);
+
+    HRESULT (STDMETHODCALLTYPE *GetTypeInfo)(
+        IVLCInput* This,
+        UINT iTInfo,
+        LCID lcid,
+        ITypeInfo** ppTInfo);
+
+    HRESULT (STDMETHODCALLTYPE *GetIDsOfNames)(
+        IVLCInput* This,
+        REFIID riid,
+        LPOLESTR* rgszNames,
+        UINT cNames,
+        LCID lcid,
+        DISPID* rgDispId);
+
+    HRESULT (STDMETHODCALLTYPE *Invoke)(
+        IVLCInput* This,
+        DISPID dispIdMember,
+        REFIID riid,
+        LCID lcid,
+        WORD wFlags,
+        DISPPARAMS* pDispParams,
+        VARIANT* pVarResult,
+        EXCEPINFO* pExcepInfo,
+        UINT* puArgErr);
+
+    /*** IVLCInput methods ***/
+    HRESULT (STDMETHODCALLTYPE *get_length)(
+        IVLCInput* This,
+        double* length);
+
+    HRESULT (STDMETHODCALLTYPE *get_position)(
+        IVLCInput* This,
+        float* position);
+
+    HRESULT (STDMETHODCALLTYPE *put_position)(
+        IVLCInput* This,
+        float position);
+
+    HRESULT (STDMETHODCALLTYPE *get_time)(
+        IVLCInput* This,
+        double* time);
+
+    HRESULT (STDMETHODCALLTYPE *put_time)(
+        IVLCInput* This,
+        double time);
+
+    HRESULT (STDMETHODCALLTYPE *get_state)(
+        IVLCInput* This,
+        int* state);
+
+    HRESULT (STDMETHODCALLTYPE *get_rate)(
+        IVLCInput* This,
+        float* rate);
+
+    HRESULT (STDMETHODCALLTYPE *put_rate)(
+        IVLCInput* This,
+        float rate);
+
+    HRESULT (STDMETHODCALLTYPE *get_fps)(
+        IVLCInput* This,
+        float* fps);
+
+    HRESULT (STDMETHODCALLTYPE *get_hasVout)(
+        IVLCInput* This,
+        VARIANT_BOOL* hasVout);
+
+    END_INTERFACE
+} IVLCInputVtbl;
+interface IVLCInput {
+    const IVLCInputVtbl* lpVtbl;
+};
 
+#ifdef COBJMACROS
+/*** IUnknown methods ***/
+#define IVLCInput_QueryInterface(p,a,b) (p)->lpVtbl->QueryInterface(p,a,b)
+#define IVLCInput_AddRef(p) (p)->lpVtbl->AddRef(p)
+#define IVLCInput_Release(p) (p)->lpVtbl->Release(p)
+/*** IDispatch methods ***/
+#define IVLCInput_GetTypeInfoCount(p,a) (p)->lpVtbl->GetTypeInfoCount(p,a)
+#define IVLCInput_GetTypeInfo(p,a,b,c) (p)->lpVtbl->GetTypeInfo(p,a,b,c)
+#define IVLCInput_GetIDsOfNames(p,a,b,c,d,e) (p)->lpVtbl->GetIDsOfNames(p,a,b,c,d,e)
+#define IVLCInput_Invoke(p,a,b,c,d,e,f,g,h) (p)->lpVtbl->Invoke(p,a,b,c,d,e,f,g,h)
+/*** IVLCInput methods ***/
+#define IVLCInput_get_length(p,a) (p)->lpVtbl->get_length(p,a)
+#define IVLCInput_get_position(p,a) (p)->lpVtbl->get_position(p,a)
+#define IVLCInput_put_position(p,a) (p)->lpVtbl->put_position(p,a)
+#define IVLCInput_get_time(p,a) (p)->lpVtbl->get_time(p,a)
+#define IVLCInput_put_time(p,a) (p)->lpVtbl->put_time(p,a)
+#define IVLCInput_get_state(p,a) (p)->lpVtbl->get_state(p,a)
+#define IVLCInput_get_rate(p,a) (p)->lpVtbl->get_rate(p,a)
+#define IVLCInput_put_rate(p,a) (p)->lpVtbl->put_rate(p,a)
+#define IVLCInput_get_fps(p,a) (p)->lpVtbl->get_fps(p,a)
+#define IVLCInput_get_hasVout(p,a) (p)->lpVtbl->get_hasVout(p,a)
+#endif
 
-void __RPC_STUB IVLCControl_playlistPrev_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
+#endif
 
+HRESULT CALLBACK IVLCInput_get_length_Proxy(
+    IVLCInput* This,
+    double* length);
+void __RPC_STUB IVLCInput_get_length_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCInput_get_position_Proxy(
+    IVLCInput* This,
+    float* position);
+void __RPC_STUB IVLCInput_get_position_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCInput_put_position_Proxy(
+    IVLCInput* This,
+    float position);
+void __RPC_STUB IVLCInput_put_position_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCInput_get_time_Proxy(
+    IVLCInput* This,
+    double* time);
+void __RPC_STUB IVLCInput_get_time_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCInput_put_time_Proxy(
+    IVLCInput* This,
+    double time);
+void __RPC_STUB IVLCInput_put_time_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCInput_get_state_Proxy(
+    IVLCInput* This,
+    int* state);
+void __RPC_STUB IVLCInput_get_state_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCInput_get_rate_Proxy(
+    IVLCInput* This,
+    float* rate);
+void __RPC_STUB IVLCInput_get_rate_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCInput_put_rate_Proxy(
+    IVLCInput* This,
+    float rate);
+void __RPC_STUB IVLCInput_put_rate_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCInput_get_fps_Proxy(
+    IVLCInput* This,
+    float* fps);
+void __RPC_STUB IVLCInput_get_fps_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCInput_get_hasVout_Proxy(
+    IVLCInput* This,
+    VARIANT_BOOL* hasVout);
+void __RPC_STUB IVLCInput_get_hasVout_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
 
-/* [helpstring] */ HRESULT STDMETHODCALLTYPE IVLCControl_playlistClear_Proxy( 
-    IVLCControl __RPC_FAR * This);
+#endif  /* __IVLCInput_INTERFACE_DEFINED__ */
 
+/*****************************************************************************
+ * IVLCPlaylist interface
+ */
+#ifndef __IVLCPlaylist_INTERFACE_DEFINED__
+#define __IVLCPlaylist_INTERFACE_DEFINED__
 
-void __RPC_STUB IVLCControl_playlistClear_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
+DEFINE_GUID(IID_IVLCPlaylist, 0x54613049, 0x40bf, 0x4035, 0x9e,0x70, 0x0a,0x93,0x12,0xc0,0x18,0x8d);
+#if defined(__cplusplus) && !defined(CINTERFACE)
+interface IVLCPlaylist : public IDispatch
+{
+    virtual HRESULT STDMETHODCALLTYPE get_itemCount(
+        int* count) = 0;
 
+    virtual HRESULT STDMETHODCALLTYPE get_isPlaying(
+        VARIANT_BOOL* playing) = 0;
 
-/* [helpstring][hidden][propget] */ HRESULT STDMETHODCALLTYPE IVLCControl_get_VersionInfo_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [retval][out] */ BSTR __RPC_FAR *version);
+    virtual HRESULT STDMETHODCALLTYPE add(
+        BSTR uri,
+        VARIANT name,
+        VARIANT options,
+        int* item) = 0;
 
+    virtual HRESULT STDMETHODCALLTYPE play(
+        ) = 0;
 
-void __RPC_STUB IVLCControl_get_VersionInfo_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
+    virtual HRESULT STDMETHODCALLTYPE playItem(
+        int item) = 0;
 
+    virtual HRESULT STDMETHODCALLTYPE togglePause(
+        ) = 0;
 
-/* [helpstring][propget][id] */ HRESULT STDMETHODCALLTYPE IVLCControl_get_MRL_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [retval][out] */ BSTR __RPC_FAR *mrl);
+    virtual HRESULT STDMETHODCALLTYPE stop(
+        ) = 0;
 
+    virtual HRESULT STDMETHODCALLTYPE next(
+        ) = 0;
 
-void __RPC_STUB IVLCControl_get_MRL_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
+    virtual HRESULT STDMETHODCALLTYPE prev(
+        ) = 0;
 
+    virtual HRESULT STDMETHODCALLTYPE clear(
+        ) = 0;
 
-/* [helpstring][propput][id] */ HRESULT STDMETHODCALLTYPE IVLCControl_put_MRL_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [in] */ BSTR mrl);
+    virtual HRESULT STDMETHODCALLTYPE removeItem(
+        int item) = 0;
 
+};
+#else
+typedef struct IVLCPlaylistVtbl {
+    BEGIN_INTERFACE
 
-void __RPC_STUB IVLCControl_put_MRL_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
+    /*** IUnknown methods ***/
+    HRESULT (STDMETHODCALLTYPE *QueryInterface)(
+        IVLCPlaylist* This,
+        REFIID riid,
+        void** ppvObject);
+
+    ULONG (STDMETHODCALLTYPE *AddRef)(
+        IVLCPlaylist* This);
+
+    ULONG (STDMETHODCALLTYPE *Release)(
+        IVLCPlaylist* This);
+
+    /*** IDispatch methods ***/
+    HRESULT (STDMETHODCALLTYPE *GetTypeInfoCount)(
+        IVLCPlaylist* This,
+        UINT* pctinfo);
+
+    HRESULT (STDMETHODCALLTYPE *GetTypeInfo)(
+        IVLCPlaylist* This,
+        UINT iTInfo,
+        LCID lcid,
+        ITypeInfo** ppTInfo);
+
+    HRESULT (STDMETHODCALLTYPE *GetIDsOfNames)(
+        IVLCPlaylist* This,
+        REFIID riid,
+        LPOLESTR* rgszNames,
+        UINT cNames,
+        LCID lcid,
+        DISPID* rgDispId);
+
+    HRESULT (STDMETHODCALLTYPE *Invoke)(
+        IVLCPlaylist* This,
+        DISPID dispIdMember,
+        REFIID riid,
+        LCID lcid,
+        WORD wFlags,
+        DISPPARAMS* pDispParams,
+        VARIANT* pVarResult,
+        EXCEPINFO* pExcepInfo,
+        UINT* puArgErr);
+
+    /*** IVLCPlaylist methods ***/
+    HRESULT (STDMETHODCALLTYPE *get_itemCount)(
+        IVLCPlaylist* This,
+        int* count);
+
+    HRESULT (STDMETHODCALLTYPE *get_isPlaying)(
+        IVLCPlaylist* This,
+        VARIANT_BOOL* playing);
+
+    HRESULT (STDMETHODCALLTYPE *add)(
+        IVLCPlaylist* This,
+        BSTR uri,
+        VARIANT name,
+        VARIANT options,
+        int* item);
+
+    HRESULT (STDMETHODCALLTYPE *play)(
+        IVLCPlaylist* This);
+
+    HRESULT (STDMETHODCALLTYPE *playItem)(
+        IVLCPlaylist* This,
+        int item);
+
+    HRESULT (STDMETHODCALLTYPE *togglePause)(
+        IVLCPlaylist* This);
+
+    HRESULT (STDMETHODCALLTYPE *stop)(
+        IVLCPlaylist* This);
+
+    HRESULT (STDMETHODCALLTYPE *next)(
+        IVLCPlaylist* This);
+
+    HRESULT (STDMETHODCALLTYPE *prev)(
+        IVLCPlaylist* This);
+
+    HRESULT (STDMETHODCALLTYPE *clear)(
+        IVLCPlaylist* This);
+
+    HRESULT (STDMETHODCALLTYPE *removeItem)(
+        IVLCPlaylist* This,
+        int item);
+
+    END_INTERFACE
+} IVLCPlaylistVtbl;
+interface IVLCPlaylist {
+    const IVLCPlaylistVtbl* lpVtbl;
+};
 
+#ifdef COBJMACROS
+/*** IUnknown methods ***/
+#define IVLCPlaylist_QueryInterface(p,a,b) (p)->lpVtbl->QueryInterface(p,a,b)
+#define IVLCPlaylist_AddRef(p) (p)->lpVtbl->AddRef(p)
+#define IVLCPlaylist_Release(p) (p)->lpVtbl->Release(p)
+/*** IDispatch methods ***/
+#define IVLCPlaylist_GetTypeInfoCount(p,a) (p)->lpVtbl->GetTypeInfoCount(p,a)
+#define IVLCPlaylist_GetTypeInfo(p,a,b,c) (p)->lpVtbl->GetTypeInfo(p,a,b,c)
+#define IVLCPlaylist_GetIDsOfNames(p,a,b,c,d,e) (p)->lpVtbl->GetIDsOfNames(p,a,b,c,d,e)
+#define IVLCPlaylist_Invoke(p,a,b,c,d,e,f,g,h) (p)->lpVtbl->Invoke(p,a,b,c,d,e,f,g,h)
+/*** IVLCPlaylist methods ***/
+#define IVLCPlaylist_get_itemCount(p,a) (p)->lpVtbl->get_itemCount(p,a)
+#define IVLCPlaylist_get_isPlaying(p,a) (p)->lpVtbl->get_isPlaying(p,a)
+#define IVLCPlaylist_add(p,a,b,c,d) (p)->lpVtbl->add(p,a,b,c,d)
+#define IVLCPlaylist_play(p) (p)->lpVtbl->play(p)
+#define IVLCPlaylist_playItem(p,a) (p)->lpVtbl->playItem(p,a)
+#define IVLCPlaylist_togglePause(p) (p)->lpVtbl->togglePause(p)
+#define IVLCPlaylist_stop(p) (p)->lpVtbl->stop(p)
+#define IVLCPlaylist_next(p) (p)->lpVtbl->next(p)
+#define IVLCPlaylist_prev(p) (p)->lpVtbl->prev(p)
+#define IVLCPlaylist_clear(p) (p)->lpVtbl->clear(p)
+#define IVLCPlaylist_removeItem(p,a) (p)->lpVtbl->removeItem(p,a)
+#endif
 
-/* [helpstring][propget][id] */ HRESULT STDMETHODCALLTYPE IVLCControl_get_AutoPlay_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [retval][out] */ VARIANT_BOOL __RPC_FAR *autoplay);
+#endif
 
+HRESULT CALLBACK IVLCPlaylist_get_itemCount_Proxy(
+    IVLCPlaylist* This,
+    int* count);
+void __RPC_STUB IVLCPlaylist_get_itemCount_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCPlaylist_get_isPlaying_Proxy(
+    IVLCPlaylist* This,
+    VARIANT_BOOL* playing);
+void __RPC_STUB IVLCPlaylist_get_isPlaying_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCPlaylist_add_Proxy(
+    IVLCPlaylist* This,
+    BSTR uri,
+    VARIANT name,
+    VARIANT options,
+    int* item);
+void __RPC_STUB IVLCPlaylist_add_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCPlaylist_play_Proxy(
+    IVLCPlaylist* This);
+void __RPC_STUB IVLCPlaylist_play_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCPlaylist_playItem_Proxy(
+    IVLCPlaylist* This,
+    int item);
+void __RPC_STUB IVLCPlaylist_playItem_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCPlaylist_togglePause_Proxy(
+    IVLCPlaylist* This);
+void __RPC_STUB IVLCPlaylist_togglePause_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCPlaylist_stop_Proxy(
+    IVLCPlaylist* This);
+void __RPC_STUB IVLCPlaylist_stop_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCPlaylist_next_Proxy(
+    IVLCPlaylist* This);
+void __RPC_STUB IVLCPlaylist_next_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCPlaylist_prev_Proxy(
+    IVLCPlaylist* This);
+void __RPC_STUB IVLCPlaylist_prev_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCPlaylist_clear_Proxy(
+    IVLCPlaylist* This);
+void __RPC_STUB IVLCPlaylist_clear_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCPlaylist_removeItem_Proxy(
+    IVLCPlaylist* This,
+    int item);
+void __RPC_STUB IVLCPlaylist_removeItem_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
 
-void __RPC_STUB IVLCControl_get_AutoPlay_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
+#endif  /* __IVLCPlaylist_INTERFACE_DEFINED__ */
 
+/*****************************************************************************
+ * IVLCVideo interface
+ */
+#ifndef __IVLCVideo_INTERFACE_DEFINED__
+#define __IVLCVideo_INTERFACE_DEFINED__
 
-/* [helpstring][propput][id] */ HRESULT STDMETHODCALLTYPE IVLCControl_put_AutoPlay_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [in] */ VARIANT_BOOL autoplay);
+DEFINE_GUID(IID_IVLCVideo, 0x0aaedf0b, 0xd333, 0x4b27, 0xa0,0xc6, 0xbb,0xf3,0x14,0x13,0xa4,0x2e);
+#if defined(__cplusplus) && !defined(CINTERFACE)
+interface IVLCVideo : public IDispatch
+{
+    virtual HRESULT STDMETHODCALLTYPE get_fullscreen(
+        VARIANT_BOOL* fullscreen) = 0;
 
+    virtual HRESULT STDMETHODCALLTYPE put_fullscreen(
+        VARIANT_BOOL fullscreen) = 0;
 
-void __RPC_STUB IVLCControl_put_AutoPlay_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
+    virtual HRESULT STDMETHODCALLTYPE get_width(
+        int* width) = 0;
 
+    virtual HRESULT STDMETHODCALLTYPE get_height(
+        int* height) = 0;
 
-/* [helpstring][propget][id] */ HRESULT STDMETHODCALLTYPE IVLCControl_get_AutoLoop_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [retval][out] */ VARIANT_BOOL __RPC_FAR *autoloop);
+};
+#else
+typedef struct IVLCVideoVtbl {
+    BEGIN_INTERFACE
 
+    /*** IUnknown methods ***/
+    HRESULT (STDMETHODCALLTYPE *QueryInterface)(
+        IVLCVideo* This,
+        REFIID riid,
+        void** ppvObject);
+
+    ULONG (STDMETHODCALLTYPE *AddRef)(
+        IVLCVideo* This);
+
+    ULONG (STDMETHODCALLTYPE *Release)(
+        IVLCVideo* This);
+
+    /*** IDispatch methods ***/
+    HRESULT (STDMETHODCALLTYPE *GetTypeInfoCount)(
+        IVLCVideo* This,
+        UINT* pctinfo);
+
+    HRESULT (STDMETHODCALLTYPE *GetTypeInfo)(
+        IVLCVideo* This,
+        UINT iTInfo,
+        LCID lcid,
+        ITypeInfo** ppTInfo);
+
+    HRESULT (STDMETHODCALLTYPE *GetIDsOfNames)(
+        IVLCVideo* This,
+        REFIID riid,
+        LPOLESTR* rgszNames,
+        UINT cNames,
+        LCID lcid,
+        DISPID* rgDispId);
+
+    HRESULT (STDMETHODCALLTYPE *Invoke)(
+        IVLCVideo* This,
+        DISPID dispIdMember,
+        REFIID riid,
+        LCID lcid,
+        WORD wFlags,
+        DISPPARAMS* pDispParams,
+        VARIANT* pVarResult,
+        EXCEPINFO* pExcepInfo,
+        UINT* puArgErr);
+
+    /*** IVLCVideo methods ***/
+    HRESULT (STDMETHODCALLTYPE *get_fullscreen)(
+        IVLCVideo* This,
+        VARIANT_BOOL* fullscreen);
+
+    HRESULT (STDMETHODCALLTYPE *put_fullscreen)(
+        IVLCVideo* This,
+        VARIANT_BOOL fullscreen);
+
+    HRESULT (STDMETHODCALLTYPE *get_width)(
+        IVLCVideo* This,
+        int* width);
+
+    HRESULT (STDMETHODCALLTYPE *get_height)(
+        IVLCVideo* This,
+        int* height);
+
+    END_INTERFACE
+} IVLCVideoVtbl;
+interface IVLCVideo {
+    const IVLCVideoVtbl* lpVtbl;
+};
 
-void __RPC_STUB IVLCControl_get_AutoLoop_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
+#ifdef COBJMACROS
+/*** IUnknown methods ***/
+#define IVLCVideo_QueryInterface(p,a,b) (p)->lpVtbl->QueryInterface(p,a,b)
+#define IVLCVideo_AddRef(p) (p)->lpVtbl->AddRef(p)
+#define IVLCVideo_Release(p) (p)->lpVtbl->Release(p)
+/*** IDispatch methods ***/
+#define IVLCVideo_GetTypeInfoCount(p,a) (p)->lpVtbl->GetTypeInfoCount(p,a)
+#define IVLCVideo_GetTypeInfo(p,a,b,c) (p)->lpVtbl->GetTypeInfo(p,a,b,c)
+#define IVLCVideo_GetIDsOfNames(p,a,b,c,d,e) (p)->lpVtbl->GetIDsOfNames(p,a,b,c,d,e)
+#define IVLCVideo_Invoke(p,a,b,c,d,e,f,g,h) (p)->lpVtbl->Invoke(p,a,b,c,d,e,f,g,h)
+/*** IVLCVideo methods ***/
+#define IVLCVideo_get_fullscreen(p,a) (p)->lpVtbl->get_fullscreen(p,a)
+#define IVLCVideo_put_fullscreen(p,a) (p)->lpVtbl->put_fullscreen(p,a)
+#define IVLCVideo_get_width(p,a) (p)->lpVtbl->get_width(p,a)
+#define IVLCVideo_get_height(p,a) (p)->lpVtbl->get_height(p,a)
+#endif
 
+#endif
 
-/* [helpstring][propput][id] */ HRESULT STDMETHODCALLTYPE IVLCControl_put_AutoLoop_Proxy( 
-    IVLCControl __RPC_FAR * This,
-    /* [in] */ VARIANT_BOOL autoloop);
+HRESULT CALLBACK IVLCVideo_get_fullscreen_Proxy(
+    IVLCVideo* This,
+    VARIANT_BOOL* fullscreen);
+void __RPC_STUB IVLCVideo_get_fullscreen_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCVideo_put_fullscreen_Proxy(
+    IVLCVideo* This,
+    VARIANT_BOOL fullscreen);
+void __RPC_STUB IVLCVideo_put_fullscreen_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCVideo_get_width_Proxy(
+    IVLCVideo* This,
+    int* width);
+void __RPC_STUB IVLCVideo_get_width_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCVideo_get_height_Proxy(
+    IVLCVideo* This,
+    int* height);
+void __RPC_STUB IVLCVideo_get_height_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
 
+#endif  /* __IVLCVideo_INTERFACE_DEFINED__ */
 
-void __RPC_STUB IVLCControl_put_AutoLoop_Stub(
-    IRpcStubBuffer *This,
-    IRpcChannelBuffer *_pRpcChannelBuffer,
-    PRPC_MESSAGE _pRpcMessage,
-    DWORD *_pdwStubPhase);
+/*****************************************************************************
+ * IVLCControl2 interface
+ */
+#ifndef __IVLCControl2_INTERFACE_DEFINED__
+#define __IVLCControl2_INTERFACE_DEFINED__
 
+DEFINE_GUID(IID_IVLCControl2, 0x2d719729, 0x5333, 0x406c, 0xbf,0x12, 0x8d,0xe7,0x87,0xfd,0x65,0xe3);
+#if defined(__cplusplus) && !defined(CINTERFACE)
+interface IVLCControl2 : public IDispatch
+{
+    virtual HRESULT STDMETHODCALLTYPE get_AutoLoop(
+        VARIANT_BOOL* autoloop) = 0;
 
+    virtual HRESULT STDMETHODCALLTYPE put_AutoLoop(
+        VARIANT_BOOL autoloop) = 0;
 
-#endif 	/* __IVLCControl_INTERFACE_DEFINED__ */
+    virtual HRESULT STDMETHODCALLTYPE get_AutoPlay(
+        VARIANT_BOOL* autoplay) = 0;
 
+    virtual HRESULT STDMETHODCALLTYPE put_AutoPlay(
+        VARIANT_BOOL autoplay) = 0;
 
-#ifndef __DVLCEvents_DISPINTERFACE_DEFINED__
-#define __DVLCEvents_DISPINTERFACE_DEFINED__
+    virtual HRESULT STDMETHODCALLTYPE get_BaseURL(
+        BSTR* url) = 0;
 
-/* dispinterface DVLCEvents */
-/* [hidden][helpstring][uuid] */ 
+    virtual HRESULT STDMETHODCALLTYPE put_BaseURL(
+        BSTR url) = 0;
 
+    virtual HRESULT STDMETHODCALLTYPE get_StartTime(
+        int* seconds) = 0;
 
-EXTERN_C const IID DIID_DVLCEvents;
+    virtual HRESULT STDMETHODCALLTYPE put_StartTime(
+        int seconds) = 0;
 
-#if defined(__cplusplus) && !defined(CINTERFACE)
+    virtual HRESULT STDMETHODCALLTYPE get_MRL(
+        BSTR* mrl) = 0;
 
-    MIDL_INTERFACE("DF48072F-5EF8-434e-9B40-E2F3AE759B5F")
-    DVLCEvents : public IDispatch
-    {
-    };
-    
-#else 	/* C style interface */
-
-    typedef struct DVLCEventsVtbl
-    {
-        BEGIN_INTERFACE
-        
-        HRESULT ( STDMETHODCALLTYPE __RPC_FAR *QueryInterface )( 
-            DVLCEvents __RPC_FAR * This,
-            /* [in] */ REFIID riid,
-            /* [iid_is][out] */ void __RPC_FAR *__RPC_FAR *ppvObject);
-        
-        ULONG ( STDMETHODCALLTYPE __RPC_FAR *AddRef )( 
-            DVLCEvents __RPC_FAR * This);
-        
-        ULONG ( STDMETHODCALLTYPE __RPC_FAR *Release )( 
-            DVLCEvents __RPC_FAR * This);
-        
-        HRESULT ( STDMETHODCALLTYPE __RPC_FAR *GetTypeInfoCount )( 
-            DVLCEvents __RPC_FAR * This,
-            /* [out] */ UINT __RPC_FAR *pctinfo);
-        
-        HRESULT ( STDMETHODCALLTYPE __RPC_FAR *GetTypeInfo )( 
-            DVLCEvents __RPC_FAR * This,
-            /* [in] */ UINT iTInfo,
-            /* [in] */ LCID lcid,
-            /* [out] */ ITypeInfo __RPC_FAR *__RPC_FAR *ppTInfo);
-        
-        HRESULT ( STDMETHODCALLTYPE __RPC_FAR *GetIDsOfNames )( 
-            DVLCEvents __RPC_FAR * This,
-            /* [in] */ REFIID riid,
-            /* [size_is][in] */ LPOLESTR __RPC_FAR *rgszNames,
-            /* [in] */ UINT cNames,
-            /* [in] */ LCID lcid,
-            /* [size_is][out] */ DISPID __RPC_FAR *rgDispId);
-        
-        /* [local] */ HRESULT ( STDMETHODCALLTYPE __RPC_FAR *Invoke )( 
-            DVLCEvents __RPC_FAR * This,
-            /* [in] */ DISPID dispIdMember,
-            /* [in] */ REFIID riid,
-            /* [in] */ LCID lcid,
-            /* [in] */ WORD wFlags,
-            /* [out][in] */ DISPPARAMS __RPC_FAR *pDispParams,
-            /* [out] */ VARIANT __RPC_FAR *pVarResult,
-            /* [out] */ EXCEPINFO __RPC_FAR *pExcepInfo,
-            /* [out] */ UINT __RPC_FAR *puArgErr);
-        
-        END_INTERFACE
-    } DVLCEventsVtbl;
-
-    interface DVLCEvents
-    {
-        CONST_VTBL struct DVLCEventsVtbl __RPC_FAR *lpVtbl;
-    };
+    virtual HRESULT STDMETHODCALLTYPE put_MRL(
+        BSTR mrl) = 0;
 
-    
+    virtual HRESULT STDMETHODCALLTYPE get_VersionInfo(
+        BSTR* version) = 0;
 
-#ifdef COBJMACROS
+    virtual HRESULT STDMETHODCALLTYPE get_Visible(
+        VARIANT_BOOL* visible) = 0;
 
+    virtual HRESULT STDMETHODCALLTYPE put_Visible(
+        VARIANT_BOOL visible) = 0;
 
-#define DVLCEvents_QueryInterface(This,riid,ppvObject)	\
-    (This)->lpVtbl -> QueryInterface(This,riid,ppvObject)
+    virtual HRESULT STDMETHODCALLTYPE get_Volume(
+        int* volume) = 0;
 
-#define DVLCEvents_AddRef(This)	\
-    (This)->lpVtbl -> AddRef(This)
+    virtual HRESULT STDMETHODCALLTYPE put_Volume(
+        int volume) = 0;
 
-#define DVLCEvents_Release(This)	\
-    (This)->lpVtbl -> Release(This)
+    virtual HRESULT STDMETHODCALLTYPE get_audio(
+        IVLCAudio** obj) = 0;
 
+    virtual HRESULT STDMETHODCALLTYPE get_input(
+        IVLCInput** obj) = 0;
 
-#define DVLCEvents_GetTypeInfoCount(This,pctinfo)	\
-    (This)->lpVtbl -> GetTypeInfoCount(This,pctinfo)
+    virtual HRESULT STDMETHODCALLTYPE get_playlist(
+        IVLCPlaylist** obj) = 0;
 
-#define DVLCEvents_GetTypeInfo(This,iTInfo,lcid,ppTInfo)	\
-    (This)->lpVtbl -> GetTypeInfo(This,iTInfo,lcid,ppTInfo)
+    virtual HRESULT STDMETHODCALLTYPE get_video(
+        IVLCVideo** obj) = 0;
 
-#define DVLCEvents_GetIDsOfNames(This,riid,rgszNames,cNames,lcid,rgDispId)	\
-    (This)->lpVtbl -> GetIDsOfNames(This,riid,rgszNames,cNames,lcid,rgDispId)
+};
+#else
+typedef struct IVLCControl2Vtbl {
+    BEGIN_INTERFACE
 
-#define DVLCEvents_Invoke(This,dispIdMember,riid,lcid,wFlags,pDispParams,pVarResult,pExcepInfo,puArgErr)	\
-    (This)->lpVtbl -> Invoke(This,dispIdMember,riid,lcid,wFlags,pDispParams,pVarResult,pExcepInfo,puArgErr)
+    /*** IUnknown methods ***/
+    HRESULT (STDMETHODCALLTYPE *QueryInterface)(
+        IVLCControl2* This,
+        REFIID riid,
+        void** ppvObject);
+
+    ULONG (STDMETHODCALLTYPE *AddRef)(
+        IVLCControl2* This);
+
+    ULONG (STDMETHODCALLTYPE *Release)(
+        IVLCControl2* This);
+
+    /*** IDispatch methods ***/
+    HRESULT (STDMETHODCALLTYPE *GetTypeInfoCount)(
+        IVLCControl2* This,
+        UINT* pctinfo);
+
+    HRESULT (STDMETHODCALLTYPE *GetTypeInfo)(
+        IVLCControl2* This,
+        UINT iTInfo,
+        LCID lcid,
+        ITypeInfo** ppTInfo);
+
+    HRESULT (STDMETHODCALLTYPE *GetIDsOfNames)(
+        IVLCControl2* This,
+        REFIID riid,
+        LPOLESTR* rgszNames,
+        UINT cNames,
+        LCID lcid,
+        DISPID* rgDispId);
+
+    HRESULT (STDMETHODCALLTYPE *Invoke)(
+        IVLCControl2* This,
+        DISPID dispIdMember,
+        REFIID riid,
+        LCID lcid,
+        WORD wFlags,
+        DISPPARAMS* pDispParams,
+        VARIANT* pVarResult,
+        EXCEPINFO* pExcepInfo,
+        UINT* puArgErr);
+
+    /*** IVLCControl2 methods ***/
+    HRESULT (STDMETHODCALLTYPE *get_AutoLoop)(
+        IVLCControl2* This,
+        VARIANT_BOOL* autoloop);
+
+    HRESULT (STDMETHODCALLTYPE *put_AutoLoop)(
+        IVLCControl2* This,
+        VARIANT_BOOL autoloop);
+
+    HRESULT (STDMETHODCALLTYPE *get_AutoPlay)(
+        IVLCControl2* This,
+        VARIANT_BOOL* autoplay);
+
+    HRESULT (STDMETHODCALLTYPE *put_AutoPlay)(
+        IVLCControl2* This,
+        VARIANT_BOOL autoplay);
+
+    HRESULT (STDMETHODCALLTYPE *get_BaseURL)(
+        IVLCControl2* This,
+        BSTR* url);
+
+    HRESULT (STDMETHODCALLTYPE *put_BaseURL)(
+        IVLCControl2* This,
+        BSTR url);
+
+    HRESULT (STDMETHODCALLTYPE *get_StartTime)(
+        IVLCControl2* This,
+        int* seconds);
+
+    HRESULT (STDMETHODCALLTYPE *put_StartTime)(
+        IVLCControl2* This,
+        int seconds);
+
+    HRESULT (STDMETHODCALLTYPE *get_MRL)(
+        IVLCControl2* This,
+        BSTR* mrl);
+
+    HRESULT (STDMETHODCALLTYPE *put_MRL)(
+        IVLCControl2* This,
+        BSTR mrl);
+
+    HRESULT (STDMETHODCALLTYPE *get_VersionInfo)(
+        IVLCControl2* This,
+        BSTR* version);
+
+    HRESULT (STDMETHODCALLTYPE *get_Visible)(
+        IVLCControl2* This,
+        VARIANT_BOOL* visible);
+
+    HRESULT (STDMETHODCALLTYPE *put_Visible)(
+        IVLCControl2* This,
+        VARIANT_BOOL visible);
+
+    HRESULT (STDMETHODCALLTYPE *get_Volume)(
+        IVLCControl2* This,
+        int* volume);
+
+    HRESULT (STDMETHODCALLTYPE *put_Volume)(
+        IVLCControl2* This,
+        int volume);
+
+    HRESULT (STDMETHODCALLTYPE *get_audio)(
+        IVLCControl2* This,
+        IVLCAudio** obj);
+
+    HRESULT (STDMETHODCALLTYPE *get_input)(
+        IVLCControl2* This,
+        IVLCInput** obj);
+
+    HRESULT (STDMETHODCALLTYPE *get_playlist)(
+        IVLCControl2* This,
+        IVLCPlaylist** obj);
+
+    HRESULT (STDMETHODCALLTYPE *get_video)(
+        IVLCControl2* This,
+        IVLCVideo** obj);
+
+    END_INTERFACE
+} IVLCControl2Vtbl;
+interface IVLCControl2 {
+    const IVLCControl2Vtbl* lpVtbl;
+};
 
-#endif /* COBJMACROS */
+#ifdef COBJMACROS
+/*** IUnknown methods ***/
+#define IVLCControl2_QueryInterface(p,a,b) (p)->lpVtbl->QueryInterface(p,a,b)
+#define IVLCControl2_AddRef(p) (p)->lpVtbl->AddRef(p)
+#define IVLCControl2_Release(p) (p)->lpVtbl->Release(p)
+/*** IDispatch methods ***/
+#define IVLCControl2_GetTypeInfoCount(p,a) (p)->lpVtbl->GetTypeInfoCount(p,a)
+#define IVLCControl2_GetTypeInfo(p,a,b,c) (p)->lpVtbl->GetTypeInfo(p,a,b,c)
+#define IVLCControl2_GetIDsOfNames(p,a,b,c,d,e) (p)->lpVtbl->GetIDsOfNames(p,a,b,c,d,e)
+#define IVLCControl2_Invoke(p,a,b,c,d,e,f,g,h) (p)->lpVtbl->Invoke(p,a,b,c,d,e,f,g,h)
+/*** IVLCControl2 methods ***/
+#define IVLCControl2_get_AutoLoop(p,a) (p)->lpVtbl->get_AutoLoop(p,a)
+#define IVLCControl2_put_AutoLoop(p,a) (p)->lpVtbl->put_AutoLoop(p,a)
+#define IVLCControl2_get_AutoPlay(p,a) (p)->lpVtbl->get_AutoPlay(p,a)
+#define IVLCControl2_put_AutoPlay(p,a) (p)->lpVtbl->put_AutoPlay(p,a)
+#define IVLCControl2_get_BaseURL(p,a) (p)->lpVtbl->get_BaseURL(p,a)
+#define IVLCControl2_put_BaseURL(p,a) (p)->lpVtbl->put_BaseURL(p,a)
+#define IVLCControl2_get_StartTime(p,a) (p)->lpVtbl->get_StartTime(p,a)
+#define IVLCControl2_put_StartTime(p,a) (p)->lpVtbl->put_StartTime(p,a)
+#define IVLCControl2_get_MRL(p,a) (p)->lpVtbl->get_MRL(p,a)
+#define IVLCControl2_put_MRL(p,a) (p)->lpVtbl->put_MRL(p,a)
+#define IVLCControl2_get_VersionInfo(p,a) (p)->lpVtbl->get_VersionInfo(p,a)
+#define IVLCControl2_get_Visible(p,a) (p)->lpVtbl->get_Visible(p,a)
+#define IVLCControl2_put_Visible(p,a) (p)->lpVtbl->put_Visible(p,a)
+#define IVLCControl2_get_Volume(p,a) (p)->lpVtbl->get_Volume(p,a)
+#define IVLCControl2_put_Volume(p,a) (p)->lpVtbl->put_Volume(p,a)
+#define IVLCControl2_get_audio(p,a) (p)->lpVtbl->get_audio(p,a)
+#define IVLCControl2_get_input(p,a) (p)->lpVtbl->get_input(p,a)
+#define IVLCControl2_get_playlist(p,a) (p)->lpVtbl->get_playlist(p,a)
+#define IVLCControl2_get_video(p,a) (p)->lpVtbl->get_video(p,a)
+#endif
 
+#endif
 
-#endif 	/* C style interface */
+HRESULT CALLBACK IVLCControl2_get_AutoLoop_Proxy(
+    IVLCControl2* This,
+    VARIANT_BOOL* autoloop);
+void __RPC_STUB IVLCControl2_get_AutoLoop_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl2_put_AutoLoop_Proxy(
+    IVLCControl2* This,
+    VARIANT_BOOL autoloop);
+void __RPC_STUB IVLCControl2_put_AutoLoop_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl2_get_AutoPlay_Proxy(
+    IVLCControl2* This,
+    VARIANT_BOOL* autoplay);
+void __RPC_STUB IVLCControl2_get_AutoPlay_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl2_put_AutoPlay_Proxy(
+    IVLCControl2* This,
+    VARIANT_BOOL autoplay);
+void __RPC_STUB IVLCControl2_put_AutoPlay_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl2_get_BaseURL_Proxy(
+    IVLCControl2* This,
+    BSTR* url);
+void __RPC_STUB IVLCControl2_get_BaseURL_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl2_put_BaseURL_Proxy(
+    IVLCControl2* This,
+    BSTR url);
+void __RPC_STUB IVLCControl2_put_BaseURL_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl2_get_StartTime_Proxy(
+    IVLCControl2* This,
+    int* seconds);
+void __RPC_STUB IVLCControl2_get_StartTime_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl2_put_StartTime_Proxy(
+    IVLCControl2* This,
+    int seconds);
+void __RPC_STUB IVLCControl2_put_StartTime_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl2_get_MRL_Proxy(
+    IVLCControl2* This,
+    BSTR* mrl);
+void __RPC_STUB IVLCControl2_get_MRL_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl2_put_MRL_Proxy(
+    IVLCControl2* This,
+    BSTR mrl);
+void __RPC_STUB IVLCControl2_put_MRL_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl2_get_VersionInfo_Proxy(
+    IVLCControl2* This,
+    BSTR* version);
+void __RPC_STUB IVLCControl2_get_VersionInfo_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl2_get_Visible_Proxy(
+    IVLCControl2* This,
+    VARIANT_BOOL* visible);
+void __RPC_STUB IVLCControl2_get_Visible_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl2_put_Visible_Proxy(
+    IVLCControl2* This,
+    VARIANT_BOOL visible);
+void __RPC_STUB IVLCControl2_put_Visible_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl2_get_Volume_Proxy(
+    IVLCControl2* This,
+    int* volume);
+void __RPC_STUB IVLCControl2_get_Volume_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl2_put_Volume_Proxy(
+    IVLCControl2* This,
+    int volume);
+void __RPC_STUB IVLCControl2_put_Volume_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl2_get_audio_Proxy(
+    IVLCControl2* This,
+    IVLCAudio** obj);
+void __RPC_STUB IVLCControl2_get_audio_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl2_get_input_Proxy(
+    IVLCControl2* This,
+    IVLCInput** obj);
+void __RPC_STUB IVLCControl2_get_input_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl2_get_playlist_Proxy(
+    IVLCControl2* This,
+    IVLCPlaylist** obj);
+void __RPC_STUB IVLCControl2_get_playlist_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
+HRESULT CALLBACK IVLCControl2_get_video_Proxy(
+    IVLCControl2* This,
+    IVLCVideo** obj);
+void __RPC_STUB IVLCControl2_get_video_Stub(
+    IRpcStubBuffer* This,
+    IRpcChannelBuffer* pRpcChannelBuffer,
+    PRPC_MESSAGE pRpcMessage,
+    DWORD* pdwStubPhase);
 
+#endif  /* __IVLCControl2_INTERFACE_DEFINED__ */
 
-#endif 	/* __DVLCEvents_DISPINTERFACE_DEFINED__ */
+/*****************************************************************************
+ * VLCPlugin coclass
+ */
 
+DEFINE_GUID(CLSID_VLCPlugin, 0xe23fe9c6, 0x778e, 0x49d4, 0xb5,0x37, 0x38,0xfc,0xde,0x48,0x87,0xd8);
 
-EXTERN_C const CLSID CLSID_VLCPlugin;
+#ifndef __VLCPlugin_FWD_DEFINED__
+#define __VLCPlugin_FWD_DEFINED__
+typedef struct VLCPlugin VLCPlugin;
+#endif /* defined __VLCPlugin_FWD_DEFINED__ */
 
-#ifdef __cplusplus
+/*****************************************************************************
+ * VLCPlugin2 coclass
+ */
 
-class DECLSPEC_UUID("E23FE9C6-778E-49D4-B537-38FCDE4887D8")
-VLCPlugin;
-#endif
-#endif /* __AXVLC_LIBRARY_DEFINED__ */
+DEFINE_GUID(CLSID_VLCPlugin2, 0x9be31822, 0xfdad, 0x461b, 0xad,0x51, 0xbe,0x1d,0x1c,0x15,0x99,0x21);
 
-/* Additional Prototypes for ALL interfaces */
+#ifndef __VLCPlugin2_FWD_DEFINED__
+#define __VLCPlugin2_FWD_DEFINED__
+typedef struct VLCPlugin2 VLCPlugin2;
+#endif /* defined __VLCPlugin2_FWD_DEFINED__ */
+
+/* Begin additional prototypes for all interfaces */
+
+unsigned long   __RPC_USER VARIANT_UserSize     (unsigned long *, unsigned long,   VARIANT *);
+unsigned char * __RPC_USER VARIANT_UserMarshal  (unsigned long *, unsigned char *, VARIANT *);
+unsigned char * __RPC_USER VARIANT_UserUnmarshal(unsigned long *, unsigned char *, VARIANT *);
+void            __RPC_USER VARIANT_UserFree     (unsigned long *, VARIANT *);
+unsigned long   __RPC_USER BSTR_UserSize     (unsigned long *, unsigned long,   BSTR *);
+unsigned char * __RPC_USER BSTR_UserMarshal  (unsigned long *, unsigned char *, BSTR *);
+unsigned char * __RPC_USER BSTR_UserUnmarshal(unsigned long *, unsigned char *, BSTR *);
+void            __RPC_USER BSTR_UserFree     (unsigned long *, BSTR *);
 
-/* end of Additional Prototypes */
+/* End additional prototypes */
 
 #ifdef __cplusplus
 }
 #endif
-
-#endif
+#endif /* __WIDL_AXVLC_IDL_H */
diff -uNr vlc-0.8.6-svn20060918.debian/activex/axvlc.inf.in vlc-0.8.6-svn20061008.debian/activex/axvlc.inf.in
--- vlc-0.8.6-svn20060918.debian/activex/axvlc.inf.in	2006-09-18 06:28:02.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/activex/axvlc.inf.in	2006-10-04 09:47:07.000000000 -0400
@@ -10,7 +10,7 @@
 
 [axvlc.dll]
   FileVersion=@VERSION_MAJOR@,@VERSION_MINOR@,@VERSION_REVISION@,0
-  clsid={E23FE9C6-778E-49d4-B537-38FCDE4887D8}
+  clsid={9BE31822-FDAD-461B-AD51-BE1D1C159921}
   RegisterServer=no
   Hook=runinstaller
 
Binary files vlc-0.8.6-svn20060918.debian/activex/axvlc.tlb and vlc-0.8.6-svn20061008.debian/activex/axvlc.tlb differ
diff -uNr vlc-0.8.6-svn20060918.debian/activex/connectioncontainer.cpp vlc-0.8.6-svn20061008.debian/activex/connectioncontainer.cpp
--- vlc-0.8.6-svn20060918.debian/activex/connectioncontainer.cpp	2006-09-18 06:28:02.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/activex/connectioncontainer.cpp	2006-10-04 09:47:07.000000000 -0400
@@ -29,46 +29,62 @@
 
 ////////////////////////////////////////////////////////////////////////////////////////////////
 
-class VLCEnumConnections : public IEnumConnections
+/* this function object is used to return the value from a map pair */
+struct VLCEnumConnectionsDereference
+{
+    CONNECTDATA operator()(const map<DWORD,LPUNKNOWN>::iterator& i)
+    {
+        CONNECTDATA cd;
+        
+        cd.dwCookie = i->first;
+        cd.pUnk     = i->second;
+        return cd;
+    };
+};
+
+class VLCEnumConnections : public VLCEnumIterator<IID_IEnumConnections,
+    IEnumConnections,
+    CONNECTDATA,
+    map<DWORD,LPUNKNOWN>::iterator,
+    VLCEnumConnectionsDereference>
 {
 public:
-    VLCEnumConnections(vector<CONNECTDATA> &v) :
-        e(VLCEnum<CONNECTDATA>(IID_IEnumConnections, v))
-    { e.setRetainOperation((VLCEnum<CONNECTDATA>::retainer)&retain); };
-
-    VLCEnumConnections(const VLCEnumConnections &vlcEnum) : e(vlcEnum.e) {};
-
-    virtual ~VLCEnumConnections() {};
-
-    // IUnknown methods
-    STDMETHODIMP QueryInterface(REFIID riid, void **ppv)
-        { return e.QueryInterface(riid, ppv); };
-    STDMETHODIMP_(ULONG) AddRef(void)
-        { return e.AddRef(); };
-    STDMETHODIMP_(ULONG) Release(void)
-        {return e.Release(); };
-
-    //IEnumConnectionPoints
-    STDMETHODIMP Next(ULONG celt, LPCONNECTDATA rgelt, ULONG *pceltFetched)
-        { return e.Next(celt, rgelt, pceltFetched); };
-    STDMETHODIMP Skip(ULONG celt)
-        { return e.Skip(celt);};
-    STDMETHODIMP Reset(void)
-        { return e.Reset();};
-    STDMETHODIMP Clone(LPENUMCONNECTIONS *ppenum)
-        { if( NULL == ppenum ) return E_POINTER;
-          *ppenum = dynamic_cast<LPENUMCONNECTIONS>(new VLCEnumConnections(*this));
-          return (NULL != *ppenum) ? S_OK : E_OUTOFMEMORY;
-        };
+    VLCEnumConnections(map<DWORD,LPUNKNOWN> &m) :
+        VLCEnumIterator<IID_IEnumConnections,
+            IEnumConnections,
+            CONNECTDATA,
+            map<DWORD,LPUNKNOWN>::iterator,
+            VLCEnumConnectionsDereference> (m.begin(), m.end())
+    {};
+};
 
-private:
+////////////////////////////////////////////////////////////////////////////////////////////////
 
-    static void retain(CONNECTDATA cd)
+/* this function object is used to retain the dereferenced iterator value */
+struct VLCEnumConnectionPointsDereference
+{
+    LPCONNECTIONPOINT operator()(const vector<LPCONNECTIONPOINT>::iterator& i)
     {
-        cd.pUnk->AddRef();
-    };
+        LPCONNECTIONPOINT cp = *i;
+        cp->AddRef();
+        return cp;
+    }
+};
 
-    VLCEnum<CONNECTDATA> e;
+class VLCEnumConnectionPoints: public VLCEnumIterator<IID_IEnumConnectionPoints,
+    IEnumConnectionPoints,
+    LPCONNECTIONPOINT,
+    vector<LPCONNECTIONPOINT>::iterator,
+    VLCEnumConnectionPointsDereference>
+{
+public:
+    VLCEnumConnectionPoints(vector<LPCONNECTIONPOINT>& v) :
+        VLCEnumIterator<IID_IEnumConnectionPoints,
+            IEnumConnectionPoints,
+            LPCONNECTIONPOINT,
+            vector<LPCONNECTIONPOINT>::iterator,
+            VLCEnumConnectionPointsDereference> (v.begin(), v.end())
+    {};
 };
 
 ////////////////////////////////////////////////////////////////////////////////////////////////
@@ -94,31 +110,28 @@
 
 STDMETHODIMP VLCConnectionPoint::Advise(IUnknown *pUnk, DWORD *pdwCookie)
 {
+    static DWORD dwCookieCounter = 0;
+
     if( (NULL == pUnk) || (NULL == pdwCookie) )
         return E_POINTER;
 
-    CONNECTDATA cd;
-
     pUnk->AddRef();
-    cd.pUnk = pUnk;
-    *pdwCookie = cd.dwCookie = _connections.size()+1;
 
-    _connections.push_back(cd);
+    *pdwCookie = ++dwCookieCounter;
+    _connections[*pdwCookie] = pUnk;
 
     return S_OK;
 };
 
 STDMETHODIMP VLCConnectionPoint::Unadvise(DWORD pdwCookie)
 {
-    if( (0 < pdwCookie) && (pdwCookie <= _connections.size()) )
+    map<DWORD,LPUNKNOWN>::iterator pcd = _connections.find((DWORD)pdwCookie);
+    if( pcd != _connections.end() )
     {
-        CONNECTDATA cd = _connections[pdwCookie-1];
-        if( NULL != cd.pUnk )
-        {
-            cd.pUnk->Release();
-            cd.pUnk = NULL;
-            return S_OK;
-        }
+        pcd->second->Release();
+
+        _connections.erase(pdwCookie);
+        return S_OK;
     }
     return CONNECT_E_NOCONNECTION;
 };
@@ -135,16 +148,16 @@
 
 void VLCConnectionPoint::fireEvent(DISPID dispId, DISPPARAMS *pDispParams)
 {
-    vector<CONNECTDATA>::iterator end = _connections.end();
-    vector<CONNECTDATA>::iterator iter = _connections.begin();
+    map<DWORD,LPUNKNOWN>::iterator end = _connections.end();
+    map<DWORD,LPUNKNOWN>::iterator iter = _connections.begin();
 
     while( iter != end )
     {
-        CONNECTDATA cd = *iter;
-        if( NULL != cd.pUnk )
+        LPUNKNOWN pUnk = iter->second;
+        if( NULL != pUnk )
         {
             IDispatch *pDisp;
-            if( SUCCEEDED(cd.pUnk->QueryInterface(IID_IDispatch, (LPVOID *)&pDisp)) )
+            if( SUCCEEDED(pUnk->QueryInterface(IID_IDispatch, (LPVOID *)&pDisp)) )
             {
                 pDisp->Invoke(dispId, IID_NULL, LOCALE_USER_DEFAULT, DISPATCH_METHOD, pDispParams, NULL, NULL, NULL);
                 pDisp->Release();
@@ -156,16 +169,16 @@
 
 void VLCConnectionPoint::firePropChangedEvent(DISPID dispId)
 {
-    vector<CONNECTDATA>::iterator end = _connections.end();
-    vector<CONNECTDATA>::iterator iter = _connections.begin();
+    map<DWORD,LPUNKNOWN>::iterator end = _connections.end();
+    map<DWORD,LPUNKNOWN>::iterator iter = _connections.begin();
 
     while( iter != end )
     {
-        CONNECTDATA cd = *iter;
-        if( NULL != cd.pUnk )
+        LPUNKNOWN pUnk = iter->second;
+        if( NULL != pUnk )
         {
             IPropertyNotifySink *pPropSink;
-            if( SUCCEEDED(cd.pUnk->QueryInterface(IID_IPropertyNotifySink, (LPVOID *)&pPropSink)) )
+            if( SUCCEEDED(pUnk->QueryInterface(IID_IPropertyNotifySink, (LPVOID *)&pPropSink)) )
             {
                 pPropSink->OnChanged(dispId);
                 pPropSink->Release();
@@ -177,50 +190,6 @@
 
 ////////////////////////////////////////////////////////////////////////////////////////////////
 
-class VLCEnumConnectionPoints : public IEnumConnectionPoints
-{
-public:
-    VLCEnumConnectionPoints(vector<LPCONNECTIONPOINT> &v) :
-        e(VLCEnum<LPCONNECTIONPOINT>(IID_IEnumConnectionPoints, v))
-    { e.setRetainOperation((VLCEnum<LPCONNECTIONPOINT>::retainer)&retain); };
-
-    VLCEnumConnectionPoints(const VLCEnumConnectionPoints &vlcEnum) : e(vlcEnum.e) {};
-
-    virtual ~VLCEnumConnectionPoints() {};
-
-    // IUnknown methods
-    STDMETHODIMP QueryInterface(REFIID riid, void **ppv)
-        { return e.QueryInterface(riid, ppv); };
-    STDMETHODIMP_(ULONG) AddRef(void)
-        { return e.AddRef(); };
-    STDMETHODIMP_(ULONG) Release(void)
-        {return e.Release(); };
-
-    //IEnumConnectionPoints
-    STDMETHODIMP Next(ULONG celt, LPCONNECTIONPOINT *rgelt, ULONG *pceltFetched)
-        { return e.Next(celt, rgelt, pceltFetched); };
-    STDMETHODIMP Skip(ULONG celt)
-        { return e.Skip(celt);};
-    STDMETHODIMP Reset(void)
-        { return e.Reset();};
-    STDMETHODIMP Clone(LPENUMCONNECTIONPOINTS *ppenum)
-        { if( NULL == ppenum ) return E_POINTER;
-          *ppenum = dynamic_cast<LPENUMCONNECTIONPOINTS>(new VLCEnumConnectionPoints(*this));
-          return (NULL != *ppenum) ? S_OK : E_OUTOFMEMORY;
-        };
-
-private:
-
-    static void retain(LPCONNECTIONPOINT cp)
-    {
-        cp->AddRef();
-    };
-
-    VLCEnum<LPCONNECTIONPOINT> e;
-};
-
-////////////////////////////////////////////////////////////////////////////////////////////////
-
 VLCDispatchEvent::~VLCDispatchEvent()
 {
     //clear event arguments
diff -uNr vlc-0.8.6-svn20060918.debian/activex/connectioncontainer.h vlc-0.8.6-svn20061008.debian/activex/connectioncontainer.h
--- vlc-0.8.6-svn20060918.debian/activex/connectioncontainer.h	2006-09-18 06:28:02.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/activex/connectioncontainer.h	2006-10-04 09:47:07.000000000 -0400
@@ -26,6 +26,7 @@
 #include <ocidl.h>
 #include <vector>
 #include <queue>
+#include <map>
 
 class VLCConnectionPoint : public IConnectionPoint
 {
@@ -69,7 +70,7 @@
 
     REFIID _iid;
     IConnectionPointContainer *_p_cpc;
-    std::vector<CONNECTDATA> _connections;
+    std::map<DWORD, LPUNKNOWN> _connections;
 };
 
 //////////////////////////////////////////////////////////////////////////
diff -uNr vlc-0.8.6-svn20060918.debian/activex/dataobject.cpp vlc-0.8.6-svn20061008.debian/activex/dataobject.cpp
--- vlc-0.8.6-svn20060918.debian/activex/dataobject.cpp	2006-09-18 06:28:02.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/activex/dataobject.cpp	2006-10-04 09:47:07.000000000 -0400
@@ -29,44 +29,6 @@
 
 ////////////////////////////////////////////////////////////////////////////////////////////////
 
-class VLCEnumFORMATETC : public IEnumFORMATETC
-{
-public:
-
-    VLCEnumFORMATETC(vector<FORMATETC> &v) :
-        e(VLCEnum<FORMATETC>(IID_IEnumFORMATETC, v)) {};
-
-    VLCEnumFORMATETC(const VLCEnumFORMATETC &vlcEnum) : e(vlcEnum.e) {};
-    virtual ~VLCEnumFORMATETC() {};
-
-    // IUnknown methods
-    STDMETHODIMP QueryInterface(REFIID riid, void **ppv)
-        { return e.QueryInterface(riid, ppv); };
-    STDMETHODIMP_(ULONG) AddRef(void)
-        { return e.AddRef(); };
-    STDMETHODIMP_(ULONG) Release(void)
-        {return e.Release(); };
-
-    //IEnumConnectionPoints
-    STDMETHODIMP Next(ULONG celt, LPFORMATETC rgelt, ULONG *pceltFetched)
-        { return e.Next(celt, rgelt, pceltFetched); };
-    STDMETHODIMP Skip(ULONG celt)
-        { return e.Skip(celt);};
-    STDMETHODIMP Reset(void)
-        { return e.Reset();};
-    STDMETHODIMP Clone(LPENUMFORMATETC *ppenum)
-        { if( NULL == ppenum ) return E_POINTER;
-          *ppenum = dynamic_cast<LPENUMFORMATETC>(new VLCEnumFORMATETC(*this));
-          return (NULL != *ppenum) ? S_OK : E_OUTOFMEMORY;
-        };
-
-private:
-
-    VLCEnum<FORMATETC> e;
-};
-
-////////////////////////////////////////////////////////////////////////////////////////////////
-
 static const FORMATETC _metaFileFormatEtc =
     {
         CF_METAFILEPICT,
@@ -84,6 +46,22 @@
         TYMED_ENHMF,
     };
 
+class VLCEnumFORMATETC : public VLCEnumIterator<IID_IEnumFORMATETC,
+    IEnumFORMATETC,
+    FORMATETC,
+    vector<FORMATETC>::iterator>
+{
+public:
+    VLCEnumFORMATETC(vector<FORMATETC> v) :
+        VLCEnumIterator<IID_IEnumFORMATETC,
+        IEnumFORMATETC,
+        FORMATETC,
+        vector<FORMATETC>::iterator>(v.begin(), v.end())
+    {};
+};
+
+////////////////////////////////////////////////////////////////////////////////////////////////
+
 VLCDataObject::VLCDataObject(VLCPlugin *p_instance) : _p_instance(p_instance)
 {
     _v_formatEtc.push_back(_enhMetaFileFormatEtc);
@@ -114,13 +92,14 @@
     return _p_adviseHolder->EnumAdvise(ppenumAdvise);
 };
 
-STDMETHODIMP VLCDataObject::EnumFormatEtc(DWORD dwDirection, IEnumFORMATETC **ppenumformatetc)
+STDMETHODIMP VLCDataObject::EnumFormatEtc(DWORD dwDirection, IEnumFORMATETC **ppEnum)
 {
-    if( NULL == ppenumformatetc )
+    if( NULL == ppEnum )
         return E_POINTER;
 
-    *ppenumformatetc = new VLCEnumFORMATETC(_v_formatEtc);
-    return NOERROR;
+    *ppEnum = dynamic_cast<IEnumFORMATETC *>(new VLCEnumFORMATETC(_v_formatEtc));
+
+    return (NULL != *ppEnum ) ? S_OK : E_OUTOFMEMORY;
 };
 
 STDMETHODIMP VLCDataObject::GetCanonicalFormatEtc(LPFORMATETC pFormatEtcIn, LPFORMATETC pFormatEtcOut)
diff -uNr vlc-0.8.6-svn20060918.debian/activex/main.cpp vlc-0.8.6-svn20061008.debian/activex/main.cpp
--- vlc-0.8.6-svn20060918.debian/activex/main.cpp	2006-09-18 06:28:02.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/activex/main.cpp	2006-10-04 09:47:07.000000000 -0400
@@ -21,6 +21,9 @@
  *****************************************************************************/
 
 #include "plugin.h"
+#include "utils.h"
+
+#include <stdio.h>
 
 #include <comcat.h>
 #include <windows.h>
@@ -30,16 +33,12 @@
 
 #define COMPANY_STR "VideoLAN"
 #define PROGRAM_STR "VLCPlugin"
-#define VERSION_MAJOR_STR "1"
-#define VERSION_MINOR_STR "0"
 #define DESCRIPTION "VideoLAN VLC ActiveX Plugin"
 
 #define THREADING_MODEL "Apartment"
 #define MISC_STATUS     "131473"
 
 #define PROGID_STR COMPANY_STR"."PROGRAM_STR
-#define VERS_PROGID_STR COMPANY_STR"."PROGRAM_STR"."VERSION_MAJOR_STR
-#define VERSION_STR VERSION_MAJOR_STR"."VERSION_MINOR_STR
 
 #define GUID_STRLEN 39
 
@@ -52,15 +51,21 @@
 static LONG i_class_ref= 0;
 static HINSTANCE h_instance= 0;
 
+HMODULE DllGetModule()
+{
+    return h_instance;
+};
+
 STDAPI DllGetClassObject(REFCLSID rclsid, REFIID riid, LPVOID *ppv)
 {
     HRESULT hr = CLASS_E_CLASSNOTAVAILABLE;
 
     *ppv = NULL;
 
-    if( CLSID_VLCPlugin == rclsid )
+    if( (CLSID_VLCPlugin == rclsid )
+     || ( CLSID_VLCPlugin2 == rclsid) )
     {
-        VLCPluginClass *plugin = new VLCPluginClass(&i_class_ref, h_instance);
+        VLCPluginClass *plugin = new VLCPluginClass(&i_class_ref, h_instance, rclsid);
         hr = plugin->QueryInterface(riid, ppv);
         plugin->Release();
     }
@@ -72,48 +77,67 @@
     return (0 == i_class_ref) ? S_OK: S_FALSE;
 };
 
-static LPCTSTR TStrFromGUID(REFGUID clsid)
+static inline HKEY keyCreate(HKEY parentKey, LPCSTR keyName)
 {
-    LPOLESTR oleStr;
-
-    if( FAILED(StringFromIID(clsid, &oleStr)) )
-        return NULL;
-
-    //check whether TCHAR and OLECHAR are both either ANSI or UNICODE
-    if( sizeof(TCHAR) == sizeof(OLECHAR) )
-        return (LPCTSTR)oleStr;
-
-    LPTSTR pct_CLSID = NULL;
-#ifndef OLE2ANSI
-    size_t len = WideCharToMultiByte(CP_ACP, 0, oleStr, -1, NULL, 0, NULL, NULL);
-    if( len > 0 )
+    HKEY childKey;
+    if( ERROR_SUCCESS == RegCreateKeyExA(parentKey, keyName, 0, NULL,
+                REG_OPTION_NON_VOLATILE, KEY_ALL_ACCESS, NULL, &childKey, NULL) )
     {
-        pct_CLSID = (char *)CoTaskMemAlloc(len);
-        WideCharToMultiByte(CP_ACP, 0, oleStr, -1, pct_CLSID, len, NULL, NULL);
+        return childKey;
     }
-#else
-    size_t len = MutiByteToWideChar(CP_ACP, 0, oleStr, -1, NULL, 0);
-    if( len > 0 )
+    return NULL;
+};
+
+static inline HKEY keySet(HKEY hKey, LPCSTR valueName, const void *s, size_t len)
+{
+    if( NULL != hKey )
     {
-        clsidStr = (wchar_t *)CoTaskMemAlloc(len*sizeof(wchar_t));
-        MultiByteToWideChar(CP_ACP, 0, oleStr, -1, pct_CLSID, len);
+        RegSetValueExA(hKey, valueName, 0, REG_SZ,
+            (const BYTE*)s, len);
     }
-#endif
-    CoTaskMemFree(oleStr);
-    return pct_CLSID;
+    return hKey;
 };
 
-static HKEY keyCreate(HKEY parentKey, LPCTSTR keyName)
+static inline HKEY keySetDef(HKEY hKey, const void *s, size_t len)
 {
-    HKEY childKey;
-    if( ERROR_SUCCESS == RegCreateKeyEx(parentKey, keyName, 0, NULL,
-                REG_OPTION_NON_VOLATILE, KEY_ALL_ACCESS, NULL, &childKey, NULL) )
+    return keySet(hKey, NULL, s, len);
+};
+
+static inline HKEY keySetDef(HKEY hKey, LPCSTR s)
+{
+    return keySetDef(hKey, s, strlen(s)+1);
+};
+
+static inline HKEY keyClose(HKEY hKey)
+{
+    if( NULL != hKey )
     {
-        return childKey;
+        RegCloseKey(hKey);
     }
     return NULL;
 };
 
+static HRESULT UnregisterProgID(REFCLSID rclsid, unsigned int version)
+{
+    LPCSTR psz_CLSID = CStrFromGUID(rclsid);
+
+    if( NULL == psz_CLSID )
+        return E_OUTOFMEMORY;
+
+    char progId[sizeof(PROGID_STR)+16];
+    sprintf(progId, "%s.%u", PROGID_STR, version);
+
+    SHDeleteKeyA(HKEY_CLASSES_ROOT, progId);
+
+    HKEY hClsIDKey;
+    if( ERROR_SUCCESS == RegOpenKeyExA(HKEY_CLASSES_ROOT, "CLSID", 0, KEY_WRITE, &hClsIDKey) )
+    {
+        SHDeleteKey(hClsIDKey, psz_CLSID);
+        RegCloseKey(hClsIDKey);
+    }
+    CoTaskMemFree((void *)psz_CLSID);
+};
+
 STDAPI DllUnregisterServer(VOID)
 {
     // unregister type lib from the registry
@@ -132,177 +156,160 @@
 
         pcr->UnRegisterClassImplCategories(CLSID_VLCPlugin,
                 sizeof(implCategories)/sizeof(CATID), implCategories);
+        pcr->UnRegisterClassImplCategories(CLSID_VLCPlugin2,
+                sizeof(implCategories)/sizeof(CATID), implCategories);
         pcr->Release();
     }
 
-    SHDeleteKey(HKEY_CLASSES_ROOT, TEXT(VERS_PROGID_STR));
     SHDeleteKey(HKEY_CLASSES_ROOT, TEXT(PROGID_STR));
 
-    LPCTSTR psz_CLSID = TStrFromGUID(CLSID_VLCPlugin);
-
-    if( NULL == psz_CLSID )
-        return E_OUTOFMEMORY;
-
-    HKEY hClsIDKey;
-    if( ERROR_SUCCESS == RegOpenKeyEx(HKEY_CLASSES_ROOT, TEXT("CLSID"), 0, KEY_WRITE, &hClsIDKey) )
-    {
-        SHDeleteKey(hClsIDKey, psz_CLSID);
-        RegCloseKey(hClsIDKey);
-    }
-    CoTaskMemFree((void *)psz_CLSID);
+    UnregisterProgID(CLSID_VLCPlugin, 2);
+    UnregisterProgID(CLSID_VLCPlugin2, 1);
 
     return S_OK;
 };
 
-STDAPI DllRegisterServer(VOID)
+static HRESULT RegisterClassID(HKEY hParent, REFCLSID rclsid, unsigned int version, BOOL isDefault, const char *path, size_t pathLen)
 {
-    DllUnregisterServer();
-
-    char DllPath[MAX_PATH];
-    DWORD DllPathLen= GetModuleFileName(h_instance, DllPath, sizeof(DllPath)) ;
-	if( 0 == DllPathLen )
-        return E_UNEXPECTED;
+    char progId[sizeof(PROGID_STR)+16];
+    sprintf(progId, "%s.%u", PROGID_STR, version);
 
-    LPCTSTR psz_CLSID = TStrFromGUID(CLSID_VLCPlugin);
+    char description[sizeof(DESCRIPTION)+16];
+    sprintf(description, "%s v%u", DESCRIPTION, version);
 
-    if( NULL == psz_CLSID )
-        return E_OUTOFMEMORY;
+    HKEY hClassKey;
+    {
+        LPCSTR psz_CLSID = CStrFromGUID(rclsid);
 
-    HKEY hBaseKey;
+        if( NULL == psz_CLSID )
+            return E_OUTOFMEMORY;
 
-    if( ERROR_SUCCESS != RegOpenKeyEx(HKEY_CLASSES_ROOT, TEXT("CLSID"), 0, KEY_CREATE_SUB_KEY, &hBaseKey) )
-        return SELFREG_E_CLASS;
+        HKEY hProgKey = keyCreate(HKEY_CLASSES_ROOT, progId);
+        if( NULL != hProgKey )
+        {
+            // default key value
+            keySetDef(hProgKey, description);
 
-    HKEY hClassKey = keyCreate(hBaseKey, psz_CLSID);
+            keyClose(keySetDef(keyCreate(hProgKey, "CLSID"),
+                psz_CLSID,
+                GUID_STRLEN));
+     
+            //hSubKey = keyClose(keyCreate(hBaseKey, "Insertable"));
+     
+            RegCloseKey(hProgKey);
+        }
+        if( isDefault )
+        {
+            hProgKey = keyCreate(HKEY_CLASSES_ROOT, PROGID_STR);
+            if( NULL != hProgKey )
+            {
+                // default key value
+                keySetDef(hProgKey, description);
+
+                keyClose(keySetDef(keyCreate(hProgKey, "CLSID"),
+                    psz_CLSID,
+                    GUID_STRLEN));
+         
+                keyClose(keySetDef(keyCreate(hProgKey, "CurVer"),
+                    progId));
+            }
+        }
+        hClassKey = keyCreate(hParent, psz_CLSID);
+        CoTaskMemFree((void *)psz_CLSID);
+    }
     if( NULL != hClassKey )
     {
-        HKEY hSubKey;
-
         // default key value
-        RegSetValueEx(hClassKey, NULL, 0, REG_SZ,
-                (const BYTE*)DESCRIPTION, sizeof(DESCRIPTION));
+        keySetDef(hClassKey, description);
 
         // Control key value
-        hSubKey = keyCreate(hClassKey, TEXT("Control"));
-        RegCloseKey(hSubKey);
+        keyClose(keyCreate(hClassKey, "Control"));
 
         // Insertable key value
-        //hSubKey = keyCreate(hClassKey, TEXT("Insertable"));
-        //RegCloseKey(hSubKey);
+        //keyClose(keyCreate(hClassKey, "Insertable"));
 
         // ToolboxBitmap32 key value
-        hSubKey = keyCreate(hClassKey, TEXT("ToolboxBitmap32"));
-        strcpy(DllPath+DllPathLen, ",1");
-        RegSetValueEx(hSubKey, NULL, 0, REG_SZ,
-                (const BYTE*)DllPath, DllPathLen+2);
-        DllPath[DllPathLen] = '\0';
-        RegCloseKey(hSubKey);
+        {
+            char iconPath[pathLen+3];
+            memcpy(iconPath, path, pathLen);
+            strcpy(iconPath+pathLen, ",1");
+            keyClose(keySetDef(keyCreate(hClassKey,
+                "ToolboxBitmap32"),
+                iconPath, sizeof(iconPath)));
+        }
 
 #ifdef BUILD_LOCALSERVER
         // LocalServer32 key value
-        hSubKey = keyCreate(hClassKey, TEXT("LocalServer32"));
-        RegSetValueEx(hSubKey, NULL, 0, REG_SZ,
-                (const BYTE*)DllPath, DllPathLen);
-        RegCloseKey(hSubKey);
+        keyClose(keySetDef(keyCreate(hClassKey,
+            "LocalServer32", path, pathLen+1)));
 #else
         // InprocServer32 key value
-        hSubKey = keyCreate(hClassKey, TEXT("InprocServer32"));
-        RegSetValueEx(hSubKey, NULL, 0, REG_SZ,
-                (const BYTE*)DllPath, DllPathLen);
-        RegSetValueEx(hSubKey, TEXT("ThreadingModel"), 0, REG_SZ,
-                (const BYTE*)THREADING_MODEL, sizeof(THREADING_MODEL));
-        RegCloseKey(hSubKey);
+        {
+            HKEY hSubKey = keySetDef(keyCreate(hClassKey,
+                "InprocServer32"),
+                path, pathLen+1);
+            keySet(hSubKey,
+                "ThreadingModel",
+                THREADING_MODEL, sizeof(THREADING_MODEL));
+            keyClose(hSubKey);
+        }
 #endif
 
         // MiscStatus key value
-        hSubKey = keyCreate(hClassKey, TEXT("MiscStatus\\1"));
-        RegSetValueEx(hSubKey, NULL, 0, REG_SZ, (const BYTE*)MISC_STATUS, sizeof(MISC_STATUS));
-        RegCloseKey(hSubKey);
+        keyClose(keySetDef(keyCreate(hClassKey,
+            "MiscStatus\\1"),
+            MISC_STATUS, sizeof(MISC_STATUS)));
 
         // Programmable key value
-        hSubKey = keyCreate(hClassKey, TEXT("Programmable"));
-        RegCloseKey(hSubKey);
+        keyClose(keyCreate(hClassKey, "Programmable"));
 
         // ProgID key value
-        hSubKey = keyCreate(hClassKey, TEXT("ProgID"));
-        RegSetValueEx(hSubKey, NULL, 0, REG_SZ, 
-                (const BYTE*)VERS_PROGID_STR, sizeof(VERS_PROGID_STR));
-        RegCloseKey(hSubKey);
+        keyClose(keySetDef(keyCreate(hClassKey,
+            TEXT("ProgID")),
+            progId));
 
         // VersionIndependentProgID key value
-        hSubKey = keyCreate(hClassKey, TEXT("VersionIndependentProgID"));
-        RegSetValueEx(hSubKey, NULL, 0, REG_SZ, 
-                (const BYTE*)PROGID_STR, sizeof(PROGID_STR));
-        RegCloseKey(hSubKey);
+        keyClose(keySetDef(keyCreate(hClassKey,
+            "VersionIndependentProgID"),
+            PROGID_STR, sizeof(PROGID_STR)));
 
         // Version key value
-        hSubKey = keyCreate(hClassKey, TEXT("Version"));
-        RegSetValueEx(hSubKey, NULL, 0, REG_SZ,
-                (const BYTE*)VERSION_STR, sizeof(VERSION_STR));
-        RegCloseKey(hSubKey);
+        keyClose(keySetDef(keyCreate(hClassKey,
+            "Version"),
+            "1.0"));
 
         // TypeLib key value
-        LPCTSTR psz_LIBID = TStrFromGUID(LIBID_AXVLC);
+        LPCSTR psz_LIBID = CStrFromGUID(LIBID_AXVLC);
         if( NULL != psz_LIBID )
         {
-            hSubKey = keyCreate(hClassKey, TEXT("TypeLib"));
-            RegSetValueEx(hSubKey, NULL, 0, REG_SZ,
-                    (const BYTE*)psz_LIBID, sizeof(TCHAR)*GUID_STRLEN);
-            RegCloseKey(hSubKey);
+            keyClose(keySetDef(keyCreate(hClassKey,
+                    "TypeLib"),
+                    psz_LIBID, GUID_STRLEN));
+            CoTaskMemFree((void *)psz_LIBID);
         }
         RegCloseKey(hClassKey);
     }
-    RegCloseKey(hBaseKey);
-
-    hBaseKey = keyCreate(HKEY_CLASSES_ROOT, TEXT(PROGID_STR));
-    if( NULL != hBaseKey )
-    {
-        // default key value
-        RegSetValueEx(hBaseKey, NULL, 0, REG_SZ,
-                (const BYTE*)DESCRIPTION, sizeof(DESCRIPTION));
-
-        HKEY hSubKey = keyCreate(hBaseKey, TEXT("CLSID"));
-        if( NULL != hSubKey )
-        {
-            // default key value
-            RegSetValueEx(hSubKey, NULL, 0, REG_SZ,
-                    (const BYTE*)psz_CLSID, sizeof(TCHAR)*GUID_STRLEN);
+    return S_OK;
+}
 
-            RegCloseKey(hSubKey);
-        }
-        hSubKey = keyCreate(hBaseKey, TEXT("CurVer"));
-        if( NULL != hSubKey )
-        {
-            // default key value
-            RegSetValueEx(hSubKey, NULL, 0, REG_SZ,
-                    (const BYTE*)VERS_PROGID_STR, sizeof(VERS_PROGID_STR));
+STDAPI DllRegisterServer(VOID)
+{
+    DllUnregisterServer();
 
-            RegCloseKey(hSubKey);
-        }
-        RegCloseKey(hBaseKey);
-    }
+    char DllPath[MAX_PATH];
+    DWORD DllPathLen=GetModuleFileNameA(h_instance, DllPath, sizeof(DllPath)) ;
+	if( 0 == DllPathLen )
+        return E_UNEXPECTED;
 
-    hBaseKey = keyCreate(HKEY_CLASSES_ROOT, TEXT(VERS_PROGID_STR));
-    if( NULL != hBaseKey )
-    {
-        // default key value
-        RegSetValueEx(hBaseKey, NULL, 0, REG_SZ,
-                (const BYTE*)DESCRIPTION, sizeof(DESCRIPTION));
+    HKEY hBaseKey;
 
-        HKEY hSubKey = keyCreate(hBaseKey, TEXT("CLSID"));
-        if( NULL != hSubKey )
-        {
-            // default key value
-            RegSetValueEx(hSubKey, NULL, 0, REG_SZ,
-                    (const BYTE*)psz_CLSID, sizeof(TCHAR)*GUID_STRLEN);
+    if( ERROR_SUCCESS != RegOpenKeyExA(HKEY_CLASSES_ROOT, "CLSID", 0, KEY_CREATE_SUB_KEY, &hBaseKey) )
+        return SELFREG_E_CLASS;
+    
+    RegisterClassID(hBaseKey, CLSID_VLCPlugin, 1, FALSE, DllPath, DllPathLen);
+    RegisterClassID(hBaseKey, CLSID_VLCPlugin2, 2, TRUE, DllPath, DllPathLen);
 
-            RegCloseKey(hSubKey);
-        }
-        //hSubKey = keyCreate(hBaseKey, TEXT("Insertable"));
-        //RegCloseKey(hSubKey);
- 
-        RegCloseKey(hBaseKey);
-    }
+    RegCloseKey(hBaseKey);
 
     // indicate which component categories we support
     ICatRegister *pcr;
@@ -317,6 +324,8 @@
 
         pcr->RegisterClassImplCategories(CLSID_VLCPlugin,
                 sizeof(implCategories)/sizeof(CATID), implCategories);
+        pcr->RegisterClassImplCategories(CLSID_VLCPlugin2,
+                sizeof(implCategories)/sizeof(CATID), implCategories);
         pcr->Release();
     }
 
@@ -347,8 +356,6 @@
     typeLib->Release();
 #endif
 
-    CoTaskMemFree((void *)psz_CLSID);
-
     return S_OK;
 };
 
@@ -383,6 +390,7 @@
         return 0;
  
     DWORD dwRegisterClassObject;
+    DWORD dwRegisterClassObject2;
 
     if( FAILED(CoRegisterClassObject(CLSID_VLCPlugin, classProc,
         CLSCTX_LOCAL_SERVER, REGCLS_MULTIPLEUSE, &dwRegisterClassObject)) )
@@ -394,6 +402,10 @@
                     ACTIVEOBJECT_WEAK, &dwRegisterActiveObject)) )
         return 0;
 
+    if( FAILED(RegisterActiveObject(classProc, CLSID_VLCPlugin2,
+                    ACTIVEOBJECT_WEAK, &dwRegisterActiveObject2)) )
+        return 0;
+
     classProc->Release();
 
     /*
@@ -404,7 +416,7 @@
         while( PeekMessage(&msg, NULL, 0, 0, PM_REMOVE) )
         {
             if( msg.message == WM_QUIT )
-                break;  // Leave the PeekMessage while() loop
+                break;  // break out PeekMessage loop
 
             /*if(TranslateAccelerator(ghwndApp, ghAccel, &msg))
                 continue;*/
@@ -414,7 +426,7 @@
         }
 
         if(msg.message == WM_QUIT)
-            break;  // Leave the for() loop
+            break;  // break out main loop
 
         WaitMessage();
     }
@@ -422,8 +434,11 @@
     if( SUCCEEDED(RevokeActiveObject(dwRegisterActiveObject, NULL)) )
         CoRevokeClassObject(dwRegisterClassObject);
 
+    if( SUCCEEDED(RevokeActiveObject(dwRegisterActiveObject2, NULL)) )
+        CoRevokeClassObject(dwRegisterClassObject2);
+
     // Reached on WM_QUIT message
-    CoUninitialize();
+    OleUninitialize();
     return ((int) msg.wParam);
 };
 
diff -uNr vlc-0.8.6-svn20060918.debian/activex/Makefile.in vlc-0.8.6-svn20061008.debian/activex/Makefile.in
--- vlc-0.8.6-svn20060918.debian/activex/Makefile.in	2006-09-18 06:30:31.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/activex/Makefile.in	2006-10-08 12:42:32.000000000 -0400
@@ -119,12 +119,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -132,6 +133,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -156,9 +159,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -235,7 +235,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -250,7 +252,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
@@ -337,6 +338,8 @@
     viewobject.h \
     vlccontrol.cpp \
     vlccontrol.h \
+    vlccontrol2.cpp \
+    vlccontrol2.h \
     plugin.cpp \
     plugin.h \
     axvlc_idl.c \
@@ -362,7 +365,7 @@
 
 @BUILD_SHARED_FALSE@LIBRARIES_libvlc = $(top_builddir)/src/libvlc.a
 
-@BUILD_SHARED_TRUE@LIBRARIES_libvlc = $(top_builddir)/src/libvlc.dll.a
+@BUILD_SHARED_TRUE@LIBRARIES_libvlc = $(top_builddir)/src/libvlc.dll
 
 @BUILD_ACTIVEX_TRUE@noinst_LIBRARIES_activex = libaxvlc.a
 @BUILD_ACTIVEX_TRUE@axvlc_DATA = axvlc$(LIBEXT)
@@ -373,7 +376,7 @@
 @BUILD_ACTIVEX_TRUE@libaxvlc_a_SOURCES = $(SOURCES_activex) $(SOURCE_dll)
 @BUILD_ACTIVEX_TRUE@libaxvlc_a_CFLAGS = `$(VLC_CONFIG) --cflags activex`
 @BUILD_ACTIVEX_TRUE@libaxvlc_a_CXXFLAGS = `$(VLC_CONFIG) --cxxflags activex`
-@BUILD_ACTIVEX_TRUE@libaxvlc_a_DEPENDENCIES = axvlc.def $(DATA_axvlc_rc)
+@BUILD_ACTIVEX_TRUE@libaxvlc_a_DEPENDENCIES = axvlc.def $(DATA_axvlc_rc) $(LIBRARIES_libvlc)
 
 @BUILD_ACTIVEX_TRUE@DATA_axvlc_tlb = $(axvlc_tlb_DATA)
 @BUILD_ACTIVEX_TRUE@noinst_axvlc_tlb_DATA = axvlc.tlb
@@ -400,8 +403,8 @@
 	provideclassinfo.h connectioncontainer.cpp \
 	connectioncontainer.h objectsafety.cpp objectsafety.h \
 	dataobject.cpp dataobject.h viewobject.cpp viewobject.h \
-	vlccontrol.cpp vlccontrol.h plugin.cpp plugin.h axvlc_idl.c \
-	axvlc_idl.h
+	vlccontrol.cpp vlccontrol.h vlccontrol2.cpp vlccontrol2.h \
+	plugin.cpp plugin.h axvlc_idl.c axvlc_idl.h
 am__objects_2 = libaxvlc_a-main.$(OBJEXT) libaxvlc_a-utils.$(OBJEXT) \
 	libaxvlc_a-olecontrol.$(OBJEXT) \
 	libaxvlc_a-oleinplaceactiveobject.$(OBJEXT) \
@@ -414,7 +417,8 @@
 	libaxvlc_a-connectioncontainer.$(OBJEXT) \
 	libaxvlc_a-objectsafety.$(OBJEXT) \
 	libaxvlc_a-dataobject.$(OBJEXT) libaxvlc_a-viewobject.$(OBJEXT) \
-	libaxvlc_a-vlccontrol.$(OBJEXT) libaxvlc_a-plugin.$(OBJEXT) \
+	libaxvlc_a-vlccontrol.$(OBJEXT) \
+	libaxvlc_a-vlccontrol2.$(OBJEXT) libaxvlc_a-plugin.$(OBJEXT) \
 	libaxvlc_a-axvlc_idl.$(OBJEXT) $(am__objects_1)
 @BUILD_ACTIVEX_TRUE@am_libaxvlc_a_OBJECTS = $(am__objects_2) \
 @BUILD_ACTIVEX_TRUE@	$(am__objects_1)
@@ -439,7 +443,8 @@
 @AMDEP_TRUE@	./$(DEPDIR)/libaxvlc_a-provideclassinfo.Po \
 @AMDEP_TRUE@	./$(DEPDIR)/libaxvlc_a-utils.Po \
 @AMDEP_TRUE@	./$(DEPDIR)/libaxvlc_a-viewobject.Po \
-@AMDEP_TRUE@	./$(DEPDIR)/libaxvlc_a-vlccontrol.Po
+@AMDEP_TRUE@	./$(DEPDIR)/libaxvlc_a-vlccontrol.Po \
+@AMDEP_TRUE@	./$(DEPDIR)/libaxvlc_a-vlccontrol2.Po
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
 	$(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)
 LTCOMPILE = $(LIBTOOL) --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) \
@@ -504,6 +509,7 @@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libaxvlc_a-utils.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libaxvlc_a-viewobject.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libaxvlc_a-vlccontrol.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libaxvlc_a-vlccontrol2.Po@am__quote@
 
 .c.o:
 @am__fastdepCC_TRUE@	if $(COMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" \
@@ -1099,6 +1105,39 @@
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCXX_FALSE@	$(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libaxvlc_a_CXXFLAGS) $(CXXFLAGS) -c -o libaxvlc_a-vlccontrol.lo `test -f 'vlccontrol.cpp' || echo '$(srcdir)/'`vlccontrol.cpp
 
+libaxvlc_a-vlccontrol2.o: vlccontrol2.cpp
+@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libaxvlc_a_CXXFLAGS) $(CXXFLAGS) -MT libaxvlc_a-vlccontrol2.o -MD -MP -MF "$(DEPDIR)/libaxvlc_a-vlccontrol2.Tpo" \
+@am__fastdepCXX_TRUE@	  -c -o libaxvlc_a-vlccontrol2.o `test -f 'vlccontrol2.cpp' || echo '$(srcdir)/'`vlccontrol2.cpp; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libaxvlc_a-vlccontrol2.Tpo" "$(DEPDIR)/libaxvlc_a-vlccontrol2.Po"; \
+@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libaxvlc_a-vlccontrol2.Tpo"; exit 1; \
+@am__fastdepCXX_TRUE@	fi
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='vlccontrol2.cpp' object='libaxvlc_a-vlccontrol2.o' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libaxvlc_a-vlccontrol2.Po' tmpdepfile='$(DEPDIR)/libaxvlc_a-vlccontrol2.TPo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libaxvlc_a_CXXFLAGS) $(CXXFLAGS) -c -o libaxvlc_a-vlccontrol2.o `test -f 'vlccontrol2.cpp' || echo '$(srcdir)/'`vlccontrol2.cpp
+
+libaxvlc_a-vlccontrol2.obj: vlccontrol2.cpp
+@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libaxvlc_a_CXXFLAGS) $(CXXFLAGS) -MT libaxvlc_a-vlccontrol2.obj -MD -MP -MF "$(DEPDIR)/libaxvlc_a-vlccontrol2.Tpo" \
+@am__fastdepCXX_TRUE@	  -c -o libaxvlc_a-vlccontrol2.obj `if test -f 'vlccontrol2.cpp'; then $(CYGPATH_W) 'vlccontrol2.cpp'; else $(CYGPATH_W) '$(srcdir)/vlccontrol2.cpp'; fi`; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libaxvlc_a-vlccontrol2.Tpo" "$(DEPDIR)/libaxvlc_a-vlccontrol2.Po"; \
+@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libaxvlc_a-vlccontrol2.Tpo"; exit 1; \
+@am__fastdepCXX_TRUE@	fi
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='vlccontrol2.cpp' object='libaxvlc_a-vlccontrol2.obj' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libaxvlc_a-vlccontrol2.Po' tmpdepfile='$(DEPDIR)/libaxvlc_a-vlccontrol2.TPo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libaxvlc_a_CXXFLAGS) $(CXXFLAGS) -c -o libaxvlc_a-vlccontrol2.obj `if test -f 'vlccontrol2.cpp'; then $(CYGPATH_W) 'vlccontrol2.cpp'; else $(CYGPATH_W) '$(srcdir)/vlccontrol2.cpp'; fi`
+
+libaxvlc_a-vlccontrol2.lo: vlccontrol2.cpp
+@am__fastdepCXX_TRUE@	if $(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libaxvlc_a_CXXFLAGS) $(CXXFLAGS) -MT libaxvlc_a-vlccontrol2.lo -MD -MP -MF "$(DEPDIR)/libaxvlc_a-vlccontrol2.Tpo" \
+@am__fastdepCXX_TRUE@	  -c -o libaxvlc_a-vlccontrol2.lo `test -f 'vlccontrol2.cpp' || echo '$(srcdir)/'`vlccontrol2.cpp; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libaxvlc_a-vlccontrol2.Tpo" "$(DEPDIR)/libaxvlc_a-vlccontrol2.Plo"; \
+@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libaxvlc_a-vlccontrol2.Tpo"; exit 1; \
+@am__fastdepCXX_TRUE@	fi
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='vlccontrol2.cpp' object='libaxvlc_a-vlccontrol2.lo' libtool=yes @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libaxvlc_a-vlccontrol2.Plo' tmpdepfile='$(DEPDIR)/libaxvlc_a-vlccontrol2.TPlo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCXX_FALSE@	$(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libaxvlc_a_CXXFLAGS) $(CXXFLAGS) -c -o libaxvlc_a-vlccontrol2.lo `test -f 'vlccontrol2.cpp' || echo '$(srcdir)/'`vlccontrol2.cpp
+
 libaxvlc_a-plugin.o: plugin.cpp
 @am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libaxvlc_a_CXXFLAGS) $(CXXFLAGS) -MT libaxvlc_a-plugin.o -MD -MP -MF "$(DEPDIR)/libaxvlc_a-plugin.Tpo" \
 @am__fastdepCXX_TRUE@	  -c -o libaxvlc_a-plugin.o `test -f 'plugin.cpp' || echo '$(srcdir)/'`plugin.cpp; \
@@ -1383,7 +1422,7 @@
 
 
 @BUILD_ACTIVEX_TRUE@axvlc$(LIBEXT): $(libaxvlc_a_OBJECTS) \
-@BUILD_ACTIVEX_TRUE@	              $(libaxvlc_a_DEPENDENCIES) stamp-pic
+@BUILD_ACTIVEX_TRUE@	              $(libaxvlc_a_DEPENDENCIES) stamp-builtin
 @BUILD_ACTIVEX_TRUE@	$(CXXLINK) $(libaxvlc_a_OBJECTS) $(DATA_axvlc_rc) \
 @BUILD_ACTIVEX_TRUE@	$(srcdir)/axvlc.def \
 @BUILD_ACTIVEX_TRUE@	  $(LIBRARIES_libvlc) -shared $(LIBRARIES_libvlc) $(LDFLAGS_activex) \
@@ -1397,7 +1436,13 @@
 @BUILD_ACTIVEX_TRUE@@HAS_MIDL_COMPILER_TRUE@clean-tlb:
 @BUILD_ACTIVEX_TRUE@@HAS_MIDL_COMPILER_TRUE@	rm -f axvlc.tlb axvlc_idl.c axvlc_idl.h
 
-@BUILD_ACTIVEX_TRUE@@HAS_MIDL_COMPILER_FALSE@clean-tlb:
+@BUILD_ACTIVEX_TRUE@@HAS_MIDL_COMPILER_FALSE@@HAS_WIDL_COMPILER_TRUE@axvlc.tlb axvlc_idl.c axvlc_idl.h: axvlc.idl
+@BUILD_ACTIVEX_TRUE@@HAS_MIDL_COMPILER_FALSE@@HAS_WIDL_COMPILER_TRUE@	$(WIDL) -I$(WINE_SDK_PATH)/include -tuh -T axvlc.tlb -U axvlc_idl.c -H axvlc_idl.h axvlc.idl
+
+@BUILD_ACTIVEX_TRUE@@HAS_MIDL_COMPILER_FALSE@@HAS_WIDL_COMPILER_TRUE@clean-tlb:
+@BUILD_ACTIVEX_TRUE@@HAS_MIDL_COMPILER_FALSE@@HAS_WIDL_COMPILER_TRUE@	rm -f axvlc.tlb axvlc_idl.c axvlc_idl.h
+
+@BUILD_ACTIVEX_TRUE@@HAS_MIDL_COMPILER_FALSE@@HAS_WIDL_COMPILER_FALSE@clean-tlb:
 @BUILD_ACTIVEX_TRUE@axvlc_rc.$(OBJEXT): axvlc_rc.rc inplace.bmp axvlc.tlb
 @BUILD_ACTIVEX_TRUE@	$(WINDRES) -DVERSION=$(VERSION) -DVERSION_NUMBER=`echo $(VERSION).0.0.0 | sed 's/[^0-9]*\([0-9]*\)[^.]*\.*\([0-9]*\)[^.]*\.*\([0-9]*\)[^.]*\.*\([0-9]*\).*/\1,\2,\3,\4/'` --include-dir $(srcdir) -i $< -o $@
 
@@ -1408,16 +1453,11 @@
 ###############################################################################
 
 clean-stamp:
-	rm -f stamp-pic
+	rm -f stamp-builtin
 
-stamp-pic: FORCE
-	@for dep in "" `$(VLC_CONFIG) --target builtin`; do \
-	  if test "$${dep}" -nt "$(LIBRARIES_activex)"; then \
-	    rm -f $@; \
-	    break; \
-	  fi; \
-	done
-	@if test ! -f $@; then printf "" > $@; fi
+@BUILD_SHARED_TRUE@stamp-builtin:
+@BUILD_SHARED_FALSE@stamp-builtin: $(shell ${VLC_CONFIG} --target builtin)
+	@touch $@
 
 ###############################################################################
 # Clean rules
@@ -1427,9 +1467,8 @@
 	rm -f axvlc$(LIBEXT)
 
 ###############################################################################
-# Force rule
+# Force rules
 ###############################################################################
-FORCE:
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
 .NOEXPORT:
diff -uNr vlc-0.8.6-svn20060918.debian/activex/persistpropbag.cpp vlc-0.8.6-svn20061008.debian/activex/persistpropbag.cpp
--- vlc-0.8.6-svn20060918.debian/activex/persistpropbag.cpp	2006-09-18 06:28:02.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/activex/persistpropbag.cpp	2006-10-04 09:47:07.000000000 -0400
@@ -171,7 +171,14 @@
     V_VT(&value) = VT_I4;
     if( S_OK == pPropBag->Read(OLESTR("starttime"), &value, pErrorLog) )
     {
-        _p_instance->setTime(V_I4(&value));
+        _p_instance->setStartTime(V_I4(&value));
+        VariantClear(&value);
+    }
+
+    V_VT(&value) = VT_BSTR;
+    if( S_OK == pPropBag->Read(OLESTR("baseurl"), &value, pErrorLog) )
+    {
+        _p_instance->setBaseURL(V_BSTR(&value));
         VariantClear(&value);
     }
 
@@ -221,10 +228,16 @@
     VariantClear(&value);
 
     V_VT(&value) = VT_I4;
-    V_I4(&value) = _p_instance->getTime();
+    V_I4(&value) = _p_instance->getStartTime();
     pPropBag->Write(OLESTR("StartTime"), &value);
     VariantClear(&value);
 
+    V_VT(&value) = VT_BSTR;
+    V_BSTR(&value) = SysAllocStringLen(_p_instance->getBaseURL(),
+                            SysStringLen(_p_instance->getBaseURL()));
+    pPropBag->Write(OLESTR("BaseURL"), &value);
+    VariantClear(&value);
+
     if( fClearDirty )
         _p_instance->setDirty(FALSE);
 
diff -uNr vlc-0.8.6-svn20060918.debian/activex/plugin.cpp vlc-0.8.6-svn20061008.debian/activex/plugin.cpp
--- vlc-0.8.6-svn20060918.debian/activex/plugin.cpp	2006-09-18 06:28:02.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/activex/plugin.cpp	2006-10-04 09:47:07.000000000 -0400
@@ -1,7 +1,7 @@
 /*****************************************************************************
  * plugin.cpp: ActiveX control for VLC
  *****************************************************************************
- * Copyright (C) 2005 the VideoLAN team
+ * Copyright (C) 2006 the VideoLAN team
  *
  * Authors: Damien Fouilleul <Damien.Fouilleul@laposte.net>
  *
@@ -33,6 +33,7 @@
 #include "connectioncontainer.h"
 #include "objectsafety.h"
 #include "vlccontrol.h"
+#include "vlccontrol2.h"
 #include "viewobject.h"
 #include "dataobject.h"
 
@@ -50,10 +51,6 @@
 ////////////////////////////////////////////////////////////////////////
 //class factory
 
-// {E23FE9C6-778E-49d4-B537-38FCDE4887D8}
-//const GUID CLSID_VLCPlugin = 
-//    { 0xe23fe9c6, 0x778e, 0x49d4, { 0xb5, 0x37, 0x38, 0xfc, 0xde, 0x48, 0x87, 0xd8 } };
-
 static LRESULT CALLBACK VLCInPlaceClassWndProc(HWND hWnd, UINT uMsg, WPARAM wParam, LPARAM lParam) {
     switch( uMsg )
     {
@@ -100,9 +97,10 @@
     }
 };
 
-VLCPluginClass::VLCPluginClass(LONG *p_class_ref, HINSTANCE hInstance) :
+VLCPluginClass::VLCPluginClass(LONG *p_class_ref, HINSTANCE hInstance, REFCLSID rclsid) :
     _p_class_ref(p_class_ref),
     _hinstance(hInstance),
+    _classid(rclsid),
     _inplace_picture(NULL)
 {
     WNDCLASS wClass;
@@ -225,6 +223,7 @@
     if( NULL != plugin )
     {
         HRESULT hr = plugin->QueryInterface(riid, ppv);
+        // the following will destroy the object if QueryInterface() failed
         plugin->Release();
         return hr;
     }
@@ -248,9 +247,9 @@
     _videownd(NULL),
     _p_class(p_class),
     _i_ref(1UL),
+    _p_libvlc(NULL),
     _i_codepage(CP_ACP),
-    _b_usermode(TRUE),
-    _i_vlc(0)
+    _b_usermode(TRUE)
 {
     p_class->AddRef();
 
@@ -264,6 +263,7 @@
     vlcConnectionPointContainer = new VLCConnectionPointContainer(this);
     vlcObjectSafety = new VLCObjectSafety(this);
     vlcControl = new VLCControl(this);
+    vlcControl2 = new VLCControl2(this);
     vlcViewObject = new VLCViewObject(this);
     vlcDataObject = new VLCDataObject(this);
     vlcOleObject = new VLCOleObject(this);
@@ -283,6 +283,7 @@
     delete vlcOleObject;
     delete vlcDataObject;
     delete vlcViewObject;
+    delete vlcControl2;
     delete vlcControl;
     delete vlcConnectionPointContainer;
     delete vlcProvideClassInfo;
@@ -336,9 +337,13 @@
     else if( IID_IObjectSafety == riid )
         *ppv = reinterpret_cast<LPVOID>(vlcObjectSafety);
     else if( IID_IDispatch == riid )
-        *ppv = reinterpret_cast<LPVOID>(vlcControl);
+        *ppv = (CLSID_VLCPlugin2 == getClassID()) ?
+                reinterpret_cast<LPVOID>(vlcControl2) :
+                reinterpret_cast<LPVOID>(vlcControl);
     else if( IID_IVLCControl == riid )
         *ppv = reinterpret_cast<LPVOID>(vlcControl);
+    else if( IID_IVLCControl2 == riid )
+        *ppv = reinterpret_cast<LPVOID>(vlcControl2);
     else if( IID_IViewObject == riid )
         *ppv = reinterpret_cast<LPVOID>(vlcViewObject);
     else if( IID_IViewObject2 == riid )
@@ -465,12 +470,13 @@
 
 HRESULT VLCPlugin::onInit(void)
 {
-    if( 0 == _i_vlc )
+    if( NULL == _p_libvlc )
     {
         // initialize persistable properties
-        _bstr_mrl = NULL;
         _b_autoplay = TRUE;
         _b_autoloop = FALSE;
+        _bstr_baseurl = NULL;
+        _bstr_mrl = NULL;
         _b_visible = TRUE;
         _b_mute = FALSE;
         _i_volume = 50;
@@ -489,12 +495,11 @@
 
 HRESULT VLCPlugin::onLoad(void)
 {
-    if( SysStringLen(_bstr_mrl) > 0 )
+    if( SysStringLen(_bstr_baseurl) == 0 )
     {
         /*
-        ** try to combine MRL with client site moniker, which for Internet Explorer
-        ** is the URL of the page the plugin is embedded into. Hence, if the MRL
-        ** is a relative URL, we should end up with an absolute URL
+        ** try to retreive the base URL using the client site moniker, which for Internet Explorer
+        ** is the URL of the page the plugin is embedded into. 
         */
         LPOLECLIENTSITE pClientSite;
         if( SUCCEEDED(vlcOleObject->GetClientSite(&pClientSite)) && (NULL != pClientSite) )
@@ -514,47 +519,44 @@
                         */
                         if( UrlIsW(base_url, URLIS_URL) )
                         {
-                            DWORD len = INTERNET_MAX_URL_LENGTH;
-                            LPOLESTR abs_url = (LPOLESTR)CoTaskMemAlloc(sizeof(OLECHAR)*len);
-                            if( NULL != abs_url )
-                            {
-                                if( SUCCEEDED(UrlCombineW(base_url, _bstr_mrl, abs_url, &len,
-                                                URL_ESCAPE_UNSAFE|URL_PLUGGABLE_PROTOCOL)) )
-                                {
-                                    SysFreeString(_bstr_mrl);
-                                    _bstr_mrl = SysAllocStringLen(abs_url, len);
-                                }
-                                CoTaskMemFree(abs_url);
-                            }
+                            /* copy base URL */
+                            _bstr_baseurl = SysAllocString(base_url);
                         }
                         CoTaskMemFree(base_url);
                     }
-                    pContMoniker->Release();
                 }
-                pBC->Release();
             }
-            pClientSite->Release();
         }
     }
     setDirty(FALSE);
     return S_OK;
 };
 
-HRESULT VLCPlugin::getVLCObject(int *i_vlc)
+HRESULT VLCPlugin::getVLCObject(int* i_vlc)
 {
-    if( ! isRunning() )
+    libvlc_instance_t *p_libvlc;
+    HRESULT result = getVLC(&p_libvlc);
+    if( SUCCEEDED(result) )
     {
-        _i_vlc = VLC_Create();
-        if( _i_vlc < 0 )
-        {
-            _i_vlc = 0;
-            return E_FAIL;
-        }
+        *i_vlc = libvlc_get_vlc_id(p_libvlc);
+    }
+    else
+    {
+        *i_vlc = 0;
+    }
+    return result;
+}
 
+HRESULT VLCPlugin::getVLC(libvlc_instance_t** pp_libvlc)
+{
+    extern HMODULE DllGetModule();
+
+    if( ! isRunning() )
+    {
         /*
         ** default initialization options
         */
-        char *ppsz_argv[10] = { "vlc", };
+        char *ppsz_argv[32] = { "vlc" };
         int   ppsz_argc = 1;
 
         HKEY h_key;
@@ -568,68 +570,119 @@
              {
                  if( i_type == REG_SZ )
                  {
-                     strcat( p_data, "\\vlc" );
-                     ppsz_argv[0] = p_data;
+                     strcat( p_data, "\\plugins" );
+		     ppsz_argv[ppsz_argc++] = "--plugin-path";
+                     ppsz_argv[ppsz_argc++] = p_data;
                  }
              }
              RegCloseKey( h_key );
         }
 
-#if 0
-        ppsz_argv[0] = "C:\\cygwin\\home\\Damien_Fouilleul\\dev\\videolan\\vlc-trunk\\vlc";
-#endif
+	char p_path[MAX_PATH+1];
+	DWORD len = GetModuleFileNameA(DllGetModule(), p_path, sizeof(p_path));
+	if( len > 0 )
+	{
+	    p_path[len] = '\0';
+	    ppsz_argv[0] = p_path;
+	}
 
         // make sure plugin isn't affected with VLC single instance mode
         ppsz_argv[ppsz_argc++] = "--no-one-instance";
 
+        /* common settings */
+        ppsz_argv[ppsz_argc++] = "-vv";
+        ppsz_argv[ppsz_argc++] = "--no-stats";
+        ppsz_argv[ppsz_argc++] = "--intf";
+        ppsz_argv[ppsz_argc++] = "dummy";
+
         // loop mode is a configuration option only
         if( _b_autoloop )
             ppsz_argv[ppsz_argc++] = "--loop";
 
+        // initial volume setting
+        char volBuffer[16];
+        ppsz_argv[ppsz_argc++] = "--volume";
+        if( _b_mute )
+        {
+           ppsz_argv[ppsz_argc++] = "0";
+        }
+        else
+        {
+            snprintf(volBuffer, sizeof(volBuffer), "%d", _i_volume);
+            ppsz_argv[ppsz_argc++] = volBuffer;
+        }
+            
         if( IsDebuggerPresent() )
         {
             /*
             ** VLC default threading mechanism is designed to be as compatible
-            ** with POSIX as possible, however when debugged on win32, threads
+            ** with POSIX as possible. However when debugged on win32, threads
             ** lose signals and eventually VLC get stuck during initialization.
             ** threading support can be configured to be more debugging friendly
             ** but it will be less compatible with POSIX.
-            ** This is done by initializing with the following options
+            ** This is done by initializing with the following options:
             */
             ppsz_argv[ppsz_argc++] = "--fast-mutex";
             ppsz_argv[ppsz_argc++] = "--win9x-cv-method=1";
         }
 
-        if( VLC_Init(_i_vlc, ppsz_argc, ppsz_argv) )
+        _p_libvlc = libvlc_new(ppsz_argc, ppsz_argv, NULL);
+        if( NULL == _p_libvlc )
         {
-            VLC_Destroy(_i_vlc);
-            _i_vlc = 0;
+            *pp_libvlc = NULL;
             return E_FAIL;
         }
 
-        VLC_VolumeSet(_i_vlc, _i_volume);
-
-        if( _b_mute )
-            VLC_VolumeMute(_i_vlc);
-
-        char *psz_mrl = CStrFromBSTR(CP_UTF8, _bstr_mrl);
-        if( NULL != psz_mrl )
+        if( SysStringLen(_bstr_mrl) > 0 )
         {
-            char timeBuffer[32];
-            const char *options[1];
-            int   cOptions = 0;
+            char *psz_mrl = NULL;
 
-            if( _i_time )
+            if( SysStringLen(_bstr_baseurl) > 0 )
+            {
+                DWORD len = INTERNET_MAX_URL_LENGTH;
+                LPOLESTR abs_url = (LPOLESTR)CoTaskMemAlloc(sizeof(OLECHAR)*len);
+                if( NULL != abs_url )
+                {
+                    /*
+                    ** if the MRL a relative URL, we should end up with an absolute URL
+                    */
+                    if( SUCCEEDED(UrlCombineW(_bstr_baseurl, _bstr_mrl, abs_url, &len,
+                                    URL_ESCAPE_UNSAFE|URL_PLUGGABLE_PROTOCOL)) )
+                    {
+                        psz_mrl = CStrFromBSTR(CP_UTF8, abs_url);
+                    }
+                    else
+                    {
+                        psz_mrl = CStrFromBSTR(CP_UTF8, _bstr_mrl);
+                    }
+                    CoTaskMemFree(abs_url);
+                }
+            }
+            else
             {
-                snprintf(timeBuffer, sizeof(timeBuffer), ":start-time=%d", _i_time);
-                options[cOptions++] = timeBuffer;
+                /*
+                ** baseURL is empty, assume MRL is absolute
+                */
+                psz_mrl = CStrFromBSTR(CP_UTF8, _bstr_mrl);
+            }
+            if( NULL != psz_mrl )
+            {
+                const char *options[1];
+                int i_options = 0;
+
+                char timeBuffer[32];
+                if( _i_time )
+                {
+                    snprintf(timeBuffer, sizeof(timeBuffer), ":start-time=%d", _i_time);
+                    options[i_options++] = timeBuffer;
+                }
+                // add default target to playlist
+                libvlc_playlist_add_extended(_p_libvlc, psz_mrl, NULL, i_options, options, NULL);
+                CoTaskMemFree(psz_mrl);
             }
-            // add default target to playlist
-            VLC_AddTarget(_i_vlc, psz_mrl, options, cOptions, PLAYLIST_APPEND, PLAYLIST_END);
-            CoTaskMemFree(psz_mrl);
         }
     }
-    *i_vlc = _i_vlc;
+    *pp_libvlc = _p_libvlc;
     return S_OK;
 };
 
@@ -721,13 +774,12 @@
     }
     if( isRunning() )
     {
-        int i_vlc = _i_vlc;
+        libvlc_instance_t* p_libvlc = _p_libvlc;
 
-        _i_vlc = 0;
+        _p_libvlc = NULL;
         vlcDataObject->onClose();
 
-        VLC_CleanUp(i_vlc);
-        VLC_Destroy(i_vlc);
+        libvlc_destroy(p_libvlc);
     }
     return S_OK;
 };
@@ -806,26 +858,24 @@
     if( _b_usermode )
     {
         /* will run vlc if not done already */
-        int i_vlc;
-        HRESULT result = getVLCObject(&i_vlc);
+        libvlc_instance_t* p_libvlc;
+        HRESULT result = getVLC(&p_libvlc);
         if( FAILED(result) )
             return result;
 
         /* set internal video width and height */
-        vlc_value_t val;
-        val.i_int = posRect.right-posRect.left;
-        VLC_VariableSet(i_vlc, "conf::width", val);
-        val.i_int = posRect.bottom-posRect.top;
-        VLC_VariableSet(i_vlc, "conf::height", val);
+        libvlc_video_set_size(p_libvlc,
+            posRect.right-posRect.left,
+            posRect.bottom-posRect.top,
+            NULL );
 
         /* set internal video parent window */
-        /* horrible cast there */
-        val.i_int = reinterpret_cast<int>(_videownd);
-        VLC_VariableSet(i_vlc, "drawable", val);
+        libvlc_video_set_parent(p_libvlc,
+            reinterpret_cast<libvlc_drawable_t>(_videownd), NULL);
 
-        if( _b_autoplay & (VLC_PlaylistNumberOfItems(i_vlc) > 0) )
+        if( _b_autoplay & (libvlc_playlist_items_count(p_libvlc, NULL) > 0) )
         {
-            VLC_Play(i_vlc);
+            libvlc_playlist_play(p_libvlc, 0, 0, NULL, NULL);
             fireOnPlayEvent();
         }
     }
@@ -840,7 +890,7 @@
 {
     if( isRunning() )
     {
-        VLC_Stop(_i_vlc);
+        libvlc_playlist_stop(_p_libvlc, NULL);
         fireOnStopEvent();
     }
 
@@ -880,7 +930,7 @@
         _i_volume = volume;
         if( isRunning() )
         {
-            VLC_VolumeSet(_i_vlc, _i_volume);
+            libvlc_audio_set_volume(_p_libvlc, _i_volume, NULL);
         }
         setDirty(TRUE);
     }
@@ -893,12 +943,16 @@
 
     if( seconds != _i_time )
     {
-        _i_time = seconds;
+        setStartTime(_i_time);
         if( isRunning() )
         {
-            VLC_TimeSet(_i_vlc, seconds, VLC_FALSE);
+            libvlc_input_t *p_input = libvlc_playlist_get_input(_p_libvlc, NULL);
+            if( NULL != p_input )
+            {
+                libvlc_input_set_time(p_input, _i_time, NULL);
+                libvlc_input_free(p_input);
+            }
         }
-        setDirty(TRUE);
     }
 };
 
@@ -1065,11 +1119,13 @@
             SWP_NOOWNERZORDER );
 
     //RedrawWindow(_videownd, &posRect, NULL, RDW_INVALIDATE|RDW_ERASE|RDW_ALLCHILDREN);
-    vlc_value_t val;
-    val.i_int = posRect.right-posRect.left;
-    VLC_VariableSet(_i_vlc, "conf::width", val);
-    val.i_int = posRect.bottom-posRect.top;
-    VLC_VariableSet(_i_vlc, "conf::height", val);
+    if( isRunning() )
+    {
+        libvlc_video_set_size(_p_libvlc,
+            posRect.right-posRect.left,
+            posRect.bottom-posRect.top,
+            NULL );
+    }
 };
 
 void VLCPlugin::freezeEvents(BOOL freeze)
diff -uNr vlc-0.8.6-svn20060918.debian/activex/plugin.h vlc-0.8.6-svn20061008.debian/activex/plugin.h
--- vlc-0.8.6-svn20060918.debian/activex/plugin.h	2006-09-18 06:28:02.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/activex/plugin.h	2006-10-04 09:47:07.000000000 -0400
@@ -26,9 +26,10 @@
 #include <ole2.h>
 #include <olectl.h>
 
-#include <vlc/vlc.h>
+#include <vlc/libvlc.h>
 
 extern const GUID CLSID_VLCPlugin; 
+extern const GUID CLSID_VLCPlugin2; 
 extern const GUID LIBID_AXVLC; 
 extern const GUID DIID_DVLCEvents; 
 
@@ -37,7 +38,7 @@
 
 public:
 
-    VLCPluginClass(LONG *p_class_ref,HINSTANCE hInstance);
+    VLCPluginClass(LONG *p_class_ref, HINSTANCE hInstance, REFCLSID rclsid);
 
     /* IUnknown methods */
     STDMETHODIMP QueryInterface(REFIID riid, void **ppv);
@@ -48,6 +49,8 @@
     STDMETHODIMP CreateInstance(LPUNKNOWN pUnkOuter, REFIID riid, void **ppv);
     STDMETHODIMP LockServer(BOOL fLock);
 
+    REFCLSID getClassID(void) { return (REFCLSID)_classid; };
+
     LPCSTR getInPlaceWndClassName(void) const { return TEXT("VLC Plugin In-Place"); };
     LPCSTR getVideoWndClassName(void) const { return TEXT("VLC Plugin Video"); };
     HINSTANCE getHInstance(void) const { return _hinstance; };
@@ -62,6 +65,7 @@
 
     LPLONG      _p_class_ref;
     HINSTANCE   _hinstance;
+    CLSID       _classid;
     ATOM        _inplace_wndclass_atom;
     ATOM        _video_wndclass_atom;
     LPPICTURE   _inplace_picture;
@@ -81,7 +85,7 @@
 
     /* custom methods */
     HRESULT getTypeLib(LCID lcid, ITypeLib **pTL) { return LoadRegTypeLib(LIBID_AXVLC, 1, 0, lcid, pTL); };
-    REFCLSID getClassID(void) { return (REFCLSID)CLSID_VLCPlugin; };
+    REFCLSID getClassID(void) { return _p_class->getClassID(); };
     REFIID getDispEventID(void) { return (REFIID)DIID_DVLCEvents; };
 
     /*
@@ -116,9 +120,24 @@
     BOOL getVisible(void) { return _b_visible; };
     BOOL isVisible(void) { return _b_visible || (! _b_usermode); };
 
+    inline void setStartTime(int time)
+    {
+        _i_time = time;
+        setDirty(TRUE);
+    };
+    inline int getStartTime(void) { return _i_time; };
+
     void setTime(int time);
     int  getTime(void) { return _i_time; };
 
+    void setBaseURL(BSTR url)
+    {
+        SysFreeString(_bstr_baseurl);
+        _bstr_baseurl = SysAllocStringLen(url, SysStringLen(url));
+        setDirty(TRUE);
+    };
+    const BSTR getBaseURL(void) { return _bstr_baseurl; };
+
     // control size in HIMETRIC
     inline void setExtent(const SIZEL& extent)
     {
@@ -165,9 +184,9 @@
     inline BOOL isDirty(void) { return _b_dirty; };
     inline void setDirty(BOOL dirty) { _b_dirty = dirty; };
 
-    inline BOOL isRunning(void) { return 0 != _i_vlc; };
+    inline BOOL isRunning(void) { return NULL != _p_libvlc; };
     HRESULT getVLCObject(int *i_vlc);
-
+    HRESULT getVLC(libvlc_instance_t** p_vlc);
 
     // control geometry within container
     RECT getPosRect(void) { return _posRect; }; 
@@ -218,6 +237,7 @@
     class VLCConnectionPointContainer *vlcConnectionPointContainer;
     class VLCObjectSafety *vlcObjectSafety;
     class VLCControl *vlcControl;
+    class VLCControl2 *vlcControl2;
     class VLCViewObject *vlcViewObject;
     class VLCDataObject *vlcDataObject;
 
@@ -226,15 +246,16 @@
     // video window (Drawing window)
     HWND _videownd;
 
-    VLCPluginClass *_p_class;
+    VLCPluginClass* _p_class;
     ULONG _i_ref;
 
+    libvlc_instance_t* _p_libvlc;
     UINT _i_codepage;
     BOOL _b_usermode;
-    int  _i_vlc;
     RECT _posRect;
 
     // persistable properties
+    BSTR _bstr_baseurl;
     BSTR _bstr_mrl;
     BOOL _b_autoplay;
     BOOL _b_autoloop;
diff -uNr vlc-0.8.6-svn20060918.debian/activex/test.html vlc-0.8.6-svn20061008.debian/activex/test.html
--- vlc-0.8.6-svn20060918.debian/activex/test.html	2006-09-18 06:28:02.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/activex/test.html	2006-10-04 09:47:07.000000000 -0400
@@ -1,219 +1,294 @@
-<HTML>
-<TITLE>VLC ActiveX plugin test page</TITLE>
-<BODY>
-<TABLE>
-<TR><TD colspan="2">
-MRL:
-<INPUT size="90" name="targetTextField" value="">
-<INPUT type=submit value="Go" onClick="doGo(targetTextField.value);">
-</TD></TR>
-<TR><TD colspan="2">
-<!--
-Insert VideoLAN.VLCPlugin.1 activex control
--->
-<OBJECT classid="clsid:E23FE9C6-778E-49D4-B537-38FCDE4887D8"
-        codebase="http://downloads.videolan.org/pub/videolan/vlc/latest/win32/axvlc.cab#Version=0,8,4,0"
-        width="640"
-        height="480"
-        id="vlc"
-        events="True">
-<param name="MRL" value="" />
-<param name="ShowDisplay" value="True" />
-<param name="AutoLoop" value="False" />
-<param name="AutoPlay" value="False" />
-<param name="Volume" value="50" />
-<param name="StartTime" value="0" />
-</OBJECT>
-</TD></TR>
-<TR><TD>
-<!--
-Insert MSComctlLib.Slider.2 activex control
--->
-<OBJECT classid="clsid:F08DF954-8592-11D1-B16A-00C0F0283628"
-        width="540"
-        height="20"
-        id="slider"
-        events="True">
-<param name="TickStyle" value="3" />
-<param name="Min" value="0" />
-<param name="Max" value="0" />
-<param name="Value" value="0" />
-<param name="Enabled" value="False" />
-</OBJECT>
-</TD><TD width="15%">
-<DIV id="info" style="text-align:center">-:--:--/-:--:--</DIV>
-</TD></TR>
-<TR><TD colspan="2">
-<INPUT type=button id="PlayOrPause" value=" Play " onClick='doPlayOrPause()'>
-<INPUT type=button value="Stop" onClick='document.vlc.stop();'>
-&nbsp;
-<INPUT type=button value=" << " onClick='document.vlc.playSlower();'>
-<INPUT type=button value=" >> " onClick='document.vlc.playFaster();'>
-&nbsp;
-<INPUT type=button value="Show" onClick='document.vlc.Visible = true;'>
-<INPUT type=button value="Hide" onClick='document.vlc.Visible = false;'>
-&nbsp;
-<INPUT type=button value="Version" onClick='alert(document.vlc.VersionInfo);'>
-<SPAN style="text-align:center">Volume:</SPAN>
-<INPUT type=button value=" - " onClick='updateVolume(-10)'>
-<SPAN id="volumeTextField" style="text-align: center">--</SPAN>
-<INPUT type=button value=" + " onClick='updateVolume(+10)'>
-<INPUT type=button value="Mute" onClick='document.vlc.toggleMute();'>
-</TD>
-</TR>
-</TABLE>
-<SCRIPT LANGUAGE="JScript">
-<!--
-var sliderTimerId = 0;
-var sliderScrolling = false;
-
-document.onreadystatechange=onVLCStateChange;
-function onVLCStateChange()
-{
-    if( document.readyState == 'complete' )
-    {
-        updateVolume(0);
-    }
-};
-function updateVolume(deltaVol)
-{
-    vlc.Volume += deltaVol;
-    volumeTextField.innerText = vlc.Volume+"%";
-};
-function formatTime(timeVal)
-{
-    var timeHour = timeVal;
-    var timeSec = timeHour % 60;
-    if( timeSec < 10 )
-    	timeSec = '0'+timeSec;
-    timeHour = (timeHour - timeSec)/60;
-    var timeMin = timeHour % 60;
-    if( timeMin < 10 )
-    	timeMin = '0'+timeMin;
-    timeHour = (timeHour - timeMin)/60;
-    if( timeHour > 0 )
-    	return timeHour+":"+timeMin+":"+timeSec;
-    else
-    	return timeMin+":"+timeSec;
-};
-function onPlay()
-{
-    document.getElementById("PlayOrPause").value = "Pause";
-};
-function onPause()
-{
-    document.getElementById("PlayOrPause").value = " Play ";
-};
-function onStop()
-{
-    if( slider.Enabled )
-    {
-        slider.Value = slider.Min;
-        slider.Enabled = false;
-    }
-    info.innerText = "-:--:--/-:--:--";
-    document.getElementById("PlayOrPause").value = " Play ";
-};
-var liveFeedText = new Array("Live", "((Live))", "(( Live ))", "((  Live  ))");
-var liveFeedRoll = 0;
-
-function doUpdate()
-{
-    if( vlc.Playing )
-    {
-        if( ! sliderScrolling )
-        {
-            if( vlc.Length > 0 )
-            {
-                // seekable stream
-                slider.Enabled = true;
-                slider.Max = vlc.Length;
-                slider.Value = vlc.Time;
-                info.innerText = formatTime(vlc.Time)+"/"+formatTime(vlc.Length);
-                document.getElementById("PlayOrPause").Enabled = true;
-            }
-            else {
-                // non-seekable "live" stream
-                if( slider.Enabled )
-                {
-                    slider.Value = slider.Min;
-                    slider.Enabled = false;
-                }
-                liveFeedRoll = liveFeedRoll & 3;
-                info.innerText = liveFeedText[liveFeedRoll++];
-            }
-        }
-        sliderTimerId = setTimeout("doUpdate()", 1000);
-    }
-    else
-    {
-        onStop();
-        sliderTimerId = 0;
-    }
-};
-function doGo(targetURL)
-{
-	var options = new Array(":vout-filter=deinterlace", ":deinterlace-mode=linear");
-	document.vlc.addTarget(targetURL, options, 4+8, -666);
-};
-function doPlayOrPause()
-{
-    if( document.vlc.playing )
-    {
-        document.vlc.pause();
-    }
-    else
-    {
-        document.vlc.play();
-    }
-};
-function vlc::Play()
-{
-    if( ! sliderTimerId )
-    {
-        sliderTimerId = setTimeout("doUpdate()", 1000);
-    }
-    onPlay();
-};
-function vlc::Pause()
-{
-    if( sliderTimerId )
-    {
-        clearTimeout(sliderTimerId)
-        sliderTimerId = 0;
-    }
-    onPause();
-};
-function vlc::Stop()
-{
-    if( sliderTimerId )
-    {
-        clearTimeout(sliderTimerId)
-        sliderTimerId = 0;
-    }
-    onStop();
-};
-function slider::Scroll()
-{
-    slider.Text = formatTime(slider.Value);
-    info.innerText = slider.Text+"/"+formatTime(vlc.Length);
-    if( vlc.Time != slider.Value )
-    {
-        vlc.Time = slider.Value;
-    }
-};
-function slider::Change()
-{
-    if( sliderScrolling )
-    {
-        sliderScrolling = false;
-    }
-    else if( vlc.Time != slider.Value )
-    {
-        vlc.Time = slider.Value;
-    }
-};
-//-->
-</SCRIPT>
-</BODY>
-</HTML>
+<HTML>
+<TITLE>VLC ActiveX plugin test page</TITLE>
+<BODY>
+<TABLE>
+<TR><TD colspan="2">
+MRL:
+<INPUT size="90" id="targetTextField" value="">
+<INPUT type=submit value="Go" onClick="doGo(document.getElementById('targetTextField').value);">
+</TD></TR>
+<TR><TD colspan="2">
+<!--
+Insert VideoLAN.VLCPlugin.2 activex control
+-->
+<OBJECT classid="clsid:9BE31822-FDAD-461B-AD51-BE1D1C159921"
+        codebase="http://downloads.videolan.org/pub/videolan/vlc/latest/win32/axvlc.cab#Version=0,8,6,0"
+        width="640"
+        height="480"
+        id="vlc"
+        events="True">
+<param name="MRL" value="" />
+<param name="ShowDisplay" value="True" />
+<param name="AutoLoop" value="False" />
+<param name="AutoPlay" value="False" />
+<param name="Volume" value="50" />
+<param name="StartTime" value="0" />
+</OBJECT>
+</TD></TR>
+<TR><TD>
+<!--
+Insert MSComctlLib.Slider.2 activex control
+-->
+<OBJECT classid="clsid:F08DF954-8592-11D1-B16A-00C0F0283628"
+        width="540"
+        height="20"
+        id="slider"
+        events="True">
+<param name="TickStyle" value="3" />
+<param name="Min" value="0" />
+<param name="Max" value="0" />
+<param name="Value" value="0" />
+<param name="Enabled" value="False" />
+</OBJECT>
+</TD><TD width="15%">
+<DIV id="info" style="text-align:center">-:--:--/-:--:--</DIV>
+</TD></TR>
+<TR><TD colspan="2">
+<INPUT type=button id="PlayOrPause" value=" Play " onClick='doPlayOrPause();'>
+<INPUT type=button value="Stop" onClick='doStop();'>
+&nbsp;
+<INPUT type=button value=" << " onClick='doPlaySlower();'>
+<INPUT type=button value=" >> " onClick='doPlayFaster();'>
+&nbsp;
+<INPUT type=button value="Show" onClick='document.getElementById("vlc").Visible = true;'>
+<INPUT type=button value="Hide" onClick='document.getElementById("vlc").Visible = false;'>
+&nbsp;
+<INPUT type=button id="VersionBut" value="Version" onClick='alert(document.getElementById("vlc").VersionInfo);'>
+<SPAN style="text-align:center">Volume:</SPAN>
+<INPUT type=button value=" - " onClick='updateVolume(-10)'>
+<SPAN id="volumeTextField" style="text-align: center">--</SPAN>
+<INPUT type=button value=" + " onClick='updateVolume(+10)'>
+<INPUT type=button value="Mute" onClick='document.getElementById("vlc").audio.toggleMute();'>
+</TD>
+</TR>
+</TABLE>
+<SCRIPT language="javascript">
+<!--
+
+var prevState = 0;
+var monitorTimerId = 0;
+var sliderScrolling = false;
+var ignoreSliderChange = false;
+
+function updateVolume(deltaVol)
+{
+    var vlc = document.getElementById("vlc");
+    vlc.audio.volume += deltaVol;
+    document.getElementById("volumeTextField").innerHTML = vlc.audio.volume+"%";
+};
+function formatTime(timeVal)
+{
+    var timeHour = Math.round(timeVal / 1000);
+    var timeSec = timeHour % 60;
+    if( timeSec < 10 )
+	timeSec = '0'+timeSec;
+    timeHour = (timeHour - timeSec)/60;
+    var timeMin = timeHour % 60;
+    if( timeMin < 10 )
+	timeMin = '0'+timeMin;
+    timeHour = (timeHour - timeMin)/60;
+    if( timeHour > 0 )
+	return timeHour+":"+timeMin+":"+timeSec;
+    else
+	return timeMin+":"+timeSec;
+};
+function monitor()
+{
+    var vlc = document.getElementById("vlc");
+    var newState = vlc.input.state;
+    if( prevState != newState )
+    {
+	if( newState == 0 )
+	{
+	    // current media has stopped 
+	    onStop();
+	}
+	else if( newState == 1 )
+	{
+	    // current media is openning/connecting
+	    onOpen();
+	}
+	else if( newState == 2 )
+	{
+	    // current media is buffering data
+	    onBuffer();
+	}
+	else if( newState == 3 )
+	{
+	    // current media is now playing
+	    onPlay();
+	}
+	else if( vlc.input.state == 4 )
+	{
+	    // current media is now paused
+	    onPause();
+	}
+	prevState = newState;
+    }
+    else if( newState == 3 )
+    {
+	// current media is playing
+	onPlaying();
+    }
+    monitorTimerId = setTimeout("monitor()", 1000);
+};
+
+/* actions */
+
+function doGo(targetURL)
+{
+    var vlc = document.getElementById("vlc");
+    var options = new Array(":vout-filter=deinterlace", ":deinterlace-mode=linear");
+    vlc.playlist.clear();
+    //vlc.playlist.add(targetURL, null, options);
+    vlc.playlist.add(targetURL);
+    vlc.playlist.play();
+    if( monitorTimerId == 0 )
+    {
+	monitor();
+    }
+};
+function doPlayOrPause()
+{
+    var vlc = document.getElementById("vlc");
+    if( vlc.playlist.isPlaying )
+    {
+	vlc.playlist.togglePause();
+    }
+    else
+    {
+	vlc.playlist.play();
+	if( monitorTimerId == 0 )
+	{
+	    monitor();
+	}
+    }
+};
+function doStop()
+{
+    document.getElementById("vlc").playlist.stop();
+    if( monitorTimerId != 0 )
+    {
+	clearTimeout(monitorTimerId);
+	monitorTimerId = 0;
+    }
+    onStop();
+};
+function doPlaySlower()
+{
+    var vlc = document.getElementById("vlc");
+    vlc.input.rate = vlc.input.rate / 2;
+};
+function doPlayFaster()
+{
+    var vlc = document.getElementById("vlc");
+    vlc.input.rate = vlc.input.rate * 2;
+};
+
+/* events */
+
+function onOpen()
+{
+    document.getElementById("info").innerHTML = "Opening...";
+    document.getElementById("PlayOrPause").value = "Pause";
+};
+function onBuffer()
+{
+    document.getElementById("info").innerHTML = "Buffering...";
+    document.getElementById("PlayOrPause").value = "Pause";
+};
+function onPlay()
+{
+    onPlaying();
+    document.getElementById("PlayOrPause").value = "Pause";
+};
+var liveFeedText = new Array("Live", "((Live))", "(( Live ))", "((  Live  ))");
+var liveFeedRoll = 0;
+function onPlaying()
+{
+    if( ! sliderScrolling )
+    {
+	var slider = document.getElementById("slider");
+	if( vlc.input.length > 0 )
+	{
+	    // seekable media
+	    slider.Enabled = true;
+	    slider.Max = slider.width;
+	    ignoreSliderChange = true;
+	    slider.Value = vlc.input.position*slider.width;
+	    ignoreSliderChange = false;
+	    document.getElementById("info").innerHTML = formatTime(vlc.input.time)+"/"+formatTime(vlc.input.length);
+	}
+	else
+	{
+	    // non-seekable "live" media
+	    if( slider.Enabled )
+	    {
+		slider.Value = slider.Min;
+		slider.Enabled = false;
+	    }
+            liveFeedRoll = liveFeedRoll & 3;
+            document.getElementById("info").innerHTML = liveFeedText[liveFeedRoll++];
+	}
+    }
+};
+function onPause()
+{
+    document.getElementById("PlayOrPause").value = " Play ";
+};
+function onStop()
+{
+    if( slider.Enabled )
+    {
+        slider.Value = slider.Min;
+        slider.Enabled = false;
+    }
+    document.getElementById("info").innerHTML = "-:--:--/-:--:--";
+    document.getElementById("PlayOrPause").value = " Play ";
+};
+//-->
+</SCRIPT>
+<SCRIPT language="JScript">
+<!--
+
+document.onreadystatechange=onVLCStateChange;
+function onVLCStateChange()
+{
+    if( document.readyState == 'complete' )
+    {
+        updateVolume(0);
+    }
+};
+function slider::Scroll()
+{
+    var vlc = document.getElementById("vlc");
+    var slider = document.getElementById("slider");
+    var oldPos = vlc.input.position;
+    var newPos = slider.Value/slider.width;
+    if( (vlc.input.state == 3) && (oldPos != newPos) )
+    {
+        vlc.input.position = newPos;
+	slider.Text = formatTime(vlc.input.time);
+	document.getElementById("info").innerHTML = slider.Text+"/"+formatTime(vlc.input.length);
+    }
+    sliderScrolling = true;
+};
+function slider::Change()
+{
+    var vlc = document.getElementById("vlc");
+    var slider = document.getElementById("slider");
+    var oldPos = vlc.input.position;
+    var newPos = slider.Value/slider.width;
+    if( sliderScrolling )
+    {
+        sliderScrolling = false;
+    }
+    else if( !ignoreSliderChange && (vlc.input.state == 3) && (oldPos != newPos) )
+    {
+        vlc.input.position = newPos;
+    }
+};
+//-->
+</SCRIPT>
+</BODY>
+</HTML>
diff -uNr vlc-0.8.6-svn20060918.debian/activex/utils.cpp vlc-0.8.6-svn20061008.debian/activex/utils.cpp
--- vlc-0.8.6-svn20060918.debian/activex/utils.cpp	2006-09-18 06:28:02.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/activex/utils.cpp	2006-10-04 09:47:07.000000000 -0400
@@ -62,7 +62,7 @@
             ZeroMemory(wideStr, wideLen*sizeof(WCHAR));
             MultiByteToWideChar(codePage, 0, s, -1, wideStr, wideLen);
             bstr = SysAllocStringLen(wideStr, wideLen);
-            free(wideStr);
+            CoTaskMemFree(wideStr);
 
             return bstr;
         }
@@ -70,6 +70,28 @@
     return NULL;
 };
 
+char *CStrFromGUID(REFGUID clsid)
+{
+    LPOLESTR oleStr;
+
+    if( FAILED(StringFromIID(clsid, &oleStr)) )
+        return NULL;
+
+#ifdef OLE2ANSI
+    return (LPCSTR)oleStr;
+#else
+    char *pct_CLSID = NULL;
+    size_t len = WideCharToMultiByte(CP_ACP, 0, oleStr, -1, NULL, 0, NULL, NULL);
+    if( len > 0 )
+    {
+        pct_CLSID = (char *)CoTaskMemAlloc(len);
+        WideCharToMultiByte(CP_ACP, 0, oleStr, -1, pct_CLSID, len, NULL, NULL);
+    }
+    CoTaskMemFree(oleStr);
+    return pct_CLSID;
+#endif
+};
+
 /*
 **  properties
 */
@@ -105,32 +127,35 @@
 HDC CreateDevDC(DVTARGETDEVICE *ptd)
 {
 	HDC hdc=NULL;
-	LPDEVNAMES lpDevNames;
-	LPDEVMODE lpDevMode;
-	LPTSTR lpszDriverName;
-	LPTSTR lpszDeviceName;
-	LPTSTR lpszPortName;
-
-	if (ptd == NULL) {
+	if( NULL == ptd )
+    {
 		hdc = CreateDC(TEXT("DISPLAY"), NULL, NULL, NULL);
-		goto errReturn;
 	}
+    else
+    {
+        LPDEVNAMES lpDevNames;
+        LPDEVMODE lpDevMode;
+        LPTSTR lpszDriverName;
+        LPTSTR lpszDeviceName;
+        LPTSTR lpszPortName;
 
-	lpDevNames = (LPDEVNAMES) ptd; // offset for size field
-
-	if (ptd->tdExtDevmodeOffset == 0) {
-		lpDevMode = NULL;
-	}else{
-		lpDevMode  = (LPDEVMODE) ((LPTSTR)ptd + ptd->tdExtDevmodeOffset);
-	}
+        lpDevNames = (LPDEVNAMES) ptd; // offset for size field
 
-	lpszDriverName = (LPTSTR) lpDevNames + ptd->tdDriverNameOffset;
-	lpszDeviceName = (LPTSTR) lpDevNames + ptd->tdDeviceNameOffset;
-	lpszPortName   = (LPTSTR) lpDevNames + ptd->tdPortNameOffset;
+        if (ptd->tdExtDevmodeOffset == 0)
+        {
+            lpDevMode = NULL;
+        }
+        else
+        {
+            lpDevMode  = (LPDEVMODE) ((LPTSTR)ptd + ptd->tdExtDevmodeOffset);
+        }
 
-	hdc = CreateDC(lpszDriverName, lpszDeviceName, lpszPortName, lpDevMode);
+        lpszDriverName = (LPTSTR) lpDevNames + ptd->tdDriverNameOffset;
+        lpszDeviceName = (LPTSTR) lpDevNames + ptd->tdDeviceNameOffset;
+        lpszPortName   = (LPTSTR) lpDevNames + ptd->tdPortNameOffset;
 
-errReturn:
+        hdc = CreateDC(lpszDriverName, lpszDeviceName, lpszPortName, lpDevMode);
+    }
 	return hdc;
 };
 
diff -uNr vlc-0.8.6-svn20060918.debian/activex/utils.h vlc-0.8.6-svn20061008.debian/activex/utils.h
--- vlc-0.8.6-svn20060918.debian/activex/utils.h	2006-09-18 06:28:02.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/activex/utils.h	2006-10-04 09:47:07.000000000 -0400
@@ -31,6 +31,8 @@
 extern char *CStrFromBSTR(UINT codePage, BSTR bstr);
 extern BSTR BSTRFromCStr(UINT codePage, LPCSTR s);
 
+extern char *CStrFromGUID(REFGUID clsid);
+
 // properties
 extern HRESULT GetObjectProperty(LPUNKNOWN object, DISPID dispID, VARIANT& v);
 
@@ -39,151 +41,132 @@
 extern void DPFromHimetric(HDC hdc, LPPOINT pt, int count);
 extern void HimetricFromDP(HDC hdc, LPPOINT pt, int count);
 
+/**************************************************************************************************/
+
+/* this function object is used to dereference the iterator into a value */
+template <class T, class Iterator>
+struct VLCDereference
+{
+    T operator()(const Iterator& i) const
+    {
+        return *i;
+    };
+};
 
-// enumeration
-template<class T> class VLCEnum : IUnknown
+template<REFIID EnumeratorIID, class Enumerator, class T, class Iterator, typename Dereference = VLCDereference<T, Iterator> >
+class VLCEnumIterator : public Enumerator
 {
 
 public:
 
-    VLCEnum(REFIID riid, std::vector<T> &);
-    VLCEnum(const VLCEnum<T> &);
-    virtual ~VLCEnum() {};
+    VLCEnumIterator(const Iterator& from, const Iterator& to) :
+        _refcount(1),
+        _begin(from),
+        _curr(from),
+        _end(to)
+    {};
+
+    VLCEnumIterator(const VLCEnumIterator& e) :
+        Enumerator(),
+        _refcount(e._refcount),
+        _begin(e._begin),
+        _curr(e._curr),
+        _end(e._end)
+    {};
 
-    VLCEnum<T>& operator=(const VLCEnum<T> &t);
+    virtual ~VLCEnumIterator()
+    {};
 
     // IUnknown methods
-    STDMETHODIMP QueryInterface(REFIID riid, void **);
-    STDMETHODIMP_(ULONG) AddRef(void);
-    STDMETHODIMP_(ULONG) Release(void);
-
-    // IEnumXXXX methods
-    STDMETHODIMP Next(ULONG, T *, ULONG *);
-    STDMETHODIMP Skip(ULONG);
-    STDMETHODIMP Reset(void);
-    // cloning is implemented by subclasses and must use copy constructor
-    //STDMETHODIMP Clone(VLCEnum<T> **);
+    STDMETHODIMP QueryInterface(REFIID riid, void **ppv)
+    {
+        if( NULL == ppv )
+            return E_POINTER;
+        if( (IID_IUnknown == riid) 
+         || (EnumeratorIID == riid) )
+        {
+            AddRef();
+            *ppv = reinterpret_cast<LPVOID>(this);
+            return NOERROR;
+        }
+        // standalone object
+        return E_NOINTERFACE;
+    };
 
-    typedef void (*retainer)(T);
+    STDMETHODIMP_(ULONG) AddRef(void)
+    {
+        return InterlockedIncrement(&_refcount);
+    };
 
-    void setRetainOperation(retainer retain) { _retain = retain; };
+    STDMETHODIMP_(ULONG) Release(void)
+    {
+        ULONG refcount = InterlockedDecrement(&_refcount);
+        if( 0 == refcount )
+        {
+            delete this;
+            return 0;
+        }
+        return refcount;
+    };
 
-private:
 
-    LONG                                _refcount;
-    std::vector<T>                      _v;
-    typename std::vector<T>::iterator   _i;
-    REFIID                              _riid;
-    retainer                            _retain;
-};
+    // IEnumXXXX methods
+    STDMETHODIMP Next(ULONG celt, T *rgelt, ULONG *pceltFetched)
+    {
+        if( NULL == rgelt )
+            return E_POINTER;
 
-template<class T>
-VLCEnum<T>::VLCEnum(REFIID riid, std::vector<T> &v) :
-    _refcount(1),
-    _v(v),
-    _riid(riid),
-    _retain(NULL)
-{
-    _i= v.begin();
-};
+        if( (celt > 1) && (NULL == pceltFetched) )
+            return E_INVALIDARG;
 
-template<class T>
-VLCEnum<T>::VLCEnum(const VLCEnum<T> &e) :
-    _refcount(1),
-    _v(e._v),
-    _riid(e._riid)
-{
-};
+        ULONG c = 0;
 
-template<class T>
-VLCEnum<T>& VLCEnum<T>::operator=(const VLCEnum<T> &e)
-{
-    this->_refcount = 1;
-    this->_riid = e._riid;
-    this->_v    = e._v;
-    this->_i    = e._i;
-    return this;
-};
+        while( (c < celt) && (_curr != _end) )
+        {
+            rgelt[c] = dereference(_curr);
+            ++_curr;
+            ++c;
+        }
 
-template<class T>
-STDMETHODIMP VLCEnum<T>::QueryInterface(REFIID riid, void **ppv)
-{
-    if( NULL == ppv )
-        return E_POINTER;
-    if( (IID_IUnknown == riid) 
-     || (_riid == riid) )
-    {
-        AddRef();
-        *ppv = reinterpret_cast<LPVOID>(this);
-        return NOERROR;
-    }
-    // standalone object
-    return E_NOINTERFACE;
-};
+        if( NULL != pceltFetched )
+            *pceltFetched = c;
 
-template<class T>
-STDMETHODIMP_(ULONG) VLCEnum<T>::AddRef(void)
-{
-    return InterlockedIncrement(&_refcount);
-};
+        return (c == celt) ? S_OK : S_FALSE;
+    };
 
-template<class T>
-STDMETHODIMP_(ULONG) VLCEnum<T>::Release(void)
-{
-    ULONG refcount = InterlockedDecrement(&_refcount);
-    if( 0 == refcount )
+    STDMETHODIMP Skip(ULONG celt)
     {
-        delete this;
-        return 0;
-    }
-    return refcount;
-};
-
-template<class T>
-STDMETHODIMP VLCEnum<T>::Next(ULONG celt, T *rgelt, ULONG *pceltFetched)
-{
-    if( NULL == rgelt )
-        return E_POINTER;
+        ULONG c = 0;
 
-    if( (celt > 1) && (NULL == pceltFetched) )
-        return E_INVALIDARG;
+        while( (c < celt) && (_curr != _end) )
+        {
+            ++_curr;
+            ++c;
+        }
+        return (c == celt) ? S_OK : S_FALSE;
+    };
 
-    ULONG c = 0;
-    typename std::vector<T>::iterator end = _v.end();
+    STDMETHODIMP Reset(void)
+    {
+        _curr = _begin;
+        return S_OK;
+    };
 
-    while( (c < celt) && (_i != end) )
+    STDMETHODIMP Clone(Enumerator **ppEnum)
     {
-        rgelt[c] = *_i;
-        if( NULL != _retain ) _retain(rgelt[c]);
-        ++_i;
-        ++c;
-    }
+        if( NULL == ppEnum )
+            return E_POINTER;
+        *ppEnum = dynamic_cast<Enumerator *>(new VLCEnumIterator(*this));
+        return (NULL != *ppEnum ) ? S_OK : E_OUTOFMEMORY;
+    };
 
-    if( NULL != pceltFetched )
-        *pceltFetched = c;
+private:
 
-    return (c == celt) ? S_OK : S_FALSE;
-};
+    LONG     _refcount;
+    Iterator _begin, _curr, _end;
 
-template<class T>
-STDMETHODIMP VLCEnum<T>::Skip(ULONG celt)
-{
-    ULONG c = 0;
-    typename std::vector<T>::iterator end = _v.end();
+    Dereference dereference;
 
-    while( (c < celt) && (_i != end) )
-    {
-        ++_i;
-        ++c;
-    }
-    return (c == celt) ? S_OK : S_FALSE;
-};
-
-template<class T>
-STDMETHODIMP VLCEnum<T>::Reset(void)
-{
-    _i= _v.begin();
-    return S_OK;
 };
 
 #endif
diff -uNr vlc-0.8.6-svn20060918.debian/activex/vlccontrol2.cpp vlc-0.8.6-svn20061008.debian/activex/vlccontrol2.cpp
--- vlc-0.8.6-svn20060918.debian/activex/vlccontrol2.cpp	1969-12-31 19:00:00.000000000 -0500
+++ vlc-0.8.6-svn20061008.debian/activex/vlccontrol2.cpp	2006-10-04 09:47:07.000000000 -0400
@@ -0,0 +1,1381 @@
+/*****************************************************************************
+ * vlccontrol2.cpp: ActiveX control for VLC
+ *****************************************************************************
+ * Copyright (C) 2006 the VideoLAN team
+ *
+ * Authors: Damien Fouilleul <Damien.Fouilleul@laposte.net>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
+ *****************************************************************************/
+
+#include "plugin.h"
+#include "vlccontrol2.h"
+#include "vlccontrol.h"
+
+#include "utils.h"
+
+using namespace std;
+
+VLCAudio::~VLCAudio()
+{
+    if( _p_typeinfo )
+        _p_typeinfo->Release();
+};
+
+HRESULT VLCAudio::loadTypeInfo(void)
+{
+    HRESULT hr = NOERROR;
+    if( NULL == _p_typeinfo )
+    {
+        ITypeLib *p_typelib;
+
+        hr = _p_instance->getTypeLib(LOCALE_USER_DEFAULT, &p_typelib);
+        if( SUCCEEDED(hr) )
+        {
+            hr = p_typelib->GetTypeInfoOfGuid(IID_IVLCAudio, &_p_typeinfo);
+            if( FAILED(hr) )
+            {
+                _p_typeinfo = NULL;
+            }
+            p_typelib->Release();
+        }
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCAudio::GetTypeInfoCount(UINT* pctInfo)
+{
+    if( NULL == pctInfo )
+        return E_INVALIDARG;
+
+    if( SUCCEEDED(loadTypeInfo()) )
+        *pctInfo = 1;
+    else
+        *pctInfo = 0;
+
+    return NOERROR;
+};
+
+STDMETHODIMP VLCAudio::GetTypeInfo(UINT iTInfo, LCID lcid, LPTYPEINFO* ppTInfo)
+{
+    if( NULL == ppTInfo )
+        return E_INVALIDARG;
+
+    if( SUCCEEDED(loadTypeInfo()) )
+    {
+        _p_typeinfo->AddRef();
+        *ppTInfo = _p_typeinfo;
+        return NOERROR;
+    }
+    *ppTInfo = NULL;
+    return E_NOTIMPL;
+};
+
+STDMETHODIMP VLCAudio::GetIDsOfNames(REFIID riid, LPOLESTR* rgszNames, 
+        UINT cNames, LCID lcid, DISPID* rgDispID)
+{
+    if( SUCCEEDED(loadTypeInfo()) )
+    {
+        return DispGetIDsOfNames(_p_typeinfo, rgszNames, cNames, rgDispID);
+    }
+    return E_NOTIMPL;
+};
+
+STDMETHODIMP VLCAudio::Invoke(DISPID dispIdMember, REFIID riid,
+        LCID lcid, WORD wFlags, DISPPARAMS* pDispParams,
+        VARIANT* pVarResult, EXCEPINFO* pExcepInfo, UINT* puArgErr)
+{
+    if( SUCCEEDED(loadTypeInfo()) )
+    {
+        return DispInvoke(this, _p_typeinfo, dispIdMember, wFlags, pDispParams,
+                pVarResult, pExcepInfo, puArgErr);
+    }
+    return E_NOTIMPL;
+};
+
+STDMETHODIMP VLCAudio::get_mute(VARIANT_BOOL* mute)
+{
+    if( NULL == mute )
+        return E_POINTER;
+
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        *mute = libvlc_audio_get_mute(p_libvlc, &ex) ? VARIANT_TRUE : VARIANT_FALSE;
+        if( libvlc_exception_raised(&ex) )
+        {
+            libvlc_exception_clear(&ex);
+            return E_FAIL;
+        }
+        return NOERROR;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCAudio::put_mute(VARIANT_BOOL mute)
+{
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_audio_set_mute(p_libvlc, VARIANT_FALSE != mute, &ex);
+        if( libvlc_exception_raised(&ex) )
+        {
+            libvlc_exception_clear(&ex);
+            return E_FAIL;
+        }
+        return NOERROR;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCAudio::get_volume(int* volume)
+{
+    if( NULL == volume )
+        return E_POINTER;
+
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        *volume = libvlc_audio_get_volume(p_libvlc, &ex);
+        if( libvlc_exception_raised(&ex) )
+        {
+            libvlc_exception_clear(&ex);
+            return E_FAIL;
+        }
+        return NOERROR;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCAudio::put_volume(int volume)
+{
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_audio_set_volume(p_libvlc, volume, &ex);
+        if( libvlc_exception_raised(&ex) )
+        {
+            libvlc_exception_clear(&ex);
+            return E_FAIL;
+        }
+        return NOERROR;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCAudio::toggleMute()
+{
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_audio_toggle_mute(p_libvlc, &ex);
+        if( libvlc_exception_raised(&ex) )
+        {
+            libvlc_exception_clear(&ex);
+            return E_FAIL;
+        }
+        return NOERROR;
+    }
+    return hr;
+};
+
+/*******************************************************************************/
+
+VLCInput::~VLCInput()
+{
+    if( _p_typeinfo )
+        _p_typeinfo->Release();
+};
+
+HRESULT VLCInput::loadTypeInfo(void)
+{
+    HRESULT hr = NOERROR;
+    if( NULL == _p_typeinfo )
+    {
+        ITypeLib *p_typelib;
+
+        hr = _p_instance->getTypeLib(LOCALE_USER_DEFAULT, &p_typelib);
+        if( SUCCEEDED(hr) )
+        {
+            hr = p_typelib->GetTypeInfoOfGuid(IID_IVLCInput, &_p_typeinfo);
+            if( FAILED(hr) )
+            {
+                _p_typeinfo = NULL;
+            }
+            p_typelib->Release();
+        }
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCInput::GetTypeInfoCount(UINT* pctInfo)
+{
+    if( NULL == pctInfo )
+        return E_INVALIDARG;
+
+    if( SUCCEEDED(loadTypeInfo()) )
+        *pctInfo = 1;
+    else
+        *pctInfo = 0;
+
+    return NOERROR;
+};
+
+STDMETHODIMP VLCInput::GetTypeInfo(UINT iTInfo, LCID lcid, LPTYPEINFO* ppTInfo)
+{
+    if( NULL == ppTInfo )
+        return E_INVALIDARG;
+
+    if( SUCCEEDED(loadTypeInfo()) )
+    {
+        _p_typeinfo->AddRef();
+        *ppTInfo = _p_typeinfo;
+        return NOERROR;
+    }
+    *ppTInfo = NULL;
+    return E_NOTIMPL;
+};
+
+STDMETHODIMP VLCInput::GetIDsOfNames(REFIID riid, LPOLESTR* rgszNames, 
+        UINT cNames, LCID lcid, DISPID* rgDispID)
+{
+    if( SUCCEEDED(loadTypeInfo()) )
+    {
+        return DispGetIDsOfNames(_p_typeinfo, rgszNames, cNames, rgDispID);
+    }
+    return E_NOTIMPL;
+};
+
+STDMETHODIMP VLCInput::Invoke(DISPID dispIdMember, REFIID riid,
+        LCID lcid, WORD wFlags, DISPPARAMS* pDispParams,
+        VARIANT* pVarResult, EXCEPINFO* pExcepInfo, UINT* puArgErr)
+{
+    if( SUCCEEDED(loadTypeInfo()) )
+    {
+        return DispInvoke(this, _p_typeinfo, dispIdMember, wFlags, pDispParams,
+                pVarResult, pExcepInfo, puArgErr);
+    }
+    return E_NOTIMPL;
+};
+
+STDMETHODIMP VLCInput::get_length(double* length)
+{
+    if( NULL == length )
+        return E_POINTER;
+
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_libvlc, &ex);
+        if( ! libvlc_exception_raised(&ex) )
+        {
+            *length = (double)libvlc_input_get_length(p_input, &ex);
+            libvlc_input_free(p_input);
+            if( ! libvlc_exception_raised(&ex) )
+            {
+                return NOERROR;
+            }
+        }
+        libvlc_exception_clear(&ex);
+        return E_FAIL;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCInput::get_position(float* position)
+{
+    if( NULL == position )
+        return E_POINTER;
+
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_libvlc, &ex);
+        if( ! libvlc_exception_raised(&ex) )
+        {
+            *position = libvlc_input_get_position(p_input, &ex);
+            libvlc_input_free(p_input);
+            if( ! libvlc_exception_raised(&ex) )
+            {
+                return NOERROR;
+            }
+        }
+        libvlc_exception_clear(&ex);
+        return E_FAIL;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCInput::put_position(float position)
+{
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_libvlc, &ex);
+        if( ! libvlc_exception_raised(&ex) )
+        {
+            libvlc_input_set_position(p_input, position, &ex);
+            libvlc_input_free(p_input);
+            if( ! libvlc_exception_raised(&ex) )
+            {
+                return NOERROR;
+            }
+        }
+        libvlc_exception_clear(&ex);
+        return E_FAIL;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCInput::get_time(double* time)
+{
+    if( NULL == time )
+        return E_POINTER;
+
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_libvlc, &ex);
+        if( ! libvlc_exception_raised(&ex) )
+        {
+            *time = (double)libvlc_input_get_time(p_input, &ex);
+            libvlc_input_free(p_input);
+            if( ! libvlc_exception_raised(&ex) )
+            {
+                return NOERROR;
+            }
+        }
+        libvlc_exception_clear(&ex);
+        return E_FAIL;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCInput::put_time(double time)
+{
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_libvlc, &ex);
+        if( ! libvlc_exception_raised(&ex) )
+        {
+            libvlc_input_set_time(p_input, (vlc_int64_t)time, &ex);
+            libvlc_input_free(p_input);
+            if( ! libvlc_exception_raised(&ex) )
+            {
+                return NOERROR;
+            }
+        }
+        libvlc_exception_clear(&ex);
+        return E_FAIL;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCInput::get_state(int* state)
+{
+    if( NULL == state )
+        return E_POINTER;
+
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_libvlc, &ex);
+        if( ! libvlc_exception_raised(&ex) )
+        {
+            *state = libvlc_input_get_state(p_input, &ex);
+            libvlc_input_free(p_input);
+            if( ! libvlc_exception_raised(&ex) )
+            {
+                return NOERROR;
+            }
+        }
+        libvlc_exception_clear(&ex);
+        // don't fail, just return the idle state
+        *state = 0;
+        return NOERROR;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCInput::get_rate(float* rate)
+{
+    if( NULL == rate )
+        return E_POINTER;
+
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_libvlc, &ex);
+        if( ! libvlc_exception_raised(&ex) )
+        {
+            *rate = libvlc_input_get_rate(p_input, &ex);
+            libvlc_input_free(p_input);
+            if( ! libvlc_exception_raised(&ex) )
+            {
+                return NOERROR;
+            }
+        }
+        libvlc_exception_clear(&ex);
+        return E_FAIL;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCInput::put_rate(float rate)
+{
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_libvlc, &ex);
+        if( ! libvlc_exception_raised(&ex) )
+        {
+            libvlc_input_set_rate(p_input, rate, &ex);
+            libvlc_input_free(p_input);
+            if( ! libvlc_exception_raised(&ex) )
+            {
+                return NOERROR;
+            }
+        }
+        libvlc_exception_clear(&ex);
+        return E_FAIL;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCInput::get_fps(float* fps)
+{
+    if( NULL == fps )
+        return E_POINTER;
+
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_libvlc, &ex);
+        if( ! libvlc_exception_raised(&ex) )
+        {
+            *fps = libvlc_input_get_fps(p_input, &ex);
+            libvlc_input_free(p_input);
+            if( ! libvlc_exception_raised(&ex) )
+            {
+                return NOERROR;
+            }
+        }
+        libvlc_exception_clear(&ex);
+        return E_FAIL;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCInput::get_hasVout(VARIANT_BOOL* hasVout)
+{
+    if( NULL == hasVout )
+        return E_POINTER;
+
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_libvlc, &ex);
+        if( ! libvlc_exception_raised(&ex) )
+        {
+            *hasVout = libvlc_input_has_vout(p_input, &ex) ? VARIANT_TRUE : VARIANT_FALSE;
+            libvlc_input_free(p_input);
+            if( ! libvlc_exception_raised(&ex) )
+            {
+                return NOERROR;
+            }
+        }
+        libvlc_exception_clear(&ex);
+        return E_FAIL;
+    }
+    return hr;
+};
+
+/*******************************************************************************/
+
+VLCPlaylist::~VLCPlaylist()
+{
+    if( _p_typeinfo )
+        _p_typeinfo->Release();
+};
+
+HRESULT VLCPlaylist::loadTypeInfo(void)
+{
+    HRESULT hr = NOERROR;
+    if( NULL == _p_typeinfo )
+    {
+        ITypeLib *p_typelib;
+
+        hr = _p_instance->getTypeLib(LOCALE_USER_DEFAULT, &p_typelib);
+        if( SUCCEEDED(hr) )
+        {
+            hr = p_typelib->GetTypeInfoOfGuid(IID_IVLCPlaylist, &_p_typeinfo);
+            if( FAILED(hr) )
+            {
+                _p_typeinfo = NULL;
+            }
+            p_typelib->Release();
+        }
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCPlaylist::GetTypeInfoCount(UINT* pctInfo)
+{
+    if( NULL == pctInfo )
+        return E_INVALIDARG;
+
+    if( SUCCEEDED(loadTypeInfo()) )
+        *pctInfo = 1;
+    else
+        *pctInfo = 0;
+
+    return NOERROR;
+};
+
+STDMETHODIMP VLCPlaylist::GetTypeInfo(UINT iTInfo, LCID lcid, LPTYPEINFO* ppTInfo)
+{
+    if( NULL == ppTInfo )
+        return E_INVALIDARG;
+
+    if( SUCCEEDED(loadTypeInfo()) )
+    {
+        _p_typeinfo->AddRef();
+        *ppTInfo = _p_typeinfo;
+        return NOERROR;
+    }
+    *ppTInfo = NULL;
+    return E_NOTIMPL;
+};
+
+STDMETHODIMP VLCPlaylist::GetIDsOfNames(REFIID riid, LPOLESTR* rgszNames, 
+        UINT cNames, LCID lcid, DISPID* rgDispID)
+{
+    if( SUCCEEDED(loadTypeInfo()) )
+    {
+        return DispGetIDsOfNames(_p_typeinfo, rgszNames, cNames, rgDispID);
+    }
+    return E_NOTIMPL;
+};
+
+STDMETHODIMP VLCPlaylist::Invoke(DISPID dispIdMember, REFIID riid,
+        LCID lcid, WORD wFlags, DISPPARAMS* pDispParams,
+        VARIANT* pVarResult, EXCEPINFO* pExcepInfo, UINT* puArgErr)
+{
+    if( SUCCEEDED(loadTypeInfo()) )
+    {
+        return DispInvoke(this, _p_typeinfo, dispIdMember, wFlags, pDispParams,
+                pVarResult, pExcepInfo, puArgErr);
+    }
+    return E_NOTIMPL;
+};
+
+STDMETHODIMP VLCPlaylist::get_itemCount(int* count)
+{
+    if( NULL == count )
+        return E_POINTER;
+
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        *count = libvlc_playlist_items_count(p_libvlc, &ex);
+        if( libvlc_exception_raised(&ex) )
+        {
+            libvlc_exception_clear(&ex);
+            return E_FAIL;
+        }
+        return NOERROR;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCPlaylist::get_isPlaying(VARIANT_BOOL* isPlaying)
+{
+    if( NULL == isPlaying )
+        return E_POINTER;
+
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        *isPlaying = libvlc_playlist_isplaying(p_libvlc, &ex) ? VARIANT_TRUE: VARIANT_FALSE;
+        if( libvlc_exception_raised(&ex) )
+        {
+            libvlc_exception_clear(&ex);
+            return E_FAIL;
+        }
+        return NOERROR;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCPlaylist::add(BSTR uri, VARIANT name, VARIANT options, int* item)
+{
+    if( NULL == item )
+        return E_POINTER;
+
+    if( 0 == SysStringLen(uri) )
+        return E_INVALIDARG;
+
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        int i_options;
+        char **ppsz_options;
+
+        hr = VLCControl::CreateTargetOptions(CP_UTF8, &options, &ppsz_options, &i_options);
+        if( FAILED(hr) )
+            return hr;
+
+        char *psz_uri = CStrFromBSTR(CP_UTF8, uri);
+        if( NULL == psz_uri )
+        {
+            VLCControl::FreeTargetOptions(ppsz_options, i_options);
+            return E_OUTOFMEMORY;
+        }
+
+        char *psz_name = NULL;
+        VARIANT v_name;
+        VariantInit(&v_name);
+        if( SUCCEEDED(VariantChangeType(&v_name, &name, 0, VT_BSTR)) )
+        {
+            if( SysStringLen(V_BSTR(&v_name)) > 0 )
+                psz_name = CStrFromBSTR(CP_UTF8, V_BSTR(&v_name));
+
+            VariantClear(&v_name);
+        }
+
+        *item = libvlc_playlist_add_extended(p_libvlc,
+            psz_uri,
+            psz_name,
+            i_options,
+            const_cast<const char **>(ppsz_options),
+            &ex);
+
+        VLCControl::FreeTargetOptions(ppsz_options, i_options);
+        CoTaskMemFree(psz_uri);
+        if( psz_name )
+            CoTaskMemFree(psz_name);
+        if( libvlc_exception_raised(&ex) )
+        {
+            libvlc_exception_clear(&ex);
+            return E_FAIL;
+        }
+        return NOERROR;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCPlaylist::play()
+{
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_playlist_play(p_libvlc, -1, 0, NULL, &ex);
+        if( libvlc_exception_raised(&ex) )
+        {
+            libvlc_exception_clear(&ex);
+            return E_FAIL;
+        }
+        return NOERROR;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCPlaylist::playItem(int item)
+{
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_playlist_play(p_libvlc, item, 0, NULL, &ex);
+        if( libvlc_exception_raised(&ex) )
+        {
+            libvlc_exception_clear(&ex);
+            return E_FAIL;
+        }
+        return NOERROR;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCPlaylist::togglePause()
+{
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_playlist_pause(p_libvlc, &ex);
+        if( libvlc_exception_raised(&ex) )
+        {
+            libvlc_exception_clear(&ex);
+            return E_FAIL;
+        }
+        return NOERROR;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCPlaylist::stop()
+{
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_playlist_stop(p_libvlc, &ex);
+        if( libvlc_exception_raised(&ex) )
+        {
+            libvlc_exception_clear(&ex);
+            return E_FAIL;
+        }
+        return NOERROR;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCPlaylist::next()
+{
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_playlist_next(p_libvlc, &ex);
+        if( libvlc_exception_raised(&ex) )
+        {
+            libvlc_exception_clear(&ex);
+            return E_FAIL;
+        }
+        return NOERROR;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCPlaylist::prev()
+{
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_playlist_prev(p_libvlc, &ex);
+        if( libvlc_exception_raised(&ex) )
+        {
+            libvlc_exception_clear(&ex);
+            return E_FAIL;
+        }
+        return NOERROR;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCPlaylist::clear()
+{
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_playlist_clear(p_libvlc, &ex);
+        if( libvlc_exception_raised(&ex) )
+        {
+            libvlc_exception_clear(&ex);
+            return E_FAIL;
+        }
+        return NOERROR;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCPlaylist::removeItem(int item)
+{
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_playlist_delete_item(p_libvlc, item, &ex);
+        if( libvlc_exception_raised(&ex) )
+        {
+            libvlc_exception_clear(&ex);
+            return E_FAIL;
+        }
+        return NOERROR;
+    }
+    return hr;
+};
+
+/*******************************************************************************/
+
+VLCVideo::~VLCVideo()
+{
+    if( _p_typeinfo )
+        _p_typeinfo->Release();
+};
+
+HRESULT VLCVideo::loadTypeInfo(void)
+{
+    HRESULT hr = NOERROR;
+    if( NULL == _p_typeinfo )
+    {
+        ITypeLib *p_typelib;
+
+        hr = _p_instance->getTypeLib(LOCALE_USER_DEFAULT, &p_typelib);
+        if( SUCCEEDED(hr) )
+        {
+            hr = p_typelib->GetTypeInfoOfGuid(IID_IVLCVideo, &_p_typeinfo);
+            if( FAILED(hr) )
+            {
+                _p_typeinfo = NULL;
+            }
+            p_typelib->Release();
+        }
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCVideo::GetTypeInfoCount(UINT* pctInfo)
+{
+    if( NULL == pctInfo )
+        return E_INVALIDARG;
+
+    if( SUCCEEDED(loadTypeInfo()) )
+        *pctInfo = 1;
+    else
+        *pctInfo = 0;
+
+    return NOERROR;
+};
+
+STDMETHODIMP VLCVideo::GetTypeInfo(UINT iTInfo, LCID lcid, LPTYPEINFO* ppTInfo)
+{
+    if( NULL == ppTInfo )
+        return E_INVALIDARG;
+
+    if( SUCCEEDED(loadTypeInfo()) )
+    {
+        _p_typeinfo->AddRef();
+        *ppTInfo = _p_typeinfo;
+        return NOERROR;
+    }
+    *ppTInfo = NULL;
+    return E_NOTIMPL;
+};
+
+STDMETHODIMP VLCVideo::GetIDsOfNames(REFIID riid, LPOLESTR* rgszNames, 
+        UINT cNames, LCID lcid, DISPID* rgDispID)
+{
+    if( SUCCEEDED(loadTypeInfo()) )
+    {
+        return DispGetIDsOfNames(_p_typeinfo, rgszNames, cNames, rgDispID);
+    }
+    return E_NOTIMPL;
+};
+
+STDMETHODIMP VLCVideo::Invoke(DISPID dispIdMember, REFIID riid,
+        LCID lcid, WORD wFlags, DISPPARAMS* pDispParams,
+        VARIANT* pVarResult, EXCEPINFO* pExcepInfo, UINT* puArgErr)
+{
+    if( SUCCEEDED(loadTypeInfo()) )
+    {
+        return DispInvoke(this, _p_typeinfo, dispIdMember, wFlags, pDispParams,
+                pVarResult, pExcepInfo, puArgErr);
+    }
+    return E_NOTIMPL;
+};
+
+STDMETHODIMP VLCVideo::get_fullscreen(VARIANT_BOOL* fullscreen)
+{
+    if( NULL == fullscreen )
+        return E_POINTER;
+
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_libvlc, &ex);
+        if( ! libvlc_exception_raised(&ex) )
+        {
+            *fullscreen = libvlc_get_fullscreen(p_input, &ex) ? VARIANT_TRUE : VARIANT_FALSE;
+            libvlc_input_free(p_input);
+            if( ! libvlc_exception_raised(&ex) )
+            {
+                return NOERROR;
+            }
+        }
+        libvlc_exception_clear(&ex);
+        return E_FAIL;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCVideo::put_fullscreen(VARIANT_BOOL fullscreen)
+{
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_libvlc, &ex);
+        if( ! libvlc_exception_raised(&ex) )
+        {
+            libvlc_set_fullscreen(p_input, VARIANT_FALSE != fullscreen, &ex);
+            libvlc_input_free(p_input);
+            if( ! libvlc_exception_raised(&ex) )
+            {
+                return NOERROR;
+            }
+        }
+        libvlc_exception_clear(&ex);
+        return E_FAIL;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCVideo::get_width(int* width)
+{
+    if( NULL == width )
+        return E_POINTER;
+
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_libvlc, &ex);
+        if( ! libvlc_exception_raised(&ex) )
+        {
+            *width = libvlc_video_get_width(p_input, &ex);
+            libvlc_input_free(p_input);
+            if( ! libvlc_exception_raised(&ex) )
+            {
+                return NOERROR;
+            }
+        }
+        libvlc_exception_clear(&ex);
+        return E_FAIL;
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCVideo::get_height(int* height)
+{
+    if( NULL == height )
+        return E_POINTER;
+
+    libvlc_instance_t* p_libvlc;
+    HRESULT hr = _p_instance->getVLC(&p_libvlc);
+    if( SUCCEEDED(hr) )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_libvlc, &ex);
+        if( ! libvlc_exception_raised(&ex) )
+        {
+            *height = libvlc_video_get_height(p_input, &ex);
+            libvlc_input_free(p_input);
+            if( ! libvlc_exception_raised(&ex) )
+            {
+                return NOERROR;
+            }
+        }
+        libvlc_exception_clear(&ex);
+        return E_FAIL;
+    }
+    return hr;
+};
+
+/*******************************************************************************/
+
+VLCControl2::VLCControl2(VLCPlugin *p_instance) :
+    _p_instance(p_instance),
+    _p_typeinfo(NULL),
+    _p_vlcaudio(NULL),
+    _p_vlcinput(NULL),
+    _p_vlcplaylist(NULL),
+    _p_vlcvideo(NULL)
+{
+    _p_vlcaudio     = new VLCAudio(p_instance);
+    _p_vlcinput     = new VLCInput(p_instance);
+    _p_vlcplaylist  = new VLCPlaylist(p_instance);
+    _p_vlcvideo     = new VLCVideo(p_instance);
+};
+
+VLCControl2::~VLCControl2()
+{
+    delete _p_vlcvideo;
+    delete _p_vlcplaylist;
+    delete _p_vlcinput;
+    delete _p_vlcaudio;
+    if( _p_typeinfo )
+        _p_typeinfo->Release();
+};
+
+HRESULT VLCControl2::loadTypeInfo(void)
+{
+    HRESULT hr = NOERROR;
+    if( NULL == _p_typeinfo )
+    {
+        ITypeLib *p_typelib;
+
+        hr = _p_instance->getTypeLib(LOCALE_USER_DEFAULT, &p_typelib);
+        if( SUCCEEDED(hr) )
+        {
+            hr = p_typelib->GetTypeInfoOfGuid(IID_IVLCControl2, &_p_typeinfo);
+            if( FAILED(hr) )
+            {
+                _p_typeinfo = NULL;
+            }
+            p_typelib->Release();
+        }
+    }
+    return hr;
+};
+
+STDMETHODIMP VLCControl2::GetTypeInfoCount(UINT* pctInfo)
+{
+    if( NULL == pctInfo )
+        return E_INVALIDARG;
+
+    if( SUCCEEDED(loadTypeInfo()) )
+        *pctInfo = 1;
+    else
+        *pctInfo = 0;
+
+    return NOERROR;
+};
+
+STDMETHODIMP VLCControl2::GetTypeInfo(UINT iTInfo, LCID lcid, LPTYPEINFO* ppTInfo)
+{
+    if( NULL == ppTInfo )
+        return E_INVALIDARG;
+
+    if( SUCCEEDED(loadTypeInfo()) )
+    {
+        _p_typeinfo->AddRef();
+        *ppTInfo = _p_typeinfo;
+        return NOERROR;
+    }
+    *ppTInfo = NULL;
+    return E_NOTIMPL;
+};
+
+STDMETHODIMP VLCControl2::GetIDsOfNames(REFIID riid, LPOLESTR* rgszNames, 
+        UINT cNames, LCID lcid, DISPID* rgDispID)
+{
+    if( SUCCEEDED(loadTypeInfo()) )
+    {
+        return DispGetIDsOfNames(_p_typeinfo, rgszNames, cNames, rgDispID);
+    }
+    return E_NOTIMPL;
+};
+
+STDMETHODIMP VLCControl2::Invoke(DISPID dispIdMember, REFIID riid,
+        LCID lcid, WORD wFlags, DISPPARAMS* pDispParams,
+        VARIANT* pVarResult, EXCEPINFO* pExcepInfo, UINT* puArgErr)
+{
+    if( SUCCEEDED(loadTypeInfo()) )
+    {
+        return DispInvoke(this, _p_typeinfo, dispIdMember, wFlags, pDispParams,
+                pVarResult, pExcepInfo, puArgErr);
+    }
+    return E_NOTIMPL;
+};
+
+STDMETHODIMP VLCControl2::get_AutoLoop(VARIANT_BOOL *autoloop)
+{
+    if( NULL == autoloop )
+        return E_POINTER;
+
+    *autoloop = _p_instance->getAutoLoop() ? VARIANT_TRUE: VARIANT_FALSE;
+    return S_OK;
+};
+
+STDMETHODIMP VLCControl2::put_AutoLoop(VARIANT_BOOL autoloop)
+{
+    _p_instance->setAutoLoop((VARIANT_FALSE != autoloop) ? TRUE: FALSE);
+    return S_OK;
+};
+
+STDMETHODIMP VLCControl2::get_AutoPlay(VARIANT_BOOL *autoplay)
+{
+    if( NULL == autoplay )
+        return E_POINTER;
+
+    *autoplay = _p_instance->getAutoPlay() ? VARIANT_TRUE: VARIANT_FALSE;
+    return S_OK;
+};
+
+STDMETHODIMP VLCControl2::put_AutoPlay(VARIANT_BOOL autoplay)
+{
+    _p_instance->setAutoPlay((VARIANT_FALSE != autoplay) ? TRUE: FALSE);
+    return S_OK;
+};
+
+STDMETHODIMP VLCControl2::get_BaseURL(BSTR *url)
+{
+    if( NULL == url )
+        return E_POINTER;
+
+    *url = SysAllocStringLen(_p_instance->getBaseURL(),
+                SysStringLen(_p_instance->getBaseURL()));
+    return NOERROR;
+};
+
+STDMETHODIMP VLCControl2::put_BaseURL(BSTR mrl)
+{
+    _p_instance->setBaseURL(mrl);
+
+    return S_OK;
+};
+
+STDMETHODIMP VLCControl2::get_MRL(BSTR *mrl)
+{
+    if( NULL == mrl )
+        return E_POINTER;
+
+    *mrl = SysAllocStringLen(_p_instance->getMRL(),
+                SysStringLen(_p_instance->getMRL()));
+    return NOERROR;
+};
+
+STDMETHODIMP VLCControl2::put_MRL(BSTR mrl)
+{
+    _p_instance->setMRL(mrl);
+
+    return S_OK;
+};
+
+STDMETHODIMP VLCControl2::get_StartTime(int *seconds)
+{
+    if( NULL == seconds )
+        return E_POINTER;
+
+    *seconds = _p_instance->getStartTime();
+
+    return S_OK;
+};
+     
+STDMETHODIMP VLCControl2::put_StartTime(int seconds)
+{
+    _p_instance->setStartTime(seconds);
+
+    return NOERROR;
+};
+        
+STDMETHODIMP VLCControl2::get_VersionInfo(BSTR *version)
+{
+    if( NULL == version )
+        return E_POINTER;
+
+    const char *versionStr = VLC_Version();
+    if( NULL != versionStr )
+    {
+        *version = BSTRFromCStr(_p_instance->getCodePage(), versionStr);
+        
+        return NULL == *version ? E_OUTOFMEMORY : NOERROR;
+    }
+    *version = NULL;
+    return E_FAIL;
+};
+ 
+STDMETHODIMP VLCControl2::get_Visible(VARIANT_BOOL *isVisible)
+{
+    if( NULL == isVisible )
+        return E_POINTER;
+
+    *isVisible = _p_instance->getVisible() ? VARIANT_TRUE : VARIANT_FALSE;
+
+    return NOERROR;
+};
+        
+STDMETHODIMP VLCControl2::put_Visible(VARIANT_BOOL isVisible)
+{
+    _p_instance->setVisible(isVisible != VARIANT_FALSE);
+
+    return NOERROR;
+};
+
+STDMETHODIMP VLCControl2::get_Volume(int *volume)
+{
+    if( NULL == volume )
+        return E_POINTER;
+
+    *volume  = _p_instance->getVolume();
+    return NOERROR;
+};
+        
+STDMETHODIMP VLCControl2::put_Volume(int volume)
+{
+    _p_instance->setVolume(volume);
+    return NOERROR;
+};
+
+STDMETHODIMP VLCControl2::get_audio(IVLCAudio** obj)
+{
+    if( NULL == obj )
+        return E_POINTER;
+
+    *obj = _p_vlcaudio;
+    if( NULL != _p_vlcaudio )
+    {
+        _p_vlcaudio->AddRef();
+        return NOERROR;
+    }
+    return E_OUTOFMEMORY;
+};
+
+STDMETHODIMP VLCControl2::get_input(IVLCInput** obj)
+{
+    if( NULL == obj )
+        return E_POINTER;
+
+    *obj = _p_vlcinput;
+    if( NULL != _p_vlcinput )
+    {
+        _p_vlcinput->AddRef();
+        return NOERROR;
+    }
+    return E_OUTOFMEMORY;
+};
+
+STDMETHODIMP VLCControl2::get_playlist(IVLCPlaylist** obj)
+{
+    if( NULL == obj )
+        return E_POINTER;
+
+    *obj = _p_vlcplaylist;
+    if( NULL != _p_vlcplaylist )
+    {
+        _p_vlcplaylist->AddRef();
+        return NOERROR;
+    }
+    return E_OUTOFMEMORY;
+};
+
+STDMETHODIMP VLCControl2::get_video(IVLCVideo** obj)
+{
+    if( NULL == obj )
+        return E_POINTER;
+
+    *obj = _p_vlcvideo;
+    if( NULL != _p_vlcvideo )
+    {
+        _p_vlcvideo->AddRef();
+        return NOERROR;
+    }
+    return E_OUTOFMEMORY;
+};
+
diff -uNr vlc-0.8.6-svn20060918.debian/activex/vlccontrol2.h vlc-0.8.6-svn20061008.debian/activex/vlccontrol2.h
--- vlc-0.8.6-svn20060918.debian/activex/vlccontrol2.h	1969-12-31 19:00:00.000000000 -0500
+++ vlc-0.8.6-svn20061008.debian/activex/vlccontrol2.h	2006-10-04 09:47:07.000000000 -0400
@@ -0,0 +1,304 @@
+/*****************************************************************************
+ * vlccontrol.h: ActiveX control for VLC
+ *****************************************************************************
+ * Copyright (C) 2006 the VideoLAN team
+ *
+ * Authors: Damien Fouilleul <Damien.Fouilleul@laposte.net>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
+ *****************************************************************************/
+
+#ifndef _VLCCONTROL2_H_
+#define _VLCCONTROL2_H_
+
+#include "axvlc_idl.h"
+
+class VLCAudio : public IVLCAudio
+{
+public:
+    VLCAudio(VLCPlugin *p_instance) :
+        _p_instance(p_instance), _p_typeinfo(NULL) {};
+    virtual ~VLCAudio();
+
+    // IUnknown methods
+    STDMETHODIMP QueryInterface(REFIID riid, void **ppv)
+    {
+        if( NULL == ppv )
+          return E_POINTER;
+        if( (IID_IUnknown == riid)
+         || (IID_IDispatch == riid)
+         || (IID_IVLCAudio == riid) )
+        {
+            AddRef();
+            *ppv = reinterpret_cast<LPVOID>(this);
+            return NOERROR;
+        }
+        // behaves as a standalone object
+        return E_NOINTERFACE;
+    };
+
+    STDMETHODIMP_(ULONG) AddRef(void) { return _p_instance->pUnkOuter->AddRef(); };
+    STDMETHODIMP_(ULONG) Release(void) { return _p_instance->pUnkOuter->Release(); };
+
+    // IDispatch methods
+    STDMETHODIMP GetTypeInfoCount(UINT*);
+    STDMETHODIMP GetTypeInfo(UINT, LCID, LPTYPEINFO*);
+    STDMETHODIMP GetIDsOfNames(REFIID,LPOLESTR*,UINT,LCID,DISPID*);
+    STDMETHODIMP Invoke(DISPID,REFIID,LCID,WORD,DISPPARAMS*,VARIANT*,EXCEPINFO*,UINT*);
+
+    // IVLCAudio methods
+    STDMETHODIMP get_mute(VARIANT_BOOL*);
+    STDMETHODIMP put_mute(VARIANT_BOOL);
+    STDMETHODIMP get_volume(int*);
+    STDMETHODIMP put_volume(int);
+    STDMETHODIMP toggleMute();
+ 
+protected:
+    HRESULT loadTypeInfo();
+
+private:
+    VLCPlugin*      _p_instance;
+    ITypeInfo*      _p_typeinfo;
+
+};
+ 
+class VLCInput : public IVLCInput
+{
+public:
+
+    VLCInput(VLCPlugin *p_instance) :
+        _p_instance(p_instance), _p_typeinfo(NULL) {};
+    virtual ~VLCInput();
+
+    // IUnknown methods
+    STDMETHODIMP QueryInterface(REFIID riid, void **ppv)
+    {
+        if( NULL == ppv )
+          return E_POINTER;
+        if( (IID_IUnknown == riid)
+         || (IID_IDispatch == riid)
+         || (IID_IVLCInput == riid) )
+        {
+            AddRef();
+            *ppv = reinterpret_cast<LPVOID>(this);
+            return NOERROR;
+        }
+        // behaves as a standalone object
+        return E_NOINTERFACE;
+    };
+
+    STDMETHODIMP_(ULONG) AddRef(void) { return _p_instance->pUnkOuter->AddRef(); };
+    STDMETHODIMP_(ULONG) Release(void) { return _p_instance->pUnkOuter->Release(); };
+
+    // IDispatch methods
+    STDMETHODIMP GetTypeInfoCount(UINT*);
+    STDMETHODIMP GetTypeInfo(UINT, LCID, LPTYPEINFO*);
+    STDMETHODIMP GetIDsOfNames(REFIID,LPOLESTR*,UINT,LCID,DISPID*);
+    STDMETHODIMP Invoke(DISPID,REFIID,LCID,WORD,DISPPARAMS*,VARIANT*,EXCEPINFO*,UINT*);
+
+    // IVLCInput methods
+    STDMETHODIMP get_length(double*);
+    STDMETHODIMP get_position(float*);
+    STDMETHODIMP put_position(float);
+    STDMETHODIMP get_time(double*);
+    STDMETHODIMP put_time(double);
+    STDMETHODIMP get_state(int*);
+    STDMETHODIMP get_rate(float*);
+    STDMETHODIMP put_rate(float);
+    STDMETHODIMP get_fps(float*);
+    STDMETHODIMP get_hasVout(VARIANT_BOOL*);
+    
+protected:
+    HRESULT loadTypeInfo();
+
+private:
+    VLCPlugin*      _p_instance;
+    ITypeInfo*      _p_typeinfo;
+
+};
+ 
+class VLCPlaylist : public IVLCPlaylist
+{
+public:
+    VLCPlaylist(VLCPlugin *p_instance) :
+        _p_instance(p_instance), _p_typeinfo(NULL) {};
+    virtual ~VLCPlaylist();
+
+    // IUnknown methods
+    STDMETHODIMP QueryInterface(REFIID riid, void **ppv)
+    {
+        if( NULL == ppv )
+          return E_POINTER;
+        if( (IID_IUnknown == riid)
+         || (IID_IDispatch == riid)
+         || (IID_IVLCPlaylist == riid) )
+        {
+            AddRef();
+            *ppv = reinterpret_cast<LPVOID>(this);
+            return NOERROR;
+        }
+        // behaves as a standalone object
+        return E_NOINTERFACE;
+    };
+
+    STDMETHODIMP_(ULONG) AddRef(void) { return _p_instance->pUnkOuter->AddRef(); };
+    STDMETHODIMP_(ULONG) Release(void) { return _p_instance->pUnkOuter->Release(); };
+
+    // IDispatch methods
+    STDMETHODIMP GetTypeInfoCount(UINT*);
+    STDMETHODIMP GetTypeInfo(UINT, LCID, LPTYPEINFO*);
+    STDMETHODIMP GetIDsOfNames(REFIID,LPOLESTR*,UINT,LCID,DISPID*);
+    STDMETHODIMP Invoke(DISPID,REFIID,LCID,WORD,DISPPARAMS*,VARIANT*,EXCEPINFO*,UINT*);
+
+    // IVLCPlaylist methods
+    STDMETHODIMP get_itemCount(int*);
+    STDMETHODIMP get_isPlaying(VARIANT_BOOL*);
+    STDMETHODIMP add(BSTR, VARIANT, VARIANT, int*);
+    STDMETHODIMP play();
+    STDMETHODIMP playItem(int);
+    STDMETHODIMP togglePause();
+    STDMETHODIMP stop();
+    STDMETHODIMP next();
+    STDMETHODIMP prev();
+    STDMETHODIMP clear();
+    STDMETHODIMP removeItem(int);
+ 
+protected:
+    HRESULT loadTypeInfo();
+
+private:
+    VLCPlugin*  _p_instance;
+    ITypeInfo*  _p_typeinfo;
+
+};
+ 
+class VLCVideo : public IVLCVideo
+{
+public:
+    VLCVideo(VLCPlugin *p_instance) :
+        _p_instance(p_instance), _p_typeinfo(NULL) {};
+    virtual ~VLCVideo();
+
+    // IUnknown methods
+    STDMETHODIMP QueryInterface(REFIID riid, void **ppv)
+    {
+        if( NULL == ppv )
+          return E_POINTER;
+        if( (IID_IUnknown == riid)
+         || (IID_IDispatch == riid)
+         || (IID_IVLCVideo == riid) )
+        {
+            AddRef();
+            *ppv = reinterpret_cast<LPVOID>(this);
+            return NOERROR;
+        }
+        // behaves as a standalone object
+        return E_NOINTERFACE;
+    };
+
+    STDMETHODIMP_(ULONG) AddRef(void) { return _p_instance->pUnkOuter->AddRef(); };
+    STDMETHODIMP_(ULONG) Release(void) { return _p_instance->pUnkOuter->Release(); };
+
+    // IDispatch methods
+    STDMETHODIMP GetTypeInfoCount(UINT*);
+    STDMETHODIMP GetTypeInfo(UINT, LCID, LPTYPEINFO*);
+    STDMETHODIMP GetIDsOfNames(REFIID,LPOLESTR*,UINT,LCID,DISPID*);
+    STDMETHODIMP Invoke(DISPID,REFIID,LCID,WORD,DISPPARAMS*,VARIANT*,EXCEPINFO*,UINT*);
+
+    // IVLCVideo methods
+    STDMETHODIMP get_fullscreen(VARIANT_BOOL*);
+    STDMETHODIMP put_fullscreen(VARIANT_BOOL);
+    STDMETHODIMP get_width(int*);
+    STDMETHODIMP get_height(int*);
+ 
+protected:
+    HRESULT loadTypeInfo();
+
+private:
+    VLCPlugin*      _p_instance;
+    ITypeInfo*      _p_typeinfo;
+
+};
+ 
+class VLCControl2 : public IVLCControl2
+{
+    
+public:
+
+    VLCControl2(VLCPlugin *p_instance);
+    virtual ~VLCControl2();
+
+    // IUnknown methods
+    STDMETHODIMP QueryInterface(REFIID riid, void **ppv)
+    {
+        if( NULL == ppv )
+          return E_POINTER;
+        if( (IID_IUnknown == riid)
+         || (IID_IDispatch == riid)
+         || (IID_IVLCControl2 == riid) )
+        {
+            AddRef();
+            *ppv = reinterpret_cast<LPVOID>(this);
+            return NOERROR;
+        }
+        return _p_instance->pUnkOuter->QueryInterface(riid, ppv);
+    };
+
+    STDMETHODIMP_(ULONG) AddRef(void) { return _p_instance->pUnkOuter->AddRef(); };
+    STDMETHODIMP_(ULONG) Release(void) { return _p_instance->pUnkOuter->Release(); };
+
+    // IDispatch methods
+    STDMETHODIMP GetTypeInfoCount(UINT*);
+    STDMETHODIMP GetTypeInfo(UINT, LCID, LPTYPEINFO*);
+    STDMETHODIMP GetIDsOfNames(REFIID,LPOLESTR*,UINT,LCID,DISPID*);
+    STDMETHODIMP Invoke(DISPID,REFIID,LCID,WORD,DISPPARAMS*,VARIANT*,EXCEPINFO*,UINT*);
+
+    // IVLCControl2 methods
+    STDMETHODIMP get_AutoLoop(VARIANT_BOOL *autoloop);
+    STDMETHODIMP put_AutoLoop(VARIANT_BOOL autoloop);
+    STDMETHODIMP get_AutoPlay(VARIANT_BOOL *autoplay);
+    STDMETHODIMP put_AutoPlay(VARIANT_BOOL autoplay);
+    STDMETHODIMP get_BaseURL(BSTR *url);
+    STDMETHODIMP put_BaseURL(BSTR url);
+    STDMETHODIMP get_MRL(BSTR *mrl);
+    STDMETHODIMP put_MRL(BSTR mrl);
+    STDMETHODIMP get_StartTime(int *seconds);
+    STDMETHODIMP put_StartTime(int seconds);
+    STDMETHODIMP get_VersionInfo(BSTR *version);
+    STDMETHODIMP get_Visible(VARIANT_BOOL *visible);
+    STDMETHODIMP put_Visible(VARIANT_BOOL visible);
+    STDMETHODIMP get_Volume(int *volume);
+    STDMETHODIMP put_Volume(int volume);
+
+    STDMETHODIMP get_audio(IVLCAudio**);
+    STDMETHODIMP get_input(IVLCInput**);
+    STDMETHODIMP get_playlist(IVLCPlaylist**);
+    STDMETHODIMP get_video(IVLCVideo**);
+
+protected:
+    HRESULT loadTypeInfo();
+
+private:
+    VLCPlugin*      _p_instance;
+    ITypeInfo*      _p_typeinfo;
+
+    VLCAudio*       _p_vlcaudio;
+    VLCInput*       _p_vlcinput;
+    VLCPlaylist*    _p_vlcplaylist;
+    VLCVideo*       _p_vlcvideo;
+};
+ 
+#endif
+
diff -uNr vlc-0.8.6-svn20060918.debian/activex/vlccontrol.cpp vlc-0.8.6-svn20061008.debian/activex/vlccontrol.cpp
--- vlc-0.8.6-svn20060918.debian/activex/vlccontrol.cpp	2006-09-18 06:28:02.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/activex/vlccontrol.cpp	2006-10-04 09:47:07.000000000 -0400
@@ -113,7 +113,7 @@
 
     return NOERROR;
 };
-        
+
 STDMETHODIMP VLCControl::put_Visible(VARIANT_BOOL isVisible)
 {
     _p_instance->setVisible(isVisible != VARIANT_FALSE);
@@ -529,7 +529,7 @@
     return hr;
 };
 
-static void freeTargetOptions(char **cOptions, int cOptionCount)
+void VLCControl::FreeTargetOptions(char **cOptions, int cOptionCount)
 {
     // clean up 
     if( NULL != cOptions )
@@ -546,7 +546,7 @@
     }
 };
 
-static HRESULT createTargetOptions(int codePage, VARIANT *options, char ***cOptions, int *cOptionCount)
+HRESULT VLCControl::CreateTargetOptions(int codePage, VARIANT *options, char ***cOptions, int *cOptionCount)
 {
     HRESULT hr = E_INVALIDARG;
     if( VT_ERROR == V_VT(options) )
@@ -621,7 +621,7 @@
                     if( FAILED(hr) )
                     {
                         // free already processed elements
-                        freeTargetOptions(*cOptions, *cOptionCount);
+                        FreeTargetOptions(*cOptions, *cOptionCount);
                     }
                 }
                 else
@@ -715,7 +715,7 @@
             if( FAILED(hr) )
             {
                 // free already processed elements
-                freeTargetOptions(*cOptions, *cOptionCount);
+                FreeTargetOptions(*cOptions, *cOptionCount);
             }
         }
         else
@@ -750,7 +750,7 @@
         int cOptionsCount;
         char **cOptions;
 
-        if( FAILED(createTargetOptions(CP_UTF8, &options, &cOptions, &cOptionsCount)) )
+        if( FAILED(CreateTargetOptions(CP_UTF8, &options, &cOptions, &cOptionsCount)) )
             return E_INVALIDARG;
 
         if( VLC_SUCCESS <= VLC_AddTarget(i_vlc, cUri, (const char **)cOptions, cOptionsCount, mode, position) )
@@ -766,7 +766,7 @@
                 _p_instance->fireOnStopEvent();
         }
 
-        freeTargetOptions(cOptions, cOptionsCount);
+        FreeTargetOptions(cOptions, cOptionsCount);
         CoTaskMemFree(cUri);
     }
     return hr;
diff -uNr vlc-0.8.6-svn20060918.debian/activex/vlccontrol.h vlc-0.8.6-svn20061008.debian/activex/vlccontrol.h
--- vlc-0.8.6-svn20060918.debian/activex/vlccontrol.h	2006-09-18 06:28:02.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/activex/vlccontrol.h	2006-10-04 09:47:07.000000000 -0400
@@ -23,7 +23,6 @@
 #ifndef _VLCCONTROL_H_
 #define _VLCCONTROL_H_
 
-#include <oaidl.h>
 #include "axvlc_idl.h"
 
 class VLCControl : public IVLCControl
@@ -94,6 +93,9 @@
     STDMETHODIMP get_AutoPlay(VARIANT_BOOL *autoplay);
     STDMETHODIMP put_AutoPlay(VARIANT_BOOL autoplay);
  
+    static HRESULT CreateTargetOptions(int codePage, VARIANT *options, char ***cOptions, int *cOptionCount);
+    static void FreeTargetOptions(char **cOptions, int cOptionCount);
+
 private:
 
     HRESULT      getTypeInfo();
diff -uNr vlc-0.8.6-svn20060918.debian/bindings/java/Makefile.in vlc-0.8.6-svn20061008.debian/bindings/java/Makefile.in
--- vlc-0.8.6-svn20060918.debian/bindings/java/Makefile.in	2006-09-18 06:30:31.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/bindings/java/Makefile.in	2006-10-08 12:42:32.000000000 -0400
@@ -119,12 +119,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -132,6 +133,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -156,9 +159,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -235,7 +235,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -250,7 +252,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/bindings/Makefile.in vlc-0.8.6-svn20061008.debian/bindings/Makefile.in
--- vlc-0.8.6-svn20060918.debian/bindings/Makefile.in	2006-09-18 06:30:31.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/bindings/Makefile.in	2006-10-08 12:42:32.000000000 -0400
@@ -115,12 +115,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -128,6 +129,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -152,9 +155,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -231,7 +231,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -246,7 +248,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/bindings/mediacontrol-python/Makefile.in vlc-0.8.6-svn20061008.debian/bindings/mediacontrol-python/Makefile.in
--- vlc-0.8.6-svn20060918.debian/bindings/mediacontrol-python/Makefile.in	2006-09-18 06:30:31.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/bindings/mediacontrol-python/Makefile.in	2006-10-08 12:42:32.000000000 -0400
@@ -119,12 +119,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -132,6 +133,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -156,9 +159,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -235,7 +235,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -250,7 +252,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/configure vlc-0.8.6-svn20061008.debian/configure
--- vlc-0.8.6-svn20060918.debian/configure	2006-09-18 06:30:17.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/configure	2006-10-08 12:42:17.000000000 -0400
@@ -959,11 +959,16 @@
 CORBA_LIBS
 ENABLE_CORBA_TRUE
 ENABLE_CORBA_FALSE
+GNUTLS_CFLAGS
+GNUTLS_LIBS
 LOADER_TRUE
 LOADER_FALSE
 MIDL
+WIDL
 HAS_MIDL_COMPILER_TRUE
 HAS_MIDL_COMPILER_FALSE
+HAS_WIDL_COMPILER_TRUE
+HAS_WIDL_COMPILER_FALSE
 BUILD_ACTIVEX_TRUE
 BUILD_ACTIVEX_FALSE
 MOZILLA_CONFIG
@@ -975,11 +980,6 @@
 BUILD_MOZILLA_FALSE
 BUILD_PYTHON_TRUE
 BUILD_PYTHON_FALSE
-JAVA_CC
-JAVA_CC_FLAGS
-ac_ct_JAVA_CC
-GCJ_OPTS
-JAVA_CC_OPTS
 JAVAC
 JAVA
 uudecode
@@ -1003,6 +1003,7 @@
 ASM
 MOC
 MOZILLA_SDK_PATH
+WINE_SDK_PATH
 XPIDL_INCL
 LIBEXT
 AM_CPPFLAGS
@@ -1060,9 +1061,10 @@
 BONJOUR_LIBS
 CORBA_CFLAGS
 CORBA_LIBS
+GNUTLS_CFLAGS
+GNUTLS_LIBS
 MIDL
-JAVA_CC
-JAVA_CC_FLAGS'
+WIDL'
 
 
 # Initialize some variables set by options.
@@ -1797,7 +1799,7 @@
 
 Optimization options:
   --with-tuning=ARCH      enable special tuning for an architecture
-                          (default Pentium 2 on IA-32 and 750 on PPC)
+                          (default Pentium 2 on IA-32 and G4 on PPC)
 Input plugins:
     --with-live555-tree=PATH live.com tree for static linking
     --with-dv-raw1394=PATH   libraw1394 headers and libraries
@@ -1859,6 +1861,7 @@
     --with-goom-tree=PATH goom tree for static linking (required)
 Misc options:
     --with-words=endianness set endianness (big or little)
+    --with-wine-sdk-path=PATH path to wine sdk
     --with-mozilla-sdk-path=PATH path to mozilla sdk
 
 Some influential environment variables:
@@ -1927,10 +1930,11 @@
   CORBA_CFLAGS
               C compiler flags for CORBA, overriding pkg-config
   CORBA_LIBS  linker flags for CORBA, overriding pkg-config
+  GNUTLS_CFLAGS
+              C compiler flags for GNUTLS, overriding pkg-config
+  GNUTLS_LIBS linker flags for GNUTLS, overriding pkg-config
   MIDL        Microsoft IDL compiler (Win32 platform only)
-  JAVA_CC     java compiler command
-  JAVA_CC_FLAGS
-              java compiler flags
+  WIDL        Wine IDL compiler (requires Wine SDK)
 
 Use these variables to override the choices made by `configure' or to help
 it to find libraries and programs with nonstandard names/locations.
@@ -6660,7 +6664,7 @@
   ;;
 *-*-irix6*)
   # Find out which ABI we are using.
-  echo '#line 6663 "configure"' > conftest.$ac_ext
+  echo '#line 6667 "configure"' > conftest.$ac_ext
   if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
@@ -9109,11 +9113,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:9112: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:9116: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:9116: \$? = $ac_status" >&5
+   echo "$as_me:9120: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -9377,11 +9381,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:9380: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:9384: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:9384: \$? = $ac_status" >&5
+   echo "$as_me:9388: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -9481,11 +9485,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:9484: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:9488: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:9488: \$? = $ac_status" >&5
+   echo "$as_me:9492: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -11922,7 +11926,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<EOF
-#line 11925 "configure"
+#line 11929 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -12022,7 +12026,7 @@
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<EOF
-#line 12025 "configure"
+#line 12029 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -14390,11 +14394,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:14393: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:14397: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:14397: \$? = $ac_status" >&5
+   echo "$as_me:14401: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -14494,11 +14498,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:14497: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:14501: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:14501: \$? = $ac_status" >&5
+   echo "$as_me:14505: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -16055,11 +16059,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:16058: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:16062: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:16062: \$? = $ac_status" >&5
+   echo "$as_me:16066: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -16159,11 +16163,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:16162: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:16166: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:16166: \$? = $ac_status" >&5
+   echo "$as_me:16170: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -18378,11 +18382,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:18381: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:18385: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:18385: \$? = $ac_status" >&5
+   echo "$as_me:18389: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -18646,11 +18650,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:18649: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:18653: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:18653: \$? = $ac_status" >&5
+   echo "$as_me:18657: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -18750,11 +18754,11 @@
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:18753: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:18757: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:18757: \$? = $ac_status" >&5
+   echo "$as_me:18761: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -21669,13 +21673,29 @@
 fi
 
   if test "${with_contrib}" != "no"; then
-
+    { echo "$as_me:$LINENO: checking for libs in extras/contrib" >&5
+echo $ECHO_N "checking for libs in extras/contrib... $ECHO_C" >&6; }
     topdir="`dirname $0`"
     if test "`echo \"$topdir\" | cut -c 1`" != "/"; then
        topdir="`pwd`/$topdir"
     fi
-
+   if test "`grep HOST ${topdir}/extras/contrib/config.mak 2>/dev/null|awk '{print $3}'`" != "`$CC -dumpmachine`"; then
+      if test "${with_contrib}" = "yes"; then
+        { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
+	{ { echo "$as_me:$LINENO: error:  not using the libs in extras/contrib as it is not the same host" >&5
+echo "$as_me: error:  not using the libs in extras/contrib as it is not the same host" >&2;}
+   { (exit 1); exit 1; }; }
+      else
+        { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
+	{ echo "$as_me:$LINENO: WARNING:  not using the libs in extras/contrib as it is not the same host" >&5
+echo "$as_me: WARNING:  not using the libs in extras/contrib as it is not the same host" >&2;}
+      fi
+     else
   if test -d ${topdir}/extras/contrib/lib; then
+    { echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6; }
     export PATH=${topdir}/extras/contrib/bin:$PATH
     CPPFLAGS="${CPPFLAGS} -I${topdir}/extras/contrib/include"
     CPPFLAGS_save="${CPPFLAGS_save} -I${topdir}/extras/contrib/include"
@@ -21708,6 +21728,9 @@
     if test -z $with_cyberlink_tree; then
        with_cyberlink_tree=${topdir}/extras/contrib/src/clinkcc
     fi
+    if test -z $with_libmpeg2_tree; then
+        with_libmpeg2_tree=${topdir}/extras/contrib/src/mpeg2dec
+    fi
 
     if test ".`uname -s`" = ".Darwin"; then
       export LD_LIBRARY_PATH=${topdir}/extras/contrib/lib:$LD_LIBRARY_PATH
@@ -21716,6 +21739,10 @@
       export LIBRARY_PATH=${topdir}/extras/contrib/lib:$LIBRARY_PATH
       export BELIBRARIES=${topdir}/extras/contrib/lib:$BELIBRARIES
     fi
+  else
+    { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
+  fi
   fi
 fi
 LDFLAGS_vlc="${LDFLAGS}"
@@ -22109,7 +22136,7 @@
   MACOSX_DEPLOYMENT_TARGET="10.3"
 fi
 
-ALL_LINGUAS="ca cs da de en_GB es fr gl he hi hu it ja ka ko nl oc pt_BR ro ru sv tr zh_CN zh_TW"
+ALL_LINGUAS="ca cs da de en_GB es fr gl he hi hu it ja ka ko nl oc pt_BR ro ru sk sv tr zh_CN zh_TW"
 
 
         MKINSTALLDIRS=
@@ -39501,7 +39528,7 @@
     elif test "${target_cpu}" = "x86_64"; then
         CFLAGS_TUNING="-mtune=athlon64"
     elif test "${target_cpu}" = "powerpc"; then
-        CFLAGS_TUNING="-mtune=750";
+        CFLAGS_TUNING="-mtune=G4";
     fi
 fi
 
@@ -39768,13 +39795,13 @@
   PLUGINS="${PLUGINS} access_output_shout"
 
 
-  for element in vlc access_output_shout; do
+  for element in access_output_shout; do
     eval "LDFLAGS_${element}="'"'"$SHOUT_LIBS "'$'"{LDFLAGS_${element}} "'"'
     am_modules_with_ldflags="${am_modules_with_ldflags} ${element}"
   done
 
 
-  for element in vlc access_output_shout; do
+  for element in access_output_shout; do
     eval "CFLAGS_${element}="'"$'"{CFLAGS_${element}} $SHOUT_CFLAGS"'"'
     am_modules_with_cflags="${am_modules_with_cflags} ${element}"
   done
@@ -64311,6 +64338,12 @@
     am_modules_with_ldflags="${am_modules_with_ldflags} ${element}"
   done
 
+
+  for element in macosx; do
+    eval "OBJCFLAGS_${element}="'"$'"{OBJCFLAGS_${element}} -fobjc-exceptions "'"'
+    am_modules_with_objcflags="${am_modules_with_objcflags} ${element}"
+  done
+
    fi
 else
 
@@ -64482,6 +64515,12 @@
   done
 
 
+  for element in macosx; do
+    eval "OBJCFLAGS_${element}="'"$'"{OBJCFLAGS_${element}} -fobjc-exceptions "'"'
+    am_modules_with_objcflags="${am_modules_with_objcflags} ${element}"
+  done
+
+
 fi
 
 done
@@ -66369,510 +66408,78 @@
 
 if test "${enable_gnutls}" != "no"; then
 
-  gcrypt_LIBS="-lgpg-error"
-  if test "${SYS}" = "mingw32"; then
-
-    gcrypt_LIBS="${gcrypt_LIBS} -lws2_32"
-
-  for element in gnutls; do
-    eval "LDFLAGS_${element}="'"'"-lws2_32 "'$'"{LDFLAGS_${element}} "'"'
-    am_modules_with_ldflags="${am_modules_with_ldflags} ${element}"
-  done
-
-
-fi
-
-
-  gnutls_LIBS="-lgcrypt -lz ${gcrypt_LIBS}"
-  if test "${SYS}" = "darwin"; then
-
-    gnutls_LIBS="-lintl ${gnutls_LIBS}"
-
-  for element in gnutls; do
-    eval "LDFLAGS_${element}="'"'"-lintl "'$'"{LDFLAGS_${element}} "'"'
-    am_modules_with_ldflags="${am_modules_with_ldflags} ${element}"
-  done
-
-
-fi
-
-
-  if test "${ac_cv_header_gcrypt_h+set}" = set; then
-  { echo "$as_me:$LINENO: checking for gcrypt.h" >&5
-echo $ECHO_N "checking for gcrypt.h... $ECHO_C" >&6; }
-if test "${ac_cv_header_gcrypt_h+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_header_gcrypt_h" >&5
-echo "${ECHO_T}$ac_cv_header_gcrypt_h" >&6; }
-else
-  # Is the header compilable?
-{ echo "$as_me:$LINENO: checking gcrypt.h usability" >&5
-echo $ECHO_N "checking gcrypt.h usability... $ECHO_C" >&6; }
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
-#include <gcrypt.h>
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag" || test ! -s conftest.err'
-  { (case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_try") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_try") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_header_compiler=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_header_compiler=no
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6; }
-
-# Is the header present?
-{ echo "$as_me:$LINENO: checking gcrypt.h presence" >&5
-echo $ECHO_N "checking gcrypt.h presence... $ECHO_C" >&6; }
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <gcrypt.h>
-_ACEOF
-if { (ac_try="$ac_cpp conftest.$ac_ext"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
-else
-  ac_cpp_err=yes
-fi
-if test -z "$ac_cpp_err"; then
-  ac_header_preproc=yes
-else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  ac_header_preproc=no
-fi
-
-rm -f conftest.err conftest.$ac_ext
-{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6; }
-
-# So?  What about this header?
-case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
-  yes:no: )
-    { echo "$as_me:$LINENO: WARNING: gcrypt.h: accepted by the compiler, rejected by the preprocessor!" >&5
-echo "$as_me: WARNING: gcrypt.h: accepted by the compiler, rejected by the preprocessor!" >&2;}
-    { echo "$as_me:$LINENO: WARNING: gcrypt.h: proceeding with the compiler's result" >&5
-echo "$as_me: WARNING: gcrypt.h: proceeding with the compiler's result" >&2;}
-    ac_header_preproc=yes
-    ;;
-  no:yes:* )
-    { echo "$as_me:$LINENO: WARNING: gcrypt.h: present but cannot be compiled" >&5
-echo "$as_me: WARNING: gcrypt.h: present but cannot be compiled" >&2;}
-    { echo "$as_me:$LINENO: WARNING: gcrypt.h:     check for missing prerequisite headers?" >&5
-echo "$as_me: WARNING: gcrypt.h:     check for missing prerequisite headers?" >&2;}
-    { echo "$as_me:$LINENO: WARNING: gcrypt.h: see the Autoconf documentation" >&5
-echo "$as_me: WARNING: gcrypt.h: see the Autoconf documentation" >&2;}
-    { echo "$as_me:$LINENO: WARNING: gcrypt.h:     section \"Present But Cannot Be Compiled\"" >&5
-echo "$as_me: WARNING: gcrypt.h:     section \"Present But Cannot Be Compiled\"" >&2;}
-    { echo "$as_me:$LINENO: WARNING: gcrypt.h: proceeding with the preprocessor's result" >&5
-echo "$as_me: WARNING: gcrypt.h: proceeding with the preprocessor's result" >&2;}
-    { echo "$as_me:$LINENO: WARNING: gcrypt.h: in the future, the compiler will take precedence" >&5
-echo "$as_me: WARNING: gcrypt.h: in the future, the compiler will take precedence" >&2;}
-
-    ;;
-esac
-{ echo "$as_me:$LINENO: checking for gcrypt.h" >&5
-echo $ECHO_N "checking for gcrypt.h... $ECHO_C" >&6; }
-if test "${ac_cv_header_gcrypt_h+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_cv_header_gcrypt_h=$ac_header_preproc
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_header_gcrypt_h" >&5
-echo "${ECHO_T}$ac_cv_header_gcrypt_h" >&6; }
-
-fi
-if test $ac_cv_header_gcrypt_h = yes; then
 
-    { echo "$as_me:$LINENO: checking for gcry_control in -lgcrypt" >&5
-echo $ECHO_N "checking for gcry_control in -lgcrypt... $ECHO_C" >&6; }
-if test "${ac_cv_lib_gcrypt_gcry_control+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lgcrypt ${gcrypt_LIBS} $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+pkg_failed=no
+{ echo "$as_me:$LINENO: checking for GNUTLS" >&5
+echo $ECHO_N "checking for GNUTLS... $ECHO_C" >&6; }
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-char gcry_control ();
-int
-main ()
-{
-return gcry_control ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag" || test ! -s conftest.err'
-  { (case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_try") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_try") 2>&5
+if test -n "$PKG_CONFIG"; then
+    if test -n "$GNUTLS_CFLAGS"; then
+        pkg_cv_GNUTLS_CFLAGS="$GNUTLS_CFLAGS"
+    else
+        if test -n "$PKG_CONFIG" && \
+    { (echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \"gnutls >= 1.2.9\"") >&5
+  ($PKG_CONFIG --exists --print-errors "gnutls >= 1.2.9") 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_gcrypt_gcry_control=yes
+  (exit $ac_status); }; then
+  pkg_cv_GNUTLS_CFLAGS=`$PKG_CONFIG --cflags "gnutls >= 1.2.9" 2>/dev/null`
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_cv_lib_gcrypt_gcry_control=no
-fi
-
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_lib_gcrypt_gcry_control" >&5
-echo "${ECHO_T}$ac_cv_lib_gcrypt_gcry_control" >&6; }
-if test $ac_cv_lib_gcrypt_gcry_control = yes; then
-
-      if test "${ac_cv_header_gnutls_gnutls_h+set}" = set; then
-  { echo "$as_me:$LINENO: checking for gnutls/gnutls.h" >&5
-echo $ECHO_N "checking for gnutls/gnutls.h... $ECHO_C" >&6; }
-if test "${ac_cv_header_gnutls_gnutls_h+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
+  pkg_failed=yes
 fi
-{ echo "$as_me:$LINENO: result: $ac_cv_header_gnutls_gnutls_h" >&5
-echo "${ECHO_T}$ac_cv_header_gnutls_gnutls_h" >&6; }
-else
-  # Is the header compilable?
-{ echo "$as_me:$LINENO: checking gnutls/gnutls.h usability" >&5
-echo $ECHO_N "checking gnutls/gnutls.h usability... $ECHO_C" >&6; }
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-$ac_includes_default
-#include <gnutls/gnutls.h>
-_ACEOF
-rm -f conftest.$ac_objext
-if { (ac_try="$ac_compile"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_compile") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag" || test ! -s conftest.err'
-  { (case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_try") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest.$ac_objext'
-  { (case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_try") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_header_compiler=yes
+    fi
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_header_compiler=no
+	pkg_failed=untried
 fi
-
-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-{ echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
-echo "${ECHO_T}$ac_header_compiler" >&6; }
-
-# Is the header present?
-{ echo "$as_me:$LINENO: checking gnutls/gnutls.h presence" >&5
-echo $ECHO_N "checking gnutls/gnutls.h presence... $ECHO_C" >&6; }
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
-#include <gnutls/gnutls.h>
-_ACEOF
-if { (ac_try="$ac_cpp conftest.$ac_ext"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.er1
+if test -n "$PKG_CONFIG"; then
+    if test -n "$GNUTLS_LIBS"; then
+        pkg_cv_GNUTLS_LIBS="$GNUTLS_LIBS"
+    else
+        if test -n "$PKG_CONFIG" && \
+    { (echo "$as_me:$LINENO: \$PKG_CONFIG --exists --print-errors \"gnutls >= 1.2.9\"") >&5
+  ($PKG_CONFIG --exists --print-errors "gnutls >= 1.2.9") 2>&5
   ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } >/dev/null; then
-  if test -s conftest.err; then
-    ac_cpp_err=$ac_c_preproc_warn_flag
-    ac_cpp_err=$ac_cpp_err$ac_c_werror_flag
-  else
-    ac_cpp_err=
-  fi
+  (exit $ac_status); }; then
+  pkg_cv_GNUTLS_LIBS=`$PKG_CONFIG --libs "gnutls >= 1.2.9" 2>/dev/null`
 else
-  ac_cpp_err=yes
+  pkg_failed=yes
 fi
-if test -z "$ac_cpp_err"; then
-  ac_header_preproc=yes
+    fi
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-  ac_header_preproc=no
+	pkg_failed=untried
 fi
 
-rm -f conftest.err conftest.$ac_ext
-{ echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
-echo "${ECHO_T}$ac_header_preproc" >&6; }
-
-# So?  What about this header?
-case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
-  yes:no: )
-    { echo "$as_me:$LINENO: WARNING: gnutls/gnutls.h: accepted by the compiler, rejected by the preprocessor!" >&5
-echo "$as_me: WARNING: gnutls/gnutls.h: accepted by the compiler, rejected by the preprocessor!" >&2;}
-    { echo "$as_me:$LINENO: WARNING: gnutls/gnutls.h: proceeding with the compiler's result" >&5
-echo "$as_me: WARNING: gnutls/gnutls.h: proceeding with the compiler's result" >&2;}
-    ac_header_preproc=yes
-    ;;
-  no:yes:* )
-    { echo "$as_me:$LINENO: WARNING: gnutls/gnutls.h: present but cannot be compiled" >&5
-echo "$as_me: WARNING: gnutls/gnutls.h: present but cannot be compiled" >&2;}
-    { echo "$as_me:$LINENO: WARNING: gnutls/gnutls.h:     check for missing prerequisite headers?" >&5
-echo "$as_me: WARNING: gnutls/gnutls.h:     check for missing prerequisite headers?" >&2;}
-    { echo "$as_me:$LINENO: WARNING: gnutls/gnutls.h: see the Autoconf documentation" >&5
-echo "$as_me: WARNING: gnutls/gnutls.h: see the Autoconf documentation" >&2;}
-    { echo "$as_me:$LINENO: WARNING: gnutls/gnutls.h:     section \"Present But Cannot Be Compiled\"" >&5
-echo "$as_me: WARNING: gnutls/gnutls.h:     section \"Present But Cannot Be Compiled\"" >&2;}
-    { echo "$as_me:$LINENO: WARNING: gnutls/gnutls.h: proceeding with the preprocessor's result" >&5
-echo "$as_me: WARNING: gnutls/gnutls.h: proceeding with the preprocessor's result" >&2;}
-    { echo "$as_me:$LINENO: WARNING: gnutls/gnutls.h: in the future, the compiler will take precedence" >&5
-echo "$as_me: WARNING: gnutls/gnutls.h: in the future, the compiler will take precedence" >&2;}
-
-    ;;
-esac
-{ echo "$as_me:$LINENO: checking for gnutls/gnutls.h" >&5
-echo $ECHO_N "checking for gnutls/gnutls.h... $ECHO_C" >&6; }
-if test "${ac_cv_header_gnutls_gnutls_h+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_cv_header_gnutls_gnutls_h=$ac_header_preproc
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_header_gnutls_gnutls_h" >&5
-echo "${ECHO_T}$ac_cv_header_gnutls_gnutls_h" >&6; }
 
-fi
-if test $ac_cv_header_gnutls_gnutls_h = yes; then
 
-        { echo "$as_me:$LINENO: checking for gnutls_certificate_verify_peers2 in -lgnutls" >&5
-echo $ECHO_N "checking for gnutls_certificate_verify_peers2 in -lgnutls... $ECHO_C" >&6; }
-if test "${ac_cv_lib_gnutls_gnutls_certificate_verify_peers2+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS="-lgnutls ${gnutls_LIBS} $LIBS"
-cat >conftest.$ac_ext <<_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h >>conftest.$ac_ext
-cat >>conftest.$ac_ext <<_ACEOF
-/* end confdefs.h.  */
+if test $pkg_failed = yes; then
 
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-#ifdef __cplusplus
-extern "C"
-#endif
-char gnutls_certificate_verify_peers2 ();
-int
-main ()
-{
-return gnutls_certificate_verify_peers2 ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try="$ac_link"
-case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_link") 2>conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 >conftest.err
-  rm -f conftest.er1
-  cat conftest.err >&5
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); } &&
-	 { ac_try='test -z "$ac_c_werror_flag" || test ! -s conftest.err'
-  { (case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_try") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; } &&
-	 { ac_try='test -s conftest$ac_exeext'
-  { (case "(($ac_try" in
-  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval "echo \"\$as_me:$LINENO: $ac_try_echo\"") >&5
-  (eval "$ac_try") 2>&5
-  ac_status=$?
-  echo "$as_me:$LINENO: \$? = $ac_status" >&5
-  (exit $ac_status); }; }; then
-  ac_cv_lib_gnutls_gnutls_certificate_verify_peers2=yes
+if $PKG_CONFIG --atleast-pkgconfig-version 0.20; then
+        _pkg_short_errors_supported=yes
 else
-  echo "$as_me: failed program was:" >&5
-sed 's/^/| /' conftest.$ac_ext >&5
-
-	ac_cv_lib_gnutls_gnutls_certificate_verify_peers2=no
+        _pkg_short_errors_supported=no
 fi
+        if test $_pkg_short_errors_supported = yes; then
+	        GNUTLS_PKG_ERRORS=`$PKG_CONFIG --short-errors --errors-to-stdout --print-errors "gnutls >= 1.2.9"`
+        else
+	        GNUTLS_PKG_ERRORS=`$PKG_CONFIG --errors-to-stdout --print-errors "gnutls >= 1.2.9"`
+        fi
+	# Put the nasty error message in config.log where it belongs
+	echo "$GNUTLS_PKG_ERRORS" >&5
 
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-{ echo "$as_me:$LINENO: result: $ac_cv_lib_gnutls_gnutls_certificate_verify_peers2" >&5
-echo "${ECHO_T}$ac_cv_lib_gnutls_gnutls_certificate_verify_peers2" >&6; }
-if test $ac_cv_lib_gnutls_gnutls_certificate_verify_peers2 = yes; then
-  have_gnutls="yes"
+	{ echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
+                have_gnutls="no"
+elif test $pkg_failed = untried; then
+	have_gnutls="no"
 else
-  old_gnutls="yes"
-fi
-
-
-fi
-
-
-
-fi
-
-
+	GNUTLS_CFLAGS=$pkg_cv_GNUTLS_CFLAGS
+	GNUTLS_LIBS=$pkg_cv_GNUTLS_LIBS
+        { echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6; }
+	have_gnutls="yes"
 fi
 
-
-
   if test "${have_gnutls}" = "yes"; then
 
 
@@ -66880,7 +66487,13 @@
 
 
   for element in gnutls; do
-    eval "LDFLAGS_${element}="'"'"-lgnutls ${gnutls_LIBS} "'$'"{LDFLAGS_${element}} "'"'
+    eval "CFLAGS_${element}="'"$'"{CFLAGS_${element}} $GNUTLS_CFLAGS"'"'
+    am_modules_with_cflags="${am_modules_with_cflags} ${element}"
+  done
+
+
+  for element in gnutls; do
+    eval "LDFLAGS_${element}="'"'"$GNUTLS_LIBS "'$'"{LDFLAGS_${element}} "'"'
     am_modules_with_ldflags="${am_modules_with_ldflags} ${element}"
   done
 
@@ -66889,8 +66502,8 @@
 
     if test "${enable_gnutls}" = "yes"; then
 
-      { { echo "$as_me:$LINENO: error: gnutls not present or too old (version 1.0.17 required)" >&5
-echo "$as_me: error: gnutls not present or too old (version 1.0.17 required)" >&2;}
+      { { echo "$as_me:$LINENO: error: gnutls not present or too old (version 1.2.9 required)" >&5
+echo "$as_me: error: gnutls not present or too old (version 1.2.9 required)" >&2;}
    { (exit 1); exit 1; }; }
 
 fi
@@ -67035,11 +66648,17 @@
   enableval=$enable_activex;
 fi
 
+
+# Check whether --with-wine-sdk-path was given.
+if test "${with_wine_sdk_path+set}" = set; then
+  withval=$with_wine_sdk_path;
+fi
+
 if test "${enable_activex}" != "no"
 then
   if test "${SYS}" = "mingw32" -o "${SYS}" = "cygwin"
   then
-    for ac_prog in midl widl
+    for ac_prog in midl
 do
   # Extract the first word of "$ac_prog", so it can be a program name with args.
 set dummy $ac_prog; ac_word=$2
@@ -67082,6 +66701,54 @@
 done
 test -n "$MIDL" || MIDL="no"
 
+    if test "${with_wine_sdk_path}" != ""
+    then
+       WINE_SDK_PATH=${with_wine_sdk_path}
+       # Extract the first word of "widl", so it can be a program name with args.
+set dummy widl; ac_word=$2
+{ echo "$as_me:$LINENO: checking for $ac_word" >&5
+echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
+if test "${ac_cv_path_WIDL+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  case $WIDL in
+  [\\/]* | ?:[\\/]*)
+  ac_cv_path_WIDL="$WIDL" # Let the user override the test with a path.
+  ;;
+  *)
+  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+as_dummy="$WINE_SDK_PATH/bin:$WINE_SDK_PATH/tools/widl"
+for as_dir in $as_dummy
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+  for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_path_WIDL="$as_dir/$ac_word$ac_exec_ext"
+    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+done
+IFS=$as_save_IFS
+
+  test -z "$ac_cv_path_WIDL" && ac_cv_path_WIDL="no"
+  ;;
+esac
+fi
+WIDL=$ac_cv_path_WIDL
+if test -n "$WIDL"; then
+  { echo "$as_me:$LINENO: result: $WIDL" >&5
+echo "${ECHO_T}$WIDL" >&6; }
+else
+  { echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6; }
+fi
+
+
+    else
+       WIDL=no
+    fi
     ac_ext=cpp
 ac_cpp='$CXXCPP $CPPFLAGS'
 ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
@@ -67375,6 +67042,17 @@
 
 
 
+
+if test "${WIDL}" != "no"; then
+  HAS_WIDL_COMPILER_TRUE=
+  HAS_WIDL_COMPILER_FALSE='#'
+else
+  HAS_WIDL_COMPILER_TRUE='#'
+  HAS_WIDL_COMPILER_FALSE=
+fi
+
+
+
 if ${activex}; then
   BUILD_ACTIVEX_TRUE=
   BUILD_ACTIVEX_FALSE='#'
@@ -68231,124 +67909,13 @@
   enableval=$enable_java_bindings;
 fi
 
-if test "${enable-java-bindings}" = "yes"
+if test "${enable_java_bindings}" = "yes"
 then
-  if test -n "$ac_tool_prefix"; then
-  for ac_prog in javac
-  do
-    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
-set dummy $ac_tool_prefix$ac_prog; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_JAVA_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$JAVA_CC"; then
-  ac_cv_prog_JAVA_CC="$JAVA_CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_JAVA_CC="$ac_tool_prefix$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-JAVA_CC=$ac_cv_prog_JAVA_CC
-if test -n "$JAVA_CC"; then
-  { echo "$as_me:$LINENO: result: $JAVA_CC" >&5
-echo "${ECHO_T}$JAVA_CC" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-    test -n "$JAVA_CC" && break
-  done
-fi
-if test -z "$JAVA_CC"; then
-  ac_ct_JAVA_CC=$JAVA_CC
-  for ac_prog in javac
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-{ echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6; }
-if test "${ac_cv_prog_ac_ct_JAVA_CC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_JAVA_CC"; then
-  ac_cv_prog_ac_ct_JAVA_CC="$ac_ct_JAVA_CC" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; }; then
-    ac_cv_prog_ac_ct_JAVA_CC="$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-IFS=$as_save_IFS
-
-fi
-fi
-ac_ct_JAVA_CC=$ac_cv_prog_ac_ct_JAVA_CC
-if test -n "$ac_ct_JAVA_CC"; then
-  { echo "$as_me:$LINENO: result: $ac_ct_JAVA_CC" >&5
-echo "${ECHO_T}$ac_ct_JAVA_CC" >&6; }
-else
-  { echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6; }
-fi
-
-
-  test -n "$ac_ct_JAVA_CC" && break
-done
-
-  if test "x$ac_ct_JAVA_CC" = x; then
-    JAVA_CC=""
-  else
-    case $cross_compiling:$ac_tool_warned in
-yes:)
-{ echo "$as_me:$LINENO: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&5
-echo "$as_me: WARNING: In the future, Autoconf will not detect cross-tools
-whose name does not start with the host triplet.  If you think this
-configuration is useful to you, please write to autoconf@gnu.org." >&2;}
-ac_tool_warned=yes ;;
-esac
-    JAVA_CC=$ac_ct_JAVA_CC
-  fi
-fi
-
-
-if test "$JAVA_CC" = "gcj"; then
-   if test "$GCJ_OPTS" = ""; then
-      GCJ_OPTS=-C
-
-   fi
-   JAVA_CC_OPTS=@GCJ_OPTS@
-
-fi
-test -z "$JAVA_CC" && { { echo "$as_me:$LINENO: error: no acceptable java compiler found in \$PATH" >&5
-echo "$as_me: error: no acceptable java compiler found in \$PATH" >&2;}
+  if test "x${JAVA_HOME}" == "x"; then
+  { { echo "$as_me:$LINENO: error: Please set the JAVA_HOME variable to your JDK environment" >&5
+echo "$as_me: error: Please set the JAVA_HOME variable to your JDK environment" >&2;}
    { (exit 1); exit 1; }; }
+fi
 
 
 if test "x$JAVAPREFIX" = x; then
@@ -68452,7 +68019,7 @@
 JAVA_TEST=Test.java
 CLASS_TEST=Test.class
 cat << \EOF > $JAVA_TEST
-/* #line 68455 "configure" */
+/* #line 68022 "configure" */
 public class Test {
 }
 EOF
@@ -68628,7 +68195,7 @@
 if uudecode$EXEEXT Test.uue; then
         ac_cv_prog_uudecode_base64=yes
 else
-        echo "configure: 68631: uudecode had trouble decoding base 64 file 'Test.uue'" >&5
+        echo "configure: 68198: uudecode had trouble decoding base 64 file 'Test.uue'" >&5
         echo "configure: failed file was:" >&5
         cat Test.uue >&5
         ac_cv_prog_uudecode_base64=no
@@ -68750,7 +68317,7 @@
 JAVA_TEST=Test.java
 CLASS_TEST=Test.class
 cat << \EOF > $JAVA_TEST
-/* #line 68753 "configure" */
+/* #line 68320 "configure" */
 public class Test {
 }
 EOF
@@ -68787,7 +68354,7 @@
 CLASS_TEST=Test.class
 TEST=Test
 cat << \EOF > $JAVA_TEST
-/* [#]line 68790 "configure" */
+/* [#]line 68357 "configure" */
 public class Test {
 public static void main (String args[]) {
         System.exit (0);
@@ -69299,6 +68866,7 @@
 
 
 
+
   { echo "$as_me:$LINENO: result: configure: creating ./vlc-config.in" >&5
 echo "${ECHO_T}configure: creating ./vlc-config.in" >&6; }
 
@@ -69851,6 +69419,13 @@
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
 fi
+if test -z "${HAS_WIDL_COMPILER_TRUE}" && test -z "${HAS_WIDL_COMPILER_FALSE}"; then
+  { { echo "$as_me:$LINENO: error: conditional \"HAS_WIDL_COMPILER\" was never defined.
+Usually this means the macro was only invoked conditionally." >&5
+echo "$as_me: error: conditional \"HAS_WIDL_COMPILER\" was never defined.
+Usually this means the macro was only invoked conditionally." >&2;}
+   { (exit 1); exit 1; }; }
+fi
 if test -z "${BUILD_ACTIVEX_TRUE}" && test -z "${BUILD_ACTIVEX_FALSE}"; then
   { { echo "$as_me:$LINENO: error: conditional \"BUILD_ACTIVEX\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
@@ -70797,11 +70372,16 @@
 CORBA_LIBS!$CORBA_LIBS$ac_delim
 ENABLE_CORBA_TRUE!$ENABLE_CORBA_TRUE$ac_delim
 ENABLE_CORBA_FALSE!$ENABLE_CORBA_FALSE$ac_delim
+GNUTLS_CFLAGS!$GNUTLS_CFLAGS$ac_delim
+GNUTLS_LIBS!$GNUTLS_LIBS$ac_delim
 LOADER_TRUE!$LOADER_TRUE$ac_delim
 LOADER_FALSE!$LOADER_FALSE$ac_delim
 MIDL!$MIDL$ac_delim
+WIDL!$WIDL$ac_delim
 HAS_MIDL_COMPILER_TRUE!$HAS_MIDL_COMPILER_TRUE$ac_delim
 HAS_MIDL_COMPILER_FALSE!$HAS_MIDL_COMPILER_FALSE$ac_delim
+HAS_WIDL_COMPILER_TRUE!$HAS_WIDL_COMPILER_TRUE$ac_delim
+HAS_WIDL_COMPILER_FALSE!$HAS_WIDL_COMPILER_FALSE$ac_delim
 BUILD_ACTIVEX_TRUE!$BUILD_ACTIVEX_TRUE$ac_delim
 BUILD_ACTIVEX_FALSE!$BUILD_ACTIVEX_FALSE$ac_delim
 MOZILLA_CONFIG!$MOZILLA_CONFIG$ac_delim
@@ -70813,11 +70393,6 @@
 BUILD_MOZILLA_FALSE!$BUILD_MOZILLA_FALSE$ac_delim
 BUILD_PYTHON_TRUE!$BUILD_PYTHON_TRUE$ac_delim
 BUILD_PYTHON_FALSE!$BUILD_PYTHON_FALSE$ac_delim
-JAVA_CC!$JAVA_CC$ac_delim
-JAVA_CC_FLAGS!$JAVA_CC_FLAGS$ac_delim
-ac_ct_JAVA_CC!$ac_ct_JAVA_CC$ac_delim
-GCJ_OPTS!$GCJ_OPTS$ac_delim
-JAVA_CC_OPTS!$JAVA_CC_OPTS$ac_delim
 JAVAC!$JAVAC$ac_delim
 JAVA!$JAVA$ac_delim
 uudecode!$uudecode$ac_delim
@@ -70841,6 +70416,7 @@
 ASM!$ASM$ac_delim
 MOC!$MOC$ac_delim
 MOZILLA_SDK_PATH!$MOZILLA_SDK_PATH$ac_delim
+WINE_SDK_PATH!$WINE_SDK_PATH$ac_delim
 XPIDL_INCL!$XPIDL_INCL$ac_delim
 LIBEXT!$LIBEXT$ac_delim
 AM_CPPFLAGS!$AM_CPPFLAGS$ac_delim
@@ -70851,7 +70427,7 @@
 LTLIBOBJS!$LTLIBOBJS$ac_delim
 _ACEOF
 
-  if test `sed -n "s/.*$ac_delim\$/X/p" conf$$subs.sed | grep -c X` = 65; then
+  if test `sed -n "s/.*$ac_delim\$/X/p" conf$$subs.sed | grep -c X` = 66; then
     break
   elif $ac_last_try; then
     { { echo "$as_me:$LINENO: error: could not make $CONFIG_STATUS" >&5
diff -uNr vlc-0.8.6-svn20060918.debian/doc/Makefile.in vlc-0.8.6-svn20061008.debian/doc/Makefile.in
--- vlc-0.8.6-svn20060918.debian/doc/Makefile.in	2006-09-18 06:30:31.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/doc/Makefile.in	2006-10-08 12:42:32.000000000 -0400
@@ -115,12 +115,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -128,6 +129,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -152,9 +155,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -231,7 +231,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -246,7 +248,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
@@ -314,6 +315,7 @@
 	ChangeLog-2002 \
 	ChangeLog-2003 \
 	ChangeLog-2004 \
+	ChangeLog-2005 \
 	vlc.1 \
 	vlc-config.1 \
 	bugreport-howto.txt \
diff -uNr vlc-0.8.6-svn20060918.debian/extras/contrib/src/Makefile vlc-0.8.6-svn20061008.debian/extras/contrib/src/Makefile
--- vlc-0.8.6-svn20060918.debian/extras/contrib/src/Makefile	2006-09-18 06:34:35.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/extras/contrib/src/Makefile	2006-10-08 12:47:28.000000000 -0400
@@ -2,7 +2,7 @@
 # src/Makefile : Dearchive and compile all files necessary
 # ***************************************************************************
 # Copyright (C) 2003 - 2006 the VideoLAN team
-# $Id: Makefile 16404 2006-08-29 00:42:17Z hartman $
+# $Id: Makefile 16961 2006-10-07 15:29:34Z hartman $
 #
 # Authors: Christophe Massiot <massiot@via.ecp.fr>
 #          Derk-Jan Hartman <hartman at videolan dot org>
@@ -141,12 +141,14 @@
 	.dvdcss .dvdnav .dvdread .dvbpsi .live .x264 .caca .mod \
 	.png .gpg-error .gcrypt .gnutls .opendaap .cddb .cdio .vcdimager .SDL_image \
 	.glib .libidl .gecko .mpcdec .dirac_encoder .dirac_decoder .aclocal \
-        .libdca
+        .libdca .goom2k4 .x264
 # .expat .clinkcc don't work with SDK yet
 # .glib .libidl .gecko are required to build the mozilla plugin
 # .mozilla will build an entire mozilla. it can be used if we need to create a new .gecko package
+# 
+# Things only enabled on PPC
 ifneq ($(HOST),i686-apple-darwin8)
-all: .goom2k4
+all:
 endif
 else
 
@@ -1119,6 +1121,7 @@
 	$(EXTRACT_GZ)
 ifdef HAVE_DARWIN_OS
 	patch -p 0 < Patches/goom.patch
+	patch -p 0 < Patches/goom2k4-0-mmx.patch
 endif
 ifdef HAVE_WIN32
 	(cd $@; dos2unix configure.in)
diff -uNr vlc-0.8.6-svn20060918.debian/extras/contrib/src/packages.mak vlc-0.8.6-svn20061008.debian/extras/contrib/src/packages.mak
--- vlc-0.8.6-svn20060918.debian/extras/contrib/src/packages.mak	2006-09-18 06:34:35.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/extras/contrib/src/packages.mak	2006-10-08 12:47:28.000000000 -0400
@@ -2,7 +2,7 @@
 # src/packages.mak : Archive locations
 # ***************************************************************************
 # Copyright (C) 2003 - 2006 the VideoLAN team
-# $Id: packages.mak 16404 2006-08-29 00:42:17Z hartman $
+# $Id: packages.mak 16885 2006-09-30 12:47:51Z fkuehne $
 #
 # Authors: Christophe Massiot <massiot@via.ecp.fr>
 #          Derk-Jan Hartman <hartman at videolan dot org>
@@ -97,7 +97,7 @@
 GOOM2k4_VERSION=2k4-0
 GOOM2k4_URL=$(SF)/goom/goom-$(GOOM2k4_VERSION)-src.tar.gz
 LIBCACA_VERSION=0.9
-LIBCACA_URL=http://sam.zoy.org/libcaca/libcaca-$(LIBCACA_VERSION).tar.gz
+LIBCACA_URL=http://libcaca.zoy.org/files/libcaca-$(LIBCACA_VERSION).tar.gz
 LIBDTS_VERSION=0.0.2
 LIBDTS_URL=http://debian.unnet.nl/pub/videolan/libdts/$(LIBDTS_VERSION)/libdts-$(LIBDTS_VERSION).tar.gz
 LIBDCA_SVN=svn://svn.videolan.org/libdca/trunk
diff -uNr vlc-0.8.6-svn20060918.debian/extras/contrib/src/Patches/dvdnav.patch vlc-0.8.6-svn20061008.debian/extras/contrib/src/Patches/dvdnav.patch
--- vlc-0.8.6-svn20060918.debian/extras/contrib/src/Patches/dvdnav.patch	2006-09-18 06:34:36.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/extras/contrib/src/Patches/dvdnav.patch	2006-10-08 12:47:28.000000000 -0400
@@ -389,7 +389,7 @@
 +if test x"$link_dvdcss" != xyes; then
 +dnl dlopen libdvdcss
 +  AC_CHECK_FUNC( dlopen,
-+    [DL_LIBS="" ].
++    [DL_LIBS="" ],
 +    AC_CHECK_LIB( dl, dlopen,
 +      [DL_LIBS=-ld ],
 +      AC_MSG_ERROR(You need libdl (dlopen))
diff -uNr vlc-0.8.6-svn20060918.debian/extras/contrib/src/Patches/goom2k4-0-mmx.patch vlc-0.8.6-svn20061008.debian/extras/contrib/src/Patches/goom2k4-0-mmx.patch
--- vlc-0.8.6-svn20060918.debian/extras/contrib/src/Patches/goom2k4-0-mmx.patch	1969-12-31 19:00:00.000000000 -0500
+++ vlc-0.8.6-svn20061008.debian/extras/contrib/src/Patches/goom2k4-0-mmx.patch	2006-10-08 12:47:29.000000000 -0400
@@ -0,0 +1,14 @@
+diff -ruN goom.orig/src/xmmx.c goom/src/xmmx.c
+--- goom.orig/src/xmmx.c	2006-10-01 22:10:15.000000000 +0200
++++ goom/src/xmmx.c	2006-10-01 23:45:59.000000000 +0200
+@@ -69,8 +69,8 @@
+ 		 */
+ 
+ 		asm volatile
+-      ("#1 \n\t movq %[brutS], %%mm0"
+-       "#1 \n\t movq %[brutD], %%mm1"
++      ("#1 \n\t movq (%[brutS]), %%mm0"
++       "#1 \n\t movq (%[brutD]), %%mm1"
+        "#1 \n\t psubd   %%mm0, %%mm1" /* mm1 = D - S */
+        "#1 \n\t movq    %%mm1, %%mm2" /* mm2 = D - S */
+        "#1 \n\t pslld     $16, %%mm1"
diff -uNr vlc-0.8.6-svn20060918.debian/extras/contrib/src/Patches/x264-svn-win32.patch vlc-0.8.6-svn20061008.debian/extras/contrib/src/Patches/x264-svn-win32.patch
--- vlc-0.8.6-svn20060918.debian/extras/contrib/src/Patches/x264-svn-win32.patch	2006-09-18 06:34:36.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/extras/contrib/src/Patches/x264-svn-win32.patch	2006-10-08 12:47:29.000000000 -0400
@@ -2,7 +2,7 @@
 ===================================================================
 --- configure	(rvision 547)
 +++ configure	(copie de travail)
-@@ -66,48 +66,147 @@
+@@ -66,43 +66,142 @@
  
  EXE=""
  
@@ -129,12 +129,6 @@
      SYS="NETBSD"
      LDFLAGS="$LDFLAGS -lm"
      ;;
--  OpenBSD)
-+  openbsd)
-     SYS="OPENBSD"
-     CFLAGS="$CFLAGS -I/usr/X11R6/include"
-     LDFLAGS="$LDFLAGS -lm"
-     ;;
 -  Linux)
 +  linux)
      SYS="LINUX"
@@ -160,7 +154,7 @@
      SYS="SunOS"
      CFLAGS="$CFLAGS -DHAVE_MALLOC_H"
      LDFLAGS="$LDFLAGS -lm"
-@@ -119,9 +218,8 @@
+@@ -114,9 +213,8 @@
      ;;
  esac
  
@@ -171,7 +165,7 @@
      ARCH="X86"
      CFLAGS="$CFLAGS -DHAVE_MMXEXT -DHAVE_SSE2"
      AS="nasm"
-@@ -142,7 +240,7 @@
+@@ -137,7 +235,7 @@
      AS="yasm"
      ASFLAGS="-f elf -m amd64"
      ;;
@@ -180,7 +174,7 @@
      ARCH="PPC"
      if [ $SYS = MACOSX ]
      then
-@@ -191,95 +289,6 @@
+@@ -186,89 +282,6 @@
  CFLAGS="$CFLAGS -DARCH_$ARCH -DSYS_$SYS"
  
  # parse options
@@ -250,12 +244,6 @@
 -        --disable-vfw)
 -            vfw="no"
 -            ;;
--        --enable-gtk)
--            gtk="yes"
--            ;;
--        --disable-gtk)
--            gtk="no"
--            ;;
 -        --enable-shared)
 -            shared="yes"
 -            if [ $ARCH = "X86_64" -o $ARCH = "PPC" -o $ARCH = "ALPHA" ] ; then
@@ -276,9 +264,8 @@
  # autodetect options that weren't forced nor disabled
  
  if test "$pthread" = "auto" ; then
-@@ -365,6 +374,9 @@
+@@ -360,5 +363,8 @@
  VFW=$vfw
- GTK=$gtk
  EXE=$EXE
 +AR=$AR
 +AROPTS=$AROPTS
@@ -301,9 +288,8 @@
  
  $(SONAME): .depend $(OBJS) $(OBJASM)
  	$(CC) -shared -o $@ $(OBJS) $(OBJASM) -Wl,-soname,$(SONAME) $(LDFLAGS)
-@@ -138,14 +138,14 @@
- 	rm -f config.mak config.h vfw/build/cygwin/config.mak x264.pc
- 	$(MAKE) -C gtk distclean
+@@ -135,14 +135,14 @@
+ 	rm -f config.mak config.h vfw/build/cygwin/config.mak gtk/config.mak x264.pc
  
 -install: x264 $(SONAME)
 +install: x264$(EXE)
@@ -316,6 +302,6 @@
 -	ranlib $(DESTDIR)$(libdir)/libx264.a
 +	install x264$(EXE)  $(DESTDIR)$(bindir)
 +	$(RANLIB) $(DESTDIR)$(libdir)/libx264.a
- 	$(if $(SONAME), ln -sf $(SONAME) $(DESTDIR)$(libdir)/libx264.so)
+ 	$(if $(SONAME), ln -sf $(DESTDIR)$(libdir)/$(SONAME) $(DESTDIR)$(libdir)/libx264.so)
  	$(if $(SONAME), install -m 755 $(SONAME) $(DESTDIR)$(libdir))
  
diff -uNr vlc-0.8.6-svn20060918.debian/extras/MacOSX/plugin/Info.plist vlc-0.8.6-svn20061008.debian/extras/MacOSX/plugin/Info.plist
--- vlc-0.8.6-svn20060918.debian/extras/MacOSX/plugin/Info.plist	2006-09-18 06:28:15.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/extras/MacOSX/plugin/Info.plist	2006-10-04 09:47:07.000000000 -0400
@@ -13,7 +13,7 @@
 	<key>CFBundleInfoDictionaryVersion</key>
 	<string>6.0</string>
 	<key>CFBundleName</key>
-	<string>VideoLAN VLC Plug-in</string>
+	<string>VideoLAN VLC Internet Plug-in</string>
 	<key>CFBundlePackageType</key>
 	<string>BRPL</string>
 	<key>CFBundleSignature</key>
diff -uNr vlc-0.8.6-svn20060918.debian/extras/MacOSX/plugin/InstallerDescription.plist vlc-0.8.6-svn20061008.debian/extras/MacOSX/plugin/InstallerDescription.plist
--- vlc-0.8.6-svn20060918.debian/extras/MacOSX/plugin/InstallerDescription.plist	2006-09-18 06:28:15.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/extras/MacOSX/plugin/InstallerDescription.plist	2006-10-04 09:47:07.000000000 -0400
@@ -3,7 +3,7 @@
 <plist version="1.0">
 <dict>
 	<key>IFPkgDescriptionDescription</key>
-	<string>Safari and Firefox Plug-In for the VideoLAN VLC Multimedia player.</string>
+	<string>Internet browser Plug-In for the VideoLAN VLC Multimedia player.</string>
 	<key>IFPkgDescriptionTitle</key>
 	<string>VideoLAN VLC Internet Plug-In</string>
 </dict>
diff -uNr vlc-0.8.6-svn20060918.debian/extras/MacOSX/plugin/InstallerInfo.plist vlc-0.8.6-svn20061008.debian/extras/MacOSX/plugin/InstallerInfo.plist
--- vlc-0.8.6-svn20060918.debian/extras/MacOSX/plugin/InstallerInfo.plist	2006-09-18 06:28:15.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/extras/MacOSX/plugin/InstallerInfo.plist	2006-10-04 09:47:07.000000000 -0400
@@ -3,17 +3,17 @@
 <plist version="1.0">
 <dict>
 	<key>CFBundleGetInfoString</key>
-	<string>0.8.5, The VideoLAN Team, All Rights Reserved.</string>
+	<string>0.8.6, The VideoLAN Team, All Rights Reserved.</string>
 	<key>CFBundleIdentifier</key>
 	<string>org.videolan.vlc</string>
 	<key>CFBundleShortVersionString</key>
-	<string>0.8.5</string>
+	<string>0.8.6</string>
 	<key>IFMajorVersion</key>
 	<integer>0</integer>
 	<key>IFMinorVersion</key>
-	<integer>8</integer>
+	<integer>86</integer>
 	<key>IFPkgFlagAllowBackRev</key>
-	<false/>
+	<true/>
 	<key>IFPkgFlagAuthorizationAction</key>
 	<string>AdminAuthorization</string>
 	<key>IFPkgFlagBackgroundAlignment</key>
diff -uNr vlc-0.8.6-svn20060918.debian/extras/MacOSX/Resources/English.lproj/MainMenu.nib/classes.nib vlc-0.8.6-svn20061008.debian/extras/MacOSX/Resources/English.lproj/MainMenu.nib/classes.nib
--- vlc-0.8.6-svn20060918.debian/extras/MacOSX/Resources/English.lproj/MainMenu.nib/classes.nib	2006-09-18 06:28:15.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/extras/MacOSX/Resources/English.lproj/MainMenu.nib/classes.nib	2006-10-01 11:34:21.000000000 -0400
@@ -327,7 +327,17 @@
                 "o_scrollfield" = id; 
                 "o_timefield" = id; 
                 "o_timeslider" = id; 
+                "o_vmi_fullscreen" = id; 
+                "o_vmi_mute" = id; 
+                "o_vmi_next" = id; 
+                "o_vmi_play" = id; 
+                "o_vmi_prev" = id; 
+                "o_vmi_snapshot" = id; 
+                "o_vmi_stop" = id; 
+                "o_vmi_voldown" = id; 
+                "o_vmi_volup" = id; 
                 "o_volumeslider" = id; 
+                "o_vout_menu" = id; 
                 "o_window" = id; 
             }; 
             SUPERCLASS = NSObject; 
diff -uNr vlc-0.8.6-svn20060918.debian/extras/MacOSX/Resources/English.lproj/MainMenu.nib/info.nib vlc-0.8.6-svn20061008.debian/extras/MacOSX/Resources/English.lproj/MainMenu.nib/info.nib
--- vlc-0.8.6-svn20060918.debian/extras/MacOSX/Resources/English.lproj/MainMenu.nib/info.nib	2006-09-18 06:28:15.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/extras/MacOSX/Resources/English.lproj/MainMenu.nib/info.nib	2006-10-01 11:34:21.000000000 -0400
@@ -3,30 +3,33 @@
 <plist version="1.0">
 <dict>
 	<key>IBDocumentLocation</key>
-	<string>90 147 478 430 0 0 1024 746 </string>
+	<string>577 80 478 430 0 0 1440 878 </string>
 	<key>IBEditorPositions</key>
 	<dict>
 		<key>1617</key>
 		<string>788 586 109 149 0 0 1440 878 </string>
 		<key>2197</key>
-		<string>172 420 596 143 0 0 1024 746 </string>
+		<string>422 532 596 143 0 0 1440 878 </string>
 		<key>2709</key>
 		<string>305 626 508 82 0 0 1024 746 </string>
+		<key>2730</key>
+		<string>396 512 130 249 0 0 1440 878 </string>
 		<key>29</key>
 		<string>130 802 438 44 0 0 1440 878 </string>
 		<key>915</key>
 		<string>777 479 187 249 0 0 1440 878 </string>
 	</dict>
 	<key>IBFramework Version</key>
-	<string>443.0</string>
+	<string>446.1</string>
 	<key>IBLockedObjects</key>
 	<array/>
 	<key>IBOpenObjects</key>
 	<array>
-		<integer>21</integer>
+		<integer>2730</integer>
 		<integer>29</integer>
+		<integer>2769</integer>
 	</array>
 	<key>IBSystem Version</key>
-	<string>8I127</string>
+	<string>8L127</string>
 </dict>
 </plist>
Binary files vlc-0.8.6-svn20060918.debian/extras/MacOSX/Resources/English.lproj/MainMenu.nib/keyedobjects.nib and vlc-0.8.6-svn20061008.debian/extras/MacOSX/Resources/English.lproj/MainMenu.nib/keyedobjects.nib differ
diff -uNr vlc-0.8.6-svn20060918.debian/include/libvlc_internal.h vlc-0.8.6-svn20061008.debian/include/libvlc_internal.h
--- vlc-0.8.6-svn20060918.debian/include/libvlc_internal.h	2006-09-18 06:28:45.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/include/libvlc_internal.h	2006-09-22 11:14:32.000000000 -0400
@@ -46,6 +46,9 @@
     struct libvlc_instance_t *p_instance; ///< Parent instance
 };
 
+#define RAISENULL( psz ) { libvlc_exception_raise( p_e, psz ); return NULL; }
+#define RAISEVOID( psz ) { libvlc_exception_raise( p_e, psz ); return; }
+#define RAISEZERO( psz ) { libvlc_exception_raise( p_e, psz ); return 0; }
 
 # ifdef __cplusplus
 }
diff -uNr vlc-0.8.6-svn20060918.debian/include/video_output.h vlc-0.8.6-svn20061008.debian/include/video_output.h
--- vlc-0.8.6-svn20060918.debian/include/video_output.h	2006-09-18 06:28:45.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/include/video_output.h	2006-10-04 09:47:08.000000000 -0400
@@ -2,7 +2,7 @@
  * video_output.h : video output thread
  *****************************************************************************
  * Copyright (C) 1999, 2000 the VideoLAN team
- * $Id: video_output.h 13905 2006-01-12 23:10:04Z dionoea $
+ * $Id: video_output.h 16931 2006-10-03 09:04:50Z damienf $
  *
  * Authors: Vincent Seguin <seguin@via.ecp.fr>
  *          Samuel Hocevar <sam@via.ecp.fr>
@@ -260,7 +260,8 @@
     VOUT_REPARENT,
     VOUT_SNAPSHOT,
     VOUT_CLOSE,
-    VOUT_SET_FOCUS         /* arg1= vlc_bool_t       res=    */
+    VOUT_SET_FOCUS,         /* arg1= vlc_bool_t       res=    */
+    VOUT_SET_VIEWPORT      /* arg1= view rect, arg2=clip rect, res= */
 };
 
 /**
diff -uNr vlc-0.8.6-svn20060918.debian/include/vlc/libvlc.h vlc-0.8.6-svn20061008.debian/include/vlc/libvlc.h
--- vlc-0.8.6-svn20060918.debian/include/vlc/libvlc.h	2006-09-18 06:28:44.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/include/vlc/libvlc.h	2006-10-08 12:40:59.000000000 -0400
@@ -114,6 +114,14 @@
 libvlc_instance_t * libvlc_new( int , char **, libvlc_exception_t *);
 
 /**
+ * Returns a libvlc instance identifier for legacy APIs. Use of this
+ * function is discouraged, you should convert your program to use the
+ * new API.
+ * \param p_instance the instance
+ */
+int libvlc_get_vlc_id( libvlc_instance_t *p_instance );
+
+/**
  * Destroy a libvlc instance
  * \param p_instance the instance to destroy
  */
@@ -195,20 +203,6 @@
 void libvlc_playlist_clear( libvlc_instance_t *, libvlc_exception_t * );
 
 /**
- * Go to next playlist item
- * \param p_instance the instance
- * \param p_exception an initialized exception
- */
-void libvlc_playlist_next( libvlc_instance_t *, libvlc_exception_t * );
-
-/**
- * Go to Previous playlist item
- * \param p_instance the instance
- * \param p_exception an initialized exception
- */
-void libvlc_playlist_prev( libvlc_instance_t *, libvlc_exception_t * );
-
-/**
  * Add an item at the end of the playlist
  * If you need more advanced options, \see libvlc_playlist_add_extended
  * \param p_instance the instance
@@ -226,13 +220,20 @@
  * \param psz_name a name that you might want to give or NULL
  * \param i_options the number of options to add
  * \param ppsz_options strings representing the options to add
+ * \param p_exception an initialized exception
  * \return the identifier of the new item
  */
 int libvlc_playlist_add_extended( libvlc_instance_t *, const char *,
                                   const char *, int, const char **,
                                   libvlc_exception_t * );
 
-
+/** 
+ * Delete the playlist item with the given ID.
+ * \param p_instance the instance
+ * \param i_id the id to remove
+ * \param p_exception an initialized exception
+ * \return
+ */
 int libvlc_playlist_delete_item( libvlc_instance_t *, int,
                                  libvlc_exception_t * );
     
@@ -246,8 +247,6 @@
 libvlc_input_t *libvlc_playlist_get_input( libvlc_instance_t *,
                                            libvlc_exception_t * );
 
-
-
 /** @}*/
 
 /*****************************************************************************
@@ -267,10 +266,13 @@
 /// \bug This might go away ... to be replaced by a broader system
 vlc_int64_t libvlc_input_get_length     ( libvlc_input_t *, libvlc_exception_t *);
 vlc_int64_t libvlc_input_get_time       ( libvlc_input_t *, libvlc_exception_t *);
+void        libvlc_input_set_time       ( libvlc_input_t *, vlc_int64_t, libvlc_exception_t *);
 float       libvlc_input_get_position   ( libvlc_input_t *, libvlc_exception_t *);
+void        libvlc_input_set_position   ( libvlc_input_t *, float, libvlc_exception_t *);
 vlc_bool_t  libvlc_input_will_play      ( libvlc_input_t *, libvlc_exception_t *);
-vlc_bool_t  libvlc_input_has_vout       ( libvlc_input_t *, libvlc_exception_t *);
-float       libvlc_input_get_fps        ( libvlc_input_t *, libvlc_exception_t *);
+float       libvlc_input_get_rate       ( libvlc_input_t *, libvlc_exception_t *);
+void        libvlc_input_set_rate       ( libvlc_input_t *, float, libvlc_exception_t *);
+int         libvlc_input_get_state      ( libvlc_input_t *, libvlc_exception_t *);
         
 /** @} */
 
@@ -281,6 +283,14 @@
  */
 
 /**
+ * Does this input have a video output ?
+ * \param p_input the input
+ * \param p_exception an initialized exception
+ */
+vlc_bool_t  libvlc_input_has_vout       ( libvlc_input_t *, libvlc_exception_t *);
+float       libvlc_input_get_fps        ( libvlc_input_t *, libvlc_exception_t *);
+
+/**
  * Toggle fullscreen status on video output
  * \param p_input the input
  * \param p_exception an initialized exception
@@ -327,6 +337,71 @@
  */
 void libvlc_video_take_snapshot( libvlc_input_t *, char *, libvlc_exception_t * );
     
+int libvlc_video_destroy( libvlc_input_t *, libvlc_exception_t *);
+
+/**
+ * Resize the video output window
+ * \param p_instance libvlc instance
+ * \param width new width for video output window
+ * \param height new height for video output window
+ * \param p_exception an initialized exception
+ * \return the mute status (boolean)
+ */
+void libvlc_video_resize( libvlc_input_t *, int, int, libvlc_exception_t *);
+    
+/**
+* Downcast to this general type as placeholder for a platform specific one, such as:
+*  Drawable on X11,
+*  CGrafPort on MacOSX,
+*  HWND on win32
+*/
+typedef int libvlc_drawable_t;
+
+/**
+ * Get current mute status
+ * \param p_instance libvlc instance
+ * \param drawable the new parent window (Drawable on X11, CGrafPort on MacOSX, HWND on Win32)
+ * \param p_exception an initialized exception
+ * \return the mute status (boolean)
+ */
+int libvlc_video_reparent( libvlc_input_t *, libvlc_drawable_t, libvlc_exception_t * );
+
+/**
+ * Embedding support: Set/change the default parent drawable for video outputs
+ * \param p_instance libvlc instance
+ * \param drawable the new parent window (Drawable on X11, CGrafPort on MacOSX, HWND on Win32)
+ * \param p_exception an initialized exception
+ */
+void libvlc_video_set_parent( libvlc_instance_t *, libvlc_drawable_t, libvlc_exception_t * );
+
+/**
+ * Embedding support: Set/change the default size for video outputs
+ * \param p_instance libvlc instance
+ * \param width new width for video drawable
+ * \param height new height for video drawable
+ * \param p_exception an initialized exception
+ */
+void libvlc_video_set_size( libvlc_instance_t *, int, int, libvlc_exception_t * );
+
+/**
+* Embedding support: rectangle for viewport
+*/
+typedef struct
+{
+    int top, left;
+    int bottom, right;
+}
+libvlc_rectangle_t;
+
+/**
+ * Embedding support: Set the video output viewport for a windowless video output (MacOS X only)
+ * \param p_instance libvlc instance
+ * \param view coordinates within video drawable
+ * \param clip coordinates within video drawable
+ * \param p_exception an initialized exception
+ */
+void libvlc_video_set_viewport( libvlc_instance_t *, const libvlc_rectangle_t *, const libvlc_rectangle_t *, libvlc_exception_t * );
+
 
 /** @} */
 
@@ -344,6 +419,14 @@
  */
 
 /**
+ * Toggle mute status
+ * \param p_instance libvlc instance
+ * \param p_exception an initialized exception
+ * \return void
+ */
+void libvlc_audio_toggle_mute( libvlc_instance_t *, libvlc_exception_t * );
+
+/**
  * Get current mute status
  * \param p_instance libvlc instance
  * \param p_exception an initialized exception
@@ -436,8 +519,6 @@
 void libvlc_vlm_set_input( libvlc_instance_t *, char *, char*,
                            libvlc_exception_t *);
 
-
-
 /**
  * Set output for a media
  * \param p_instance the instance
diff -uNr vlc-0.8.6-svn20060918.debian/include/vlc_common.h vlc-0.8.6-svn20061008.debian/include/vlc_common.h
--- vlc-0.8.6-svn20060918.debian/include/vlc_common.h	2006-09-18 06:28:45.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/include/vlc_common.h	2006-09-22 11:14:32.000000000 -0400
@@ -3,7 +3,7 @@
  * Collection of useful common types and macros definitions
  *****************************************************************************
  * Copyright (C) 1998-2005 the VideoLAN team
- * $Id: vlc_common.h 16434 2006-08-30 15:18:13Z hartman $
+ * $Id: vlc_common.h 16773 2006-09-21 18:46:25Z hartman $
  *
  * Authors: Samuel Hocevar <sam@via.ecp.fr>
  *          Vincent Seguin <seguin@via.ecp.fr>
@@ -1138,10 +1138,10 @@
 #   else
 #       define _(String) dgettext(PACKAGE_NAME, String)
 #   endif
-#   define N_(String) ((char*)(String))
+#   define N_(String) (String)
 #else
-#   define _(String) ((char*)(String))
-#   define N_(String) ((char*)(String))
+#   define _(String) (String)
+#   define N_(String) (String)
 #endif
 
 /*****************************************************************************
diff -uNr vlc-0.8.6-svn20060918.debian/include/vlc_config_cat.h vlc-0.8.6-svn20061008.debian/include/vlc_config_cat.h
--- vlc-0.8.6-svn20060918.debian/include/vlc_config_cat.h	2006-09-18 06:28:45.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/include/vlc_config_cat.h	2006-09-24 13:09:46.000000000 -0400
@@ -2,7 +2,7 @@
  * vlc_help.h: Help strings
  *****************************************************************************
  * Copyright (C) 2003 the VideoLAN team
- * $Id: vlc_config_cat.h 15124 2006-04-06 23:00:24Z adn $
+ * $Id: vlc_config_cat.h 16798 2006-09-22 23:56:12Z xtophe $
  *
  * Authors: Clment Stenac <zorglub@videolan.org>
  *          Anil Daoud <anil@videolan.org>
@@ -352,7 +352,7 @@
     {
         if( categories_array[i].i_id == i_value )
         {
-            return categories_array[i].psz_name;
+            return _(categories_array[i].psz_name);
         }
         i++;
     }
@@ -366,7 +366,7 @@
     {
         if( categories_array[i].i_id == i_value )
         {
-            return categories_array[i].psz_help;
+            return _(categories_array[i].psz_help);
         }
         i++;
     }
diff -uNr vlc-0.8.6-svn20060918.debian/include/vlc_es.h vlc-0.8.6-svn20061008.debian/include/vlc_es.h
--- vlc-0.8.6-svn20060918.debian/include/vlc_es.h	2006-09-18 06:28:45.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/include/vlc_es.h	2006-09-22 11:14:32.000000000 -0400
@@ -2,7 +2,7 @@
  * vlc_es.h: Elementary stream formats descriptions
  *****************************************************************************
  * Copyright (C) 1999-2001 the VideoLAN team
- * $Id: vlc_es.h 16647 2006-09-14 14:58:57Z hartman $
+ * $Id: vlc_es.h 16773 2006-09-21 18:46:25Z hartman $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *
@@ -201,7 +201,7 @@
     fmt->psz_description        = NULL;
 
     fmt->i_extra_languages      = 0;
-    fmt->p_extra_languages      = NULL;    
+    fmt->p_extra_languages      = NULL;
 
     memset( &fmt->audio, 0, sizeof(audio_format_t) );
     memset( &fmt->video, 0, sizeof(video_format_t) );
@@ -269,7 +269,8 @@
     if( fmt->i_extra > 0 ) free( fmt->p_extra );
     fmt->i_extra = 0; fmt->p_extra = NULL;
 
-    if( fmt->video.p_palette ) free( fmt->video.p_palette );
+    if( fmt->video.p_palette )
+        free( fmt->video.p_palette );
     fmt->video.p_palette = NULL;
 
     if( fmt->subs.psz_encoding ) free( fmt->subs.psz_encoding );
diff -uNr vlc-0.8.6-svn20060918.debian/include/vlc_input.h vlc-0.8.6-svn20061008.debian/include/vlc_input.h
--- vlc-0.8.6-svn20060918.debian/include/vlc_input.h	2006-09-18 06:28:45.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/include/vlc_input.h	2006-10-04 09:47:08.000000000 -0400
@@ -2,7 +2,7 @@
  * vlc_input.h: Core input structures
  *****************************************************************************
  * Copyright (C) 1999-2004 the VideoLAN team
- * $Id: vlc_input.h 16457 2006-08-31 20:51:12Z hartman $
+ * $Id: vlc_input.h 16931 2006-10-03 09:04:50Z damienf $
  *
  * Authors: Christophe Massiot <massiot@via.ecp.fr>
  *          Laurent Aimar <fenrir@via.ecp.fr>
@@ -285,6 +285,8 @@
 enum input_state_e
 {
     INIT_S,
+    OPENING_S,
+    BUFFERING_S,
     PLAYING_S,
     PAUSE_S,
     END_S
diff -uNr vlc-0.8.6-svn20060918.debian/include/vlc_spu.h vlc-0.8.6-svn20061008.debian/include/vlc_spu.h
--- vlc-0.8.6-svn20060918.debian/include/vlc_spu.h	2006-09-18 06:28:45.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/include/vlc_spu.h	2006-09-22 11:14:32.000000000 -0400
@@ -2,7 +2,7 @@
  * vlc_spu.h : subpicture unit
  *****************************************************************************
  * Copyright (C) 1999, 2000 the VideoLAN team
- * $Id: vlc_spu.h 13905 2006-01-12 23:10:04Z dionoea $
+ * $Id: vlc_spu.h 16774 2006-09-21 19:29:10Z hartman $
  *
  * Authors: Gildas Bazin <gbazin@videolan.org>
  *
@@ -104,7 +104,7 @@
 #define spu_DestroyRegion(a,b) __spu_DestroyRegion(VLC_OBJECT(a),b)
 VLC_EXPORT( void, __spu_DestroyRegion, ( vlc_object_t *, subpicture_region_t * ) );
 
-VLC_EXPORT( subpicture_t *, spu_SortSubpictures, ( spu_t *, mtime_t ) );
+VLC_EXPORT( subpicture_t *, spu_SortSubpictures, ( spu_t *, mtime_t, vlc_bool_t ) );
 VLC_EXPORT( void, spu_RenderSubpictures, ( spu_t *,  video_format_t *, picture_t *, picture_t *, subpicture_t *, int, int ) );
 
 /** @}*/
diff -uNr vlc-0.8.6-svn20060918.debian/include/vlc_symbols.h vlc-0.8.6-svn20061008.debian/include/vlc_symbols.h
--- vlc-0.8.6-svn20060918.debian/include/vlc_symbols.h	2006-09-18 06:28:45.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/include/vlc_symbols.h	2006-09-22 11:14:32.000000000 -0400
@@ -323,7 +323,7 @@
     subpicture_region_t * (*__spu_CreateRegion_inner) (vlc_object_t *, video_format_t *);
     subpicture_region_t * (*__spu_MakeRegion_inner) (vlc_object_t *, video_format_t *, picture_t *);
     void (*__spu_DestroyRegion_inner) (vlc_object_t *, subpicture_region_t *);
-    subpicture_t * (*spu_SortSubpictures_inner) (spu_t *, mtime_t);
+    subpicture_t * (*spu_SortSubpictures_inner) (spu_t *, mtime_t, vlc_bool_t);
     void (*spu_RenderSubpictures_inner) (spu_t *,  video_format_t *, picture_t *, picture_t *, subpicture_t *, int, int);
     char * (*stream_ReadLine_inner) (stream_t *);
     stream_t * (*__stream_DemuxNew_inner) (vlc_object_t *p_obj, char *psz_demux, es_out_t *out);
@@ -495,6 +495,8 @@
     vlc_bool_t (*input_AddSubtitles_inner) (input_thread_t *, char *, vlc_bool_t);
     int (*utf8_fprintf_inner) (FILE *, const char *, ...);
     int (*utf8_vfprintf_inner) (FILE *stream, const char *fmt, va_list ap);
+    void *utf8_fprintf_deprecated;
+    void *utf8_vfprintf_deprecated;
 };
 # if defined (__PLUGIN__)
 #  define aout_FiltersCreatePipeline (p_symbols)->aout_FiltersCreatePipeline_inner
@@ -1451,6 +1453,8 @@
     (p_symbols)->net_ConvertIPv4_deprecated = NULL; \
     (p_symbols)->__stats_CounterGet_deprecated = NULL; \
     (p_symbols)->__stats_TimerDumpAll_deprecated = NULL; \
+    (p_symbols)->utf8_fprintf_deprecated = NULL; \
+    (p_symbols)->utf8_vfprintf_deprecated = NULL; \
 
 # endif /* __PLUGIN__ */
 #endif /* __VLC_SYMBOLS_H */
diff -uNr vlc-0.8.6-svn20060918.debian/include/vlc_url.h vlc-0.8.6-svn20061008.debian/include/vlc_url.h
--- vlc-0.8.6-svn20060918.debian/include/vlc_url.h	2006-09-18 06:28:45.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/include/vlc_url.h	2006-09-22 11:14:32.000000000 -0400
@@ -2,7 +2,7 @@
  * vlc_url.h: URL related macros
  *****************************************************************************
  * Copyright (C) 2002-2006 the VideoLAN team
- * $Id: vlc_url.h 15121 2006-04-06 21:20:33Z courmisch $
+ * $Id: vlc_url.h 16773 2006-09-21 18:46:25Z hartman $
  *
  * Authors: Christophe Massiot <massiot@via.ecp.fr>
  *          Rmi Denis-Courmont <rem # videolan.org>
@@ -217,11 +217,12 @@
  *****************************************************************************
  *
  *****************************************************************************/
-static inline char *vlc_b64_encode( char *src )
+static inline char *vlc_b64_encode( const char *src )
 {
     static const char b64[] =
            "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
     size_t len = strlen( src );
+    const uint8_t *in = (const uint8_t *)src;
 
     char *ret;
     char *dst = (char *)malloc( ( len + 4 ) * 4 / 3 );
@@ -232,38 +233,29 @@
 
     while( len > 0 )
     {
-        /* pops (up to) 3 bytes of input */
-        uint32_t v = *src++ << 24;
+        /* pops (up to) 3 bytes of input, push 4 bytes */
+        uint32_t v = *in++ << 24; // 1/3
+        *dst++ = b64[v >> 26]; // 1/4
+        v = v << 6;
 
         if( len >= 2 )
-        {
-            v |= *src++ << 16;
-            if( len >= 3 )
-                v |= *src++ << 8;
-        }
+            v |= *in++ << 22; // 2/3
+        *dst++ = b64[v >> 26]; // 2/4
+        v = v << 6;
+
+        if( len >= 3 )
+            v |= *in++ << 20; // 3/3
+        *dst++ = ( len >= 2 ) ? b64[v >> 26] : '='; // 3/4
+        v = v << 6;
 
-        /* pushes (up to) 4 bytes of output */
-        while( v )
-        {
-            *dst++ = b64[v >> 26];
-            v = v << 6;
-        }
+        *dst++ = ( len >= 3 ) ? b64[v >> 26] : '='; // 4/4
 
-        switch( len )
+        len--;
+        if( len > 0 )
         {
-            case 1:
-                *dst++ = '=';
-                *dst++ = '=';
+            len--;
+            if( len > 0 )
                 len--;
-                break;
-
-            case 2:
-                *dst++ = '=';
-                len -= 2;
-                break;
-
-            default:
-                len -= 3;
         }
     }
 
diff -uNr vlc-0.8.6-svn20060918.debian/include/vlc_video.h vlc-0.8.6-svn20061008.debian/include/vlc_video.h
--- vlc-0.8.6-svn20060918.debian/include/vlc_video.h	2006-09-18 06:28:45.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/include/vlc_video.h	2006-09-22 11:14:32.000000000 -0400
@@ -4,7 +4,7 @@
  * includes all common video types and constants.
  *****************************************************************************
  * Copyright (C) 1999 - 2005 the VideoLAN team
- * $Id: vlc_video.h 15328 2006-04-23 13:56:24Z bigben $
+ * $Id: vlc_video.h 16774 2006-09-21 19:29:10Z hartman $
  *
  * Authors: Vincent Seguin <seguin@via.ecp.fr>
  *
@@ -246,6 +246,8 @@
     vlc_bool_t      b_ephemer;    /**< If this flag is set to true the subtitle
                                 will be displayed untill the next one appear */
     vlc_bool_t      b_fade;                               /**< enable fading */
+    vlc_bool_t      b_pausable;               /**< subpicture will be paused if
+                                                            stream is paused */
     /**@}*/
 
     subpicture_region_t *p_region;  /**< region list composing this subtitle */
diff -uNr vlc-0.8.6-svn20060918.debian/intl/plural.c vlc-0.8.6-svn20061008.debian/intl/plural.c
--- vlc-0.8.6-svn20060918.debian/intl/plural.c	2006-09-18 06:32:38.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/intl/plural.c	2006-10-08 12:41:57.000000000 -0400
@@ -1,97 +1,22 @@
-/* A Bison parser, made by GNU Bison 2.3.  */
 
-/* Skeleton implementation for Bison's Yacc-like parsers in C
+/*  A Bison parser, made from plural.y
+    by GNU Bison version 1.28  */
 
-   Copyright (C) 1984, 1989, 1990, 2000, 2001, 2002, 2003, 2004, 2005, 2006
-   Free Software Foundation, Inc.
+#define YYBISON 1  /* Identify Bison output.  */
 
-   This program is free software; you can redistribute it and/or modify
-   it under the terms of the GNU General Public License as published by
-   the Free Software Foundation; either version 2, or (at your option)
-   any later version.
-
-   This program is distributed in the hope that it will be useful,
-   but WITHOUT ANY WARRANTY; without even the implied warranty of
-   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-   GNU General Public License for more details.
-
-   You should have received a copy of the GNU General Public License
-   along with this program; if not, write to the Free Software
-   Foundation, Inc., 51 Franklin Street, Fifth Floor,
-   Boston, MA 02110-1301, USA.  */
-
-/* As a special exception, you may create a larger work that contains
-   part or all of the Bison parser skeleton and distribute that work
-   under terms of your choice, so long as that work isn't itself a
-   parser generator using the skeleton or a modified version thereof
-   as a parser skeleton.  Alternatively, if you modify or redistribute
-   the parser skeleton itself, you may (at your option) remove this
-   special exception, which will cause the skeleton and the resulting
-   Bison output files to be licensed under the GNU General Public
-   License without this special exception.
-
-   This special exception was added by the Free Software Foundation in
-   version 2.2 of Bison.  */
-
-/* C LALR(1) parser skeleton written by Richard Stallman, by
-   simplifying the original so-called "semantic" parser.  */
-
-/* All symbols defined below should begin with yy or YY, to avoid
-   infringing on user name space.  This should be done even for local
-   variables, as they might otherwise be expanded by user macros.
-   There are some unavoidable exceptions within include files to
-   define necessary library symbols; they are noted "INFRINGES ON
-   USER NAME SPACE" below.  */
-
-/* Identify Bison output.  */
-#define YYBISON 1
-
-/* Bison version.  */
-#define YYBISON_VERSION "2.3"
-
-/* Skeleton name.  */
-#define YYSKELETON_NAME "yacc.c"
-
-/* Pure parsers.  */
-#define YYPURE 1
-
-/* Using locations.  */
-#define YYLSP_NEEDED 0
-
-/* Substitute the variable and function names.  */
 #define yyparse __gettextparse
-#define yylex   __gettextlex
+#define yylex __gettextlex
 #define yyerror __gettexterror
-#define yylval  __gettextlval
-#define yychar  __gettextchar
+#define yylval __gettextlval
+#define yychar __gettextchar
 #define yydebug __gettextdebug
 #define yynerrs __gettextnerrs
+#define	EQUOP2	257
+#define	CMPOP2	258
+#define	ADDOP2	259
+#define	MULOP2	260
+#define	NUMBER	261
 
-
-/* Tokens.  */
-#ifndef YYTOKENTYPE
-# define YYTOKENTYPE
-   /* Put the tokens into the symbol table, so that GDB and other debuggers
-      know about them.  */
-   enum yytokentype {
-     EQUOP2 = 258,
-     CMPOP2 = 259,
-     ADDOP2 = 260,
-     MULOP2 = 261,
-     NUMBER = 262
-   };
-#endif
-/* Tokens.  */
-#define EQUOP2 258
-#define CMPOP2 259
-#define ADDOP2 260
-#define MULOP2 261
-#define NUMBER 262
-
-
-
-
-/* Copy the first part of user declarations.  */
 #line 1 "plural.y"
 
 /* Expression parsing for plural form selection.
@@ -138,44 +63,12 @@
 #define YYLEX_PARAM	&((struct parse_args *) arg)->cp
 #define YYPARSE_PARAM	arg
 
-
-/* Enabling traces.  */
-#ifndef YYDEBUG
-# define YYDEBUG 0
-#endif
-
-/* Enabling verbose error messages.  */
-#ifdef YYERROR_VERBOSE
-# undef YYERROR_VERBOSE
-# define YYERROR_VERBOSE 1
-#else
-# define YYERROR_VERBOSE 0
-#endif
-
-/* Enabling the token table.  */
-#ifndef YYTOKEN_TABLE
-# define YYTOKEN_TABLE 0
-#endif
-
-#if ! defined YYSTYPE && ! defined YYSTYPE_IS_DECLARED
-typedef union YYSTYPE
 #line 49 "plural.y"
-{
+typedef union {
   unsigned long int num;
   enum operator op;
   struct expression *exp;
-}
-/* Line 193 of yacc.c.  */
-#line 170 "plural.c"
-	YYSTYPE;
-# define yystype YYSTYPE /* obsolescent; will be withdrawn */
-# define YYSTYPE_IS_DECLARED 1
-# define YYSTYPE_IS_TRIVIAL 1
-#endif
-
-
-
-/* Copy the second part of user declarations.  */
+} YYSTYPE;
 #line 55 "plural.y"
 
 /* Prototypes for local functions.  */
@@ -274,1019 +167,432 @@
   return new_exp (3, op, args);
 }
 
+#include <stdio.h>
 
-
-/* Line 216 of yacc.c.  */
-#line 281 "plural.c"
-
-#ifdef short
-# undef short
+#ifndef __cplusplus
+#ifndef __STDC__
+#define const
 #endif
-
-#ifdef YYTYPE_UINT8
-typedef YYTYPE_UINT8 yytype_uint8;
-#else
-typedef unsigned char yytype_uint8;
 #endif
 
-#ifdef YYTYPE_INT8
-typedef YYTYPE_INT8 yytype_int8;
-#elif (defined __STDC__ || defined __C99__FUNC__ \
-     || defined __cplusplus || defined _MSC_VER)
-typedef signed char yytype_int8;
-#else
-typedef short int yytype_int8;
-#endif
 
-#ifdef YYTYPE_UINT16
-typedef YYTYPE_UINT16 yytype_uint16;
-#else
-typedef unsigned short int yytype_uint16;
-#endif
 
-#ifdef YYTYPE_INT16
-typedef YYTYPE_INT16 yytype_int16;
-#else
-typedef short int yytype_int16;
-#endif
+#define	YYFINAL		27
+#define	YYFLAG		-32768
+#define	YYNTBASE	16
+
+#define YYTRANSLATE(x) ((unsigned)(x) <= 261 ? yytranslate[x] : 18)
+
+static const char yytranslate[] = {     0,
+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+     2,     2,    10,     2,     2,     2,     2,     5,     2,    14,
+    15,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+     2,     2,     2,     2,     2,     2,     2,    12,     2,     2,
+     2,     2,     3,     2,     2,     2,     2,     2,     2,     2,
+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+     2,     2,     2,     2,     2,     2,     2,     2,     2,    13,
+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+     2,     2,     2,     4,     2,     2,     2,     2,     2,     2,
+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+     2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+     2,     2,     2,     2,     2,     1,     6,     7,     8,     9,
+    11
+};
 
-#ifndef YYSIZE_T
-# ifdef __SIZE_TYPE__
-#  define YYSIZE_T __SIZE_TYPE__
-# elif defined size_t
-#  define YYSIZE_T size_t
-# elif ! defined YYSIZE_T && (defined __STDC__ || defined __C99__FUNC__ \
-     || defined __cplusplus || defined _MSC_VER)
-#  include <stddef.h> /* INFRINGES ON USER NAME SPACE */
-#  define YYSIZE_T size_t
-# else
-#  define YYSIZE_T unsigned int
-# endif
-#endif
-
-#define YYSIZE_MAXIMUM ((YYSIZE_T) -1)
-
-#ifndef YY_
-# if YYENABLE_NLS
-#  if ENABLE_NLS
-#   include <libintl.h> /* INFRINGES ON USER NAME SPACE */
-#   define YY_(msgid) dgettext ("bison-runtime", msgid)
-#  endif
-# endif
-# ifndef YY_
-#  define YY_(msgid) msgid
-# endif
-#endif
-
-/* Suppress unused-variable warnings by "using" E.  */
-#if ! defined lint || defined __GNUC__
-# define YYUSE(e) ((void) (e))
-#else
-# define YYUSE(e) /* empty */
-#endif
+#if YYDEBUG != 0
+static const short yyprhs[] = {     0,
+     0,     2,     8,    12,    16,    20,    24,    28,    32,    35,
+    37,    39
+};
+
+static const short yyrhs[] = {    17,
+     0,    17,     3,    17,    12,    17,     0,    17,     4,    17,
+     0,    17,     5,    17,     0,    17,     6,    17,     0,    17,
+     7,    17,     0,    17,     8,    17,     0,    17,     9,    17,
+     0,    10,    17,     0,    13,     0,    11,     0,    14,    17,
+    15,     0
+};
 
-/* Identity function, used to suppress warnings about constant conditions.  */
-#ifndef lint
-# define YYID(n) (n)
-#else
-#if (defined __STDC__ || defined __C99__FUNC__ \
-     || defined __cplusplus || defined _MSC_VER)
-static int
-YYID (int i)
-#else
-static int
-YYID (i)
-    int i;
 #endif
-{
-  return i;
-}
+
+#if YYDEBUG != 0
+static const short yyrline[] = { 0,
+   174,   182,   186,   190,   194,   198,   202,   206,   210,   214,
+   218,   223
+};
 #endif
 
-#if ! defined yyoverflow || YYERROR_VERBOSE
 
-/* The parser invokes alloca or malloc; define the necessary symbols.  */
+#if YYDEBUG != 0 || defined (YYERROR_VERBOSE)
 
-# ifdef YYSTACK_USE_ALLOCA
-#  if YYSTACK_USE_ALLOCA
-#   ifdef __GNUC__
-#    define YYSTACK_ALLOC __builtin_alloca
-#   elif defined __BUILTIN_VA_ARG_INCR
-#    include <alloca.h> /* INFRINGES ON USER NAME SPACE */
-#   elif defined _AIX
-#    define YYSTACK_ALLOC __alloca
-#   elif defined _MSC_VER
-#    include <malloc.h> /* INFRINGES ON USER NAME SPACE */
-#    define alloca _alloca
-#   else
-#    define YYSTACK_ALLOC alloca
-#    if ! defined _ALLOCA_H && ! defined _STDLIB_H && (defined __STDC__ || defined __C99__FUNC__ \
-     || defined __cplusplus || defined _MSC_VER)
-#     include <stdlib.h> /* INFRINGES ON USER NAME SPACE */
-#     ifndef _STDLIB_H
-#      define _STDLIB_H 1
-#     endif
-#    endif
-#   endif
-#  endif
-# endif
-
-# ifdef YYSTACK_ALLOC
-   /* Pacify GCC's `empty if-body' warning.  */
-#  define YYSTACK_FREE(Ptr) do { /* empty */; } while (YYID (0))
-#  ifndef YYSTACK_ALLOC_MAXIMUM
-    /* The OS might guarantee only one guard page at the bottom of the stack,
-       and a page size can be as small as 4096 bytes.  So we cannot safely
-       invoke alloca (N) if N exceeds 4096.  Use a slightly smaller number
-       to allow for a few compiler-allocated temporary stack slots.  */
-#   define YYSTACK_ALLOC_MAXIMUM 4032 /* reasonable circa 2006 */
-#  endif
-# else
-#  define YYSTACK_ALLOC YYMALLOC
-#  define YYSTACK_FREE YYFREE
-#  ifndef YYSTACK_ALLOC_MAXIMUM
-#   define YYSTACK_ALLOC_MAXIMUM YYSIZE_MAXIMUM
-#  endif
-#  if (defined __cplusplus && ! defined _STDLIB_H \
-       && ! ((defined YYMALLOC || defined malloc) \
-	     && (defined YYFREE || defined free)))
-#   include <stdlib.h> /* INFRINGES ON USER NAME SPACE */
-#   ifndef _STDLIB_H
-#    define _STDLIB_H 1
-#   endif
-#  endif
-#  ifndef YYMALLOC
-#   define YYMALLOC malloc
-#   if ! defined malloc && ! defined _STDLIB_H && (defined __STDC__ || defined __C99__FUNC__ \
-     || defined __cplusplus || defined _MSC_VER)
-void *malloc (YYSIZE_T); /* INFRINGES ON USER NAME SPACE */
-#   endif
-#  endif
-#  ifndef YYFREE
-#   define YYFREE free
-#   if ! defined free && ! defined _STDLIB_H && (defined __STDC__ || defined __C99__FUNC__ \
-     || defined __cplusplus || defined _MSC_VER)
-void free (void *); /* INFRINGES ON USER NAME SPACE */
-#   endif
-#  endif
-# endif
-#endif /* ! defined yyoverflow || YYERROR_VERBOSE */
-
-
-#if (! defined yyoverflow \
-     && (! defined __cplusplus \
-	 || (defined YYSTYPE_IS_TRIVIAL && YYSTYPE_IS_TRIVIAL)))
-
-/* A type that is properly aligned for any stack member.  */
-union yyalloc
-{
-  yytype_int16 yyss;
-  YYSTYPE yyvs;
-  };
-
-/* The size of the maximum gap between one aligned stack and the next.  */
-# define YYSTACK_GAP_MAXIMUM (sizeof (union yyalloc) - 1)
-
-/* The size of an array large to enough to hold all stacks, each with
-   N elements.  */
-# define YYSTACK_BYTES(N) \
-     ((N) * (sizeof (yytype_int16) + sizeof (YYSTYPE)) \
-      + YYSTACK_GAP_MAXIMUM)
-
-/* Copy COUNT objects from FROM to TO.  The source and destination do
-   not overlap.  */
-# ifndef YYCOPY
-#  if defined __GNUC__ && 1 < __GNUC__
-#   define YYCOPY(To, From, Count) \
-      __builtin_memcpy (To, From, (Count) * sizeof (*(From)))
-#  else
-#   define YYCOPY(To, From, Count)		\
-      do					\
-	{					\
-	  YYSIZE_T yyi;				\
-	  for (yyi = 0; yyi < (Count); yyi++)	\
-	    (To)[yyi] = (From)[yyi];		\
-	}					\
-      while (YYID (0))
-#  endif
-# endif
-
-/* Relocate STACK from its old location to the new one.  The
-   local variables YYSIZE and YYSTACKSIZE give the old and new number of
-   elements in the stack, and YYPTR gives the new location of the
-   stack.  Advance YYPTR to a properly aligned location for the next
-   stack.  */
-# define YYSTACK_RELOCATE(Stack)					\
-    do									\
-      {									\
-	YYSIZE_T yynewbytes;						\
-	YYCOPY (&yyptr->Stack, Stack, yysize);				\
-	Stack = &yyptr->Stack;						\
-	yynewbytes = yystacksize * sizeof (*Stack) + YYSTACK_GAP_MAXIMUM; \
-	yyptr += yynewbytes / sizeof (*yyptr);				\
-      }									\
-    while (YYID (0))
-
-#endif
-
-/* YYFINAL -- State number of the termination state.  */
-#define YYFINAL  9
-/* YYLAST -- Last index in YYTABLE.  */
-#define YYLAST   54
-
-/* YYNTOKENS -- Number of terminals.  */
-#define YYNTOKENS  16
-/* YYNNTS -- Number of nonterminals.  */
-#define YYNNTS  3
-/* YYNRULES -- Number of rules.  */
-#define YYNRULES  13
-/* YYNRULES -- Number of states.  */
-#define YYNSTATES  27
-
-/* YYTRANSLATE(YYLEX) -- Bison symbol number corresponding to YYLEX.  */
-#define YYUNDEFTOK  2
-#define YYMAXUTOK   262
-
-#define YYTRANSLATE(YYX)						\
-  ((unsigned int) (YYX) <= YYMAXUTOK ? yytranslate[YYX] : YYUNDEFTOK)
-
-/* YYTRANSLATE[YYLEX] -- Bison symbol number corresponding to YYLEX.  */
-static const yytype_uint8 yytranslate[] =
-{
-       0,     2,     2,     2,     2,     2,     2,     2,     2,     2,
-       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
-       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
-       2,     2,     2,    10,     2,     2,     2,     2,     5,     2,
-      14,    15,     2,     2,     2,     2,     2,     2,     2,     2,
-       2,     2,     2,     2,     2,     2,     2,     2,    12,     2,
-       2,     2,     2,     3,     2,     2,     2,     2,     2,     2,
-       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
-       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
-       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
-       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
-      13,     2,     2,     2,     2,     2,     2,     2,     2,     2,
-       2,     2,     2,     2,     4,     2,     2,     2,     2,     2,
-       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
-       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
-       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
-       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
-       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
-       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
-       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
-       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
-       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
-       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
-       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
-       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
-       2,     2,     2,     2,     2,     2,     1,     2,     6,     7,
-       8,     9,    11
+static const char * const yytname[] = {   "$","error","$undefined.","'?'","'|'",
+"'&'","EQUOP2","CMPOP2","ADDOP2","MULOP2","'!'","NUMBER","':'","'n'","'('","')'",
+"start","exp", NULL
 };
+#endif
 
-#if YYDEBUG
-/* YYPRHS[YYN] -- Index of the first RHS symbol of rule number YYN in
-   YYRHS.  */
-static const yytype_uint8 yyprhs[] =
-{
-       0,     0,     3,     5,    11,    15,    19,    23,    27,    31,
-      35,    38,    40,    42
+static const short yyr1[] = {     0,
+    16,    17,    17,    17,    17,    17,    17,    17,    17,    17,
+    17,    17
 };
 
-/* YYRHS -- A `-1'-separated list of the rules' RHS.  */
-static const yytype_int8 yyrhs[] =
-{
-      17,     0,    -1,    18,    -1,    18,     3,    18,    12,    18,
-      -1,    18,     4,    18,    -1,    18,     5,    18,    -1,    18,
-       6,    18,    -1,    18,     7,    18,    -1,    18,     8,    18,
-      -1,    18,     9,    18,    -1,    10,    18,    -1,    13,    -1,
-      11,    -1,    14,    18,    15,    -1
+static const short yyr2[] = {     0,
+     1,     5,     3,     3,     3,     3,     3,     3,     2,     1,
+     1,     3
 };
 
-/* YYRLINE[YYN] -- source line where rule number YYN was defined.  */
-static const yytype_uint8 yyrline[] =
-{
-       0,   174,   174,   182,   186,   190,   194,   198,   202,   206,
-     210,   214,   218,   223
+static const short yydefact[] = {     0,
+     0,    11,    10,     0,     1,     9,     0,     0,     0,     0,
+     0,     0,     0,     0,    12,     0,     3,     4,     5,     6,
+     7,     8,     0,     2,     0,     0,     0
 };
-#endif
 
-#if YYDEBUG || YYERROR_VERBOSE || YYTOKEN_TABLE
-/* YYTNAME[SYMBOL-NUM] -- String name of the symbol SYMBOL-NUM.
-   First, the terminals, then, starting at YYNTOKENS, nonterminals.  */
-static const char *const yytname[] =
-{
-  "$end", "error", "$undefined", "'?'", "'|'", "'&'", "EQUOP2", "CMPOP2",
-  "ADDOP2", "MULOP2", "'!'", "NUMBER", "':'", "'n'", "'('", "')'",
-  "$accept", "start", "exp", 0
+static const short yydefgoto[] = {    25,
+     5
 };
-#endif
 
-# ifdef YYPRINT
-/* YYTOKNUM[YYLEX-NUM] -- Internal token number corresponding to
-   token YYLEX-NUM.  */
-static const yytype_uint16 yytoknum[] =
-{
-       0,   256,   257,    63,   124,    38,   258,   259,   260,   261,
-      33,   262,    58,   110,    40,    41
+static const short yypact[] = {    -9,
+    -9,-32768,-32768,    -9,    34,-32768,    11,    -9,    -9,    -9,
+    -9,    -9,    -9,    -9,-32768,    24,    39,    43,    16,    26,
+    -3,-32768,    -9,    34,    21,    53,-32768
 };
-# endif
 
-/* YYR1[YYN] -- Symbol number of symbol that rule YYN derives.  */
-static const yytype_uint8 yyr1[] =
-{
-       0,    16,    17,    18,    18,    18,    18,    18,    18,    18,
-      18,    18,    18,    18
+static const short yypgoto[] = {-32768,
+    -1
 };
 
-/* YYR2[YYN] -- Number of symbols composing right hand side of rule YYN.  */
-static const yytype_uint8 yyr2[] =
-{
-       0,     2,     1,     5,     3,     3,     3,     3,     3,     3,
-       2,     1,     1,     3
-};
 
-/* YYDEFACT[STATE-NAME] -- Default rule to reduce with in state
-   STATE-NUM when YYTABLE doesn't specify something else to do.  Zero
-   means the default is an error.  */
-static const yytype_uint8 yydefact[] =
-{
-       0,     0,    12,    11,     0,     0,     2,    10,     0,     1,
-       0,     0,     0,     0,     0,     0,     0,    13,     0,     4,
-       5,     6,     7,     8,     9,     0,     3
-};
+#define	YYLAST		53
 
-/* YYDEFGOTO[NTERM-NUM].  */
-static const yytype_int8 yydefgoto[] =
-{
-      -1,     5,     6
-};
 
-/* YYPACT[STATE-NUM] -- Index in YYTABLE of the portion describing
-   STATE-NUM.  */
-#define YYPACT_NINF -10
-static const yytype_int8 yypact[] =
-{
-      -9,    -9,   -10,   -10,    -9,     8,    36,   -10,    13,   -10,
-      -9,    -9,    -9,    -9,    -9,    -9,    -9,   -10,    26,    41,
-      45,    18,    -2,    14,   -10,    -9,    36
+static const short yytable[] = {     6,
+     1,     2,     7,     3,     4,    14,    16,    17,    18,    19,
+    20,    21,    22,     8,     9,    10,    11,    12,    13,    14,
+    26,    24,    12,    13,    14,    15,     8,     9,    10,    11,
+    12,    13,    14,    13,    14,    23,     8,     9,    10,    11,
+    12,    13,    14,    10,    11,    12,    13,    14,    11,    12,
+    13,    14,    27
 };
 
-/* YYPGOTO[NTERM-NUM].  */
-static const yytype_int8 yypgoto[] =
-{
-     -10,   -10,    -1
+static const short yycheck[] = {     1,
+    10,    11,     4,    13,    14,     9,     8,     9,    10,    11,
+    12,    13,    14,     3,     4,     5,     6,     7,     8,     9,
+     0,    23,     7,     8,     9,    15,     3,     4,     5,     6,
+     7,     8,     9,     8,     9,    12,     3,     4,     5,     6,
+     7,     8,     9,     5,     6,     7,     8,     9,     6,     7,
+     8,     9,     0
 };
+#define YYPURE 1
 
-/* YYTABLE[YYPACT[STATE-NUM]].  What to do in state STATE-NUM.  If
-   positive, shift that token.  If negative, reduce the rule which
-   number is the opposite.  If zero, do what YYDEFACT says.
-   If YYTABLE_NINF, syntax error.  */
-#define YYTABLE_NINF -1
-static const yytype_uint8 yytable[] =
-{
-       7,     1,     2,     8,     3,     4,    15,    16,     9,    18,
-      19,    20,    21,    22,    23,    24,    10,    11,    12,    13,
-      14,    15,    16,    16,    26,    14,    15,    16,    17,    10,
-      11,    12,    13,    14,    15,    16,     0,     0,    25,    10,
-      11,    12,    13,    14,    15,    16,    12,    13,    14,    15,
-      16,    13,    14,    15,    16
-};
+/* -*-C-*-  Note some compilers choke on comments on `#line' lines.  */
+#line 3 "/usr/local/share/bison.simple"
+/* This file comes from bison-1.28.  */
 
-static const yytype_int8 yycheck[] =
-{
-       1,    10,    11,     4,    13,    14,     8,     9,     0,    10,
-      11,    12,    13,    14,    15,    16,     3,     4,     5,     6,
-       7,     8,     9,     9,    25,     7,     8,     9,    15,     3,
-       4,     5,     6,     7,     8,     9,    -1,    -1,    12,     3,
-       4,     5,     6,     7,     8,     9,     5,     6,     7,     8,
-       9,     6,     7,     8,     9
-};
+/* Skeleton output parser for bison,
+   Copyright (C) 1984, 1989, 1990 Free Software Foundation, Inc.
 
-/* YYSTOS[STATE-NUM] -- The (internal number of the) accessing
-   symbol of state STATE-NUM.  */
-static const yytype_uint8 yystos[] =
-{
-       0,    10,    11,    13,    14,    17,    18,    18,    18,     0,
-       3,     4,     5,     6,     7,     8,     9,    15,    18,    18,
-      18,    18,    18,    18,    18,    12,    18
-};
+   This program is free software; you can redistribute it and/or modify
+   it under the terms of the GNU General Public License as published by
+   the Free Software Foundation; either version 2, or (at your option)
+   any later version.
+
+   This program is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+   GNU General Public License for more details.
+
+   You should have received a copy of the GNU General Public License
+   along with this program; if not, write to the Free Software
+   Foundation, Inc., 59 Temple Place - Suite 330,
+   Boston, MA 02111-1307, USA.  */
+
+/* As a special exception, when this file is copied by Bison into a
+   Bison output file, you may use that output file without restriction.
+   This special exception was added by the Free Software Foundation
+   in version 1.24 of Bison.  */
+
+/* This is the parser code that is written into each bison parser
+  when the %semantic_parser declaration is not specified in the grammar.
+  It was written by Richard Stallman by simplifying the hairy parser
+  used when %semantic_parser is specified.  */
+
+#ifndef YYSTACK_USE_ALLOCA
+#ifdef alloca
+#define YYSTACK_USE_ALLOCA
+#else /* alloca not defined */
+#ifdef __GNUC__
+#define YYSTACK_USE_ALLOCA
+#define alloca __builtin_alloca
+#else /* not GNU C.  */
+#if (!defined (__STDC__) && defined (sparc)) || defined (__sparc__) || defined (__sparc) || defined (__sgi) || (defined (__sun) && defined (__i386))
+#define YYSTACK_USE_ALLOCA
+#include <alloca.h>
+#else /* not sparc */
+/* We think this test detects Watcom and Microsoft C.  */
+/* This used to test MSDOS, but that is a bad idea
+   since that symbol is in the user namespace.  */
+#if (defined (_MSDOS) || defined (_MSDOS_)) && !defined (__TURBOC__)
+#if 0 /* No need for malloc.h, which pollutes the namespace;
+	 instead, just don't use alloca.  */
+#include <malloc.h>
+#endif
+#else /* not MSDOS, or __TURBOC__ */
+#if defined(_AIX)
+/* I don't know what this was needed for, but it pollutes the namespace.
+   So I turned it off.   rms, 2 May 1997.  */
+/* #include <malloc.h>  */
+ #pragma alloca
+#define YYSTACK_USE_ALLOCA
+#else /* not MSDOS, or __TURBOC__, or _AIX */
+#if 0
+#ifdef __hpux /* haible@ilog.fr says this works for HPUX 9.05 and up,
+		 and on HPUX 10.  Eventually we can turn this on.  */
+#define YYSTACK_USE_ALLOCA
+#define alloca __builtin_alloca
+#endif /* __hpux */
+#endif
+#endif /* not _AIX */
+#endif /* not MSDOS, or __TURBOC__ */
+#endif /* not sparc */
+#endif /* not GNU C */
+#endif /* alloca not defined */
+#endif /* YYSTACK_USE_ALLOCA not defined */
+
+#ifdef YYSTACK_USE_ALLOCA
+#define YYSTACK_ALLOC alloca
+#else
+#define YYSTACK_ALLOC malloc
+#endif
+
+/* Note: there must be only one dollar sign in this file.
+   It is replaced by the list of actions, each action
+   as one case of the switch.  */
 
 #define yyerrok		(yyerrstatus = 0)
 #define yyclearin	(yychar = YYEMPTY)
-#define YYEMPTY		(-2)
+#define YYEMPTY		-2
 #define YYEOF		0
-
 #define YYACCEPT	goto yyacceptlab
-#define YYABORT		goto yyabortlab
-#define YYERROR		goto yyerrorlab
-
-
-/* Like YYERROR except do call yyerror.  This remains here temporarily
-   to ease the transition to the new meaning of YYERROR, for GCC.
+#define YYABORT 	goto yyabortlab
+#define YYERROR		goto yyerrlab1
+/* Like YYERROR except do call yyerror.
+   This remains here temporarily to ease the
+   transition to the new meaning of YYERROR, for GCC.
    Once GCC version 2 has supplanted version 1, this can go.  */
-
 #define YYFAIL		goto yyerrlab
-
 #define YYRECOVERING()  (!!yyerrstatus)
-
-#define YYBACKUP(Token, Value)					\
+#define YYBACKUP(token, value) \
 do								\
   if (yychar == YYEMPTY && yylen == 1)				\
-    {								\
-      yychar = (Token);						\
-      yylval = (Value);						\
-      yytoken = YYTRANSLATE (yychar);				\
-      YYPOPSTACK (1);						\
+    { yychar = (token), yylval = (value);			\
+      yychar1 = YYTRANSLATE (yychar);				\
+      YYPOPSTACK;						\
       goto yybackup;						\
     }								\
   else								\
-    {								\
-      yyerror (YY_("syntax error: cannot back up")); \
-      YYERROR;							\
-    }								\
-while (YYID (0))
-
+    { yyerror ("syntax error: cannot back up"); YYERROR; }	\
+while (0)
 
 #define YYTERROR	1
 #define YYERRCODE	256
 
-
-/* YYLLOC_DEFAULT -- Set CURRENT to span from RHS[1] to RHS[N].
-   If N is 0, then set CURRENT to the empty location which ends
-   the previous symbol: RHS[0] (always defined).  */
-
-#define YYRHSLOC(Rhs, K) ((Rhs)[K])
-#ifndef YYLLOC_DEFAULT
-# define YYLLOC_DEFAULT(Current, Rhs, N)				\
-    do									\
-      if (YYID (N))                                                    \
-	{								\
-	  (Current).first_line   = YYRHSLOC (Rhs, 1).first_line;	\
-	  (Current).first_column = YYRHSLOC (Rhs, 1).first_column;	\
-	  (Current).last_line    = YYRHSLOC (Rhs, N).last_line;		\
-	  (Current).last_column  = YYRHSLOC (Rhs, N).last_column;	\
-	}								\
-      else								\
-	{								\
-	  (Current).first_line   = (Current).last_line   =		\
-	    YYRHSLOC (Rhs, 0).last_line;				\
-	  (Current).first_column = (Current).last_column =		\
-	    YYRHSLOC (Rhs, 0).last_column;				\
-	}								\
-    while (YYID (0))
-#endif
-
-
-/* YY_LOCATION_PRINT -- Print the location on the stream.
-   This macro was not mandated originally: define only if we know
-   we won't break user code: when these are the locations we know.  */
-
-#ifndef YY_LOCATION_PRINT
-# if YYLTYPE_IS_TRIVIAL
-#  define YY_LOCATION_PRINT(File, Loc)			\
-     fprintf (File, "%d.%d-%d.%d",			\
-	      (Loc).first_line, (Loc).first_column,	\
-	      (Loc).last_line,  (Loc).last_column)
-# else
-#  define YY_LOCATION_PRINT(File, Loc) ((void) 0)
-# endif
+#ifndef YYPURE
+#define YYLEX		yylex()
 #endif
 
-
-/* YYLEX -- calling `yylex' with the right arguments.  */
-
+#ifdef YYPURE
+#ifdef YYLSP_NEEDED
 #ifdef YYLEX_PARAM
-# define YYLEX yylex (&yylval, YYLEX_PARAM)
+#define YYLEX		yylex(&yylval, &yylloc, YYLEX_PARAM)
 #else
-# define YYLEX yylex (&yylval)
+#define YYLEX		yylex(&yylval, &yylloc)
 #endif
-
-/* Enable debugging if requested.  */
-#if YYDEBUG
-
-# ifndef YYFPRINTF
-#  include <stdio.h> /* INFRINGES ON USER NAME SPACE */
-#  define YYFPRINTF fprintf
-# endif
-
-# define YYDPRINTF(Args)			\
-do {						\
-  if (yydebug)					\
-    YYFPRINTF Args;				\
-} while (YYID (0))
-
-# define YY_SYMBOL_PRINT(Title, Type, Value, Location)			  \
-do {									  \
-  if (yydebug)								  \
-    {									  \
-      YYFPRINTF (stderr, "%s ", Title);					  \
-      yy_symbol_print (stderr,						  \
-		  Type, Value); \
-      YYFPRINTF (stderr, "\n");						  \
-    }									  \
-} while (YYID (0))
-
-
-/*--------------------------------.
-| Print this symbol on YYOUTPUT.  |
-`--------------------------------*/
-
-/*ARGSUSED*/
-#if (defined __STDC__ || defined __C99__FUNC__ \
-     || defined __cplusplus || defined _MSC_VER)
-static void
-yy_symbol_value_print (FILE *yyoutput, int yytype, YYSTYPE const * const yyvaluep)
+#else /* not YYLSP_NEEDED */
+#ifdef YYLEX_PARAM
+#define YYLEX		yylex(&yylval, YYLEX_PARAM)
 #else
-static void
-yy_symbol_value_print (yyoutput, yytype, yyvaluep)
-    FILE *yyoutput;
-    int yytype;
-    YYSTYPE const * const yyvaluep;
+#define YYLEX		yylex(&yylval)
 #endif
-{
-  if (!yyvaluep)
-    return;
-# ifdef YYPRINT
-  if (yytype < YYNTOKENS)
-    YYPRINT (yyoutput, yytoknum[yytype], *yyvaluep);
-# else
-  YYUSE (yyoutput);
-# endif
-  switch (yytype)
-    {
-      default:
-	break;
-    }
-}
-
-
-/*--------------------------------.
-| Print this symbol on YYOUTPUT.  |
-`--------------------------------*/
-
-#if (defined __STDC__ || defined __C99__FUNC__ \
-     || defined __cplusplus || defined _MSC_VER)
-static void
-yy_symbol_print (FILE *yyoutput, int yytype, YYSTYPE const * const yyvaluep)
-#else
-static void
-yy_symbol_print (yyoutput, yytype, yyvaluep)
-    FILE *yyoutput;
-    int yytype;
-    YYSTYPE const * const yyvaluep;
+#endif /* not YYLSP_NEEDED */
 #endif
-{
-  if (yytype < YYNTOKENS)
-    YYFPRINTF (yyoutput, "token %s (", yytname[yytype]);
-  else
-    YYFPRINTF (yyoutput, "nterm %s (", yytname[yytype]);
 
-  yy_symbol_value_print (yyoutput, yytype, yyvaluep);
-  YYFPRINTF (yyoutput, ")");
-}
+/* If nonreentrant, generate the variables here */
 
-/*------------------------------------------------------------------.
-| yy_stack_print -- Print the state stack from its BOTTOM up to its |
-| TOP (included).                                                   |
-`------------------------------------------------------------------*/
+#ifndef YYPURE
 
-#if (defined __STDC__ || defined __C99__FUNC__ \
-     || defined __cplusplus || defined _MSC_VER)
-static void
-yy_stack_print (yytype_int16 *bottom, yytype_int16 *top)
-#else
-static void
-yy_stack_print (bottom, top)
-    yytype_int16 *bottom;
-    yytype_int16 *top;
-#endif
-{
-  YYFPRINTF (stderr, "Stack now");
-  for (; bottom <= top; ++bottom)
-    YYFPRINTF (stderr, " %d", *bottom);
-  YYFPRINTF (stderr, "\n");
-}
-
-# define YY_STACK_PRINT(Bottom, Top)				\
-do {								\
-  if (yydebug)							\
-    yy_stack_print ((Bottom), (Top));				\
-} while (YYID (0))
+int	yychar;			/*  the lookahead symbol		*/
+YYSTYPE	yylval;			/*  the semantic value of the		*/
+				/*  lookahead symbol			*/
 
+#ifdef YYLSP_NEEDED
+YYLTYPE yylloc;			/*  location data for the lookahead	*/
+				/*  symbol				*/
+#endif
 
-/*------------------------------------------------.
-| Report that the YYRULE is going to be reduced.  |
-`------------------------------------------------*/
+int yynerrs;			/*  number of parse errors so far       */
+#endif  /* not YYPURE */
 
-#if (defined __STDC__ || defined __C99__FUNC__ \
-     || defined __cplusplus || defined _MSC_VER)
-static void
-yy_reduce_print (YYSTYPE *yyvsp, int yyrule)
-#else
-static void
-yy_reduce_print (yyvsp, yyrule)
-    YYSTYPE *yyvsp;
-    int yyrule;
+#if YYDEBUG != 0
+int yydebug;			/*  nonzero means print parse trace	*/
+/* Since this is uninitialized, it does not stop multiple parsers
+   from coexisting.  */
 #endif
-{
-  int yynrhs = yyr2[yyrule];
-  int yyi;
-  unsigned long int yylno = yyrline[yyrule];
-  YYFPRINTF (stderr, "Reducing stack by rule %d (line %lu):\n",
-	     yyrule - 1, yylno);
-  /* The symbols being reduced.  */
-  for (yyi = 0; yyi < yynrhs; yyi++)
-    {
-      fprintf (stderr, "   $%d = ", yyi + 1);
-      yy_symbol_print (stderr, yyrhs[yyprhs[yyrule] + yyi],
-		       &(yyvsp[(yyi + 1) - (yynrhs)])
-		       		       );
-      fprintf (stderr, "\n");
-    }
-}
-
-# define YY_REDUCE_PRINT(Rule)		\
-do {					\
-  if (yydebug)				\
-    yy_reduce_print (yyvsp, Rule); \
-} while (YYID (0))
-
-/* Nonzero means print parse trace.  It is left uninitialized so that
-   multiple parsers can coexist.  */
-int yydebug;
-#else /* !YYDEBUG */
-# define YYDPRINTF(Args)
-# define YY_SYMBOL_PRINT(Title, Type, Value, Location)
-# define YY_STACK_PRINT(Bottom, Top)
-# define YY_REDUCE_PRINT(Rule)
-#endif /* !YYDEBUG */
 
+/*  YYINITDEPTH indicates the initial size of the parser's stacks	*/
 
-/* YYINITDEPTH -- initial size of the parser's stacks.  */
 #ifndef	YYINITDEPTH
-# define YYINITDEPTH 200
+#define YYINITDEPTH 200
 #endif
 
-/* YYMAXDEPTH -- maximum size the stacks can grow to (effective only
-   if the built-in stack extension method is used).
+/*  YYMAXDEPTH is the maximum size the stacks can grow to
+    (effective only if the built-in stack extension method is used).  */
 
-   Do not make this value too large; the results are undefined if
-   YYSTACK_ALLOC_MAXIMUM < YYSTACK_BYTES (YYMAXDEPTH)
-   evaluated with infinite-precision integer arithmetic.  */
+#if YYMAXDEPTH == 0
+#undef YYMAXDEPTH
+#endif
 
 #ifndef YYMAXDEPTH
-# define YYMAXDEPTH 10000
+#define YYMAXDEPTH 10000
 #endif
-
 
+/* Define __yy_memcpy.  Note that the size argument
+   should be passed with type unsigned int, because that is what the non-GCC
+   definitions require.  With GCC, __builtin_memcpy takes an arg
+   of type size_t, but it can handle unsigned int.  */
+
+#if __GNUC__ > 1		/* GNU C and GNU C++ define this.  */
+#define __yy_memcpy(TO,FROM,COUNT)	__builtin_memcpy(TO,FROM,COUNT)
+#else				/* not GNU C or C++ */
+#ifndef __cplusplus
 
-#if YYERROR_VERBOSE
-
-# ifndef yystrlen
-#  if defined __GLIBC__ && defined _STRING_H
-#   define yystrlen strlen
-#  else
-/* Return the length of YYSTR.  */
-#if (defined __STDC__ || defined __C99__FUNC__ \
-     || defined __cplusplus || defined _MSC_VER)
-static YYSIZE_T
-yystrlen (const char *yystr)
-#else
-static YYSIZE_T
-yystrlen (yystr)
-    const char *yystr;
-#endif
-{
-  YYSIZE_T yylen;
-  for (yylen = 0; yystr[yylen]; yylen++)
-    continue;
-  return yylen;
-}
-#  endif
-# endif
-
-# ifndef yystpcpy
-#  if defined __GLIBC__ && defined _STRING_H && defined _GNU_SOURCE
-#   define yystpcpy stpcpy
-#  else
-/* Copy YYSRC to YYDEST, returning the address of the terminating '\0' in
-   YYDEST.  */
-#if (defined __STDC__ || defined __C99__FUNC__ \
-     || defined __cplusplus || defined _MSC_VER)
-static char *
-yystpcpy (char *yydest, const char *yysrc)
-#else
-static char *
-yystpcpy (yydest, yysrc)
-    char *yydest;
-    const char *yysrc;
-#endif
-{
-  char *yyd = yydest;
-  const char *yys = yysrc;
-
-  while ((*yyd++ = *yys++) != '\0')
-    continue;
+/* This is the most reliable way to avoid incompatibilities
+   in available built-in functions on various systems.  */
+static void
+__yy_memcpy (to, from, count)
+     char *to;
+     char *from;
+     unsigned int count;
+{
+  register char *f = from;
+  register char *t = to;
+  register int i = count;
 
-  return yyd - 1;
+  while (i-- > 0)
+    *t++ = *f++;
 }
-#  endif
-# endif
-
-# ifndef yytnamerr
-/* Copy to YYRES the contents of YYSTR after stripping away unnecessary
-   quotes and backslashes, so that it's suitable for yyerror.  The
-   heuristic is that double-quoting is unnecessary unless the string
-   contains an apostrophe, a comma, or backslash (other than
-   backslash-backslash).  YYSTR is taken from yytname.  If YYRES is
-   null, do not copy; instead, return the length of what the result
-   would have been.  */
-static YYSIZE_T
-yytnamerr (char *yyres, const char *yystr)
-{
-  if (*yystr == '"')
-    {
-      YYSIZE_T yyn = 0;
-      char const *yyp = yystr;
 
-      for (;;)
-	switch (*++yyp)
-	  {
-	  case '\'':
-	  case ',':
-	    goto do_not_strip_quotes;
-
-	  case '\\':
-	    if (*++yyp != '\\')
-	      goto do_not_strip_quotes;
-	    /* Fall through.  */
-	  default:
-	    if (yyres)
-	      yyres[yyn] = *yyp;
-	    yyn++;
-	    break;
-
-	  case '"':
-	    if (yyres)
-	      yyres[yyn] = '\0';
-	    return yyn;
-	  }
-    do_not_strip_quotes: ;
-    }
-
-  if (! yyres)
-    return yystrlen (yystr);
+#else /* __cplusplus */
 
-  return yystpcpy (yyres, yystr) - yyres;
-}
-# endif
-
-/* Copy into YYRESULT an error message about the unexpected token
-   YYCHAR while in state YYSTATE.  Return the number of bytes copied,
-   including the terminating null byte.  If YYRESULT is null, do not
-   copy anything; just return the number of bytes that would be
-   copied.  As a special case, return 0 if an ordinary "syntax error"
-   message will do.  Return YYSIZE_MAXIMUM if overflow occurs during
-   size calculation.  */
-static YYSIZE_T
-yysyntax_error (char *yyresult, int yystate, int yychar)
+/* This is the most reliable way to avoid incompatibilities
+   in available built-in functions on various systems.  */
+static void
+__yy_memcpy (char *to, char *from, unsigned int count)
 {
-  int yyn = yypact[yystate];
+  register char *t = to;
+  register char *f = from;
+  register int i = count;
 
-  if (! (YYPACT_NINF < yyn && yyn <= YYLAST))
-    return 0;
-  else
-    {
-      int yytype = YYTRANSLATE (yychar);
-      YYSIZE_T yysize0 = yytnamerr (0, yytname[yytype]);
-      YYSIZE_T yysize = yysize0;
-      YYSIZE_T yysize1;
-      int yysize_overflow = 0;
-      enum { YYERROR_VERBOSE_ARGS_MAXIMUM = 5 };
-      char const *yyarg[YYERROR_VERBOSE_ARGS_MAXIMUM];
-      int yyx;
-
-# if 0
-      /* This is so xgettext sees the translatable formats that are
-	 constructed on the fly.  */
-      YY_("syntax error, unexpected %s");
-      YY_("syntax error, unexpected %s, expecting %s");
-      YY_("syntax error, unexpected %s, expecting %s or %s");
-      YY_("syntax error, unexpected %s, expecting %s or %s or %s");
-      YY_("syntax error, unexpected %s, expecting %s or %s or %s or %s");
-# endif
-      char *yyfmt;
-      char const *yyf;
-      static char const yyunexpected[] = "syntax error, unexpected %s";
-      static char const yyexpecting[] = ", expecting %s";
-      static char const yyor[] = " or %s";
-      char yyformat[sizeof yyunexpected
-		    + sizeof yyexpecting - 1
-		    + ((YYERROR_VERBOSE_ARGS_MAXIMUM - 2)
-		       * (sizeof yyor - 1))];
-      char const *yyprefix = yyexpecting;
-
-      /* Start YYX at -YYN if negative to avoid negative indexes in
-	 YYCHECK.  */
-      int yyxbegin = yyn < 0 ? -yyn : 0;
-
-      /* Stay within bounds of both yycheck and yytname.  */
-      int yychecklim = YYLAST - yyn + 1;
-      int yyxend = yychecklim < YYNTOKENS ? yychecklim : YYNTOKENS;
-      int yycount = 1;
-
-      yyarg[0] = yytname[yytype];
-      yyfmt = yystpcpy (yyformat, yyunexpected);
-
-      for (yyx = yyxbegin; yyx < yyxend; ++yyx)
-	if (yycheck[yyx + yyn] == yyx && yyx != YYTERROR)
-	  {
-	    if (yycount == YYERROR_VERBOSE_ARGS_MAXIMUM)
-	      {
-		yycount = 1;
-		yysize = yysize0;
-		yyformat[sizeof yyunexpected - 1] = '\0';
-		break;
-	      }
-	    yyarg[yycount++] = yytname[yyx];
-	    yysize1 = yysize + yytnamerr (0, yytname[yyx]);
-	    yysize_overflow |= (yysize1 < yysize);
-	    yysize = yysize1;
-	    yyfmt = yystpcpy (yyfmt, yyprefix);
-	    yyprefix = yyor;
-	  }
-
-      yyf = YY_(yyformat);
-      yysize1 = yysize + yystrlen (yyf);
-      yysize_overflow |= (yysize1 < yysize);
-      yysize = yysize1;
-
-      if (yysize_overflow)
-	return YYSIZE_MAXIMUM;
-
-      if (yyresult)
-	{
-	  /* Avoid sprintf, as that infringes on the user's name space.
-	     Don't have undefined behavior even if the translation
-	     produced a string with the wrong number of "%s"s.  */
-	  char *yyp = yyresult;
-	  int yyi = 0;
-	  while ((*yyp = *yyf) != '\0')
-	    {
-	      if (*yyp == '%' && yyf[1] == 's' && yyi < yycount)
-		{
-		  yyp += yytnamerr (yyp, yyarg[yyi++]);
-		  yyf += 2;
-		}
-	      else
-		{
-		  yyp++;
-		  yyf++;
-		}
-	    }
-	}
-      return yysize;
-    }
+  while (i-- > 0)
+    *t++ = *f++;
 }
-#endif /* YYERROR_VERBOSE */
-
 
-/*-----------------------------------------------.
-| Release the memory associated to this symbol.  |
-`-----------------------------------------------*/
-
-/*ARGSUSED*/
-#if (defined __STDC__ || defined __C99__FUNC__ \
-     || defined __cplusplus || defined _MSC_VER)
-static void
-yydestruct (const char *yymsg, int yytype, YYSTYPE *yyvaluep)
-#else
-static void
-yydestruct (yymsg, yytype, yyvaluep)
-    const char *yymsg;
-    int yytype;
-    YYSTYPE *yyvaluep;
 #endif
-{
-  YYUSE (yyvaluep);
-
-  if (!yymsg)
-    yymsg = "Deleting";
-  YY_SYMBOL_PRINT (yymsg, yytype, yyvaluep, yylocationp);
-
-  switch (yytype)
-    {
-
-      default:
-	break;
-    }
-}
+#endif
 
+#line 217 "/usr/local/share/bison.simple"
 
-/* Prevent warnings from -Wmissing-prototypes.  */
+/* The user can define YYPARSE_PARAM as the name of an argument to be passed
+   into yyparse.  The argument should have type void *.
+   It should actually point to an object.
+   Grammar actions can access the variable by casting it
+   to the proper pointer type.  */
 
 #ifdef YYPARSE_PARAM
-#if defined __STDC__ || defined __cplusplus
-int yyparse (void *YYPARSE_PARAM);
+#ifdef __cplusplus
+#define YYPARSE_PARAM_ARG void *YYPARSE_PARAM
+#define YYPARSE_PARAM_DECL
+#else /* not __cplusplus */
+#define YYPARSE_PARAM_ARG YYPARSE_PARAM
+#define YYPARSE_PARAM_DECL void *YYPARSE_PARAM;
+#endif /* not __cplusplus */
+#else /* not YYPARSE_PARAM */
+#define YYPARSE_PARAM_ARG
+#define YYPARSE_PARAM_DECL
+#endif /* not YYPARSE_PARAM */
+
+/* Prevent warning if -Wstrict-prototypes.  */
+#ifdef __GNUC__
+#ifdef YYPARSE_PARAM
+int yyparse (void *);
 #else
-int yyparse ();
-#endif
-#else /* ! YYPARSE_PARAM */
-#if defined __STDC__ || defined __cplusplus
 int yyparse (void);
-#else
-int yyparse ();
 #endif
-#endif /* ! YYPARSE_PARAM */
-
-
+#endif
 
+int
+yyparse(YYPARSE_PARAM_ARG)
+     YYPARSE_PARAM_DECL
+{
+  register int yystate;
+  register int yyn;
+  register short *yyssp;
+  register YYSTYPE *yyvsp;
+  int yyerrstatus;	/*  number of tokens to shift before error messages enabled */
+  int yychar1 = 0;		/*  lookahead token as an internal (translated) token number */
 
+  short	yyssa[YYINITDEPTH];	/*  the state stack			*/
+  YYSTYPE yyvsa[YYINITDEPTH];	/*  the semantic value stack		*/
 
+  short *yyss = yyssa;		/*  refer to the stacks thru separate pointers */
+  YYSTYPE *yyvs = yyvsa;	/*  to allow yyoverflow to reallocate them elsewhere */
 
-/*----------.
-| yyparse.  |
-`----------*/
+#ifdef YYLSP_NEEDED
+  YYLTYPE yylsa[YYINITDEPTH];	/*  the location stack			*/
+  YYLTYPE *yyls = yylsa;
+  YYLTYPE *yylsp;
 
-#ifdef YYPARSE_PARAM
-#if (defined __STDC__ || defined __C99__FUNC__ \
-     || defined __cplusplus || defined _MSC_VER)
-int
-yyparse (void *YYPARSE_PARAM)
+#define YYPOPSTACK   (yyvsp--, yyssp--, yylsp--)
 #else
-int
-yyparse (YYPARSE_PARAM)
-    void *YYPARSE_PARAM;
+#define YYPOPSTACK   (yyvsp--, yyssp--)
 #endif
-#else /* ! YYPARSE_PARAM */
-#if (defined __STDC__ || defined __C99__FUNC__ \
-     || defined __cplusplus || defined _MSC_VER)
-int
-yyparse (void)
-#else
-int
-yyparse ()
 
+  int yystacksize = YYINITDEPTH;
+  int yyfree_stacks = 0;
+
+#ifdef YYPURE
+  int yychar;
+  YYSTYPE yylval;
+  int yynerrs;
+#ifdef YYLSP_NEEDED
+  YYLTYPE yylloc;
 #endif
 #endif
-{
-  /* The look-ahead symbol.  */
-int yychar;
 
-/* The semantic value of the look-ahead symbol.  */
-YYSTYPE yylval;
+  YYSTYPE yyval;		/*  the variable used to return		*/
+				/*  semantic values from the action	*/
+				/*  routines				*/
 
-/* Number of syntax errors so far.  */
-int yynerrs;
+  int yylen;
 
-  int yystate;
-  int yyn;
-  int yyresult;
-  /* Number of tokens to shift before error messages enabled.  */
-  int yyerrstatus;
-  /* Look-ahead token as an internal (translated) token number.  */
-  int yytoken = 0;
-#if YYERROR_VERBOSE
-  /* Buffer for error messages, and its allocated size.  */
-  char yymsgbuf[128];
-  char *yymsg = yymsgbuf;
-  YYSIZE_T yymsg_alloc = sizeof yymsgbuf;
+#if YYDEBUG != 0
+  if (yydebug)
+    fprintf(stderr, "Starting parse\n");
 #endif
 
-  /* Three stacks and their tools:
-     `yyss': related to states,
-     `yyvs': related to semantic values,
-     `yyls': related to locations.
-
-     Refer to the stacks thru separate pointers, to allow yyoverflow
-     to reallocate them elsewhere.  */
-
-  /* The state stack.  */
-  yytype_int16 yyssa[YYINITDEPTH];
-  yytype_int16 *yyss = yyssa;
-  yytype_int16 *yyssp;
-
-  /* The semantic value stack.  */
-  YYSTYPE yyvsa[YYINITDEPTH];
-  YYSTYPE *yyvs = yyvsa;
-  YYSTYPE *yyvsp;
-
-
-
-#define YYPOPSTACK(N)   (yyvsp -= (N), yyssp -= (N))
-
-  YYSIZE_T yystacksize = YYINITDEPTH;
-
-  /* The variables used to return semantic value and location from the
-     action routines.  */
-  YYSTYPE yyval;
-
-
-  /* The number of symbols on the RHS of the reduced rule.
-     Keep to zero when no symbol should be popped.  */
-  int yylen = 0;
-
-  YYDPRINTF ((stderr, "Starting parse\n"));
-
   yystate = 0;
   yyerrstatus = 0;
   yynerrs = 0;
@@ -1297,493 +603,541 @@
      so that they stay on the same level as the state stack.
      The wasted elements are never initialized.  */
 
-  yyssp = yyss;
+  yyssp = yyss - 1;
   yyvsp = yyvs;
+#ifdef YYLSP_NEEDED
+  yylsp = yyls;
+#endif
 
-  goto yysetstate;
-
-/*------------------------------------------------------------.
-| yynewstate -- Push a new state, which is found in yystate.  |
-`------------------------------------------------------------*/
- yynewstate:
-  /* In all cases, when you get here, the value and location stacks
-     have just been pushed.  So pushing a state here evens the stacks.  */
-  yyssp++;
+/* Push a new state, which is found in  yystate  .  */
+/* In all cases, when you get here, the value and location stacks
+   have just been pushed. so pushing a state here evens the stacks.  */
+yynewstate:
 
- yysetstate:
-  *yyssp = yystate;
+  *++yyssp = yystate;
 
-  if (yyss + yystacksize - 1 <= yyssp)
+  if (yyssp >= yyss + yystacksize - 1)
     {
+      /* Give user a chance to reallocate the stack */
+      /* Use copies of these so that the &'s don't force the real ones into memory. */
+      YYSTYPE *yyvs1 = yyvs;
+      short *yyss1 = yyss;
+#ifdef YYLSP_NEEDED
+      YYLTYPE *yyls1 = yyls;
+#endif
+
       /* Get the current used size of the three stacks, in elements.  */
-      YYSIZE_T yysize = yyssp - yyss + 1;
+      int size = yyssp - yyss + 1;
 
 #ifdef yyoverflow
-      {
-	/* Give user a chance to reallocate the stack.  Use copies of
-	   these so that the &'s don't force the real ones into
-	   memory.  */
-	YYSTYPE *yyvs1 = yyvs;
-	yytype_int16 *yyss1 = yyss;
-
-
-	/* Each stack pointer address is followed by the size of the
-	   data in use in that stack, in bytes.  This used to be a
-	   conditional around just the two extra args, but that might
-	   be undefined if yyoverflow is a macro.  */
-	yyoverflow (YY_("memory exhausted"),
-		    &yyss1, yysize * sizeof (*yyssp),
-		    &yyvs1, yysize * sizeof (*yyvsp),
-
-		    &yystacksize);
-
-	yyss = yyss1;
-	yyvs = yyvs1;
-      }
+      /* Each stack pointer address is followed by the size of
+	 the data in use in that stack, in bytes.  */
+#ifdef YYLSP_NEEDED
+      /* This used to be a conditional around just the two extra args,
+	 but that might be undefined if yyoverflow is a macro.  */
+      yyoverflow("parser stack overflow",
+		 &yyss1, size * sizeof (*yyssp),
+		 &yyvs1, size * sizeof (*yyvsp),
+		 &yyls1, size * sizeof (*yylsp),
+		 &yystacksize);
+#else
+      yyoverflow("parser stack overflow",
+		 &yyss1, size * sizeof (*yyssp),
+		 &yyvs1, size * sizeof (*yyvsp),
+		 &yystacksize);
+#endif
+
+      yyss = yyss1; yyvs = yyvs1;
+#ifdef YYLSP_NEEDED
+      yyls = yyls1;
+#endif
 #else /* no yyoverflow */
-# ifndef YYSTACK_RELOCATE
-      goto yyexhaustedlab;
-# else
       /* Extend the stack our own way.  */
-      if (YYMAXDEPTH <= yystacksize)
-	goto yyexhaustedlab;
+      if (yystacksize >= YYMAXDEPTH)
+	{
+	  yyerror("parser stack overflow");
+	  if (yyfree_stacks)
+	    {
+	      free (yyss);
+	      free (yyvs);
+#ifdef YYLSP_NEEDED
+	      free (yyls);
+#endif
+	    }
+	  return 2;
+	}
       yystacksize *= 2;
-      if (YYMAXDEPTH < yystacksize)
+      if (yystacksize > YYMAXDEPTH)
 	yystacksize = YYMAXDEPTH;
-
-      {
-	yytype_int16 *yyss1 = yyss;
-	union yyalloc *yyptr =
-	  (union yyalloc *) YYSTACK_ALLOC (YYSTACK_BYTES (yystacksize));
-	if (! yyptr)
-	  goto yyexhaustedlab;
-	YYSTACK_RELOCATE (yyss);
-	YYSTACK_RELOCATE (yyvs);
-
-#  undef YYSTACK_RELOCATE
-	if (yyss1 != yyssa)
-	  YYSTACK_FREE (yyss1);
-      }
-# endif
+#ifndef YYSTACK_USE_ALLOCA
+      yyfree_stacks = 1;
+#endif
+      yyss = (short *) YYSTACK_ALLOC (yystacksize * sizeof (*yyssp));
+      __yy_memcpy ((char *)yyss, (char *)yyss1,
+		   size * (unsigned int) sizeof (*yyssp));
+      yyvs = (YYSTYPE *) YYSTACK_ALLOC (yystacksize * sizeof (*yyvsp));
+      __yy_memcpy ((char *)yyvs, (char *)yyvs1,
+		   size * (unsigned int) sizeof (*yyvsp));
+#ifdef YYLSP_NEEDED
+      yyls = (YYLTYPE *) YYSTACK_ALLOC (yystacksize * sizeof (*yylsp));
+      __yy_memcpy ((char *)yyls, (char *)yyls1,
+		   size * (unsigned int) sizeof (*yylsp));
+#endif
 #endif /* no yyoverflow */
 
-      yyssp = yyss + yysize - 1;
-      yyvsp = yyvs + yysize - 1;
-
+      yyssp = yyss + size - 1;
+      yyvsp = yyvs + size - 1;
+#ifdef YYLSP_NEEDED
+      yylsp = yyls + size - 1;
+#endif
 
-      YYDPRINTF ((stderr, "Stack size increased to %lu\n",
-		  (unsigned long int) yystacksize));
+#if YYDEBUG != 0
+      if (yydebug)
+	fprintf(stderr, "Stack size increased to %d\n", yystacksize);
+#endif
 
-      if (yyss + yystacksize - 1 <= yyssp)
+      if (yyssp >= yyss + yystacksize - 1)
 	YYABORT;
     }
 
-  YYDPRINTF ((stderr, "Entering state %d\n", yystate));
+#if YYDEBUG != 0
+  if (yydebug)
+    fprintf(stderr, "Entering state %d\n", yystate);
+#endif
 
   goto yybackup;
+ yybackup:
 
-/*-----------.
-| yybackup.  |
-`-----------*/
-yybackup:
+/* Do appropriate processing given the current state.  */
+/* Read a lookahead token if we need one and don't already have one.  */
+/* yyresume: */
 
-  /* Do appropriate processing given the current state.  Read a
-     look-ahead token if we need one and don't already have one.  */
+  /* First try to decide what to do without reference to lookahead token.  */
 
-  /* First try to decide what to do without reference to look-ahead token.  */
   yyn = yypact[yystate];
-  if (yyn == YYPACT_NINF)
+  if (yyn == YYFLAG)
     goto yydefault;
 
-  /* Not known => get a look-ahead token if don't already have one.  */
+  /* Not known => get a lookahead token if don't already have one.  */
+
+  /* yychar is either YYEMPTY or YYEOF
+     or a valid token in external form.  */
 
-  /* YYCHAR is either YYEMPTY or YYEOF or a valid look-ahead symbol.  */
   if (yychar == YYEMPTY)
     {
-      YYDPRINTF ((stderr, "Reading a token: "));
+#if YYDEBUG != 0
+      if (yydebug)
+	fprintf(stderr, "Reading a token: ");
+#endif
       yychar = YYLEX;
     }
 
-  if (yychar <= YYEOF)
+  /* Convert token to internal form (in yychar1) for indexing tables with */
+
+  if (yychar <= 0)		/* This means end of input. */
     {
-      yychar = yytoken = YYEOF;
-      YYDPRINTF ((stderr, "Now at end of input.\n"));
+      yychar1 = 0;
+      yychar = YYEOF;		/* Don't call YYLEX any more */
+
+#if YYDEBUG != 0
+      if (yydebug)
+	fprintf(stderr, "Now at end of input.\n");
+#endif
     }
   else
     {
-      yytoken = YYTRANSLATE (yychar);
-      YY_SYMBOL_PRINT ("Next token is", yytoken, &yylval, &yylloc);
+      yychar1 = YYTRANSLATE(yychar);
+
+#if YYDEBUG != 0
+      if (yydebug)
+	{
+	  fprintf (stderr, "Next token is %d (%s", yychar, yytname[yychar1]);
+	  /* Give the individual parser a way to print the precise meaning
+	     of a token, for further debugging info.  */
+#ifdef YYPRINT
+	  YYPRINT (stderr, yychar, yylval);
+#endif
+	  fprintf (stderr, ")\n");
+	}
+#endif
     }
 
-  /* If the proper action on seeing token YYTOKEN is to reduce or to
-     detect an error, take that action.  */
-  yyn += yytoken;
-  if (yyn < 0 || YYLAST < yyn || yycheck[yyn] != yytoken)
+  yyn += yychar1;
+  if (yyn < 0 || yyn > YYLAST || yycheck[yyn] != yychar1)
     goto yydefault;
+
   yyn = yytable[yyn];
-  if (yyn <= 0)
+
+  /* yyn is what to do for this token type in this state.
+     Negative => reduce, -yyn is rule number.
+     Positive => shift, yyn is new state.
+       New state is final state => don't bother to shift,
+       just return success.
+     0, or most negative number => error.  */
+
+  if (yyn < 0)
     {
-      if (yyn == 0 || yyn == YYTABLE_NINF)
+      if (yyn == YYFLAG)
 	goto yyerrlab;
       yyn = -yyn;
       goto yyreduce;
     }
+  else if (yyn == 0)
+    goto yyerrlab;
 
   if (yyn == YYFINAL)
     YYACCEPT;
 
-  /* Count tokens shifted since error; after three, turn off error
-     status.  */
-  if (yyerrstatus)
-    yyerrstatus--;
+  /* Shift the lookahead token.  */
 
-  /* Shift the look-ahead token.  */
-  YY_SYMBOL_PRINT ("Shifting", yytoken, &yylval, &yylloc);
+#if YYDEBUG != 0
+  if (yydebug)
+    fprintf(stderr, "Shifting token %d (%s), ", yychar, yytname[yychar1]);
+#endif
 
-  /* Discard the shifted token unless it is eof.  */
+  /* Discard the token being shifted unless it is eof.  */
   if (yychar != YYEOF)
     yychar = YYEMPTY;
 
-  yystate = yyn;
   *++yyvsp = yylval;
+#ifdef YYLSP_NEEDED
+  *++yylsp = yylloc;
+#endif
 
-  goto yynewstate;
+  /* count tokens shifted since error; after three, turn off error status.  */
+  if (yyerrstatus) yyerrstatus--;
 
+  yystate = yyn;
+  goto yynewstate;
 
-/*-----------------------------------------------------------.
-| yydefault -- do the default action for the current state.  |
-`-----------------------------------------------------------*/
+/* Do the default action for the current state.  */
 yydefault:
+
   yyn = yydefact[yystate];
   if (yyn == 0)
     goto yyerrlab;
-  goto yyreduce;
-
 
-/*-----------------------------.
-| yyreduce -- Do a reduction.  |
-`-----------------------------*/
+/* Do a reduction.  yyn is the number of a rule to reduce with.  */
 yyreduce:
-  /* yyn is the number of a rule to reduce with.  */
   yylen = yyr2[yyn];
+  if (yylen > 0)
+    yyval = yyvsp[1-yylen]; /* implement default value of the action */
 
-  /* If YYLEN is nonzero, implement the default value of the action:
-     `$$ = $1'.
+#if YYDEBUG != 0
+  if (yydebug)
+    {
+      int i;
+
+      fprintf (stderr, "Reducing via rule %d (line %d), ",
+	       yyn, yyrline[yyn]);
 
-     Otherwise, the following line sets YYVAL to garbage.
-     This behavior is undocumented and Bison
-     users should not rely upon it.  Assigning to YYVAL
-     unconditionally makes the parser a bit smaller, and it avoids a
-     GCC warning that YYVAL may be used uninitialized.  */
-  yyval = yyvsp[1-yylen];
+      /* Print the symbols being reduced, and their result.  */
+      for (i = yyprhs[yyn]; yyrhs[i] > 0; i++)
+	fprintf (stderr, "%s ", yytname[yyrhs[i]]);
+      fprintf (stderr, " -> %s\n", yytname[yyr1[yyn]]);
+    }
+#endif
 
 
-  YY_REDUCE_PRINT (yyn);
-  switch (yyn)
-    {
-        case 2:
+  switch (yyn) {
+
+case 1:
 #line 175 "plural.y"
-    {
-	    if ((yyvsp[(1) - (1)].exp) == NULL)
+{
+	    if (yyvsp[0].exp == NULL)
 	      YYABORT;
-	    ((struct parse_args *) arg)->res = (yyvsp[(1) - (1)].exp);
-	  }
-    break;
-
-  case 3:
+	    ((struct parse_args *) arg)->res = yyvsp[0].exp;
+	  ;
+    break;}
+case 2:
 #line 183 "plural.y"
-    {
-	    (yyval.exp) = new_exp_3 (qmop, (yyvsp[(1) - (5)].exp), (yyvsp[(3) - (5)].exp), (yyvsp[(5) - (5)].exp));
-	  }
-    break;
-
-  case 4:
+{
+	    yyval.exp = new_exp_3 (qmop, yyvsp[-4].exp, yyvsp[-2].exp, yyvsp[0].exp);
+	  ;
+    break;}
+case 3:
 #line 187 "plural.y"
-    {
-	    (yyval.exp) = new_exp_2 (lor, (yyvsp[(1) - (3)].exp), (yyvsp[(3) - (3)].exp));
-	  }
-    break;
-
-  case 5:
+{
+	    yyval.exp = new_exp_2 (lor, yyvsp[-2].exp, yyvsp[0].exp);
+	  ;
+    break;}
+case 4:
 #line 191 "plural.y"
-    {
-	    (yyval.exp) = new_exp_2 (land, (yyvsp[(1) - (3)].exp), (yyvsp[(3) - (3)].exp));
-	  }
-    break;
-
-  case 6:
+{
+	    yyval.exp = new_exp_2 (land, yyvsp[-2].exp, yyvsp[0].exp);
+	  ;
+    break;}
+case 5:
 #line 195 "plural.y"
-    {
-	    (yyval.exp) = new_exp_2 ((yyvsp[(2) - (3)].op), (yyvsp[(1) - (3)].exp), (yyvsp[(3) - (3)].exp));
-	  }
-    break;
-
-  case 7:
+{
+	    yyval.exp = new_exp_2 (yyvsp[-1].op, yyvsp[-2].exp, yyvsp[0].exp);
+	  ;
+    break;}
+case 6:
 #line 199 "plural.y"
-    {
-	    (yyval.exp) = new_exp_2 ((yyvsp[(2) - (3)].op), (yyvsp[(1) - (3)].exp), (yyvsp[(3) - (3)].exp));
-	  }
-    break;
-
-  case 8:
+{
+	    yyval.exp = new_exp_2 (yyvsp[-1].op, yyvsp[-2].exp, yyvsp[0].exp);
+	  ;
+    break;}
+case 7:
 #line 203 "plural.y"
-    {
-	    (yyval.exp) = new_exp_2 ((yyvsp[(2) - (3)].op), (yyvsp[(1) - (3)].exp), (yyvsp[(3) - (3)].exp));
-	  }
-    break;
-
-  case 9:
+{
+	    yyval.exp = new_exp_2 (yyvsp[-1].op, yyvsp[-2].exp, yyvsp[0].exp);
+	  ;
+    break;}
+case 8:
 #line 207 "plural.y"
-    {
-	    (yyval.exp) = new_exp_2 ((yyvsp[(2) - (3)].op), (yyvsp[(1) - (3)].exp), (yyvsp[(3) - (3)].exp));
-	  }
-    break;
-
-  case 10:
+{
+	    yyval.exp = new_exp_2 (yyvsp[-1].op, yyvsp[-2].exp, yyvsp[0].exp);
+	  ;
+    break;}
+case 9:
 #line 211 "plural.y"
-    {
-	    (yyval.exp) = new_exp_1 (lnot, (yyvsp[(2) - (2)].exp));
-	  }
-    break;
-
-  case 11:
+{
+	    yyval.exp = new_exp_1 (lnot, yyvsp[0].exp);
+	  ;
+    break;}
+case 10:
 #line 215 "plural.y"
-    {
-	    (yyval.exp) = new_exp_0 (var);
-	  }
-    break;
-
-  case 12:
+{
+	    yyval.exp = new_exp_0 (var);
+	  ;
+    break;}
+case 11:
 #line 219 "plural.y"
-    {
-	    if (((yyval.exp) = new_exp_0 (num)) != NULL)
-	      (yyval.exp)->val.num = (yyvsp[(1) - (1)].num);
-	  }
-    break;
-
-  case 13:
+{
+	    if ((yyval.exp = new_exp_0 (num)) != NULL)
+	      yyval.exp->val.num = yyvsp[0].num;
+	  ;
+    break;}
+case 12:
 #line 224 "plural.y"
-    {
-	    (yyval.exp) = (yyvsp[(2) - (3)].exp);
-	  }
-    break;
-
+{
+	    yyval.exp = yyvsp[-1].exp;
+	  ;
+    break;}
+}
+   /* the action file gets copied in in place of this dollarsign */
+#line 543 "/usr/local/share/bison.simple"
+
+  yyvsp -= yylen;
+  yyssp -= yylen;
+#ifdef YYLSP_NEEDED
+  yylsp -= yylen;
+#endif
 
-/* Line 1267 of yacc.c.  */
-#line 1574 "plural.c"
-      default: break;
+#if YYDEBUG != 0
+  if (yydebug)
+    {
+      short *ssp1 = yyss - 1;
+      fprintf (stderr, "state stack now");
+      while (ssp1 != yyssp)
+	fprintf (stderr, " %d", *++ssp1);
+      fprintf (stderr, "\n");
     }
-  YY_SYMBOL_PRINT ("-> $$ =", yyr1[yyn], &yyval, &yyloc);
-
-  YYPOPSTACK (yylen);
-  yylen = 0;
-  YY_STACK_PRINT (yyss, yyssp);
+#endif
 
   *++yyvsp = yyval;
 
+#ifdef YYLSP_NEEDED
+  yylsp++;
+  if (yylen == 0)
+    {
+      yylsp->first_line = yylloc.first_line;
+      yylsp->first_column = yylloc.first_column;
+      yylsp->last_line = (yylsp-1)->last_line;
+      yylsp->last_column = (yylsp-1)->last_column;
+      yylsp->text = 0;
+    }
+  else
+    {
+      yylsp->last_line = (yylsp+yylen-1)->last_line;
+      yylsp->last_column = (yylsp+yylen-1)->last_column;
+    }
+#endif
 
-  /* Now `shift' the result of the reduction.  Determine what state
-     that goes to, based on the state we popped back to and the rule
-     number reduced by.  */
+  /* Now "shift" the result of the reduction.
+     Determine what state that goes to,
+     based on the state we popped back to
+     and the rule number reduced by.  */
 
   yyn = yyr1[yyn];
 
-  yystate = yypgoto[yyn - YYNTOKENS] + *yyssp;
-  if (0 <= yystate && yystate <= YYLAST && yycheck[yystate] == *yyssp)
+  yystate = yypgoto[yyn - YYNTBASE] + *yyssp;
+  if (yystate >= 0 && yystate <= YYLAST && yycheck[yystate] == *yyssp)
     yystate = yytable[yystate];
   else
-    yystate = yydefgoto[yyn - YYNTOKENS];
+    yystate = yydefgoto[yyn - YYNTBASE];
 
   goto yynewstate;
 
+yyerrlab:   /* here on detecting error */
 
-/*------------------------------------.
-| yyerrlab -- here on detecting error |
-`------------------------------------*/
-yyerrlab:
-  /* If not already recovering from an error, report this error.  */
-  if (!yyerrstatus)
+  if (! yyerrstatus)
+    /* If not already recovering from an error, report this error.  */
     {
       ++yynerrs;
-#if ! YYERROR_VERBOSE
-      yyerror (YY_("syntax error"));
-#else
-      {
-	YYSIZE_T yysize = yysyntax_error (0, yystate, yychar);
-	if (yymsg_alloc < yysize && yymsg_alloc < YYSTACK_ALLOC_MAXIMUM)
-	  {
-	    YYSIZE_T yyalloc = 2 * yysize;
-	    if (! (yysize <= yyalloc && yyalloc <= YYSTACK_ALLOC_MAXIMUM))
-	      yyalloc = YYSTACK_ALLOC_MAXIMUM;
-	    if (yymsg != yymsgbuf)
-	      YYSTACK_FREE (yymsg);
-	    yymsg = (char *) YYSTACK_ALLOC (yyalloc);
-	    if (yymsg)
-	      yymsg_alloc = yyalloc;
-	    else
-	      {
-		yymsg = yymsgbuf;
-		yymsg_alloc = sizeof yymsgbuf;
-	      }
-	  }
 
-	if (0 < yysize && yysize <= yymsg_alloc)
-	  {
-	    (void) yysyntax_error (yymsg, yystate, yychar);
-	    yyerror (yymsg);
-	  }
-	else
-	  {
-	    yyerror (YY_("syntax error"));
-	    if (yysize != 0)
-	      goto yyexhaustedlab;
-	  }
-      }
-#endif
-    }
+#ifdef YYERROR_VERBOSE
+      yyn = yypact[yystate];
+
+      if (yyn > YYFLAG && yyn < YYLAST)
+	{
+	  int size = 0;
+	  char *msg;
+	  int x, count;
+
+	  count = 0;
+	  /* Start X at -yyn if nec to avoid negative indexes in yycheck.  */
+	  for (x = (yyn < 0 ? -yyn : 0);
+	       x < (sizeof(yytname) / sizeof(char *)); x++)
+	    if (yycheck[x + yyn] == x)
+	      size += strlen(yytname[x]) + 15, count++;
+	  msg = (char *) malloc(size + 15);
+	  if (msg != 0)
+	    {
+	      strcpy(msg, "parse error");
 
+	      if (count < 5)
+		{
+		  count = 0;
+		  for (x = (yyn < 0 ? -yyn : 0);
+		       x < (sizeof(yytname) / sizeof(char *)); x++)
+		    if (yycheck[x + yyn] == x)
+		      {
+			strcat(msg, count == 0 ? ", expecting `" : " or `");
+			strcat(msg, yytname[x]);
+			strcat(msg, "'");
+			count++;
+		      }
+		}
+	      yyerror(msg);
+	      free(msg);
+	    }
+	  else
+	    yyerror ("parse error; also virtual memory exceeded");
+	}
+      else
+#endif /* YYERROR_VERBOSE */
+	yyerror("parse error");
+    }
 
+  goto yyerrlab1;
+yyerrlab1:   /* here on error raised explicitly by an action */
 
   if (yyerrstatus == 3)
     {
-      /* If just tried and failed to reuse look-ahead token after an
-	 error, discard it.  */
+      /* if just tried and failed to reuse lookahead token after an error, discard it.  */
 
-      if (yychar <= YYEOF)
-	{
-	  /* Return failure if at end of input.  */
-	  if (yychar == YYEOF)
-	    YYABORT;
-	}
-      else
-	{
-	  yydestruct ("Error: discarding",
-		      yytoken, &yylval);
-	  yychar = YYEMPTY;
-	}
+      /* return failure if at end of input */
+      if (yychar == YYEOF)
+	YYABORT;
+
+#if YYDEBUG != 0
+      if (yydebug)
+	fprintf(stderr, "Discarding token %d (%s).\n", yychar, yytname[yychar1]);
+#endif
+
+      yychar = YYEMPTY;
     }
 
-  /* Else will try to reuse look-ahead token after shifting the error
-     token.  */
-  goto yyerrlab1;
+  /* Else will try to reuse lookahead token
+     after shifting the error token.  */
 
+  yyerrstatus = 3;		/* Each real token shifted decrements this */
 
-/*---------------------------------------------------.
-| yyerrorlab -- error raised explicitly by YYERROR.  |
-`---------------------------------------------------*/
-yyerrorlab:
-
-  /* Pacify compilers like GCC when the user code never invokes
-     YYERROR and the label yyerrorlab therefore never appears in user
-     code.  */
-  if (/*CONSTCOND*/ 0)
-     goto yyerrorlab;
-
-  /* Do not reclaim the symbols of the rule which action triggered
-     this YYERROR.  */
-  YYPOPSTACK (yylen);
-  yylen = 0;
-  YY_STACK_PRINT (yyss, yyssp);
-  yystate = *yyssp;
-  goto yyerrlab1;
+  goto yyerrhandle;
+
+yyerrdefault:  /* current state does not do anything special for the error token. */
 
+#if 0
+  /* This is wrong; only states that explicitly want error tokens
+     should shift them.  */
+  yyn = yydefact[yystate];  /* If its default is to accept any token, ok.  Otherwise pop it.*/
+  if (yyn) goto yydefault;
+#endif
 
-/*-------------------------------------------------------------.
-| yyerrlab1 -- common code for both syntax error and YYERROR.  |
-`-------------------------------------------------------------*/
-yyerrlab1:
-  yyerrstatus = 3;	/* Each real token shifted decrements this.  */
+yyerrpop:   /* pop the current state because it cannot handle the error token */
 
-  for (;;)
+  if (yyssp == yyss) YYABORT;
+  yyvsp--;
+  yystate = *--yyssp;
+#ifdef YYLSP_NEEDED
+  yylsp--;
+#endif
+
+#if YYDEBUG != 0
+  if (yydebug)
     {
-      yyn = yypact[yystate];
-      if (yyn != YYPACT_NINF)
-	{
-	  yyn += YYTERROR;
-	  if (0 <= yyn && yyn <= YYLAST && yycheck[yyn] == YYTERROR)
-	    {
-	      yyn = yytable[yyn];
-	      if (0 < yyn)
-		break;
-	    }
-	}
+      short *ssp1 = yyss - 1;
+      fprintf (stderr, "Error: state stack now");
+      while (ssp1 != yyssp)
+	fprintf (stderr, " %d", *++ssp1);
+      fprintf (stderr, "\n");
+    }
+#endif
 
-      /* Pop the current state because it cannot handle the error token.  */
-      if (yyssp == yyss)
-	YYABORT;
+yyerrhandle:
 
+  yyn = yypact[yystate];
+  if (yyn == YYFLAG)
+    goto yyerrdefault;
 
-      yydestruct ("Error: popping",
-		  yystos[yystate], yyvsp);
-      YYPOPSTACK (1);
-      yystate = *yyssp;
-      YY_STACK_PRINT (yyss, yyssp);
+  yyn += YYTERROR;
+  if (yyn < 0 || yyn > YYLAST || yycheck[yyn] != YYTERROR)
+    goto yyerrdefault;
+
+  yyn = yytable[yyn];
+  if (yyn < 0)
+    {
+      if (yyn == YYFLAG)
+	goto yyerrpop;
+      yyn = -yyn;
+      goto yyreduce;
     }
+  else if (yyn == 0)
+    goto yyerrpop;
 
   if (yyn == YYFINAL)
     YYACCEPT;
 
-  *++yyvsp = yylval;
-
+#if YYDEBUG != 0
+  if (yydebug)
+    fprintf(stderr, "Shifting error token, ");
+#endif
 
-  /* Shift the error token.  */
-  YY_SYMBOL_PRINT ("Shifting", yystos[yyn], yyvsp, yylsp);
+  *++yyvsp = yylval;
+#ifdef YYLSP_NEEDED
+  *++yylsp = yylloc;
+#endif
 
   yystate = yyn;
   goto yynewstate;
 
-
-/*-------------------------------------.
-| yyacceptlab -- YYACCEPT comes here.  |
-`-------------------------------------*/
-yyacceptlab:
-  yyresult = 0;
-  goto yyreturn;
-
-/*-----------------------------------.
-| yyabortlab -- YYABORT comes here.  |
-`-----------------------------------*/
-yyabortlab:
-  yyresult = 1;
-  goto yyreturn;
-
-#ifndef yyoverflow
-/*-------------------------------------------------.
-| yyexhaustedlab -- memory exhaustion comes here.  |
-`-------------------------------------------------*/
-yyexhaustedlab:
-  yyerror (YY_("memory exhausted"));
-  yyresult = 2;
-  /* Fall through.  */
-#endif
-
-yyreturn:
-  if (yychar != YYEOF && yychar != YYEMPTY)
-     yydestruct ("Cleanup: discarding lookahead",
-		 yytoken, &yylval);
-  /* Do not reclaim the symbols of the rule which action triggered
-     this YYABORT or YYACCEPT.  */
-  YYPOPSTACK (yylen);
-  YY_STACK_PRINT (yyss, yyssp);
-  while (yyssp != yyss)
-    {
-      yydestruct ("Cleanup: popping",
-		  yystos[*yyssp], yyvsp);
-      YYPOPSTACK (1);
+ yyacceptlab:
+  /* YYACCEPT comes here.  */
+  if (yyfree_stacks)
+    {
+      free (yyss);
+      free (yyvs);
+#ifdef YYLSP_NEEDED
+      free (yyls);
+#endif
     }
-#ifndef yyoverflow
-  if (yyss != yyssa)
-    YYSTACK_FREE (yyss);
-#endif
-#if YYERROR_VERBOSE
-  if (yymsg != yymsgbuf)
-    YYSTACK_FREE (yymsg);
+  return 0;
+
+ yyabortlab:
+  /* YYABORT comes here.  */
+  if (yyfree_stacks)
+    {
+      free (yyss);
+      free (yyvs);
+#ifdef YYLSP_NEEDED
+      free (yyls);
 #endif
-  /* Make sure YYID is used.  */
-  return YYID (yyresult);
+    }
+  return 1;
 }
-
-
 #line 229 "plural.y"
 
 
@@ -1966,4 +1320,3 @@
 {
   /* Do nothing.  We don't print error messages here.  */
 }
-
diff -uNr vlc-0.8.6-svn20060918.debian/ipkg/Makefile.in vlc-0.8.6-svn20061008.debian/ipkg/Makefile.in
--- vlc-0.8.6-svn20060918.debian/ipkg/Makefile.in	2006-09-18 06:30:31.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/ipkg/Makefile.in	2006-10-08 12:42:32.000000000 -0400
@@ -115,12 +115,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -128,6 +129,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -152,9 +155,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -231,7 +231,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -246,7 +248,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/loader/Makefile.in vlc-0.8.6-svn20061008.debian/loader/Makefile.in
--- vlc-0.8.6-svn20060918.debian/loader/Makefile.in	2006-09-18 06:30:32.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/loader/Makefile.in	2006-10-08 12:42:33.000000000 -0400
@@ -129,12 +129,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -142,6 +143,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -166,9 +169,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -245,7 +245,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -260,7 +262,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/m4/Makefile.in vlc-0.8.6-svn20061008.debian/m4/Makefile.in
--- vlc-0.8.6-svn20060918.debian/m4/Makefile.in	2006-09-18 06:30:32.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/m4/Makefile.in	2006-10-08 12:42:33.000000000 -0400
@@ -115,12 +115,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -128,6 +129,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -152,9 +155,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -231,7 +231,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -246,7 +248,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/Makefile.in vlc-0.8.6-svn20061008.debian/Makefile.in
--- vlc-0.8.6-svn20060918.debian/Makefile.in	2006-09-18 06:30:31.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/Makefile.in	2006-10-08 12:42:31.000000000 -0400
@@ -122,12 +122,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -135,6 +136,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -159,9 +162,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -238,7 +238,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -253,7 +255,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
@@ -1675,7 +1676,6 @@
 
 @BUILD_MOZILLA_TRUE@	mkdir -p "$(top_builddir)/vlc-${VERSION}/mozilla"
 @BUILD_MOZILLA_TRUE@	cp $(top_builddir)/mozilla/*$(LIBEXT) $(top_builddir)/vlc-${VERSION}/mozilla/ ;
-@BUILD_MOZILLA_TRUE@	cp $(top_builddir)/mozilla/vlcintf.xpt  $(top_builddir)/vlc-${VERSION}/mozilla/ ;
 
 @BUILD_ACTIVEX_TRUE@	mkdir -p "$(top_builddir)/vlc-${VERSION}/activex"
 @BUILD_ACTIVEX_TRUE@	cp $(srcdir)/activex/README.TXT  $(top_builddir)/vlc-${VERSION}/activex/ ;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/access/cdda/Makefile.in vlc-0.8.6-svn20061008.debian/modules/access/cdda/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/access/cdda/Makefile.in	2006-09-18 06:30:33.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/access/cdda/Makefile.in	2006-10-08 12:42:34.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/access/directory.c vlc-0.8.6-svn20061008.debian/modules/access/directory.c
--- vlc-0.8.6-svn20060918.debian/modules/access/directory.c	2006-09-18 06:28:26.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/access/directory.c	2006-09-22 11:14:31.000000000 -0400
@@ -2,7 +2,7 @@
  * directory.c: expands a directory (directory: access plug-in)
  *****************************************************************************
  * Copyright (C) 2002-2004 the VideoLAN team
- * $Id: directory.c 16434 2006-08-30 15:18:13Z hartman $
+ * $Id: directory.c 16773 2006-09-21 18:46:25Z hartman $
  *
  * Authors: Derk-Jan Hartman <hartman at videolan dot org>
  *
@@ -28,6 +28,7 @@
 #include <vlc/vlc.h>
 #include <vlc/input.h>
 #include <vlc_playlist.h>
+#include <vlc_input.h>
 
 #include <stdlib.h>
 #include <string.h>
@@ -389,14 +390,30 @@
 static int ReadDir( playlist_t *p_playlist, const char *psz_name,
                     int i_mode, playlist_item_t *p_parent )
 {
-    struct dirent   **pp_dir_content;
-    int             i_dir_content, i;
+    struct dirent   **pp_dir_content = 0;
+    int             i_dir_content, i, i_return = VLC_SUCCESS;
     playlist_item_t *p_node;
 
-    /* Build array with ignores */
     char **ppsz_extensions = 0;
     int i_extensions = 0;
-    char *psz_ignore = var_CreateGetString( p_playlist, "ignore-filetypes" );
+    char *psz_ignore;
+
+    /* Get the first directory entry */
+    i_dir_content = scandir( psz_name, &pp_dir_content, Filter, alphasort );
+    if( i_dir_content == -1 )
+    {
+        msg_Warn( p_playlist, "failed to read directory" );
+        return VLC_EGENERIC;
+    }
+    else if( i_dir_content <= 0 )
+    {
+        /* directory is empty */
+        if( pp_dir_content ) free( pp_dir_content );
+        return VLC_SUCCESS;
+    }
+
+    /* Build array with ignores */
+    psz_ignore = var_CreateGetString( p_playlist, "ignore-filetypes" );
     if( psz_ignore && *psz_ignore )
     {
         char *psz_parser = psz_ignore;
@@ -430,19 +447,6 @@
         playlist_LockItemToNode( p_playlist,p_parent );
     }
 
-    /* get the first directory entry */
-    i_dir_content = scandir( psz_name, &pp_dir_content, Filter, alphasort );
-    if( i_dir_content == -1 )
-    {
-        msg_Warn( p_playlist, "failed to read directory" );
-        return VLC_EGENERIC;
-    }
-    else if( i_dir_content <= 0 )
-    {
-        /* directory is empty */
-        return VLC_SUCCESS;
-    }
-
     /* While we still have entries in the directory */
     for( i = 0; i < i_dir_content; i++ )
     {
@@ -506,14 +510,17 @@
 
                     p_node->input.i_type = ITEM_TYPE_DIRECTORY;
 
+                    /* an strdup() just because of Mac OS X */
+                    free( psz_newname );
+
+                    /* If we had the parent in category, the it is now node.
+                     * Else, we still don't have  */
                     if( ReadDir( p_playlist, psz_uri , MODE_EXPAND,
                                  p_node ) != VLC_SUCCESS )
                     {
-                        return VLC_EGENERIC;
+                        i_return = VLC_EGENERIC;
+                        break;
                     }
-
-                    /* an strdup() just because of Mac OS X */
-                    free( psz_newname );
                 }
             }
             else
@@ -566,15 +573,14 @@
     }
 
     for( i = 0; i < i_extensions; i++ )
-    {
-        if( ppsz_extensions[i] )
-            free( ppsz_extensions[i] );
-    }
+        if( ppsz_extensions[i] ) free( ppsz_extensions[i] );
     if( ppsz_extensions ) free( ppsz_extensions );
+
     if( psz_ignore ) free( psz_ignore );
 
     for( i = 0; i < i_dir_content; i++ )
         if( pp_dir_content[i] ) free( pp_dir_content[i] );
     if( pp_dir_content ) free( pp_dir_content );
-    return VLC_SUCCESS;
+
+    return i_return;
 }
diff -uNr vlc-0.8.6-svn20060918.debian/modules/access/dshow/common.h vlc-0.8.6-svn20061008.debian/modules/access/dshow/common.h
--- vlc-0.8.6-svn20060918.debian/modules/access/dshow/common.h	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/access/dshow/common.h	2006-10-04 09:47:07.000000000 -0400
@@ -2,7 +2,7 @@
  * common.h : DirectShow access module for vlc
  *****************************************************************************
  * Copyright (C) 2002 the VideoLAN team
- * $Id: common.h 13909 2006-01-14 09:36:16Z jpsaman $
+ * $Id: common.h 16931 2006-10-03 09:04:50Z damienf $
  *
  * Author: Gildas Bazin <gbazin@videolan.org>
  *
@@ -34,6 +34,9 @@
 #   include <unknwn.h>
 #   include <ole2.h>
 #   include <limits.h>
+#   ifdef _WINGDI_
+#      undef _WINGDI_
+#   endif
 #   define _WINGDI_ 1
 #   define AM_NOVTABLE
 #   define _OBJBASE_H_
diff -uNr vlc-0.8.6-svn20060918.debian/modules/access/dshow/filter.h vlc-0.8.6-svn20061008.debian/modules/access/dshow/filter.h
--- vlc-0.8.6-svn20060918.debian/modules/access/dshow/filter.h	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/access/dshow/filter.h	2006-10-04 09:47:07.000000000 -0400
@@ -2,7 +2,7 @@
  * filter.h : DirectShow access module for vlc
  *****************************************************************************
  * Copyright (C) 2002 the VideoLAN team
- * $Id: filter.h 13905 2006-01-12 23:10:04Z dionoea $
+ * $Id: filter.h 16931 2006-10-03 09:04:50Z damienf $
  *
  * Author: Gildas Bazin <gbazin@videolan.org>
  *
@@ -34,6 +34,9 @@
 #   include <unknwn.h>
 #   include <ole2.h>
 #   include <limits.h>
+#   ifdef _WINGDI_
+#      undef _WINGDI_
+#   endif
 #   define _WINGDI_ 1
 #   define AM_NOVTABLE
 #   define _OBJBASE_H_
diff -uNr vlc-0.8.6-svn20060918.debian/modules/access/dshow/Makefile.in vlc-0.8.6-svn20061008.debian/modules/access/dshow/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/access/dshow/Makefile.in	2006-09-18 06:30:33.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/access/dshow/Makefile.in	2006-10-08 12:42:34.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/access/dvb/Makefile.in vlc-0.8.6-svn20061008.debian/modules/access/dvb/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/access/dvb/Makefile.in	2006-09-18 06:30:33.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/access/dvb/Makefile.in	2006-10-08 12:42:34.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/access/file.c vlc-0.8.6-svn20061008.debian/modules/access/file.c
--- vlc-0.8.6-svn20060918.debian/modules/access/file.c	2006-09-18 06:28:26.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/access/file.c	2006-09-21 11:50:22.000000000 -0400
@@ -2,7 +2,7 @@
  * file.c: file input (file: access plug-in)
  *****************************************************************************
  * Copyright (C) 2001-2006 the VideoLAN team
- * $Id: file.c 16434 2006-08-30 15:18:13Z hartman $
+ * $Id: file.c 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Christophe Massiot <massiot@via.ecp.fr>
  *          Rmi Denis-Courmont <rem # videolan # org>
@@ -178,7 +178,7 @@
             ** explorer can open path such as file:/C:/ or file:///C:/...
             ** hence remove leading / if found
             */
-            ++psz_name;
+            strcpy( psz_name, p_access->psz_path + 1 );
         }
 #endif
 
@@ -257,6 +257,7 @@
         else
         {
             msg_Err( p_access, "unknown file type for `%s'", psz_name );
+            free( psz_name );
             return VLC_EGENERIC;
         }
     }
diff -uNr vlc-0.8.6-svn20060918.debian/modules/access/ftp.c vlc-0.8.6-svn20061008.debian/modules/access/ftp.c
--- vlc-0.8.6-svn20060918.debian/modules/access/ftp.c	2006-09-18 06:28:26.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/access/ftp.c	2006-09-22 11:14:31.000000000 -0400
@@ -2,7 +2,7 @@
  * ftp.c: FTP input module
  *****************************************************************************
  * Copyright (C) 2001-2006 the VideoLAN team
- * $Id: ftp.c 16457 2006-08-31 20:51:12Z hartman $
+ * $Id: ftp.c 16774 2006-09-21 19:29:10Z hartman $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr> - original code
  *          Rmi Denis-Courmont <rem # videolan.org> - EPSV support
@@ -63,7 +63,7 @@
                  CACHING_TEXT, CACHING_LONGTEXT, VLC_TRUE );
     add_string( "ftp-user", "anonymous", NULL, USER_TEXT, USER_LONGTEXT,
                 VLC_FALSE );
-    add_string( "ftp-pwd", "anonymous@dummy.org", NULL, PASS_TEXT,
+    add_string( "ftp-pwd", "anonymous@example.com", NULL, PASS_TEXT,
                 PASS_LONGTEXT, VLC_FALSE );
     add_string( "ftp-account", "anonymous", NULL, ACCOUNT_TEXT,
                 ACCOUNT_LONGTEXT, VLC_FALSE );
diff -uNr vlc-0.8.6-svn20060918.debian/modules/access/http.c vlc-0.8.6-svn20061008.debian/modules/access/http.c
--- vlc-0.8.6-svn20060918.debian/modules/access/http.c	2006-09-18 06:28:26.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/access/http.c	2006-09-22 11:14:31.000000000 -0400
@@ -2,7 +2,7 @@
  * http.c: HTTP input module
  *****************************************************************************
  * Copyright (C) 2001-2005 the VideoLAN team
- * $Id: http.c 16460 2006-08-31 22:01:13Z hartman $
+ * $Id: http.c 16774 2006-09-21 19:29:10Z hartman $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *          Christophe Massiot <massiot@via.ecp.fr>
@@ -497,8 +497,9 @@
             /* read the chunk header */
             if( psz == NULL )
             {
+                /* fatal error - end of file */
                 msg_Dbg( p_access, "failed reading chunk-header line" );
-                return -1;
+                return 0;
             }
             p_sys->i_chunk = strtoll( psz, NULL, 16 );
             free( psz );
diff -uNr vlc-0.8.6-svn20060918.debian/modules/access/Makefile.in vlc-0.8.6-svn20061008.debian/modules/access/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/access/Makefile.in	2006-09-18 06:30:32.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/access/Makefile.in	2006-10-08 12:42:33.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/access/mms/Makefile.in vlc-0.8.6-svn20061008.debian/modules/access/mms/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/access/mms/Makefile.in	2006-09-18 06:30:33.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/access/mms/Makefile.in	2006-10-08 12:42:35.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/access/pvr/Makefile.in vlc-0.8.6-svn20061008.debian/modules/access/pvr/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/access/pvr/Makefile.in	2006-09-18 06:30:34.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/access/pvr/Makefile.in	2006-10-08 12:42:35.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/access/rtsp/Makefile.in vlc-0.8.6-svn20061008.debian/modules/access/rtsp/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/access/rtsp/Makefile.in	2006-09-18 06:30:34.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/access/rtsp/Makefile.in	2006-10-08 12:42:35.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/access/screen/Makefile.in vlc-0.8.6-svn20061008.debian/modules/access/screen/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/access/screen/Makefile.in	2006-09-18 06:30:34.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/access/screen/Makefile.in	2006-10-08 12:42:36.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/access/v4l/Makefile.in vlc-0.8.6-svn20061008.debian/modules/access/v4l/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/access/v4l/Makefile.in	2006-09-18 06:30:34.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/access/v4l/Makefile.in	2006-10-08 12:42:36.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/access/vcd/Makefile.in vlc-0.8.6-svn20061008.debian/modules/access/vcd/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/access/vcd/Makefile.in	2006-09-18 06:30:35.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/access/vcd/Makefile.in	2006-10-08 12:42:36.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/access/vcdx/Makefile.in vlc-0.8.6-svn20061008.debian/modules/access/vcdx/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/access/vcdx/Makefile.in	2006-09-18 06:30:36.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/access/vcdx/Makefile.in	2006-10-08 12:42:37.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/access_filter/Makefile.in vlc-0.8.6-svn20061008.debian/modules/access_filter/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/access_filter/Makefile.in	2006-09-18 06:30:36.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/access_filter/Makefile.in	2006-10-08 12:42:38.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/access_output/Makefile.in vlc-0.8.6-svn20061008.debian/modules/access_output/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/access_output/Makefile.in	2006-09-18 06:30:36.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/access_output/Makefile.in	2006-10-08 12:42:38.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/audio_filter/channel_mixer/Makefile.in vlc-0.8.6-svn20061008.debian/modules/audio_filter/channel_mixer/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/audio_filter/channel_mixer/Makefile.in	2006-09-18 06:30:37.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/audio_filter/channel_mixer/Makefile.in	2006-10-08 12:42:39.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/audio_filter/converter/Makefile.in vlc-0.8.6-svn20061008.debian/modules/audio_filter/converter/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/audio_filter/converter/Makefile.in	2006-09-18 06:30:38.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/audio_filter/converter/Makefile.in	2006-10-08 12:42:40.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/audio_filter/Makefile.in vlc-0.8.6-svn20061008.debian/modules/audio_filter/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/audio_filter/Makefile.in	2006-09-18 06:30:37.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/audio_filter/Makefile.in	2006-10-08 12:42:39.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/audio_filter/resampler/Makefile.in vlc-0.8.6-svn20061008.debian/modules/audio_filter/resampler/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/audio_filter/resampler/Makefile.in	2006-09-18 06:30:38.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/audio_filter/resampler/Makefile.in	2006-10-08 12:42:40.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/audio_mixer/Makefile.in vlc-0.8.6-svn20061008.debian/modules/audio_mixer/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/audio_mixer/Makefile.in	2006-09-18 06:30:39.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/audio_mixer/Makefile.in	2006-10-08 12:42:41.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/audio_output/Makefile.in vlc-0.8.6-svn20061008.debian/modules/audio_output/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/audio_output/Makefile.in	2006-09-18 06:30:39.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/audio_output/Makefile.in	2006-10-08 12:42:42.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/codec/cmml/Makefile.in vlc-0.8.6-svn20061008.debian/modules/codec/cmml/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/codec/cmml/Makefile.in	2006-09-18 06:30:41.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/codec/cmml/Makefile.in	2006-10-08 12:42:44.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/codec/cvdsub.c vlc-0.8.6-svn20061008.debian/modules/codec/cvdsub.c
--- vlc-0.8.6-svn20060918.debian/modules/codec/cvdsub.c	2006-09-18 06:28:28.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/codec/cvdsub.c	2006-09-22 11:14:32.000000000 -0400
@@ -2,7 +2,7 @@
  * cvd.c : CVD Subtitle decoder
  *****************************************************************************
  * Copyright (C) 2003, 2004 the VideoLAN team
- * $Id: cvdsub.c 13905 2006-01-12 23:10:04Z dionoea $
+ * $Id: cvdsub.c 16774 2006-09-21 19:29:10Z hartman $
  *
  * Authors: Rocky Bernstein
  *          Gildas Bazin <gbazin@videolan.org>
@@ -496,6 +496,8 @@
     p_spu = p_dec->pf_spu_buffer_new( p_dec );
     if( !p_spu ) return NULL;
 
+    p_spu->b_pausable = VLC_TRUE;
+
     p_spu->i_x = p_sys->i_x_start;
     p_spu->i_x = p_spu->i_x * 3 / 4; /* FIXME: use aspect ratio for x? */
     p_spu->i_y = p_sys->i_y_start;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/codec/dmo/Makefile.in vlc-0.8.6-svn20061008.debian/modules/codec/dmo/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/codec/dmo/Makefile.in	2006-09-18 06:30:41.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/codec/dmo/Makefile.in	2006-10-08 12:42:44.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/codec/dts.c vlc-0.8.6-svn20061008.debian/modules/codec/dts.c
--- vlc-0.8.6-svn20060918.debian/modules/codec/dts.c	2006-09-18 06:28:28.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/codec/dts.c	2006-10-08 12:40:57.000000000 -0400
@@ -2,7 +2,7 @@
  * dts.c: parse DTS audio sync info and packetize the stream
  *****************************************************************************
  * Copyright (C) 2003-2005 the VideoLAN team
- * $Id: dts.c 13905 2006-01-12 23:10:04Z dionoea $
+ * $Id: dts.c 16987 2006-10-08 12:54:12Z jpsaman $
  *
  * Authors: Jon Lech Johansen <jon-vl@nanocrew.net>
  *          Gildas Bazin <gbazin@netcourrier.com>
@@ -99,7 +99,7 @@
     add_submodule();
     set_description( _("DTS audio packetizer") );
     set_capability( "packetizer", 10 );
-    set_callbacks( OpenPacketizer, NULL );
+    set_callbacks( OpenPacketizer, CloseDecoder );
 vlc_module_end();
 
 /*****************************************************************************
diff -uNr vlc-0.8.6-svn20060918.debian/modules/codec/faad.c vlc-0.8.6-svn20061008.debian/modules/codec/faad.c
--- vlc-0.8.6-svn20060918.debian/modules/codec/faad.c	2006-09-18 06:28:28.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/codec/faad.c	2006-10-08 12:40:57.000000000 -0400
@@ -2,7 +2,7 @@
  * decoder.c: AAC decoder using libfaad2
  *****************************************************************************
  * Copyright (C) 2001, 2003 the VideoLAN team
- * $Id: faad.c 13905 2006-01-12 23:10:04Z dionoea $
+ * $Id: faad.c 16964 2006-10-07 15:59:59Z hartman $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *          Gildas Bazin <gbazin@videolan.org>
@@ -25,6 +25,7 @@
 #include <vlc/vlc.h>
 #include <vlc/aout.h>
 #include <vlc/decoder.h>
+#include <vlc/input.h>
 
 #include <faad.h>
 
@@ -66,6 +67,8 @@
 
     /* Channel positions of the current stream (for re-ordering) */
     uint32_t pi_channel_positions[MAX_CHANNEL_POSITIONS];
+
+    vlc_bool_t b_sbr, b_ps;
 };
 
 static const uint32_t pi_channels_in[MAX_CHANNEL_POSITIONS] =
@@ -166,6 +169,7 @@
     /* Faad2 can't deal with truncated data (eg. from MPEG TS) */
     p_dec->b_need_packetized = VLC_TRUE;
 
+    p_sys->b_sbr = p_sys->b_ps = VLC_FALSE;
     return VLC_SUCCESS;
 }
 
@@ -311,6 +315,27 @@
         p_dec->fmt_out.audio.i_rate = frame.samplerate;
         p_dec->fmt_out.audio.i_channels = frame.channels;
 
+        /* Adjust stream info when dealing with SBR/PS */
+        if( (p_sys->b_sbr != frame.sbr || p_sys->b_ps != frame.ps) &&
+            p_dec->p_parent->i_object_type == VLC_OBJECT_INPUT )
+        {
+          input_thread_t *p_input = (input_thread_t *)p_dec->p_parent;
+          char *psz_cat, *psz_ext = (frame.sbr && frame.ps) ? "SBR+PS" :
+            frame.sbr ? "SBR" : "PS";
+
+          msg_Dbg( p_dec, "AAC %s (channels: %u, samplerate: %lu)",
+                   psz_ext, frame.channels, frame.samplerate );
+
+          asprintf( &psz_cat, _("Stream %d"), p_dec->fmt_in.i_id );
+          input_Control( p_input, INPUT_ADD_INFO, psz_cat,
+                          _("AAC extension"), "%s", psz_ext );
+          input_Control( p_input, INPUT_ADD_INFO, psz_cat,
+                         _("Channels"), "%d", frame.channels );
+          input_Control( p_input, INPUT_ADD_INFO, psz_cat,
+                         _("Sample rate"), _("%d Hz"), frame.samplerate );
+          free( psz_cat );
+          p_sys->b_sbr = frame.sbr; p_sys->b_ps = frame.ps;
+        }
 
         /* Convert frame.channel_position to our own channel values */
         for( i = 0; i < frame.channels; i++ )
@@ -330,8 +355,11 @@
             if( j == MAX_CHANNEL_POSITIONS )
             {
                 msg_Warn( p_dec, "unknown channel ordering" );
-                block_Release( p_block );
-                return NULL;
+
+                /* Try to invent something */
+                p_sys->pi_channel_positions[i] = pi_channels_out[i];
+                p_dec->fmt_out.audio.i_physical_channels |=
+                    pi_channels_out[i];
             }
         }
         p_dec->fmt_out.audio.i_original_channels =
diff -uNr vlc-0.8.6-svn20060918.debian/modules/codec/ffmpeg/demux.c vlc-0.8.6-svn20061008.debian/modules/codec/ffmpeg/demux.c
--- vlc-0.8.6-svn20060918.debian/modules/codec/ffmpeg/demux.c	2006-09-18 06:28:28.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/codec/ffmpeg/demux.c	2006-10-08 12:40:56.000000000 -0400
@@ -2,7 +2,7 @@
  * demux.c: demuxer using ffmpeg (libavformat).
  *****************************************************************************
  * Copyright (C) 2004 the VideoLAN team
- * $Id: demux.c 16603 2006-09-10 20:40:21Z sam $
+ * $Id: demux.c 16987 2006-10-08 12:54:12Z jpsaman $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *          Gildas Bazin <gbazin@videolan.org>
@@ -239,10 +239,10 @@
     msg_Dbg( p_demux, "    - format = %s (%s)",
              p_sys->fmt->name, p_sys->fmt->long_name );
     msg_Dbg( p_demux, "    - start time = "I64Fd,
-             ( p_sys->ic->start_time != AV_NOPTS_VALUE ) ?
+             ( p_sys->ic->start_time != (int64_t)AV_NOPTS_VALUE ) ?
              p_sys->ic->start_time * 1000000 / AV_TIME_BASE : -1 );
     msg_Dbg( p_demux, "    - duration = "I64Fd,
-             ( p_sys->ic->duration != AV_NOPTS_VALUE ) ?
+             ( p_sys->ic->duration != (int64_t)AV_NOPTS_VALUE ) ?
              p_sys->ic->duration * 1000000 / AV_TIME_BASE : -1 );
 
     return VLC_SUCCESS;
@@ -256,6 +256,7 @@
     demux_t     *p_demux = (demux_t*)p_this;
     demux_sys_t *p_sys = p_demux->p_sys;
 
+    if( p_sys->tk ) free( p_sys->tk );
     if( p_sys->ic ) av_close_input_file( p_sys->ic );
     if( p_sys->io_buffer ) free( p_sys->io_buffer );
     free( p_sys );
@@ -288,14 +289,14 @@
 
     memcpy( p_frame->p_buffer, pkt.data, pkt.size );
 
-    i_start_time = ( p_sys->ic->start_time != AV_NOPTS_VALUE ) ?
+    i_start_time = ( p_sys->ic->start_time != (int64_t)AV_NOPTS_VALUE ) ?
         p_sys->ic->start_time : 0;
 
-    p_frame->i_dts = ( pkt.dts == AV_NOPTS_VALUE ) ?
+    p_frame->i_dts = ( pkt.dts == (int64_t)AV_NOPTS_VALUE ) ?
         0 : (pkt.dts - i_start_time) * 1000000 *
         p_sys->ic->streams[pkt.stream_index]->time_base.num /
         p_sys->ic->streams[pkt.stream_index]->time_base.den;
-    p_frame->i_pts = ( pkt.pts == AV_NOPTS_VALUE ) ?
+    p_frame->i_pts = ( pkt.pts == (int64_t)AV_NOPTS_VALUE ) ?
         0 : (pkt.pts - i_start_time) * 1000000 *
         p_sys->ic->streams[pkt.stream_index]->time_base.num /
         p_sys->ic->streams[pkt.stream_index]->time_base.den;
@@ -338,7 +339,7 @@
                 *pf = (double)stream_Tell( p_demux->s ) / (double)i64;
             }
 
-            if( (p_sys->ic->duration != AV_NOPTS_VALUE) && (p_sys->i_pcr > 0) )
+            if( (p_sys->ic->duration != (int64_t)AV_NOPTS_VALUE) && (p_sys->i_pcr > 0) )
             {
                 *pf = (double)p_sys->i_pcr / (double)p_sys->ic->duration;
             }
@@ -353,10 +354,10 @@
                 int64_t i_size = stream_Size( p_demux->s );
 
                 i64 = p_sys->i_pcr * i_size / i64 * f;
-                if( p_sys->ic->start_time != AV_NOPTS_VALUE )
+                if( p_sys->ic->start_time != (int64_t)AV_NOPTS_VALUE )
                     i64 += p_sys->ic->start_time;
 
-                if( p_sys->ic->duration != AV_NOPTS_VALUE )
+                if( p_sys->ic->duration != (int64_t)AV_NOPTS_VALUE )
                     i64 = p_sys->ic->duration * f;
 
                 msg_Warn( p_demux, "DEMUX_SET_POSITION: "I64Fd, i64 );
@@ -372,7 +373,7 @@
 
         case DEMUX_GET_LENGTH:
             pi64 = (int64_t*)va_arg( args, int64_t * );
-            if( p_sys->ic->duration != AV_NOPTS_VALUE )
+            if( p_sys->ic->duration != (int64_t)AV_NOPTS_VALUE )
             {
                 *pi64 = p_sys->ic->duration;
             }
@@ -386,7 +387,7 @@
 
         case DEMUX_SET_TIME:
             i64 = (int64_t)va_arg( args, int64_t );
-            if( p_sys->ic->start_time != AV_NOPTS_VALUE )
+            if( p_sys->ic->start_time != (int64_t)AV_NOPTS_VALUE )
                 i64 += p_sys->ic->start_time;
 
             msg_Warn( p_demux, "DEMUX_SET_TIME: "I64Fd, i64 );
diff -uNr vlc-0.8.6-svn20060918.debian/modules/codec/ffmpeg/encoder.c vlc-0.8.6-svn20061008.debian/modules/codec/ffmpeg/encoder.c
--- vlc-0.8.6-svn20060918.debian/modules/codec/ffmpeg/encoder.c	2006-09-18 06:28:28.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/codec/ffmpeg/encoder.c	2006-09-22 11:14:32.000000000 -0400
@@ -2,7 +2,7 @@
  * encoder.c: video and audio encoder using the ffmpeg library
  *****************************************************************************
  * Copyright (C) 1999-2004 the VideoLAN team
- * $Id: encoder.c 16603 2006-09-10 20:40:21Z sam $
+ * $Id: encoder.c 16775 2006-09-21 20:35:23Z hartman $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *          Gildas Bazin <gbazin@videolan.org>
diff -uNr vlc-0.8.6-svn20060918.debian/modules/codec/ffmpeg/ffmpeg.c vlc-0.8.6-svn20061008.debian/modules/codec/ffmpeg/ffmpeg.c
--- vlc-0.8.6-svn20060918.debian/modules/codec/ffmpeg/ffmpeg.c	2006-09-18 06:28:28.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/codec/ffmpeg/ffmpeg.c	2006-09-24 13:09:01.000000000 -0400
@@ -2,7 +2,7 @@
  * ffmpeg.c: video decoder using ffmpeg library
  *****************************************************************************
  * Copyright (C) 1999-2001 the VideoLAN team
- * $Id: ffmpeg.c 16603 2006-09-10 20:40:21Z sam $
+ * $Id: ffmpeg.c 16801 2006-09-23 11:13:16Z thresh $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *          Gildas Bazin <gbazin@videolan.org>
@@ -641,6 +641,8 @@
       VIDEO_ES, "h264" },
     { VLC_FOURCC('x','2','6','4'), CODEC_ID_H264,
       VIDEO_ES, "h264" },
+    { VLC_FOURCC('X','2','6','4'), CODEC_ID_H264,
+      VIDEO_ES, "h264" },
     /* avc1: special case h264 */
     { VLC_FOURCC('a','v','c','1'), CODEC_ID_H264,
       VIDEO_ES, "h264" },
diff -uNr vlc-0.8.6-svn20060918.debian/modules/codec/ffmpeg/ffmpeg.h vlc-0.8.6-svn20061008.debian/modules/codec/ffmpeg/ffmpeg.h
--- vlc-0.8.6-svn20060918.debian/modules/codec/ffmpeg/ffmpeg.h	2006-09-18 06:28:28.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/codec/ffmpeg/ffmpeg.h	2006-09-24 13:09:01.000000000 -0400
@@ -2,7 +2,7 @@
  * ffmpeg.h: decoder using the ffmpeg library
  *****************************************************************************
  * Copyright (C) 2001 the VideoLAN team
- * $Id: ffmpeg.h 16603 2006-09-10 20:40:21Z sam $
+ * $Id: ffmpeg.h 16798 2006-09-22 23:56:12Z xtophe $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *
@@ -149,7 +149,7 @@
 #define LIBAVCODEC_PP_TEXT N_("FFmpeg post processing filter chains")
 /* FIXME (cut/past from ffmpeg */
 #define LIBAVCODEC_PP_LONGTEXT \
-"<filterName>[:<option>[:<option>...]][[,|/][-]<filterName>[:<option>...]]...\n" \
+N_("<filterName>[:<option>[:<option>...]][[,|/][-]<filterName>[:<option>...]]...\n" \
 "long form example:\n" \
 "vdeblock:autoq/hdeblock:autoq/linblenddeint    default,-vdeblock\n" \
 "short form example:\n" \
@@ -181,7 +181,7 @@
 "fa     fast                                    h1:a,v1:a,dr:a,al\n" \
 "tn     tmpnoise        (3 Thresholds)          Temporal Noise Reducer\n" \
 "                       1. <= 2. <= 3.          larger -> stronger filtering\n" \
-"fq     forceQuant      <quantizer>             Force quantizer\n"
+"fq     forceQuant      <quantizer>             Force quantizer\n")
 
 /*
  * Encoder options
diff -uNr vlc-0.8.6-svn20060918.debian/modules/codec/ffmpeg/Makefile.in vlc-0.8.6-svn20061008.debian/modules/codec/ffmpeg/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/codec/ffmpeg/Makefile.in	2006-09-18 06:30:42.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/codec/ffmpeg/Makefile.in	2006-10-08 12:42:45.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/codec/flac.c vlc-0.8.6-svn20061008.debian/modules/codec/flac.c
--- vlc-0.8.6-svn20060918.debian/modules/codec/flac.c	2006-09-18 06:28:28.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/codec/flac.c	2006-10-08 12:40:57.000000000 -0400
@@ -2,7 +2,7 @@
  * flac.c: flac decoder/packetizer/encoder module making use of libflac
  *****************************************************************************
  * Copyright (C) 1999-2001 the VideoLAN team
- * $Id: flac.c 15181 2006-04-11 22:09:20Z hartman $
+ * $Id: flac.c 16982 2006-10-08 11:56:06Z jpsaman $
  *
  * Authors: Gildas Bazin <gbazin@videolan.org>
  *          Sigmund Augdal Helberg <dnumgis@videolan.org>
@@ -1115,7 +1115,7 @@
     int i_channels;
 
     FLAC__int32 *p_buffer;
-    int         i_buffer;
+    unsigned int i_buffer;
 
     block_t *p_chain;
 
@@ -1207,7 +1207,7 @@
 {
     encoder_sys_t *p_sys = p_enc->p_sys;
     block_t *p_chain;
-    int i;
+    unsigned int i;
 
     p_sys->i_pts = p_aout_buf->start_date -
                 (mtime_t)1000000 * (mtime_t)p_sys->i_samples_delay /
@@ -1216,14 +1216,14 @@
     p_sys->i_samples_delay += p_aout_buf->i_nb_samples;
 
     /* Convert samples to FLAC__int32 */
-    if( p_sys->i_buffer < p_aout_buf->i_nb_bytes * 2 )
+    if( p_sys->i_buffer < (p_aout_buf->i_nb_bytes * 2) )
     {
         p_sys->p_buffer =
             realloc( p_sys->p_buffer, p_aout_buf->i_nb_bytes * 2 );
         p_sys->i_buffer = p_aout_buf->i_nb_bytes * 2;
     }
 
-    for( i = 0 ; i < p_aout_buf->i_nb_bytes / 2 ; i++ )
+    for( i = 0 ; i < (p_aout_buf->i_nb_bytes / 2) ; i++ )
     {
         p_sys->p_buffer[i]= ((int16_t *)p_aout_buf->p_buffer)[i];
     }
diff -uNr vlc-0.8.6-svn20060918.debian/modules/codec/Makefile.in vlc-0.8.6-svn20061008.debian/modules/codec/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/codec/Makefile.in	2006-09-18 06:30:41.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/codec/Makefile.in	2006-10-08 12:42:44.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/codec/mpeg_audio.c vlc-0.8.6-svn20061008.debian/modules/codec/mpeg_audio.c
--- vlc-0.8.6-svn20060918.debian/modules/codec/mpeg_audio.c	2006-09-18 06:28:28.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/codec/mpeg_audio.c	2006-10-08 12:40:57.000000000 -0400
@@ -2,7 +2,7 @@
  * mpeg_audio.c: parse MPEG audio sync info and packetize the stream
  *****************************************************************************
  * Copyright (C) 2001-2003 the VideoLAN team
- * $Id: mpeg_audio.c 15005 2006-03-31 16:28:03Z xtophe $
+ * $Id: mpeg_audio.c 16962 2006-10-07 15:30:51Z hartman $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *          Eric Petit <titer@videolan.org>
@@ -106,7 +106,7 @@
     set_description( _("MPEG audio layer I/II/III decoder") );
     set_category( CAT_INPUT );
     set_subcategory( SUBCAT_INPUT_ACODEC );
-#if defined(__APPLE__) || defined(UNDER_CE)
+#if defined(UNDER_CE)
    set_capability( "decoder", 5 );
 #else
     set_capability( "decoder", 100 );
diff -uNr vlc-0.8.6-svn20060918.debian/modules/codec/spudec/Makefile.in vlc-0.8.6-svn20061008.debian/modules/codec/spudec/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/codec/spudec/Makefile.in	2006-09-18 06:30:42.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/codec/spudec/Makefile.in	2006-10-08 12:42:45.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/codec/spudec/parse.c vlc-0.8.6-svn20061008.debian/modules/codec/spudec/parse.c
--- vlc-0.8.6-svn20060918.debian/modules/codec/spudec/parse.c	2006-09-18 06:28:28.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/codec/spudec/parse.c	2006-09-22 11:14:31.000000000 -0400
@@ -2,7 +2,7 @@
  * parse.c: SPU parser
  *****************************************************************************
  * Copyright (C) 2000-2001, 2005, 2006 the VideoLAN team
- * $Id: parse.c 16441 2006-08-30 21:36:35Z hartman $
+ * $Id: parse.c 16774 2006-09-21 19:29:10Z hartman $
  *
  * Authors: Sam Hocevar <sam@zoy.org>
  *          Laurent Aimar <fenrir@via.ecp.fr>
@@ -71,6 +71,8 @@
     p_spu = p_dec->pf_spu_buffer_new( p_dec );
     if( !p_spu ) return NULL;
 
+    p_spu->b_pausable = VLC_TRUE;
+
     /* Rationale for the "p_spudec->i_rle_size * 4": we are going to
      * expand the RLE stuff so that we won't need to read nibbles later
      * on. This will speed things up a lot. Plus, we'll only need to do
diff -uNr vlc-0.8.6-svn20060918.debian/modules/codec/subsdec.c vlc-0.8.6-svn20061008.debian/modules/codec/subsdec.c
--- vlc-0.8.6-svn20060918.debian/modules/codec/subsdec.c	2006-09-18 06:28:28.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/codec/subsdec.c	2006-09-22 11:14:32.000000000 -0400
@@ -2,7 +2,7 @@
  * subsdec.c : text subtitles decoder
  *****************************************************************************
  * Copyright (C) 2000-2006 the VideoLAN team
- * $Id: subsdec.c 15081 2006-04-03 01:39:59Z hartman $
+ * $Id: subsdec.c 16774 2006-09-21 19:29:10Z hartman $
  *
  * Authors: Gildas Bazin <gbazin@videolan.org>
  *          Samuel Hocevar <sam@zoy.org>
@@ -381,6 +381,8 @@
         return NULL;
     }
 
+    p_spu->b_pausable = VLC_TRUE;
+
     /* Create a new subpicture region */
     memset( &fmt, 0, sizeof(video_format_t) );
     fmt.i_chroma = VLC_FOURCC('T','E','X','T');
diff -uNr vlc-0.8.6-svn20060918.debian/modules/codec/svcdsub.c vlc-0.8.6-svn20061008.debian/modules/codec/svcdsub.c
--- vlc-0.8.6-svn20060918.debian/modules/codec/svcdsub.c	2006-09-18 06:28:28.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/codec/svcdsub.c	2006-09-24 13:09:01.000000000 -0400
@@ -2,7 +2,7 @@
  * svcdsub.c : Overlay Graphics Text (SVCD subtitles) decoder
  *****************************************************************************
  * Copyright (C) 2003, 2004 the VideoLAN team
- * $Id: svcdsub.c 14993 2006-03-31 13:46:39Z zorglub $
+ * $Id: svcdsub.c 16798 2006-09-22 23:56:12Z xtophe $
  *
  * Authors: Rocky Bernstein
  *          Gildas Bazin <gbazin@videolan.org>
@@ -42,10 +42,10 @@
 #define DEBUG_TEXT \
      "Enable debug"
 
-#define DEBUG_LONGTEXT \
+#define DEBUG_LONGTEXT N_( \
     "This integer when viewed in binary is a debugging mask\n" \
     "calls                 1\n" \
-    "packet assembly info  2\n"
+    "packet assembly info  2\n")
 
 vlc_module_begin();
     set_description( _("Philips OGT (SVCD subtitle) decoder") );
@@ -466,6 +466,8 @@
     p_spu = p_dec->pf_spu_buffer_new( p_dec );
     if( !p_spu ) return NULL;
 
+    p_spu->b_pausable = VLC_TRUE;
+
     p_spu->i_x = p_sys->i_x_start;
     p_spu->i_y = p_sys->i_y_start;
     p_spu->i_start = p_data->i_pts;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/codec/x264.c vlc-0.8.6-svn20061008.debian/modules/codec/x264.c
--- vlc-0.8.6-svn20060918.debian/modules/codec/x264.c	2006-09-18 06:28:28.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/codec/x264.c	2006-10-08 12:40:57.000000000 -0400
@@ -2,7 +2,7 @@
  * x264.c: h264 video encoder
  *****************************************************************************
  * Copyright (C) 2004-2006 the VideoLAN team
- * $Id: x264.c 16595 2006-09-10 18:51:22Z sam $
+ * $Id: x264.c 16987 2006-10-08 12:54:12Z jpsaman $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *
@@ -103,6 +103,14 @@
     "Range -6 to 6 for both alpha and beta parameters. -6 means light " \
     "filter, 6 means strong.")
 
+/* In order to play an interlaced output stream encoded by x264, a decoder needs
+   mbaff support. r570 is using the 'mb' part and not 'aff' yet; so it's really
+   'pure-interlaced' mode */
+#if X264_BUILD >= 51 /* r570 */
+#define INTERLACED_TEXT N_("Interlaced mode")
+#define INTERLACED_LONGTEXT N_( "Pure-interlaced mode.")
+#endif
+
 /* Ratecontrol */
 
 #define QP_TEXT N_("Set QP")
@@ -174,6 +182,14 @@
 #define DIRECT_PRED_TEXT N_("Direct MV prediction mode")
 #define DIRECT_PRED_LONGTEXT N_( "Direct MV prediction mode.")
 
+#if X264_BUILD >= 52 /* r573 */
+#define DIRECT_PRED_SIZE_TEXT N_("Direct prediction size")
+#define DIRECT_PRED_SIZE_LONGTEXT N_( "Direct prediction size: "\
+    " -  0: 4x4\n" \
+    " -  1: 8x8\n" \
+    " - -1: smallest possible according to level\n" )
+#endif
+
 #define WEIGHTB_TEXT N_("Weighted prediction for B-frames")
 #define WEIGHTB_LONGTEXT N_( "Weighted prediction for B-frames.")
 
@@ -248,6 +264,16 @@
 #define NR_LONGTEXT N_( "Dct-domain noise reduction. Adaptive pseudo-deadzone. " \
     "10 to 1000 seems to be a useful range." )
 
+#if X264_BUILD >= 52 /* r573 */
+#define DEADZONE_INTER_TEXT N_("Inter luma quantization deadzone")
+#define DEADZONE_INTER_LONGTEXT N_( "Set the size of the inter luma quantization deadzone. " \
+    "Range 0 to 32." )
+
+#define DEADZONE_INTRA_TEXT N_("Intra luma quantization deadzone")
+#define DEADZONE_INTRA_LONGTEXT N_( "Set the size of the intra luma quantization deadzone. " \
+    "Range 0 to 32." )
+#endif
+
 /* Input/Output */
 
 #define ASM_TEXT N_("CPU optimizations")
@@ -343,6 +369,11 @@
     add_string( SOUT_CFG_PREFIX "filter", "", NULL, FILTER_TEXT,
                  FILTER_LONGTEXT, VLC_FALSE );
 
+#if X264_BUILD >= 51 /* r570 */
+    add_bool( SOUT_CFG_PREFIX "interlaced", 0, NULL, INTERLACED_TEXT, INTERLACED_LONGTEXT,
+              VLC_FALSE );
+#endif
+
 /* Ratecontrol */
 
     add_integer( SOUT_CFG_PREFIX "qp", 26, NULL, QP_TEXT, QP_LONGTEXT,
@@ -418,6 +449,12 @@
                 DIRECT_PRED_LONGTEXT, VLC_FALSE );
         change_string_list( direct_pred_list, direct_pred_list_text, 0 );
 
+#if X264_BUILD >= 52 /* r573 */
+    add_integer( SOUT_CFG_PREFIX "direct-8x8", 0, NULL, DIRECT_PRED_SIZE_TEXT,
+                 DIRECT_PRED_SIZE_LONGTEXT, VLC_FALSE );
+        change_integer_range( -1, 1 );
+#endif
+
 #if X264_BUILD >= 0x0012 /* r134 */
     add_bool( SOUT_CFG_PREFIX "weightb", 0, NULL, WEIGHTB_TEXT,
               WEIGHTB_LONGTEXT, VLC_FALSE );
@@ -485,10 +522,25 @@
         change_integer_range( 0, 1000 );
 #endif
 
+#if X264_BUILD >= 52 /* r573 */
+    add_integer( SOUT_CFG_PREFIX "deadzone-inter", 21, NULL, DEADZONE_INTER_TEXT,
+                 DEADZONE_INTRA_LONGTEXT, VLC_FALSE );
+        change_integer_range( 0, 32 );
+
+    add_integer( SOUT_CFG_PREFIX "deadzone-intra", 11, NULL, DEADZONE_INTRA_TEXT,
+                 DEADZONE_INTRA_LONGTEXT, VLC_FALSE );
+        change_integer_range( 0, 32 );
+#endif
+
 /* Input/Output */
 
+#if defined(__DARWIN__) && defined(__INTEL__)
+    add_bool( SOUT_CFG_PREFIX "asm", 0, NULL, ASM_TEXT,
+              ASM_LONGTEXT, VLC_FALSE );
+#else
     add_bool( SOUT_CFG_PREFIX "asm", 1, NULL, ASM_TEXT,
               ASM_LONGTEXT, VLC_FALSE );
+#endif
 
     /* x264 psnr = 1 (default). disable PSNR computation for speed. */
     add_bool( SOUT_CFG_PREFIX "psnr", 0, NULL, PSNR_TEXT,
@@ -516,13 +568,13 @@
 static const char *ppsz_sout_options[] = {
     "8x8dct", "analyse", "asm", "bframes", "bime", "bpyramid", "b-adapt",
     "b-bias", "b-rdo", "cabac", "chroma-me", "chroma-qp-offset", "cplxblur",
-    "crf", "dct-decimate", "direct", "filter", "fast-pskip", "frameref",
-    "ipratio", "keyint", "keyint-min", "loopfilter", "me", "merange",
-    "min-keyint", "mixed-refs", "nf", "nr", "pbratio", "psnr", "qblur",
-    "qp", "qcomp", "qpstep", "qpmax", "qpmin", "qp-max", "qp-min", "quiet",
-    "ratetol", "ref", "scenecut", "ssim", "subme", "subpel", "tolerance",
-    "trellis", "verbose", "vbv-bufsize", "vbv-init", "vbv-maxrate",
-    "weightb", NULL
+    "crf", "dct-decimate", "deadzone-inter", "deadzone-intra", "direct",
+    "direct-8x8", "filter", "fast-pskip", "frameref", "interlaced", "ipratio",
+    "keyint", "keyint-min", "loopfilter", "me", "merange", "min-keyint",
+    "mixed-refs", "nf", "nr", "pbratio", "psnr", "qblur", "qp", "qcomp",
+    "qpstep", "qpmax", "qpmin", "qp-max", "qp-min", "quiet", "ratetol",
+    "ref", "scenecut", "ssim", "subme", "subpel", "tolerance", "trellis", "verbose",
+    "vbv-bufsize", "vbv-init", "vbv-maxrate", "weightb", NULL
 };
 
 static block_t *Encode( encoder_t *, picture_t * );
@@ -668,6 +720,11 @@
         free( val.psz_string );
     }
 
+#if X264_BUILD >= 51 /* r570 */
+    var_Get( p_enc, SOUT_CFG_PREFIX "interlaced", &val );
+    p_sys->param.b_interlaced = val.b_bool;
+#endif
+
     var_Get( p_enc, SOUT_CFG_PREFIX "ipratio", &val );
     p_sys->param.rc.f_ip_factor = val.f_float;
 
@@ -851,6 +908,20 @@
     p_sys->param.analyse.b_dct_decimate = val.b_bool;
 #endif
 
+#if X264_BUILD >= 52
+    var_Get( p_enc, SOUT_CFG_PREFIX "deadzone-inter", &val );
+    if( val.i_int >= 0 && val.i_int <= 32 )
+        p_sys->param.analyse.i_luma_deadzone[0] = val.i_int;
+
+    var_Get( p_enc, SOUT_CFG_PREFIX "deadzone-intra", &val );
+    if( val.i_int >= 0 && val.i_int <= 32 )
+        p_sys->param.analyse.i_luma_deadzone[1] = val.i_int;   
+
+    var_Get( p_enc, SOUT_CFG_PREFIX "direct-8x8", &val );
+    if( val.i_int >= -1 && val.i_int <= 1 )
+        p_sys->param.analyse.i_direct_8x8_inference = val.i_int; 
+#endif
+
     var_Get( p_enc, SOUT_CFG_PREFIX "asm", &val );
     if( !val.b_bool ) p_sys->param.cpu = 0;
 
@@ -906,7 +977,7 @@
     if( p_enc->fmt_in.video.i_aspect > 0 )
     {
         int64_t i_num, i_den;
-        int i_dst_num, i_dst_den;
+        unsigned int i_dst_num, i_dst_den;
 
         i_num = p_enc->fmt_in.video.i_aspect *
             (int64_t)p_enc->fmt_in.video.i_height;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/control/corba/Makefile.in vlc-0.8.6-svn20061008.debian/modules/control/corba/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/control/corba/Makefile.in	2006-09-18 06:30:43.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/control/corba/Makefile.in	2006-10-08 12:42:46.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
@@ -344,7 +345,7 @@
 @ENABLE_CORBA_TRUE@orbittypelib_CFLAGS = `$(VLC_CONFIG) --cflags plugin corba`
 @ENABLE_CORBA_TRUE@orbittypelib_LIBS = `$(VLC_CONFIG) --libs plugin corba`
 
-@ENABLE_CORBA_TRUE@ORBIT_IDL = $(shell pkg-config --variable=orbit_idl ORBit-2.0)
+@ENABLE_CORBA_TRUE@ORBIT_IDL = `$(PKG_CONFIG) --variable=orbit_idl ORBit-2.0`
 
 LTLIBVLC = $(top_builddir)/src/libvlc.la
 
diff -uNr vlc-0.8.6-svn20060918.debian/modules/control/http/http.c vlc-0.8.6-svn20061008.debian/modules/control/http/http.c
--- vlc-0.8.6-svn20060918.debian/modules/control/http/http.c	2006-09-18 06:28:16.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/control/http/http.c	2006-10-08 12:40:53.000000000 -0400
@@ -2,7 +2,7 @@
  * http.c : HTTP/HTTPS Remote control interface
  *****************************************************************************
  * Copyright (C) 2001-2006 the VideoLAN team
- * $Id: http.c 16439 2006-08-30 19:33:55Z hartman $
+ * $Id: http.c 16956 2006-10-05 16:41:21Z funman $
  *
  * Authors: Gildas Bazin <gbazin@netcourrier.com>
  *          Laurent Aimar <fenrir@via.ecp.fr>
@@ -124,9 +124,13 @@
                   *psz_crl = NULL;
     int           i_port       = 0;
     char          *psz_src;
-    char          psz_tmp[10];
 
-    psz_address = config_GetPsz( p_intf, "http-host" );
+    var_Create(p_intf->p_libvlc, "http-host", VLC_VAR_STRING );
+    psz_address=var_GetString(p_intf->p_libvlc, "http-host");
+    if( !psz_address || !*psz_address )
+    {
+        psz_address = config_GetPsz( p_intf, "http-host" );
+    }
     if( psz_address != NULL )
     {
         char *psz_parser = strchr( psz_address, ':' );
@@ -258,10 +262,6 @@
             i_port= 8080;
     }
 
-    /* Ugly hack to allow to run several HTTP servers on different ports. */
-    sprintf( psz_tmp, ":%d", i_port + 1 );
-    config_PutPsz( p_intf, "http-host", psz_tmp );
-
     msg_Dbg( p_intf, "base %s:%d", psz_address, i_port );
 
     p_sys->p_httpd_host = httpd_TLSHostNew( VLC_OBJECT(p_intf), psz_address,
@@ -275,6 +275,14 @@
         free( p_sys );
         return VLC_EGENERIC;
     }
+    else
+    {
+        char psz_tmp[NI_MAXHOST + 6];
+
+        /* Ugly hack to run several HTTP servers on different ports */
+        snprintf( psz_tmp, sizeof (psz_tmp), "%s:%d", psz_address, i_port + 1 );
+        var_SetString( p_intf->p_libvlc, "http-host", psz_tmp );
+    }
 
     p_sys->i_files  = 0;
     p_sys->pp_files = NULL;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/control/http/Makefile.in vlc-0.8.6-svn20061008.debian/modules/control/http/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/control/http/Makefile.in	2006-09-18 06:30:44.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/control/http/Makefile.in	2006-10-08 12:42:46.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/control/http/mvar.c vlc-0.8.6-svn20061008.debian/modules/control/http/mvar.c
--- vlc-0.8.6-svn20060918.debian/modules/control/http/mvar.c	2006-09-18 06:28:16.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/control/http/mvar.c	2006-10-01 11:34:21.000000000 -0400
@@ -2,7 +2,7 @@
  * mvar.c : Variables handling for the HTTP Interface
  *****************************************************************************
  * Copyright (C) 2001-2006 the VideoLAN team
- * $Id: mvar.c 16434 2006-08-30 15:18:13Z hartman $
+ * $Id: mvar.c 16869 2006-09-26 21:07:43Z thresh $
  *
  * Authors: Gildas Bazin <gbazin@netcourrier.com>
  *          Laurent Aimar <fenrir@via.ecp.fr>
@@ -128,7 +128,7 @@
 {
     /* format: name[index].field */
     char *field = strchr( name, '.' );
-    int i = 1 + (field != NULL) ? (field - name) : strlen( name );
+    int i = 1 + ((field != NULL) ? (field - name) : strlen( name ));
     char base[i];
     char *p;
     int i_index;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/control/Makefile.in vlc-0.8.6-svn20061008.debian/modules/control/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/control/Makefile.in	2006-09-18 06:30:43.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/control/Makefile.in	2006-10-08 12:42:46.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/control/rc.c vlc-0.8.6-svn20061008.debian/modules/control/rc.c
--- vlc-0.8.6-svn20060918.debian/modules/control/rc.c	2006-09-18 06:28:16.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/control/rc.c	2006-10-08 12:40:53.000000000 -0400
@@ -2,7 +2,7 @@
  * rc.c : remote control stdin/stdout module for vlc
  *****************************************************************************
  * Copyright (C) 2004 - 2005 the VideoLAN team
- * $Id: rc.c 16669 2006-09-16 10:31:26Z thresh $
+ * $Id: rc.c 16984 2006-10-08 12:14:56Z jpsaman $
  *
  * Author: Peter Surda <shurdeek@panorama.sth.ac.at>
  *         Jean-Paul Saman <jpsaman #_at_# m2x _replaceWith#dot_ nl>
@@ -95,6 +95,8 @@
                            vlc_value_t, vlc_value_t, void * );
 static int  VolumeMove   ( vlc_object_t *, char const *,
                            vlc_value_t, vlc_value_t, void * );
+static int  VideoConfig  ( vlc_object_t *, char const *,
+                           vlc_value_t, vlc_value_t, void * );
 static int  AudioConfig  ( vlc_object_t *, char const *,
                            vlc_value_t, vlc_value_t, void * );
 static int  Menu         ( vlc_object_t *, char const *,
@@ -372,6 +374,8 @@
 
     var_Create( p_intf, "add", VLC_VAR_STRING | VLC_VAR_ISCOMMAND );
     var_AddCallback( p_intf, "add", Playlist, NULL );
+    var_Create( p_intf, "enqueue", VLC_VAR_STRING | VLC_VAR_ISCOMMAND );
+    var_AddCallback( p_intf, "enqueue", Playlist, NULL );
     var_Create( p_intf, "playlist", VLC_VAR_VOID | VLC_VAR_ISCOMMAND );
     var_AddCallback( p_intf, "playlist", Playlist, NULL );
     var_Create( p_intf, "play", VLC_VAR_VOID | VLC_VAR_ISCOMMAND );
@@ -495,6 +499,21 @@
     var_Create( p_intf, "normal", VLC_VAR_VOID | VLC_VAR_ISCOMMAND );
     var_AddCallback( p_intf, "normal", Input, NULL );
 
+    var_Create( p_intf, "atrack", VLC_VAR_STRING | VLC_VAR_ISCOMMAND );
+    var_AddCallback( p_intf, "atrack", Input, NULL );
+    var_Create( p_intf, "vtrack", VLC_VAR_STRING | VLC_VAR_ISCOMMAND );
+    var_AddCallback( p_intf, "vtrack", Input, NULL );
+    var_Create( p_intf, "strack", VLC_VAR_STRING | VLC_VAR_ISCOMMAND );
+    var_AddCallback( p_intf, "strack", Input, NULL );
+
+    /* video commands */
+    var_Create( p_intf, "vratio", VLC_VAR_STRING | VLC_VAR_ISCOMMAND );
+    var_AddCallback( p_intf, "vratio", VideoConfig, NULL );
+    var_Create( p_intf, "vcrop", VLC_VAR_STRING | VLC_VAR_ISCOMMAND );
+    var_AddCallback( p_intf, "vcrop", VideoConfig, NULL );
+    var_Create( p_intf, "vzoom", VLC_VAR_STRING | VLC_VAR_ISCOMMAND );
+    var_AddCallback( p_intf, "vzoom", VideoConfig, NULL );
+
     /* audio commands */
     var_Create( p_intf, "volume", VLC_VAR_STRING | VLC_VAR_ISCOMMAND );
     var_AddCallback( p_intf, "volume", Volume, NULL );
@@ -882,6 +901,7 @@
     msg_rc(_("+----[ Remote control commands ]"));
     msg_rc(  "| ");
     msg_rc(_("| add XYZ  . . . . . . . . . . add XYZ to playlist"));
+    msg_rc(_("| enqueue XYZ  . . . . . . . queue XYZ to playlist"));
     msg_rc(_("| playlist . . .  show items currently in playlist"));
     msg_rc(_("| play . . . . . . . . . . . . . . . . play stream"));
     msg_rc(_("| stop . . . . . . . . . . . . . . . . stop stream"));
@@ -916,6 +936,12 @@
     msg_rc(_("| voldown [X]  . . . .  lower audio volume X steps"));
     msg_rc(_("| adev [X] . . . . . . . . .  set/get audio device"));
     msg_rc(_("| achan [X]. . . . . . . .  set/get audio channels"));
+    msg_rc(_("| atrack [X] . . . . . . . . . set/get audio track"));
+    msg_rc(_("| vtrack [X] . . . . . . . . . set/get video track"));
+    msg_rc(_("| vratio [X]  . . . . . set/get video aspect ratio"));
+    msg_rc(_("| vcrop [X]  . . . . . . . . .  set/get video crop"));
+    msg_rc(_("| vzoom [X]  . . . . . . . . .  set/get video zoom"));
+    msg_rc(_("| strack [X] . . . . . . . set/get subtitles track"));
     msg_rc(_("| menu [on|off|up|down|left|right|select] use menu"));
     msg_rc(  "| ");
 
@@ -1216,6 +1242,81 @@
         vlc_object_release( p_input );
         return VLC_SUCCESS;
     }
+    else if(    !strcmp( psz_cmd, "atrack" )
+             || !strcmp( psz_cmd, "vtrack" )
+             || !strcmp( psz_cmd, "strack" ) )
+    {
+        char *psz_variable;
+        vlc_value_t val_name;
+        int i_error;
+
+        if( !strcmp( psz_cmd, "atrack" ) )
+        {
+            psz_variable = "audio-es";
+        }
+        else if( !strcmp( psz_cmd, "vtrack" ) )
+        {
+            psz_variable = "video-es";
+        }
+        else
+        {
+            psz_variable = "spu-es";
+        }
+
+        /* Get the descriptive name of the variable */
+        var_Change( p_input, psz_variable, VLC_VAR_GETTEXT,
+                     &val_name, NULL );
+        if( !val_name.psz_string ) val_name.psz_string = strdup(psz_variable);
+
+        if( newval.psz_string && *newval.psz_string )
+        {
+            /* set */
+            vlc_value_t val;
+            val.i_int = atoi( newval.psz_string );
+
+            i_error = var_Set( p_input, psz_variable, val );
+        }
+        else
+        {
+            /* get */
+            vlc_value_t val, text;
+            int i, i_value;
+
+            if ( var_Get( p_input, psz_variable, &val ) < 0 )
+            {
+                vlc_object_release( p_input );
+                return VLC_EGENERIC;
+            }
+            i_value = val.i_int;
+
+            if ( var_Change( p_input, psz_variable,
+                             VLC_VAR_GETLIST, &val, &text ) < 0 )
+            {
+                vlc_object_release( p_input );
+                return VLC_EGENERIC;
+            }
+
+            msg_rc( "+----[ %s ]", val_name.psz_string );
+            for ( i = 0; i < val.p_list->i_count; i++ )
+            {
+                if ( i_value == val.p_list->p_values[i].i_int )
+                    msg_rc( "| %i - %s *", val.p_list->p_values[i].i_int,
+                            text.p_list->p_values[i].psz_string );
+                else
+                    msg_rc( "| %i - %s", val.p_list->p_values[i].i_int,
+                            text.p_list->p_values[i].psz_string );
+            }
+            var_Change( p_input, psz_variable, VLC_VAR_FREELIST,
+                        &val, &text );
+            msg_rc( "+----[ end of %s ]", val_name.psz_string );
+
+            if( val_name.psz_string ) free( val_name.psz_string );
+
+            i_error = VLC_SUCCESS;
+        }
+        vlc_object_release( p_input );
+        return i_error;
+    }
 
     /* Never reached. */
     vlc_object_release( p_input );
@@ -1305,6 +1406,18 @@
                               PLAYLIST_GO|PLAYLIST_APPEND, PLAYLIST_END );
         }
     }
+    else if( !strcmp( psz_cmd, "enqueue" ) &&
+             newval.psz_string && *newval.psz_string )
+    {
+        playlist_item_t *p_item = parse_MRL( p_intf, newval.psz_string );
+
+        if( p_item )
+        {
+            msg_rc( "trying to enqueue %s to playlist", newval.psz_string );
+            playlist_AddItem( p_playlist, p_item,
+                              PLAYLIST_APPEND, PLAYLIST_END );
+        }
+    }
     else if( !strcmp( psz_cmd, "playlist" ) )
     {
         int i;
@@ -1827,6 +1940,126 @@
     return i_error;
 }
 
+
+static int VideoConfig( vlc_object_t *p_this, char const *psz_cmd,
+                        vlc_value_t oldval, vlc_value_t newval, void *p_data )
+{
+    intf_thread_t *p_intf = (intf_thread_t*)p_this;
+    input_thread_t *p_input = NULL;
+    vout_thread_t * p_vout;
+    const char * psz_variable;
+    vlc_value_t val_name;
+    int i_error;
+
+    p_input = vlc_object_find( p_this, VLC_OBJECT_INPUT, FIND_ANYWHERE );
+    if( !p_input )
+        return VLC_ENOOBJ;
+
+    p_vout = vlc_object_find( p_input, VLC_OBJECT_VOUT, FIND_CHILD );
+    vlc_object_release( p_input );
+    if( !p_vout )
+        return VLC_ENOOBJ;
+
+    if( !strcmp( psz_cmd, "vcrop" ) )
+    {
+        psz_variable = "crop";
+    }
+    else if( !strcmp( psz_cmd, "vratio" ) )
+    {
+        psz_variable = "aspect-ratio";
+    }
+    else /* if( !strcmp( psz_cmd, "vzoom" ) ) */
+    {
+        psz_variable = "zoom";
+    }
+
+
+    /* Get the descriptive name of the variable */
+    var_Change( p_vout, psz_variable, VLC_VAR_GETTEXT,
+                 &val_name, NULL );
+    if( !val_name.psz_string ) val_name.psz_string = strdup(psz_variable);
+
+    if( newval.psz_string && *newval.psz_string )
+    {
+        /* set */
+        if( !strcmp( psz_variable, "zoom" ) )
+        {
+            vlc_value_t val;
+            val.f_float = atof( newval.psz_string );
+            i_error = var_Set( p_vout, psz_variable, val );
+        }
+        else
+        {
+            i_error = var_Set( p_vout, psz_variable, newval );
+        }
+    }
+    else
+    {
+        /* get */
+        vlc_value_t val, text;
+        int i;
+        float f_value = 0.0;
+        char *psz_value = NULL;
+
+        if ( var_Get( p_vout, psz_variable, &val ) < 0 )
+        {
+            vlc_object_release( p_vout );
+            return VLC_EGENERIC;
+        }
+        if( !strcmp( psz_variable, "zoom" ) )
+        {
+            f_value = val.f_float;
+        }
+        else
+        {
+            psz_value = strdup( val.psz_string );
+        }
+
+        if ( var_Change( p_vout, psz_variable,
+                         VLC_VAR_GETLIST, &val, &text ) < 0 )
+        {
+            vlc_object_release( p_vout );
+            return VLC_EGENERIC;
+        }
+
+        msg_rc( "+----[ %s ]", val_name.psz_string );
+        if( !strcmp( psz_variable, "zoom" ) )
+        {
+            for ( i = 0; i < val.p_list->i_count; i++ )
+            {
+                if ( f_value == val.p_list->p_values[i].f_float )
+                    msg_rc( "| %f - %s *", val.p_list->p_values[i].f_float,
+                            text.p_list->p_values[i].psz_string );
+                else
+                    msg_rc( "| %f - %s", val.p_list->p_values[i].f_float,
+                            text.p_list->p_values[i].psz_string );
+            }
+        }
+        else
+        {
+            for ( i = 0; i < val.p_list->i_count; i++ )
+            {
+                if ( !strcmp( psz_value, val.p_list->p_values[i].psz_string ) )
+                    msg_rc( "| %s - %s *", val.p_list->p_values[i].psz_string,
+                            text.p_list->p_values[i].psz_string );
+                else
+                    msg_rc( "| %s - %s", val.p_list->p_values[i].psz_string,
+                            text.p_list->p_values[i].psz_string );
+            }
+            free( psz_value );
+        }
+        var_Change( p_vout, psz_variable, VLC_VAR_FREELIST,
+                    &val, &text );
+        msg_rc( "+----[ end of %s ]", val_name.psz_string );
+
+        if( val_name.psz_string ) free( val_name.psz_string );
+
+        i_error = VLC_SUCCESS;
+    }
+    vlc_object_release( p_vout );
+    return i_error;
+}
+
 static int AudioConfig( vlc_object_t *p_this, char const *psz_cmd,
                         vlc_value_t oldval, vlc_value_t newval, void *p_data )
 {
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/asf/Makefile.in vlc-0.8.6-svn20061008.debian/modules/demux/asf/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/demux/asf/Makefile.in	2006-09-18 06:30:45.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/asf/Makefile.in	2006-10-08 12:42:48.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/avi/avi.c vlc-0.8.6-svn20061008.debian/modules/demux/avi/avi.c
--- vlc-0.8.6-svn20060918.debian/modules/demux/avi/avi.c	2006-09-18 06:28:16.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/avi/avi.c	2006-10-08 12:40:53.000000000 -0400
@@ -2,7 +2,7 @@
  * avi.c : AVI file Stream input module for vlc
  *****************************************************************************
  * Copyright (C) 2001-2004 the VideoLAN team
- * $Id: avi.c 16460 2006-08-31 22:01:13Z hartman $
+ * $Id: avi.c 16987 2006-10-08 12:54:12Z jpsaman $
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *
  * This program is free software; you can redistribute it and/or modify
@@ -1837,7 +1837,7 @@
  *
  ****************************************************************************/
 static void AVI_ParseStreamHeader( vlc_fourcc_t i_id,
-                                   int *pi_number, int *pi_type )
+                                   unsigned int *pi_number, unsigned int *pi_type )
 {
 #define SET_PTR( p, v ) if( p ) *(p) = (v);
     int c1, c2;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/avi/Makefile.in vlc-0.8.6-svn20061008.debian/modules/demux/avi/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/demux/avi/Makefile.in	2006-09-18 06:30:46.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/avi/Makefile.in	2006-10-08 12:42:49.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/live555.cpp vlc-0.8.6-svn20061008.debian/modules/demux/live555.cpp
--- vlc-0.8.6-svn20060918.debian/modules/demux/live555.cpp	2006-09-18 06:28:17.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/live555.cpp	2006-10-08 12:40:54.000000000 -0400
@@ -2,7 +2,7 @@
  * live555.cpp : LIVE555 Streaming Media support.
  *****************************************************************************
  * Copyright (C) 2003-2006 the VideoLAN team
- * $Id: live555.cpp 16647 2006-09-14 14:58:57Z hartman $
+ * $Id: live555.cpp 16983 2006-10-08 12:14:05Z jpsaman $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *
@@ -28,6 +28,7 @@
 
 #include <vlc/vlc.h>
 #include <vlc/input.h>
+
 #include "network.h"
 
 #include <iostream>
@@ -106,24 +107,16 @@
                   N_("Port to use for tunneling the RTSP/RTP over HTTP."),
                   VLC_TRUE );
 #endif
-        add_integer( "rtsp-caching", 4 * DEFAULT_PTS_DELAY / 1000, NULL,
-                  CACHING_TEXT, CACHING_LONGTEXT, VLC_TRUE );
-        add_bool( "rtsp-kasenna", VLC_FALSE, NULL, KASENNA_TEXT,
-                  KASENNA_LONGTEXT, VLC_TRUE );
+        add_integer("rtsp-caching", 4 * DEFAULT_PTS_DELAY / 1000, NULL,
+                    CACHING_TEXT, CACHING_LONGTEXT, VLC_TRUE );
+        add_bool(   "rtsp-kasenna", VLC_FALSE, NULL, KASENNA_TEXT,
+                    KASENNA_LONGTEXT, VLC_TRUE );
         add_string( "rtsp-user", NULL, NULL, USER_TEXT,
-                USER_LONGTEXT, VLC_TRUE );
+                    USER_LONGTEXT, VLC_TRUE );
         add_string( "rtsp-pwd", NULL, NULL, PASS_TEXT,
-                PASS_LONGTEXT, VLC_TRUE );
+                    PASS_LONGTEXT, VLC_TRUE );
 vlc_module_end();
 
-/* TODO:
- *  - Improve support of PS/TS
- *  - Support X-QT/X-QUICKTIME generic codec for audio.
- *
- *  - Check memory leak, delete/free -> still one when using rtsp-tcp but I'm
- *  not sure if it comes from me.
- *
- */
 
 /*****************************************************************************
  * Local prototypes
@@ -151,7 +144,7 @@
 
     char         waiting;
 
-    mtime_t      i_pts;
+    int64_t      i_pts;
 
 } live_track_t;
 
@@ -165,8 +158,8 @@
 
 struct demux_sys_t
 {
-    char         *p_sdp;    /* XXX mallocated */
-    char         *psz_path; /* URL-encoded path */
+    char            *p_sdp;    /* XXX mallocated */
+    char            *psz_path; /* URL-encoded path */
 
     MediaSession     *ms;
     TaskScheduler    *scheduler;
@@ -176,10 +169,10 @@
     /* */
     int              i_track;
     live_track_t     **track;   /* XXX mallocated */
-    mtime_t          i_pcr;
-    mtime_t          i_pcr_start;
-    mtime_t          i_pcr_previous;
-    mtime_t          i_pcr_repeatdate;
+    int64_t          i_pcr;
+    int64_t          i_pcr_start;
+    int64_t          i_pcr_previous;
+    int64_t          i_pcr_repeatdate;
     int              i_pcr_repeats;
 
     /* Asf */
@@ -187,8 +180,8 @@
     stream_t         *p_out_asf;
 
     /* */
-    mtime_t          i_length;
-    mtime_t          i_start;
+    int64_t          i_length;
+    int64_t          i_start;
 
     /* timeout thread information */
     int              i_timeout;     /* session timeout value in seconds */
@@ -206,12 +199,15 @@
 static int Demux  ( demux_t * );
 static int Control( demux_t *, int, va_list );
 
-static int ParseASF( demux_t * );
-static int RollOverTcp( demux_t * );
-
-static void StreamRead( void *, unsigned int, unsigned int,
-                        struct timeval, unsigned int );
-static void StreamClose( void * );
+static int Connect      ( demux_t * );
+static int SessionsSetup( demux_t * );
+static int Play         ( demux_t *);
+static int ParseASF     ( demux_t * );
+static int RollOverTcp  ( demux_t * );
+
+static void StreamRead  ( void *, unsigned int, unsigned int,
+                          struct timeval, unsigned int );
+static void StreamClose ( void * );
 static void TaskInterrupt( void * );
 
 static void TimeoutPrevention( timeout_thread_t * );
@@ -229,23 +225,15 @@
     demux_t     *p_demux = (demux_t*)p_this;
     demux_sys_t *p_sys = NULL;
 
-    MediaSubsessionIterator *iter;
-    MediaSubsession *sub;
-
-    vlc_bool_t b_rtsp_tcp;
-    uint8_t *p_peek;
-
-    char    *psz_user = NULL;
-    char    *psz_pwd  = NULL;
-
-    int     i_sdp;
-    int     i_sdp_max;
-    uint8_t *p_sdp;
+    MediaSubsessionIterator *iter   = NULL;
+    MediaSubsession         *sub    = NULL;
+    int i_return;
 
     if( p_demux->s )
     {
         /* See if it looks like a SDP
            v, o, s fields are mandatory and in this order */
+        uint8_t *p_peek;
         if( stream_Peek( p_demux->s, &p_peek, 7 ) < 7 ) return VLC_EGENERIC;
 
         if( memcmp( (char*)p_peek, "v=0\r\n", 5 ) &&
@@ -286,8 +274,7 @@
     p_sys->i_timeout = 0;
     p_sys->b_timeout_call = VLC_FALSE;
     p_sys->b_multicast = VLC_FALSE;
-    p_sys->psz_path = strdup(p_demux->psz_path);
-
+    p_sys->psz_path = strdup( p_demux->psz_path );
 
     if( ( p_sys->scheduler = BasicTaskScheduler::createNew() ) == NULL )
     {
@@ -306,68 +293,13 @@
         while( (p = strchr( p, ' ' )) != NULL ) *p = '+';
     }
 
-    if( p_demux->s == NULL && !strcasecmp( p_demux->psz_access, "rtsp" ) )
-    {
-        char *psz_url;
-        char *psz_options;
-#if LIVEMEDIA_LIBRARY_VERSION_INT > 1130457500
-        int i_http_port = 0;
-
-        if( var_CreateGetBool( p_demux, "rtsp-http" ) )
-            i_http_port = var_CreateGetInteger( p_demux, "rtsp-http-port" );
-
-        if( ( p_sys->rtsp = RTSPClient::createNew(*p_sys->env, 1/*verbose*/,
-              "VLC media player", i_http_port ) ) == NULL )
-#else
-        if( ( p_sys->rtsp = RTSPClient::createNew(*p_sys->env, 1/*verbose*/,
-              "VLC media player" ) ) == NULL )
-#endif
-        {
-            msg_Err( p_demux, "RTSPClient::createNew failed (%s)",
-                     p_sys->env->getResultMsg() );
-            goto error;
-        }
-        psz_url = (char*)malloc( strlen( p_sys->psz_path ) + 8 );
-        sprintf( psz_url, "rtsp://%s", p_sys->psz_path );
-
-        psz_options = p_sys->rtsp->sendOptionsCmd( psz_url );
-        if( psz_options ) delete [] psz_options;
-
-        psz_user = var_CreateGetString( p_demux, "rtsp-user" );
-        psz_pwd  = var_CreateGetString( p_demux, "rtsp-pwd" );
-
-        if ((*psz_user) && (*psz_pwd))
-            p_sdp = (uint8_t*)p_sys->rtsp->describeWithPassword( psz_url,
-                               psz_user, psz_pwd);
-        else
-            p_sdp = (uint8_t*)p_sys->rtsp->describeURL( psz_url,
-                               NULL, var_CreateGetBool( p_demux, "rtsp-kasenna" ) );
-        if( p_sdp == NULL )
-        {
-            msg_Err( p_demux, "describeURL failed (%s)",
-                     p_sys->env->getResultMsg() );
-            free( psz_url );
-            goto error;
-        }
-        free( psz_url );
-        free( psz_user );
-        free( psz_pwd );
-
-        /* malloc-ated copy */
-        p_sys->p_sdp = strdup( (char*)p_sdp );
-        delete[] p_sdp;
-        msg_Dbg( p_demux, "sdp=%s\n", p_sys->p_sdp );
-    }
-    else if( p_demux->s == NULL && !strcasecmp( p_demux->psz_access, "sdp" ) )
-    {
-        p_sys->p_sdp = strdup( p_sys->psz_path );
-    }
-    else
+    if( p_demux->s != NULL )
     {
         /* Gather the complete sdp file */
-        i_sdp = 0;
-        i_sdp_max = 1000;
-        p_sdp = (uint8_t*)malloc( i_sdp_max );
+        int     i_sdp       = 0;
+        int     i_sdp_max   = 1000;
+        uint8_t *p_sdp      = (uint8_t*) malloc( i_sdp_max );
+
         for( ;; )
         {
             int i_read = stream_Read( p_demux->s, &p_sdp[i_sdp],
@@ -392,119 +324,53 @@
             p_sdp = (uint8_t*)realloc( p_sdp, i_sdp_max );
         }
         p_sys->p_sdp = (char*)p_sdp;
-
-        msg_Dbg( p_demux, "sdp=%s\n", p_sys->p_sdp );
     }
-    if( !( p_sys->ms = MediaSession::createNew( *p_sys->env, p_sys->p_sdp ) ) )
+    else if( p_demux->s == NULL && !strcasecmp( p_demux->psz_access, "sdp" ) )
+    {
+        /* sdp:// link from SAP */
+        p_sys->p_sdp = strdup( p_sys->psz_path );
+    }
+    else if( ( i_return = Connect( p_demux ) ) != VLC_SUCCESS )
     {
-        msg_Err( p_demux, "MediaSession::createNew failed" );
+        msg_Err( p_demux, "Failed to connect with rtsp://%s", p_sys->psz_path );
         goto error;
     }
 
-    b_rtsp_tcp = var_CreateGetBool( p_demux, "rtsp-tcp" );
-
-    /* Initialise each media subsession */
-    iter = new MediaSubsessionIterator( *p_sys->ms );
-    while( ( sub = iter->next() ) != NULL )
+    if( p_sys->p_sdp == NULL )
     {
-        unsigned int i_buffer = 0;
-        Boolean bInit;
-        int i_client_port;
-
-        i_client_port = var_CreateGetInteger( p_demux, "rtp-client-port" );
-        if( i_client_port != -1 )
-            sub->setClientPortNum( i_client_port );
-
-        /* Value taken from mplayer */
-        if( !strcmp( sub->mediumName(), "audio" ) )
-            i_buffer = 100000;
-        else if( !strcmp( sub->mediumName(), "video" ) )
-            i_buffer = 2000000;
-        else
-            continue;
-
-        if( !strcmp( sub->codecName(), "X-ASF-PF" ) )
-            bInit = sub->initiate( 4 ); /* Constant ? */
-        else
-            bInit = sub->initiate();
-
-        if( strcasestr( sub->codecName(), "REAL" ) )
-        {
-            msg_Info( p_demux, "real codec detected, using real-RTSP instead" );
-            delete iter;
-            goto error; 
-        }
-
-        if( !bInit )
-        {
-            msg_Warn( p_demux, "RTP subsession '%s/%s' failed (%s)",
-                      sub->mediumName(), sub->codecName(),
-                      p_sys->env->getResultMsg() );
-        }
-        else
-        {
-            if( sub->rtpSource() )
-            {
-                int fd = sub->rtpSource()->RTPgs()->socketNum();
-                /* Increase the buffer size */
-                increaseReceiveBufferTo( *p_sys->env, fd, i_buffer );
-            }
-
-            msg_Dbg( p_demux, "RTP subsession '%s/%s'", sub->mediumName(),
-                     sub->codecName() );
-
-            /* Issue the SETUP */
-            if( p_sys->rtsp )
-            {
-                p_sys->rtsp->setupMediaSubsession( *sub, False,
-                                                   b_rtsp_tcp ? True : False );
-            }
-            if( !p_sys->b_multicast )
-            {
-                /* Check, because we need diff. rollover behaviour for multicast */
-                p_sys->b_multicast = IsMulticastAddress( sub->connectionEndpointAddress() );
-            }
-        }
+        msg_Err( p_demux, "Failed to retrieve the RTSP Session Description" );
+        goto error;
     }
 
-    if( p_sys->rtsp )
+    /* Create the session from the SDP */
+    if( !( p_sys->ms = MediaSession::createNew( *p_sys->env, p_sys->p_sdp ) ) )
     {
-        /* The PLAY */
-        if( !p_sys->rtsp->playMediaSession( *p_sys->ms ) )
-        {
-            msg_Err( p_demux, "PLAY failed %s", p_sys->env->getResultMsg() );
-            delete iter;
-            goto error;
-        }
+        msg_Err( p_demux, "Could not create the RTSP Session: %s",
+            p_sys->env->getResultMsg() );
+        goto error;
+    }
 
-        /* Retrieve the timeout value and set up a timeout prevention thread */
-#if LIVEMEDIA_LIBRARY_VERSION_INT >= 1138089600
-        p_sys->i_timeout = p_sys->rtsp->sessionTimeoutParameter();
-#endif
-        if( p_sys->i_timeout > 0 )
-        {
-            msg_Dbg( p_demux, "We have a timeout of %d seconds",  p_sys->i_timeout );
-            p_sys->p_timeout = (timeout_thread_t *)vlc_object_create( p_demux, sizeof(timeout_thread_t) );
-            p_sys->p_timeout->p_sys = p_demux->p_sys; /* lol, object recursion :D */
-            if( vlc_thread_create( p_sys->p_timeout, "liveMedia-timeout", TimeoutPrevention,
-                                   VLC_THREAD_PRIORITY_LOW, VLC_TRUE ) )
-            {
-                msg_Err( p_demux, "cannot spawn liveMedia timeout thread" );
-                delete iter;
-                vlc_object_destroy( p_sys->p_timeout );
-                goto error;
-            }
-            msg_Dbg( p_demux, "spawned timeout thread" );
-            vlc_object_attach( p_sys->p_timeout, p_demux );
-        }
+    if( ( i_return = SessionsSetup( p_demux ) ) != VLC_SUCCESS )
+    {
+        msg_Err( p_demux, "Nothing to play for rtsp://%s", p_sys->psz_path );
+        goto error;
     }
 
+    /* Retrieve the duration if possible */
+    p_sys->i_length = (int64_t)( p_sys->ms->playEndTime() * 1000000.0 );
+    if( p_sys->i_length < 0 )
+        p_sys->i_length = -1;
+
+    if( ( i_return = Play( p_demux ) ) != VLC_SUCCESS )
+        goto error;
+    
     /* Create all es struct */
-    iter->reset();
+    iter = new MediaSubsessionIterator( *p_sys->ms );
     while( ( sub = iter->next() ) != NULL )
     {
         live_track_t *tk;
 
+        /* Check if we will receive data from this subsession for this track */
         if( sub->readSource() == NULL ) continue;
 
         tk = (live_track_t*)malloc( sizeof( live_track_t ) );
@@ -648,7 +514,7 @@
                 unsigned int i_extra = 0;
                 uint8_t      *p_extra = NULL;
 #endif
-                tk->fmt.i_codec = VLC_FOURCC( 'H', '2', '6', '4' );
+                tk->fmt.i_codec = VLC_FOURCC( 'h', '2', '6', '4' );
                 tk->fmt.b_packetized = VLC_FALSE;
 
                 /* XXX not the right minimal version I fear */
@@ -713,7 +579,10 @@
             }
         }
 
-        tk->p_es = es_out_Add( p_demux->out, &tk->fmt );
+        if( !tk->b_quicktime && !tk->b_muxed && !tk->b_asf )
+        {
+            tk->p_es = es_out_Add( p_demux->out, &tk->fmt );
+        }
 
         if( sub->rtcpInstance() != NULL )
         {
@@ -724,13 +593,15 @@
         {
             tk->readSource = sub->readSource();
             tk->rtpSource  = sub->rtpSource();
-
+            
             /* Append */
             p_sys->track = (live_track_t**)realloc( p_sys->track, sizeof( live_track_t ) * ( p_sys->i_track + 1 ) );
             p_sys->track[p_sys->i_track++] = tk;
         }
         else
         {
+            /* BUG ??? */
+            msg_Err( p_demux, "unusable RTSP track. this should not happen" );
             free( tk );
         }
     }
@@ -744,29 +615,15 @@
         goto error;
     }
 
-    p_sys->i_length = (mtime_t)(p_sys->ms->playEndTime() * 1000000.0);
-    if( p_sys->i_length < 0 )
-    {
-        p_sys->i_length = 0;
-    }
-    else if( p_sys->i_length > 0 )
-    {
-        /* FIXME */
-        /* p_input->stream.p_selected_area->i_size = 1000;*/ /* needed for now */
-    }
-
     if( p_sys->i_track <= 0 )
-    {
-        msg_Err( p_demux, "no codec supported, aborting" );
         goto error;
-    }
 
     return VLC_SUCCESS;
 
 error:
     if( p_sys->p_out_asf ) stream_DemuxDelete( p_sys->p_out_asf );
     if( p_sys->ms ) Medium::close( p_sys->ms );
-    if( p_sys->rtsp ) Medium::close( p_sys->rtsp );
+    if( p_sys->rtsp ) RTSPClient::close( p_sys->rtsp );
     if( p_sys->env ) RECLAIM_ENV(p_sys->env);
     if( p_sys->p_timeout )
     {
@@ -820,8 +677,8 @@
         vlc_object_destroy( p_sys->p_timeout );
     }
 
-    if( p_sys->rtsp ) Medium::close( p_sys->rtsp );
-    if( p_sys->env ) RECLAIM_ENV(p_sys->env);
+    if( p_sys->rtsp ) RTSPClient::close( p_sys->rtsp );
+    if( p_sys->env ) RECLAIM_ENV( p_sys->env );
     if( p_sys->scheduler ) delete p_sys->scheduler;
     if( p_sys->p_sdp ) free( p_sys->p_sdp );
     if( p_sys->psz_path ) free( p_sys->psz_path );
@@ -829,6 +686,226 @@
 }
 
 /*****************************************************************************
+ * Connect: connects to the RTSP server to setup the session DESCRIBE
+ *****************************************************************************/
+static int Connect( demux_t *p_demux )
+{
+    demux_sys_t *p_sys = p_demux->p_sys;
+    Authenticator authenticator;
+
+    char *psz_user    = NULL;
+    char *psz_pwd     = NULL;
+    char *psz_url     = NULL;
+    char *psz_options = NULL;
+    char *p_sdp       = NULL;
+    int  i_http_port  = 0;
+    int  i_ret        = VLC_SUCCESS;
+
+createnew:
+    if( var_CreateGetBool( p_demux, "rtsp-http" ) )
+        i_http_port = var_CreateGetInteger( p_demux, "rtsp-http-port" );
+
+#if LIVEMEDIA_LIBRARY_VERSION_INT > 1130457500
+    if( ( p_sys->rtsp = RTSPClient::createNew(*p_sys->env, 1 /*verbose*/,
+          "VLC media player", i_http_port ) ) == NULL )
+#else
+    if( ( p_sys->rtsp = RTSPClient::createNew(*p_sys->env, 1 /*verbose*/,
+          "VLC media player" ) ) == NULL )
+#endif
+    {
+        msg_Err( p_demux, "RTSPClient::createNew failed (%s)",
+                 p_sys->env->getResultMsg() );
+        return VLC_EGENERIC;
+    }
+    psz_url = (char*)malloc( strlen( p_sys->psz_path ) + 8 );
+    sprintf( psz_url, "rtsp://%s", p_sys->psz_path );
+
+    psz_options = p_sys->rtsp->sendOptionsCmd( psz_url );
+    if( psz_options ) delete [] psz_options;
+
+    psz_user = var_CreateGetString( p_demux, "rtsp-user" );
+    psz_pwd  = var_CreateGetString( p_demux, "rtsp-pwd" );
+
+    authenticator.setUsernameAndPassword( (const char*)psz_user, (const char*)psz_pwd );
+    p_sdp = p_sys->rtsp->describeURL( psz_url,
+                &authenticator, var_CreateGetBool( p_demux, "rtsp-kasenna" ) );
+
+    if( psz_user ) free( psz_user );
+    if( psz_pwd ) free( psz_pwd );
+
+    if( p_sdp == NULL )
+    {
+        /* failure occured */
+        int i_code = 0;
+        const char *psz_error = p_sys->env->getResultMsg();
+
+        msg_Dbg( p_demux, "DESCRIBE failed with %d: %s", i_code, psz_error );
+        sscanf( psz_error, "%*sRTSP/%*s%3u", &i_code );
+
+        if( i_code == 401 )
+        {
+            msg_Err( p_demux, "RTSP authentication failed" );
+        }
+        else if( !var_CreateGetBool( p_demux, "rtsp-http" ) )
+        {
+            /* Perhaps a firewall is being annoying. Try HTTP tunneling mode */
+            vlc_value_t val;
+            val.b_bool = VLC_TRUE;
+            msg_Dbg( p_demux, "we will now try HTTP tunneling mode" );
+            var_Set( p_demux, "rtsp-http", val );
+            if( psz_url ) free( psz_url );
+            if( p_sys->rtsp ) RTSPClient::close( p_sys->rtsp );
+            goto createnew;
+        }
+        i_ret = VLC_EGENERIC;
+    }
+    if( psz_url ) free( psz_url );
+
+    /* malloc-ated copy */
+    if( p_sys->p_sdp ) free( p_sys->p_sdp );
+    if( p_sdp ) p_sys->p_sdp = strdup( (char*)p_sdp );
+    delete[] p_sdp;
+
+    return i_ret;
+}
+
+/*****************************************************************************
+ * Connect: prepares the subsessions and does the SETUP
+ *****************************************************************************/
+static int SessionsSetup( demux_t *p_demux )
+{
+    demux_sys_t             *p_sys  = p_demux->p_sys;
+    MediaSubsessionIterator *iter   = NULL;
+    MediaSubsession         *sub    = NULL;
+
+    vlc_bool_t     b_rtsp_tcp = VLC_FALSE;
+    int            i_client_port;
+    int            i_active_sessions = 0;
+    int            i_return = VLC_SUCCESS;
+    unsigned int   i_buffer = 0;
+    unsigned const thresh = 200000; /* RTP reorder threshold .2 second (default .1) */
+
+    b_rtsp_tcp    = var_CreateGetBool( p_demux, "rtsp-tcp" );
+    i_client_port = var_CreateGetInteger( p_demux, "rtp-client-port" );
+
+    /* Initialise each media subsession */
+    iter = new MediaSubsessionIterator( *p_sys->ms );
+    while( ( sub = iter->next() ) != NULL )
+    {
+        Boolean bInit;
+
+        /* Value taken from mplayer */
+        if( !strcmp( sub->mediumName(), "audio" ) )
+            i_buffer = 100000;
+        else if( !strcmp( sub->mediumName(), "video" ) )
+            i_buffer = 2000000;
+        else continue;
+
+        if( i_client_port != -1 )
+        {
+            sub->setClientPortNum( i_client_port );
+            i_client_port += 2;
+        }
+
+        if( strcasestr( sub->codecName(), "REAL" ) )
+        {
+            msg_Info( p_demux, "real codec detected, using real-RTSP instead" );
+            i_return = VLC_EGENERIC;
+            break;
+        }
+
+        if( !strcmp( sub->codecName(), "X-ASF-PF" ) )
+            bInit = sub->initiate( 4 ); /* Constant ? */
+        else
+            bInit = sub->initiate();
+
+        if( !bInit )
+        {
+            msg_Warn( p_demux, "RTP subsession '%s/%s' failed (%s)",
+                      sub->mediumName(), sub->codecName(),
+                      p_sys->env->getResultMsg() );
+        }
+        else
+        {
+            if( sub->rtpSource() != NULL )
+            {
+                int fd = sub->rtpSource()->RTPgs()->socketNum();
+
+                /* Increase the buffer size */
+                if( i_buffer > 0 )
+                    increaseReceiveBufferTo( *p_sys->env, fd, i_buffer );
+
+                /* Increase the RTP reorder timebuffer just a bit */
+                sub->rtpSource()->setPacketReorderingThresholdTime(thresh);
+            }
+
+            msg_Dbg( p_demux, "RTP subsession '%s/%s'", sub->mediumName(),
+                     sub->codecName() );
+
+            /* Issue the SETUP */
+            if( p_sys->rtsp )
+            {
+                if( !( p_sys->rtsp->setupMediaSubsession( *sub, False,
+                                                   b_rtsp_tcp ? True : False ) ) )
+                {
+                    msg_Err( p_demux, "SETUP of'%s/%s' failed %s", sub->mediumName(),
+                             sub->codecName(), p_sys->env->getResultMsg() );
+                }
+                else i_active_sessions++;
+            } else i_active_sessions++; /* we don't really know, let's just hope it's there */
+
+            if( !p_sys->b_multicast )
+            {
+                /* Check, because we need diff. rollover behaviour for multicast */
+                p_sys->b_multicast = IsMulticastAddress( sub->connectionEndpointAddress() );
+            }
+        }
+    }
+    delete iter;
+    if( i_active_sessions <= 0 ) i_return = VLC_EGENERIC;
+    return i_return;
+}
+
+/*****************************************************************************
+ * Play: starts the actual playback of the stream
+ *****************************************************************************/
+static int Play( demux_t *p_demux )
+{
+    demux_sys_t *p_sys = p_demux->p_sys;
+
+    if( p_sys->rtsp )
+    {
+        /* The PLAY */
+        if( !p_sys->rtsp->playMediaSession( *p_sys->ms ) )
+        {
+            msg_Err( p_demux, "RTSP PLAY failed %s", p_sys->env->getResultMsg() );
+            return VLC_EGENERIC;
+        }
+
+        /* Retrieve the timeout value and set up a timeout prevention thread */
+#if LIVEMEDIA_LIBRARY_VERSION_INT >= 1138089600
+        p_sys->i_timeout = p_sys->rtsp->sessionTimeoutParameter();
+#endif
+        if( p_sys->i_timeout > 0 && !p_sys->p_timeout )
+        {
+            msg_Dbg( p_demux, "We have a timeout of %d seconds",  p_sys->i_timeout );
+            p_sys->p_timeout = (timeout_thread_t *)vlc_object_create( p_demux, sizeof(timeout_thread_t) );
+            p_sys->p_timeout->p_sys = p_demux->p_sys; /* lol, object recursion :D */
+            if( vlc_thread_create( p_sys->p_timeout, "liveMedia-timeout", TimeoutPrevention,
+                                   VLC_THREAD_PRIORITY_LOW, VLC_TRUE ) )
+            {
+                msg_Err( p_demux, "cannot spawn liveMedia timeout thread" );
+                vlc_object_destroy( p_sys->p_timeout );
+            }
+            msg_Dbg( p_demux, "spawned timeout thread" );
+            vlc_object_attach( p_sys->p_timeout, p_demux );
+        }
+    }
+    return VLC_SUCCESS;
+}
+
+
+/*****************************************************************************
  * Demux:
  *****************************************************************************/
 static int Demux( demux_t *p_demux )
@@ -837,7 +914,7 @@
     TaskToken      task;
 
     vlc_bool_t      b_send_pcr = VLC_TRUE;
-    mtime_t         i_pcr = 0;
+    int64_t         i_pcr = 0;
     int             i;
 
     /* Check if we need to send the server a Keep-A-Live signal */
@@ -879,6 +956,9 @@
         }
     }
 
+#if 0
+    /* Disabled because it's simply not reliable enough */
+
     /* When a On Demand QT stream ends, the last frame keeps going with the same PCR/PTS value */
     /* This tests for that, so we can later decide to end this session */
     if( i_pcr > 0 && p_sys->i_pcr == p_sys->i_pcr_previous )
@@ -900,8 +980,9 @@
         msg_Dbg( p_demux, "suspect EOF due to end of VoD session" );
         return 0;
     }
+#endif
 
-    /* First warm we want to read data */
+    /* First warn we want to read data */
     p_sys->event = 0;
     for( i = 0; i < p_sys->i_track; i++ )
     {
@@ -963,7 +1044,6 @@
                 msg_Err( p_demux, "TCP rollover failed, aborting" );
                 return 0;
             }
-            var_SetBool( p_demux, "rtsp-tcp", VLC_TRUE );
         }
         else if( p_sys->i_no_data_ti > 34 )
         {
@@ -971,11 +1051,11 @@
             return 0;
         }
     }
-    else if( !p_sys->b_multicast && p_sys->b_no_data&& p_sys->i_no_data_ti > 34 )
+    else if( !p_sys->b_multicast && p_sys->b_no_data && p_sys->i_no_data_ti > 34 )
     {
         /* EOF ? */
         msg_Warn( p_demux, "no data received in 10s, eof ?" );
-	return 0;
+        return 0;
     }
 
     return p_demux->b_error ? 0 : 1;
@@ -1012,33 +1092,30 @@
             }
             else
             {
-                *pf = 0;
+                *pf = 0.0;
             }
             return VLC_SUCCESS;
 
         case DEMUX_SET_POSITION:
-        {
             float time;
 
             f = (double)va_arg( args, double );
-            time = f * (double)p_sys->i_length / 1000000.0;   /* in second */
-
             if( p_sys->rtsp && p_sys->i_length > 0 )
             {
+                time = f * (double)p_sys->i_length / 1000000.0;   /* in second */
                 if( !p_sys->rtsp->playMediaSession( *p_sys->ms, time ) )
                 {
                     msg_Err( p_demux, "PLAY failed %s",
                         p_sys->env->getResultMsg() );
                     return VLC_EGENERIC;
                 }
-                p_sys->i_start = (mtime_t)(f * (double)p_sys->i_length);
+                p_sys->i_start = (int64_t)(f * (double)p_sys->i_length);
                 p_sys->i_pcr_start = 0;
                 p_sys->i_pcr       = 0;
 
                 return VLC_SUCCESS;
             }
             return VLC_SUCCESS;
-        }
 
         /* Special for access_demux */
         case DEMUX_CAN_PAUSE:
@@ -1111,103 +1188,59 @@
 static int RollOverTcp( demux_t *p_demux )
 {
     demux_sys_t *p_sys = p_demux->p_sys;
-    MediaSubsessionIterator *iter;
+    MediaSubsessionIterator *iter = 0;
     MediaSubsession *sub;
-    char *psz_url;
-    char *psz_options;
-    char *psz_user;
-    char *psz_pwd;
-    uint8_t *p_sdp;
     int i_tk;
+    int i_return;
+
+    var_SetBool( p_demux, "rtsp-tcp", VLC_TRUE );
 
     /* We close the old RTSP session */
     p_sys->rtsp->teardownMediaSession( *p_sys->ms );
 
     Medium::close( p_sys->ms );
-    Medium::close( p_sys->rtsp );
+    RTSPClient::close( p_sys->rtsp );
 
     p_sys->ms = NULL;
     p_sys->rtsp = NULL;
 
     /* Reopen rtsp client */
-    if( ( p_sys->rtsp = RTSPClient::createNew(*p_sys->env, 1/*verbose*/,
-          "VLC media player" ) ) == NULL )
+    if( ( i_return = Connect( p_demux ) ) != VLC_SUCCESS )
     {
-        msg_Err( p_demux, "RTSPClient::createNew failed (%s)",
-                 p_sys->env->getResultMsg() );
-        return VLC_EGENERIC;
+        msg_Err( p_demux, "Failed to connect with rtsp://%s", p_sys->psz_path );
+        goto error;
     }
 
-    asprintf( &psz_url, "rtsp://%s", p_sys->psz_path );
-
-    if( ( psz_options = p_sys->rtsp->sendOptionsCmd( psz_url ) ) )
-        delete [] psz_options;
-
-    psz_user = var_CreateGetString( p_demux, "rtsp-user" );
-    psz_pwd  = var_CreateGetString( p_demux, "rtsp-pwd" );
-
-    if ((*psz_user) && (*psz_pwd))
-        p_sdp = (uint8_t*)p_sys->rtsp->describeWithPassword( psz_url,
-                            psz_user, psz_pwd);
-    else
-        p_sdp = (uint8_t*)p_sys->rtsp->describeURL( psz_url,
-                            NULL, var_CreateGetBool( p_demux, "rtsp-kasenna" ) );
-
-    free( psz_url );
-    free( psz_user );
-    free( psz_pwd );
-
-    if( p_sdp == NULL )
+    if( p_sys->p_sdp == NULL )
     {
-        msg_Err( p_demux, "describeURL failed (%s)",
-                 p_sys->env->getResultMsg() );
-        return VLC_EGENERIC;
+        msg_Err( p_demux, "Failed to retrieve the RTSP Session Description" );
+        goto error;
     }
 
-    /* malloc-ated copy */
-    p_sys->p_sdp = strdup( (char*)p_sdp );
-    delete[] p_sdp;
-
+    /* Create the session from the SDP */
     if( !( p_sys->ms = MediaSession::createNew( *p_sys->env, p_sys->p_sdp ) ) )
     {
-        msg_Err( p_demux, "MediaSession::createNew failed" );
-        return VLC_EGENERIC;
+        msg_Err( p_demux, "Could not create the RTSP Session: %s",
+            p_sys->env->getResultMsg() );
+        goto error;
     }
 
-    /* Initialise each media subsession */
-    iter = new MediaSubsessionIterator( *p_sys->ms );
-    while( ( sub = iter->next() ) != NULL )
+    if( ( i_return = SessionsSetup( p_demux ) ) != VLC_SUCCESS )
     {
-        Boolean bInit;
-
-        if( !strcmp( sub->codecName(), "X-ASF-PF" ) )
-            bInit = sub->initiate( 4 ); /* Constant ? */
-        else
-            bInit = sub->initiate();
-
-        if( !bInit )
-        {
-            msg_Warn( p_demux, "RTP subsession '%s/%s' failed (%s)",
-                      sub->mediumName(), sub->codecName(),
-                      p_sys->env->getResultMsg() );
-            continue;
-        }
-        msg_Dbg( p_demux, "RTP subsession '%s/%s'", sub->mediumName(),
-                 sub->codecName() );
-
-        /* Issue the SETUP */
-        p_sys->rtsp->setupMediaSubsession( *sub, False, True /* tcp */ );
+        msg_Err( p_demux, "Nothing to play for rtsp://%s", p_sys->psz_path );
+        goto error;
     }
 
-    /* The PLAY */
-    if( !p_sys->rtsp->playMediaSession( *p_sys->ms ) )
-    {
-        msg_Err( p_demux, "PLAY failed %s", p_sys->env->getResultMsg() );
-        return VLC_EGENERIC;
-    }
+    /* Retrieve the duration if possible */
+    p_sys->i_length = (int64_t)( p_sys->ms->playEndTime() * 1000000.0 );
+    if( p_sys->i_length < 0 )
+        p_sys->i_length = -1;
+
+    if( ( i_return = Play( p_demux ) ) != VLC_SUCCESS )
+        goto error;
 
     /* Update all tracks */
-    iter->reset();
+    iter = new MediaSubsessionIterator( *p_sys->ms );
     i_tk = 0;
     while( ( sub = iter->next() ) != NULL )
     {
@@ -1218,7 +1251,7 @@
         if( i_tk >= p_sys->i_track )
         {
             msg_Err( p_demux, "WTF !" );
-            break;
+            goto error;
         }
 
         tk = p_sys->track[i_tk];
@@ -1236,10 +1269,13 @@
 
         i_tk++;
     }
-
     delete iter;
 
     return VLC_SUCCESS;
+
+error:
+    if( iter ) delete iter;
+    return VLC_EGENERIC;
 }
 
 
@@ -1255,7 +1291,7 @@
     demux_sys_t    *p_sys = p_demux->p_sys;
     block_t        *p_block;
 
-    mtime_t i_pts = (uint64_t)pts.tv_sec * UI64C(1000000) +
+    int64_t i_pts = (uint64_t)pts.tv_sec * UI64C(1000000) +
         (uint64_t)pts.tv_usec;
 
     /* XXX Beurk beurk beurk Avoid having negative value XXX */
@@ -1340,7 +1376,7 @@
         if( tk->rtpSource->curPacketMarkerBit() )
             p_block->i_flags |= BLOCK_FLAG_END_OF_FRAME;
     }
-    else if( tk->fmt.i_codec == VLC_FOURCC('H','2','6','4') )
+    else if( tk->fmt.i_codec == VLC_FOURCC('h','2','6','4') )
     {
         if( (tk->p_buffer[0] & 0x1f) >= 24 )
             msg_Warn( p_demux, "unsupported NAL type for H264" );
@@ -1366,8 +1402,6 @@
         memcpy( p_block->p_buffer, tk->p_buffer, i_size );
     }
 
-    //p_block->i_rate = p_input->stream.control.i_rate;
-
     if( i_pts != tk->i_pts && !tk->b_muxed )
     {
         p_block->i_dts = ( tk->fmt.i_cat == VIDEO_ES ) ? 0 : i_pts;
@@ -1387,7 +1421,7 @@
         es_out_Send( p_demux->out, tk->p_es, p_block );
     }
 
-    /* warm that's ok */
+    /* warn that's ok */
     p_sys->event = 0xff;
 
     /* we have read data */
@@ -1440,7 +1474,7 @@
     p_timeout->i_remain *= 1000000;
 
     vlc_thread_ready( p_timeout );
-    
+
     /* Avoid lock */
     while( !p_timeout->b_die )
     {
@@ -1512,6 +1546,7 @@
                                           unsigned int& configSize )
 {
     char *dup, *psz;
+    int i, i_records = 1;
 
     if( configSize )
     configSize = 0;
@@ -1521,22 +1556,27 @@
 
     psz = dup = strdup( configStr );
 
-    unsigned char *cfg = new unsigned char[5 * strlen(psz)];
-    for( ;; )
+    /* Count the number of comma's */
+    for( psz = dup; *psz != '\0'; ++psz )
     {
-        char *p = strchr( psz, ',' );
-        if( p )
-            *p++ = '\0';
+        if( *psz == ',')
+        {
+            ++i_records;
+            *psz = '\0';
+        }
+    }
 
+    unsigned char *cfg = new unsigned char[5 * strlen(dup)];
+    psz = dup;
+    for( i = 0; i < i_records; i++ )
+    {
         cfg[configSize++] = 0x00;
         cfg[configSize++] = 0x00;
         cfg[configSize++] = 0x00;
         cfg[configSize++] = 0x01;
-        configSize += b64_decode( (char*)&cfg[configSize], psz );
 
-        if( p == NULL )
-            break;
-        psz = p;
+        configSize += b64_decode( (char*)&cfg[configSize], psz );
+        psz += strlen(psz)+1;
     }
 
     if( dup ) free( dup );
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/Makefile.in vlc-0.8.6-svn20061008.debian/modules/demux/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/demux/Makefile.in	2006-09-18 06:30:45.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/Makefile.in	2006-10-08 12:42:48.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/mjpeg.c vlc-0.8.6-svn20061008.debian/modules/demux/mjpeg.c
--- vlc-0.8.6-svn20060918.debian/modules/demux/mjpeg.c	2006-09-18 06:28:17.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/mjpeg.c	2006-10-08 12:40:54.000000000 -0400
@@ -2,7 +2,7 @@
  * mjpeg.c : demuxes mjpeg webcam http streams
  *****************************************************************************
  * Copyright (C) 2004 the VideoLAN team
- * $Id: mjpeg.c 14790 2006-03-18 02:06:16Z xtophe $
+ * $Id: mjpeg.c 16987 2006-10-08 12:54:12Z jpsaman $
  *
  * Authors: Henry Jen (slowhog) <henryjen@ztune.net>
  *          Derk-Jan Hartman (thedj)
@@ -157,7 +157,7 @@
         msg_Err( p_demux, "out of memory" );
         return NULL;
     }
-    strncpy ( p_line, p_buf, i );
+    strncpy ( p_line, (char *)p_buf, i );
     p_line[i] = '\0';
 //    msg_Dbg( p_demux, "i = %d, pos = %d, %s", i, *p_pos, p_line );
     return p_line;
@@ -215,8 +215,8 @@
             msg_Warn( p_demux, "separator %s does not match %s", psz_line,
                       p_sys->psz_separator );
         }
-        free( psz_line );
     }
+    free( psz_line );
     psz_line = GetLine( p_demux, &i_pos );
     while( psz_line && *psz_line )
     {
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/mkv.cpp vlc-0.8.6-svn20061008.debian/modules/demux/mkv.cpp
--- vlc-0.8.6-svn20060918.debian/modules/demux/mkv.cpp	2006-09-18 06:28:17.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/mkv.cpp	2006-09-22 11:14:29.000000000 -0400
@@ -2,7 +2,7 @@
  * mkv.cpp : matroska demuxer
  *****************************************************************************
  * Copyright (C) 2003-2004 the VideoLAN team
- * $Id: mkv.cpp 16588 2006-09-10 17:09:03Z sam $
+ * $Id: mkv.cpp 16773 2006-09-21 18:46:25Z hartman $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *          Steve Lhomme <steve.lhomme@free.fr>
@@ -1997,7 +1997,7 @@
                 if ( f_mandatory )
                     p_block->i_dts = p_block->i_pts;
                 else
-                    p_block->i_dts = min( i_pts, tk->i_last_dts + (tk->i_default_duration >> 10));
+                    p_block->i_dts = min( i_pts, tk->i_last_dts + (mtime_t)(tk->i_default_duration >> 10));
                 p_sys->i_pts = p_block->i_dts;
             }
         }
@@ -2200,17 +2200,17 @@
             {
                 tracks[i_track]->fmt.i_codec = VLC_FOURCC( 'D', 'I', 'V', '3' );
             }
-            else if( !strcmp( tracks[i_track]->psz_codec, "V_MPEG4/ISO/AVC" ) )
+            else if( !strncmp( tracks[i_track]->psz_codec, "V_MPEG4/ISO", 11 ) )
             {
-                tracks[i_track]->fmt.i_codec = VLC_FOURCC( 'a', 'v', 'c', '1' );
+                /* A MPEG 4 codec, SP, ASP, AP or AVC */
+                if( !strcmp( tracks[i_track]->psz_codec, "V_MPEG4/ISO/AVC" ) )
+                    tracks[i_track]->fmt.i_codec = VLC_FOURCC( 'a', 'v', 'c', '1' );
+                else
+                    tracks[i_track]->fmt.i_codec = VLC_FOURCC( 'm', 'p', '4', 'v' );
                 tracks[i_track]->fmt.i_extra = tracks[i_track]->i_extra_data;
                 tracks[i_track]->fmt.p_extra = malloc( tracks[i_track]->i_extra_data );
                 memcpy( tracks[i_track]->fmt.p_extra,tracks[i_track]->p_extra_data, tracks[i_track]->i_extra_data );
             }
-            else
-            {
-                tracks[i_track]->fmt.i_codec = VLC_FOURCC( 'm', 'p', '4', 'v' );
-            }
         }
         else if( !strcmp( tracks[i_track]->psz_codec, "V_QUICKTIME" ) )
         {
@@ -4923,8 +4923,6 @@
  *****************************************************************************/
 void matroska_segment_c::InformationCreate( )
 {
-    size_t      i_track;
-
     sys.meta = vlc_meta_New();
 
     if( psz_title )
@@ -4935,6 +4933,7 @@
     {
         vlc_meta_Add( sys.meta, VLC_META_DATE, psz_date_utc );
     }
+#if 0
     if( psz_segment_filename )
     {
         vlc_meta_Add( sys.meta, _("Segment filename"), psz_segment_filename );
@@ -4948,7 +4947,7 @@
         vlc_meta_Add( sys.meta, _("Writing application"), psz_writing_application );
     }
 
-    for( i_track = 0; i_track < tracks.size(); i_track++ )
+    for( size_t i_track = 0; i_track < tracks.size(); i_track++ )
     {
         mkv_track_t *tk = tracks[i_track];
         vlc_meta_t *mtk = vlc_meta_New();
@@ -4978,6 +4977,7 @@
             vlc_meta_Add( sys.meta, VLC_META_URL, tk->psz_codec_download_url );
         }
     }
+#endif
 
     if( i_tags_position >= 0 )
     {
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/mp4/drms.c vlc-0.8.6-svn20061008.debian/modules/demux/mp4/drms.c
--- vlc-0.8.6-svn20060918.debian/modules/demux/mp4/drms.c	2006-09-18 06:28:16.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/mp4/drms.c	2006-10-08 12:40:54.000000000 -0400
@@ -2,7 +2,7 @@
  * drms.c: DRMS
  *****************************************************************************
  * Copyright (C) 2004 the VideoLAN team
- * $Id: drms.c 16441 2006-08-30 21:36:35Z hartman $
+ * $Id: drms.c 16993 2006-10-08 14:17:51Z jpsaman $
  *
  * Authors: Jon Lech Johansen <jon-vl@nanocrew.net>
  *          Sam Hocevar <sam@zoy.org>
@@ -716,8 +716,8 @@
         int32_t i_hash;
 
         InitMD5( &md5 );
-        AddMD5( &md5, (uint8_t *)p_sys_key, 16 );
-        AddMD5( &md5, (uint8_t *)p_secret1, 4 );
+        AddMD5( &md5, (const uint8_t *)p_sys_key, 16 );
+        AddMD5( &md5, (const uint8_t *)p_secret1, 4 );
         EndMD5( &md5 );
 
         p_secret1[ 3 ]++;
@@ -824,11 +824,11 @@
     {
         p_big_bordel[ i ] = U32_AT(p_bordel + i);
     }
-    AddMD5( &md5, (uint8_t *)p_big_bordel, 64 );
+    AddMD5( &md5, (const uint8_t *)p_big_bordel, 64 );
     if( p_shuffle->i_version == 0x01000300 )
     {
-        AddMD5( &md5, (uint8_t *)p_secret3, sizeof(p_secret3) );
-        AddMD5( &md5, (uint8_t *)p_secret4, i_secret );
+        AddMD5( &md5, (const uint8_t *)p_secret3, sizeof(p_secret3) );
+        AddMD5( &md5, (const uint8_t *)p_secret4, i_secret );
     }
     EndMD5( &md5 );
 
@@ -1522,21 +1522,21 @@
     /* Combine our system info hash with additional secret data. The resulting
      * MD5 hash will be our system key. */
     InitMD5( &md5 );
-    AddMD5( &md5, p_secret5, 8 );
+    AddMD5( &md5, (const uint8_t*)p_secret5, 8 );
 
     if( !b_ipod )
     {
-        AddMD5( &md5, (uint8_t *)p_system_hash, 6 );
-        AddMD5( &md5, (uint8_t *)p_system_hash, 6 );
-        AddMD5( &md5, (uint8_t *)p_system_hash, 6 );
-        AddMD5( &md5, p_secret6, 8 );
+        AddMD5( &md5, (const uint8_t *)p_system_hash, 6 );
+        AddMD5( &md5, (const uint8_t *)p_system_hash, 6 );
+        AddMD5( &md5, (const uint8_t *)p_system_hash, 6 );
+        AddMD5( &md5, (const uint8_t*)p_secret6, 8 );
     }
     else
     {
         i_ipod_id = U64_AT(&i_ipod_id);
-        AddMD5( &md5, (uint8_t *)&i_ipod_id, sizeof(i_ipod_id) );
-        AddMD5( &md5, (uint8_t *)&i_ipod_id, sizeof(i_ipod_id) );
-        AddMD5( &md5, (uint8_t *)&i_ipod_id, sizeof(i_ipod_id) );
+        AddMD5( &md5, (const uint8_t *)&i_ipod_id, sizeof(i_ipod_id) );
+        AddMD5( &md5, (const uint8_t *)&i_ipod_id, sizeof(i_ipod_id) );
+        AddMD5( &md5, (const uint8_t *)&i_ipod_id, sizeof(i_ipod_id) );
     }
 
     EndMD5( &md5 );
@@ -1905,7 +1905,7 @@
 
     GetVolumeInformation( _T("C:\\"), NULL, 0, &i_serial,
                           NULL, NULL, NULL, 0 );
-    AddMD5( &md5, (uint8_t *)&i_serial, 4 );
+    AddMD5( &md5, (const uint8_t *)&i_serial, 4 );
 
     for( i = 0; i < sizeof(p_reg_keys) / sizeof(p_reg_keys[ 0 ]); i++ )
     {
@@ -1930,7 +1930,7 @@
                                  NULL, NULL, p_reg_buf,
                                  &i_size ) == ERROR_SUCCESS )
             {
-                AddMD5( &md5, (uint8_t *)p_reg_buf, i_size );
+                AddMD5( &md5, (const uint8_t *)p_reg_buf, i_size );
             }
 
             free( p_reg_buf );
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/mp4/libmp4.c vlc-0.8.6-svn20061008.debian/modules/demux/mp4/libmp4.c
--- vlc-0.8.6-svn20060918.debian/modules/demux/mp4/libmp4.c	2006-09-18 06:28:16.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/mp4/libmp4.c	2006-10-08 12:40:54.000000000 -0400
@@ -2,7 +2,7 @@
  * libmp4.c : LibMP4 library for mp4 module for vlc
  *****************************************************************************
  * Copyright (C) 2001-2004 the VideoLAN team
- * $Id: libmp4.c 15203 2006-04-13 14:47:20Z hartman $
+ * $Id: libmp4.c 16994 2006-10-08 14:40:02Z jpsaman $
  *
  * Author: Laurent Aimar <fenrir@via.ecp.fr>
  *
@@ -65,13 +65,13 @@
     MP4_GET3BYTES( p_void->i_flags )
 
 #define MP4_GETSTRINGZ( p_str ) \
-    if( ( i_read > 0 )&&(p_peek[0] ) ) \
+    if( ( i_read > 0 )&&( p_peek[0] ) ) \
     { \
-        p_str = calloc( sizeof( char ), __MIN( strlen( p_peek ), i_read )+1);\
-        memcpy( p_str, p_peek, __MIN( strlen( p_peek ), i_read ) ); \
-        p_str[__MIN( strlen( p_peek ), i_read )] = 0; \
-        p_peek += strlen( p_str ) + 1; \
-        i_read -= strlen( p_str ) + 1; \
+        p_str = calloc( sizeof( char ), __MIN( strlen( (char*)p_peek ), i_read )+1);\
+        memcpy( p_str, p_peek, __MIN( strlen( (char*)p_peek ), i_read ) ); \
+        p_str[__MIN( strlen( (char*)p_peek ), i_read )] = 0; \
+        p_peek += strlen( (char *)p_str ) + 1; \
+        i_read -= strlen( (char *)p_str ) + 1; \
     } \
     else \
     { \
@@ -958,8 +958,11 @@
     p_avcC = p_box->data.p_avcC;
 
     p_avcC->i_avcC = i_read;
-    p_avcC->p_avcC = malloc( p_avcC->i_avcC );
-    memcpy( p_avcC->p_avcC, p_peek, i_read );
+    if( p_avcC->i_avcC > 0 )
+    {
+        p_avcC->p_avcC = malloc( p_avcC->i_avcC );
+        memcpy( p_avcC->p_avcC, p_peek, i_read );
+    }
 
     MP4_GET1BYTE( p_avcC->i_version );
     MP4_GET1BYTE( p_avcC->i_profile );
@@ -1031,6 +1034,12 @@
     MP4_Box_data_avcC_t *p_avcC = p_box->data.p_avcC;
     int i;
 
+    if( p_avcC->i_avcC > 0 )
+    {
+        if( p_avcC->p_avcC )
+             free( p_avcC->p_avcC );
+        p_avcC->p_avcC = NULL;
+    }
     for( i = 0; i < p_avcC->i_sps; i++ )
     {
         FREE( p_avcC->sps[i] );
@@ -1039,8 +1048,20 @@
     {
         FREE( p_avcC->pps[i] );
     }
-    if( p_avcC->i_sps > 0 ) FREE( p_avcC->sps );
-    if( p_avcC->i_pps > 0 ) FREE( p_avcC->pps );
+    if( p_avcC->i_sps > 0 )
+    {
+        FREE( p_avcC->sps );
+        p_avcC->sps = NULL;
+        FREE( p_avcC->i_sps_length );
+        p_avcC->i_sps_length = NULL;
+    }
+    if( p_avcC->i_pps > 0 )
+    {
+        FREE( p_avcC->pps );
+        p_avcC->pps = NULL;
+        FREE( p_avcC->i_pps_length );
+        p_avcC->i_pps_length = NULL;
+    }
 }
 
 static int MP4_ReadBox_sample_soun( stream_t *p_stream, MP4_Box_t *p_box )
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/mp4/Makefile.in vlc-0.8.6-svn20061008.debian/modules/demux/mp4/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/demux/mp4/Makefile.in	2006-09-18 06:30:46.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/mp4/Makefile.in	2006-10-08 12:42:49.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/mp4/mp4.c vlc-0.8.6-svn20061008.debian/modules/demux/mp4/mp4.c
--- vlc-0.8.6-svn20060918.debian/modules/demux/mp4/mp4.c	2006-09-18 06:28:16.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/mp4/mp4.c	2006-10-08 12:40:54.000000000 -0400
@@ -2,7 +2,7 @@
  * mp4.c : MP4 file input module for vlc
  *****************************************************************************
  * Copyright (C) 2001-2004 the VideoLAN team
- * $Id: mp4.c 16434 2006-08-30 15:18:13Z hartman $
+ * $Id: mp4.c 16987 2006-10-08 12:54:12Z jpsaman $
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *
  * This program is free software; you can redistribute it and/or modify
@@ -29,6 +29,7 @@
 #include <vlc/input.h>
 #include <vlc_playlist.h>
 #include <vlc_md5.h>
+#include "charset.h"
 #include "iso_lang.h"
 #include "vlc_meta.h"
 
@@ -674,7 +675,7 @@
                             p_block->i_buffer = i_size + 1;
 
                             /* convert \r -> \n */
-                            while( ( p = strchr( p_block->p_buffer, '\r' ) ) )
+                            while( ( p = strchr( (char*)p_block->p_buffer, '\r' ) ) )
                             {
                                 *p = '\n';
                             }
@@ -1469,6 +1470,10 @@
             p_track->fmt.video.i_aspect =
                 VOUT_ASPECT_FACTOR * p_track->i_width / p_track->i_height;
 
+        /* Support for cropping (eg. in H263 files) */
+        p_track->fmt.video.i_visible_width = p_track->fmt.video.i_width;
+        p_track->fmt.video.i_visible_height = p_track->fmt.video.i_height;
+
         /* Frame rate */
         p_track->fmt.video.i_frame_rate = p_track->i_timescale;
         p_track->fmt.video.i_frame_rate_base = 1;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/mpeg/h264.c vlc-0.8.6-svn20061008.debian/modules/demux/mpeg/h264.c
--- vlc-0.8.6-svn20060918.debian/modules/demux/mpeg/h264.c	2006-09-18 06:28:17.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/mpeg/h264.c	2006-10-08 12:40:54.000000000 -0400
@@ -2,7 +2,7 @@
  * h264.c : H264 Video demuxer
  *****************************************************************************
  * Copyright (C) 2002-2004 the VideoLAN team
- * $Id: h264.c 14719 2006-03-11 17:35:55Z zorglub $
+ * $Id: h264.c 16965 2006-10-07 16:02:30Z hartman $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *
@@ -75,33 +75,23 @@
 {
     demux_t     *p_demux = (demux_t*)p_this;
     demux_sys_t *p_sys;
-    vlc_bool_t   b_forced = VLC_FALSE;
-
     uint8_t     *p_peek;
     vlc_value_t val;
 
-    if( stream_Peek( p_demux->s, &p_peek, 5 ) < 5 )
-    {
-        msg_Err( p_demux, "cannot peek" );
-        return VLC_EGENERIC;
-    }
-
-    if( !strncmp( p_demux->psz_demux, "h264", 4 ) )
-    {
-        b_forced = VLC_TRUE;
-    }
+    if( stream_Peek( p_demux->s, &p_peek, 5 ) < 5 ) return VLC_EGENERIC;
 
     if( p_peek[0] != 0x00 || p_peek[1] != 0x00 ||
         p_peek[2] != 0x00 || p_peek[3] != 0x01 ||
         (p_peek[4]&0x1F) != 7 ) /* SPS */
     {
-        if( !b_forced )
+        if( !p_demux->b_force )
         {
             msg_Warn( p_demux, "h264 module discarded (no startcode)" );
             return VLC_EGENERIC;
         }
 
-        msg_Err( p_demux, "this doesn't look like a H264 ES stream, continuing" );
+        msg_Err( p_demux, "this doesn't look like a H264 ES stream, "
+                 "continuing anyway" );
     }
 
     p_demux->pf_demux  = Demux;
@@ -112,10 +102,7 @@
     var_Create( p_demux, "h264-fps", VLC_VAR_FLOAT|VLC_VAR_DOINHERIT );
     var_Get( p_demux, "h264-fps", &val );
     p_sys->f_fps = val.f_float;
-    if( val.f_float < 0.001 )
-    {
-        p_sys->f_fps = 0.001;
-    }
+    if( val.f_float < 0.001 ) p_sys->f_fps = 0.001;
     msg_Dbg( p_demux, "using %.2f fps", p_sys->f_fps );
 
     /*
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/mpeg/m4v.c vlc-0.8.6-svn20061008.debian/modules/demux/mpeg/m4v.c
--- vlc-0.8.6-svn20060918.debian/modules/demux/mpeg/m4v.c	2006-09-18 06:28:17.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/mpeg/m4v.c	2006-10-08 12:40:54.000000000 -0400
@@ -2,7 +2,7 @@
  * m4v.c : MPEG-4 Video demuxer
  *****************************************************************************
  * Copyright (C) 2002-2004 the VideoLAN team
- * $Id: m4v.c 16457 2006-08-31 20:51:12Z hartman $
+ * $Id: m4v.c 16965 2006-10-07 16:02:30Z hartman $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *
@@ -69,33 +69,21 @@
 {
     demux_t     *p_demux = (demux_t*)p_this;
     demux_sys_t *p_sys;
-    vlc_bool_t   b_forced = VLC_FALSE;
 
     uint8_t     *p_peek;
 
-    es_format_t  fmt;
+    if( stream_Peek( p_demux->s, &p_peek, 4 ) < 4 ) return VLC_EGENERIC;
 
-    if( stream_Peek( p_demux->s, &p_peek, 4 ) < 4 )
+    if( p_peek[0] != 0x00 || p_peek[1] != 0x00 || p_peek[2] != 0x01 )
     {
-        msg_Err( p_demux, "cannot peek" );
-        return VLC_EGENERIC;
-    }
-
-    if( !strncmp( p_demux->psz_demux, "mp4v", 4 ) ||
-        !strncmp( p_demux->psz_demux, "m4v", 4 ) )
-    {
-        b_forced = VLC_TRUE;
-    }
-
-    if( p_peek[0] != 0x00 || p_peek[1] != 0x00 || p_peek[2] != 0x01 || p_peek[3] > 0x2f )
-    {
-        if( !b_forced )
+        if( !p_demux->b_force )
         {
             msg_Warn( p_demux, "m4v module discarded (no startcode)" );
             return VLC_EGENERIC;
         }
 
-        msg_Warn( p_demux, "this doesn't look like an MPEG-4 ES stream, continuing anyway" );
+        msg_Warn( p_demux, "this doesn't look like an MPEG-4 ES stream, "
+                  "continuing anyway" );
     }
 
     p_demux->pf_demux  = Demux;
@@ -126,7 +114,7 @@
         return VLC_EGENERIC;
     }
 
-    /* We need to wait until we gtt p_extra (VOL header) from the packetizer
+    /* We need to wait until we get p_extra (VOL header) from the packetizer
      * before we create the output */
 
     return VLC_SUCCESS;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/mpeg/Makefile.in vlc-0.8.6-svn20061008.debian/modules/demux/mpeg/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/demux/mpeg/Makefile.in	2006-09-18 06:30:46.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/mpeg/Makefile.in	2006-10-08 12:42:49.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/playlist/Makefile.in vlc-0.8.6-svn20061008.debian/modules/demux/playlist/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/demux/playlist/Makefile.in	2006-09-18 06:30:47.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/playlist/Makefile.in	2006-10-08 12:42:50.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/playlist/old.c vlc-0.8.6-svn20061008.debian/modules/demux/playlist/old.c
--- vlc-0.8.6-svn20060918.debian/modules/demux/playlist/old.c	2006-09-18 06:28:17.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/playlist/old.c	2006-10-08 12:40:54.000000000 -0400
@@ -2,7 +2,7 @@
  * old.c : Old playlist format import
  *****************************************************************************
  * Copyright (C) 2004 the VideoLAN team
- * $Id: old.c 14377 2006-02-18 20:34:32Z courmisch $
+ * $Id: old.c 16994 2006-10-08 14:40:02Z jpsaman $
  *
  * Authors: Clment Stenac <zorglub@videolan.org>
  *
@@ -61,6 +61,12 @@
     return VLC_SUCCESS;
 }
 
+void E_(Close_Old)( vlc_object_t *p_this )
+{
+    demux_t *p_demux = (demux_t *)p_this;
+    msg_Dbg( p_demux, "close old playlist file" );
+}
+
 static int Demux( demux_t *p_demux)
 {
     char *psz_line;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/playlist/playlist.c vlc-0.8.6-svn20061008.debian/modules/demux/playlist/playlist.c
--- vlc-0.8.6-svn20060918.debian/modules/demux/playlist/playlist.c	2006-09-18 06:28:17.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/playlist/playlist.c	2006-10-08 12:40:54.000000000 -0400
@@ -2,7 +2,7 @@
  * playlist.c :  Playlist import module
  *****************************************************************************
  * Copyright (C) 2004 the VideoLAN team
- * $Id: playlist.c 15386 2006-04-28 12:09:04Z dionoea $
+ * $Id: playlist.c 16994 2006-10-08 14:40:02Z jpsaman $
  *
  * Authors: Clment Stenac <zorglub@videolan.org>
  *
@@ -54,7 +54,7 @@
     set_description( _("Playlist") );
     add_shortcut( "old-open" );
     set_capability( "demux2", 10 );
-    set_callbacks( E_(Import_Old), NULL );
+    set_callbacks( E_(Import_Old), E_(Close_Old) );
 #if 0
     add_submodule();
         set_description( _("Native playlist import") );
@@ -93,7 +93,7 @@
         set_description( _("XSPF playlist import") );
         add_shortcut( "xspf-open" );
         set_capability( "demux2", 10 );
-        set_callbacks( E_(xspf_import_Activate), NULL );
+        set_callbacks( E_(Import_xspf), E_(Close_xspf) );
     add_submodule();
         set_description( _("New winamp 5.2 shoutcast import") );
         add_shortcut( "shout-winamp" );
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/playlist/playlist.h vlc-0.8.6-svn20061008.debian/modules/demux/playlist/playlist.h
--- vlc-0.8.6-svn20060918.debian/modules/demux/playlist/playlist.h	2006-09-18 06:28:17.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/playlist/playlist.h	2006-10-08 12:40:54.000000000 -0400
@@ -2,7 +2,7 @@
  * playlist.h:  Playlist import module common functions
  *****************************************************************************
  * Copyright (C) 2004 the VideoLAN team
- * $Id: playlist.h 15386 2006-04-28 12:09:04Z dionoea $
+ * $Id: playlist.h 16994 2006-10-08 14:40:02Z jpsaman $
  *
  * Authors: Sigmund Augdal Helberg <dnumgis@videolan.org>
  *
@@ -27,6 +27,7 @@
 vlc_bool_t E_(FindItem)( demux_t *, playlist_t *, playlist_item_t **);
 
 int E_(Import_Old) ( vlc_object_t * );
+void E_(Close_Old) ( vlc_object_t *);
 
 int E_(Import_Native) ( vlc_object_t * );
 void E_(Close_Native) ( vlc_object_t * );
@@ -46,7 +47,8 @@
 int E_(Import_podcast) ( vlc_object_t * );
 void E_(Close_podcast) ( vlc_object_t * );
 
-int E_(xspf_import_Activate) ( vlc_object_t * );
+int E_(Import_xspf) ( vlc_object_t * );
+void E_(Close_xspf) ( vlc_object_t * );
 
 int E_(Import_Shoutcast) ( vlc_object_t * );
 void E_(Close_Shoutcast) ( vlc_object_t * );
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/playlist/xspf.c vlc-0.8.6-svn20061008.debian/modules/demux/playlist/xspf.c
--- vlc-0.8.6-svn20060918.debian/modules/demux/playlist/xspf.c	2006-09-18 06:28:17.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/playlist/xspf.c	2006-10-08 12:40:54.000000000 -0400
@@ -33,7 +33,7 @@
 /**
  * \brief XSPF submodule initialization function
  */
-int E_(xspf_import_Activate)( vlc_object_t *p_this )
+int E_(Import_xspf)( vlc_object_t *p_this )
 {
     demux_t *p_demux = (demux_t *)p_this;
     char    *psz_ext;
@@ -57,6 +57,12 @@
     return VLC_SUCCESS;
 }
 
+void E_(Close_xspf)( vlc_object_t *p_this )
+{
+    demux_t *p_demux = (demux_t *)p_this;
+    msg_Dbg( p_demux, "closing xspf playlist" );	
+}
+
 /**
  * \brief demuxer function for XSPF parsing
  */
@@ -657,7 +663,7 @@
                                    playlist_item_t **pp_new, char *psz_location )
 {
     char *psz_uri=NULL;
-    psz_uri = unescape_URI_duplicate( psz_location );
+    psz_uri = decode_URI_duplicate( psz_location );
 
     if ( psz_uri )
     {
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/playlist/xspf.h vlc-0.8.6-svn20061008.debian/modules/demux/playlist/xspf.h
--- vlc-0.8.6-svn20060918.debian/modules/demux/playlist/xspf.h	2006-09-18 06:28:17.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/playlist/xspf.h	2006-10-08 12:40:54.000000000 -0400
@@ -15,6 +15,9 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
  *******************************************************************************/
+#ifndef _XSPF_H_
+#define _XSPF_H_ 1
+
 /**
  * \file modules/demux/playlist/xspf.h
  * \brief XSPF playlist import: prototypes, datatypes, defines
@@ -60,3 +63,5 @@
         vlc_bool_t (*cmplx) COMPLEX_INTERFACE;
     } pf_handler;
 } xml_elem_hnd_t;
+
+#endif /* _XSPF_H_ */
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/ps.c vlc-0.8.6-svn20061008.debian/modules/demux/ps.c
--- vlc-0.8.6-svn20060918.debian/modules/demux/ps.c	2006-09-18 06:28:17.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/ps.c	2006-09-21 11:50:22.000000000 -0400
@@ -2,7 +2,7 @@
  * ps.c: Program Stream demux module for VLC.
  *****************************************************************************
  * Copyright (C) 2004 the VideoLAN team
- * $Id: ps.c 16544 2006-09-07 23:05:11Z hartman $
+ * $Id: ps.c 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *
@@ -124,6 +124,7 @@
     p_sys->i_scr      = -1;
     p_sys->i_length   = -1;
     p_sys->i_current_pts = (mtime_t) 0;
+    p_sys->i_time_track = -1;
     
     p_sys->b_lost_sync = VLC_FALSE;
     p_sys->b_have_pack = VLC_FALSE;
@@ -441,7 +442,7 @@
 
         case DEMUX_GET_TIME:
             pi64 = (int64_t*)va_arg( args, int64_t * );
-            if( p_sys->i_current_pts > 0 )
+            if( p_sys->i_time_track >= 0 && p_sys->i_current_pts > 0 )
             {
                 *pi64 = p_sys->i_current_pts - p_sys->tk[p_sys->i_time_track].i_first_pts;
                 return VLC_SUCCESS;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/real.c vlc-0.8.6-svn20061008.debian/modules/demux/real.c
--- vlc-0.8.6-svn20060918.debian/modules/demux/real.c	2006-09-18 06:28:17.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/real.c	2006-10-08 12:40:54.000000000 -0400
@@ -2,7 +2,7 @@
  * real.c: Real demuxer.
  *****************************************************************************
  * Copyright (C) 2004, 2006 the VideoLAN team
- * $Id: real.c 16441 2006-08-30 21:36:35Z hartman $
+ * $Id: real.c 16987 2006-10-08 12:54:12Z jpsaman $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *
@@ -171,7 +171,7 @@
             if( tk->p_subpackets[ j ] )
                 block_Release( tk->p_subpackets[ j ] );
         }
-        if( !tk->i_subpackets ) free( tk->p_subpackets );
+        if( tk->i_subpackets ) free( tk->p_subpackets );
 
         free( tk );
     }
@@ -702,7 +702,7 @@
         msg_Dbg( p_demux, "object %4.4s size=%d version=%d",
                  (char*)&i_id, i_size, i_version );
 
-        if( i_size < 10 )
+        if( (i_size < 10) && (i_id != VLC_FOURCC('D','A','T','A')) )
         {
             msg_Dbg( p_demux, "invalid size for object %4.4s", (char*)&i_id );
             return VLC_EGENERIC;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/subtitle.c vlc-0.8.6-svn20061008.debian/modules/demux/subtitle.c
--- vlc-0.8.6-svn20060918.debian/modules/demux/subtitle.c	2006-09-18 06:28:17.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/subtitle.c	2006-09-22 11:14:29.000000000 -0400
@@ -2,7 +2,7 @@
  * subtitle.c: Demux for subtitle text files.
  *****************************************************************************
  * Copyright (C) 1999-2004 the VideoLAN team
- * $Id: subtitle.c 14790 2006-03-18 02:06:16Z xtophe $
+ * $Id: subtitle.c 16773 2006-09-21 18:46:25Z hartman $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *          Derk-Jan Hartman <hartman at videolan dot org>
@@ -171,13 +171,14 @@
  *****************************************************************************/
 static int Open ( vlc_object_t *p_this )
 {
-    demux_t     *p_demux = (demux_t*)p_this;
-    demux_sys_t *p_sys;
-    es_format_t fmt;
-    float f_fps;
-    char *psz_type;
+    demux_t        *p_demux = (demux_t*)p_this;
+    demux_sys_t    *p_sys;
+    es_format_t    fmt;
+    input_thread_t *p_input;
+    float          f_fps;
+    char           *psz_type;
     int  (*pf_read)( demux_t *, subtitle_t* );
-    int i, i_max;
+    int            i, i_max;
 
     if( strcmp( p_demux->psz_demux, "subtitle" ) )
     {
@@ -188,11 +189,12 @@
     p_demux->pf_demux = Demux;
     p_demux->pf_control = Control;
     p_demux->p_sys = p_sys = malloc( sizeof( demux_sys_t ) );
-    p_sys->psz_header = NULL;
-    p_sys->i_subtitle = 0;
-    p_sys->i_subtitles= 0;
-    p_sys->subtitle   = NULL;
-
+    p_sys->psz_header         = NULL;
+    p_sys->i_subtitle         = 0;
+    p_sys->i_subtitles        = 0;
+    p_sys->subtitle           = NULL;
+    p_sys->i_microsecperframe = 0;
+    p_sys->i_original_mspf    = 0;
 
     /* Get the FPS */
     f_fps = var_CreateGetFloat( p_demux, "sub-fps" );
@@ -200,19 +202,15 @@
     {
         p_sys->i_microsecperframe = (int64_t)( (float)1000000 / f_fps );
     }
-    else
-    {
-        p_sys->i_microsecperframe = 0;
-    }
 
-    f_fps = var_CreateGetFloat( p_demux, "sub-original-fps" );
-    if( f_fps >= 1.0 )
+    p_input = (input_thread_t *)vlc_object_find( p_demux, VLC_OBJECT_INPUT, FIND_PARENT );
+    if( p_input )
     {
-        p_sys->i_original_mspf = (int64_t)( (float)1000000 / f_fps );
-    }
-    else
-    {
-        p_sys->i_original_mspf = 0;
+        f_fps = var_GetFloat( p_input, "sub-original-fps" );
+        if( f_fps >= 1.0 )
+            p_sys->i_original_mspf = (int64_t)( (float)1000000 / f_fps );
+
+        vlc_object_release( p_input );
     }
 
     /* Get or probe the type */
@@ -711,6 +709,7 @@
     p_subtitle->i_stop  = 0;
     p_subtitle->psz_text = NULL;
 
+next:
     for( ;; )
     {
         if( ( s = TextGetLine( txt ) ) == NULL )
@@ -727,6 +726,15 @@
             break;
         }
     }
+    if( i_start == 1 && i_stop == 1 )
+    {
+        /* We found a possible setting of the framerate "{1}{1}23.976" */
+        float tmp = us_strtod( buffer_text, NULL );
+        if( tmp > 0.0 && !var_GetFloat( p_demux, "sub-fps" ) > 0.0 )
+            p_sys->i_microsecperframe = (int64_t)( (float)1000000 / tmp );
+        goto next;
+    }
+
     /* replace | by \n */
     for( i = 0; i < strlen( buffer_text ); i++ )
     {
diff -uNr vlc-0.8.6-svn20060918.debian/modules/demux/util/Makefile.in vlc-0.8.6-svn20061008.debian/modules/demux/util/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/demux/util/Makefile.in	2006-09-18 06:30:47.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/demux/util/Makefile.in	2006-10-08 12:42:50.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/beos/InterfaceWindow.cpp vlc-0.8.6-svn20061008.debian/modules/gui/beos/InterfaceWindow.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/beos/InterfaceWindow.cpp	2006-09-18 06:28:21.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/beos/InterfaceWindow.cpp	2006-09-22 11:14:30.000000000 -0400
@@ -2,7 +2,7 @@
  * InterfaceWindow.cpp: beos interface
  *****************************************************************************
  * Copyright (C) 1999, 2000, 2001 the VideoLAN team
- * $Id: InterfaceWindow.cpp 13905 2006-01-12 23:10:04Z dionoea $
+ * $Id: InterfaceWindow.cpp 16773 2006-09-21 18:46:25Z hartman $
  *
  * Authors: Jean-Marc Dressler <polux@via.ecp.fr>
  *          Samuel Hocevar <sam@zoy.org>
@@ -319,8 +319,10 @@
 
     /* Add the Show menu */
     fShowMenu = new BMenu( _("Window") );
+#if 0
     ADD_ELLIPSIS( _("Playlist") );
     fShowMenu->AddItem( new BMenuItem( psz_tmp, new BMessage( OPEN_PLAYLIST ), 'P') );
+#endif
     ADD_ELLIPSIS( _("Messages") );
     fShowMenu->AddItem( new BMenuItem( psz_tmp, new BMessage( OPEN_MESSAGES ), 'M' ) );
     ADD_ELLIPSIS( _("Preferences") );
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/beos/Makefile.in vlc-0.8.6-svn20061008.debian/modules/gui/beos/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/gui/beos/Makefile.in	2006-09-18 06:30:47.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/beos/Makefile.in	2006-10-08 12:42:51.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/macosx/AppleRemote.h vlc-0.8.6-svn20061008.debian/modules/gui/macosx/AppleRemote.h
--- vlc-0.8.6-svn20060918.debian/modules/gui/macosx/AppleRemote.h	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/macosx/AppleRemote.h	2006-09-21 11:50:22.000000000 -0400
@@ -1,10 +1,55 @@
-//
-//  AppleRemote.h
-//  AppleRemote
-//
-//  Created by Martin Kahr on 11.03.06.
-//  Copyright 2006 martinkahr.com. All rights reserved.
-//
+/*****************************************************************************
+ * AppleRemote.h
+ * AppleRemote
+ * $Id: AppleRemote.h 16767 2006-09-21 14:32:45Z hartman $
+ *
+ * Created by Martin Kahr on 11.03.06 under a MIT-style license. 
+ * Copyright (c) 2006 martinkahr.com. All rights reserved.
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining a 
+ * copy of this software and associated documentation files (the "Software"),
+ * to deal in the Software without restriction, including without limitation
+ * the rights to use, copy, modify, merge, publish, distribute, sublicense,
+ * and/or sell copies of the Software, and to permit persons to whom the
+ * Software is furnished to do so, subject to the following conditions:
+ *
+ * The above copyright notice and this permission notice shall be included
+ * in all copies or substantial portions of the Software.
+ *
+ * THE SOFTWARE IS PROVIDED AS IS, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL 
+ * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+ * THE SOFTWARE.
+ *
+ *****************************************************************************
+ *
+ * Note that changes made by any members or contributors of the VideoLAN team
+ * (i.e. changes that were checked in into one of VideoLAN's source code
+ * repositories are licensed under the GNU General Public License version 2,
+ * or (at your option) any later version. 
+ * Thus, the following statements apply to our changes:
+ *
+ * Copyright (C) 2006 the VideoLAN team
+ * Authors: Eric Petit <titer@m0k.org>
+ *          Felix Khne <fkuehne at videolan dot org>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
+ *****************************************************************************/
 
 #import <Cocoa/Cocoa.h>
 #import <mach/mach.h>
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/macosx/AppleRemote.m vlc-0.8.6-svn20061008.debian/modules/gui/macosx/AppleRemote.m
--- vlc-0.8.6-svn20060918.debian/modules/gui/macosx/AppleRemote.m	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/macosx/AppleRemote.m	2006-09-21 11:50:22.000000000 -0400
@@ -1,10 +1,55 @@
-//
-//  AppleRemote.m
-//  AppleRemote
-//
-//  Created by Martin Kahr on 11.03.06.
-//  Copyright 2006 martinkahr.com. All rights reserved.
-//
+/*****************************************************************************
+ * AppleRemote.m
+ * AppleRemote
+ * $Id: AppleRemote.m 16767 2006-09-21 14:32:45Z hartman $
+ *
+ * Created by Martin Kahr on 11.03.06 under a MIT-style license. 
+ * Copyright (c) 2006 martinkahr.com. All rights reserved.
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining a 
+ * copy of this software and associated documentation files (the "Software"),
+ * to deal in the Software without restriction, including without limitation
+ * the rights to use, copy, modify, merge, publish, distribute, sublicense,
+ * and/or sell copies of the Software, and to permit persons to whom the
+ * Software is furnished to do so, subject to the following conditions:
+ *
+ * The above copyright notice and this permission notice shall be included
+ * in all copies or substantial portions of the Software.
+ *
+ * THE SOFTWARE IS PROVIDED AS IS, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL 
+ * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+ * THE SOFTWARE.
+ *
+ *****************************************************************************
+ *
+ * Note that changes made by any members or contributors of the VideoLAN team
+ * (i.e. changes that were checked in to one of VideoLAN's source code
+ * repositories are licensed under the GNU General Public License version 2,
+ * or (at your option) any later version. 
+ * Thus, the following statements apply to our changes:
+ *
+ * Copyright (C) 2006 the VideoLAN team
+ * Authors: Eric Petit <titer@m0k.org>
+ *          Felix Khne <fkuehne at videolan dot org>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
+ *****************************************************************************/
 
 #import "AppleRemote.h"
 
@@ -13,8 +58,11 @@
 
 @implementation AppleRemote
 
-- (id) init {	
-	if ( self == [super init] ) {
+- (id) init
+{	
+    self = [super init];
+
+    if ( self == [super init] ) {
 		openInExclusiveMode = YES;
 		queue = NULL;
 		hidDeviceInterface = NULL;
@@ -152,7 +200,7 @@
 
 + (AppleRemote*) sharedRemote {	
 	@synchronized(self) {
-        if( sharedInstance == nil ) {
+        if (sharedInstance == nil) {
             sharedInstance = [[self alloc] init];
         }
     }
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/macosx/controls.m vlc-0.8.6-svn20061008.debian/modules/gui/macosx/controls.m
--- vlc-0.8.6-svn20060918.debian/modules/gui/macosx/controls.m	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/macosx/controls.m	2006-09-22 11:14:31.000000000 -0400
@@ -2,7 +2,7 @@
  * controls.m: MacOS X interface module
  *****************************************************************************
  * Copyright (C) 2002-2005 the VideoLAN team
- * $Id: controls.m 15491 2006-04-30 21:09:16Z bigben $
+ * $Id: controls.m 16774 2006-09-21 19:29:10Z hartman $
  *
  * Authors: Jon Lech Johansen <jon-vl@nanocrew.net>
  *          Christophe Massiot <massiot@via.ecp.fr>
@@ -161,10 +161,12 @@
     if( val.b_bool )
     {
         vout_OSDMessage( p_intf, DEFAULT_CHAN, _( "Random On" ) );
+        config_PutInt( p_playlist, "random", 1 );
     }
     else
     {
         vout_OSDMessage( p_intf, DEFAULT_CHAN, _( "Random Off" ) );
+        config_PutInt( p_playlist, "random", 0 );
     }
 
     p_intf->p_sys->b_playmode_update = VLC_TRUE;
@@ -193,12 +195,14 @@
     if( val.b_bool )
     {
         vout_OSDMessage( p_intf, DEFAULT_CHAN, _( "Repeat One" ) );
+        config_PutInt( p_playlist, "repeat", 1 );
     }
     else
     {
         vout_OSDMessage( p_intf, DEFAULT_CHAN, _( "Repeat Off" ) );
+        config_PutInt( p_playlist, "repeat", 0 );
     }
-
+    
     p_intf->p_sys->b_playmode_update = VLC_TRUE;
     p_intf->p_sys->b_intf_update = VLC_TRUE;
     vlc_object_release( p_playlist );
@@ -225,10 +229,12 @@
     if( val.b_bool )
     {
         vout_OSDMessage( p_intf, DEFAULT_CHAN, _( "Repeat All" ) );
+        config_PutInt( p_playlist, "loop", 1 );
     }
     else
     {
         vout_OSDMessage( p_intf, DEFAULT_CHAN, _( "Repeat Off" ) );
+        config_PutInt( p_playlist, "loop", 0 );
     }
 
     p_intf->p_sys->b_playmode_update = VLC_TRUE;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/macosx/interaction.m vlc-0.8.6-svn20061008.debian/modules/gui/macosx/interaction.m
--- vlc-0.8.6-svn20060918.debian/modules/gui/macosx/interaction.m	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/macosx/interaction.m	2006-10-01 11:34:21.000000000 -0400
@@ -2,7 +2,7 @@
  * interaction.h: Mac OS X interaction dialogs
  *****************************************************************************
  * Copyright (C) 2005-2006 the VideoLAN team
- * $Id: interaction.m 15032 2006-04-01 21:38:18Z xtophe $
+ * $Id: interaction.m 16902 2006-10-01 11:02:00Z fkuehne $
  *
  * Authors: Derk-Jan Hartman <hartman at videolan dot org>
  *          Felix Khne <fkuehne at videolan dot org>
@@ -122,7 +122,7 @@
         [o_prog_bar setUsesThreadedAnimation: YES];
     }
 
-    NSString *o_title = [NSString stringWithUTF8String:p_dialog->psz_title ? p_dialog->psz_title : "title"];
+    NSString *o_title = [NSString stringWithUTF8String:p_dialog->psz_title ? p_dialog->psz_title : _("Error")];
     NSString *o_description = [NSString stringWithUTF8String:p_dialog->psz_description ? p_dialog->psz_description : ""];
     
     vout_thread_t *p_vout = vlc_object_find( VLCIntf, VLC_OBJECT_VOUT, FIND_ANYWHERE );
@@ -145,13 +145,15 @@
         o_window = [NSApp mainWindow];
     }
     
+#if 0
     msg_Dbg( p_intf, "Title: %s", [o_title UTF8String] );
     msg_Dbg( p_intf, "Description: %s", [o_description UTF8String] );
+#endif
     if( p_dialog->i_id == DIALOG_ERRORS )
     {
         for( i = 0; i < p_dialog->i_widgets; i++ )
         {
-            msg_Err( p_intf, "Error: %s", p_dialog->pp_widgets[i]->psz_text );
+            msg_Dbg( p_intf, "error panel requested" );
         }
     }
     else
@@ -173,8 +175,9 @@
         else if( p_dialog->i_flags & DIALOG_YES_NO_CANCEL )
         {
             msg_Dbg( p_intf, "requested flag: DIALOG_YES_NO_CANCEL" );
-            NSBeginInformationalAlertSheet( o_title, @"Yes", @"No", @"Cancel", \
-                o_window, self,@selector(sheetDidEnd: returnCode: contextInfo:),\
+            NSBeginInformationalAlertSheet( o_title, _NS("Yes"), _NS("No"), 
+                _NS("Cancel"), o_window, self,
+                @selector(sheetDidEnd: returnCode: contextInfo:),
                 NULL, nil, o_description );
         }
         else if( p_dialog->i_type & WIDGET_PROGRESS )
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/macosx/intf.m vlc-0.8.6-svn20061008.debian/modules/gui/macosx/intf.m
--- vlc-0.8.6-svn20060918.debian/modules/gui/macosx/intf.m	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/macosx/intf.m	2006-09-22 11:14:31.000000000 -0400
@@ -2,7 +2,7 @@
  * intf.m: MacOS X interface module
  *****************************************************************************
  * Copyright (C) 2002-2006 the VideoLAN team
- * $Id: intf.m 16647 2006-09-14 14:58:57Z hartman $
+ * $Id: intf.m 16773 2006-09-21 18:46:25Z hartman $
  *
  * Authors: Jon Lech Johansen <jon-vl@nanocrew.net>
  *          Christophe Massiot <massiot@via.ecp.fr>
@@ -725,6 +725,21 @@
         case kRemoteButtonVolume_Minus:
             [o_controls volumeDown: self];
             break;
+        case kRemoteButtonRight:
+            [o_controls next: self];
+            break;
+        case kRemoteButtonLeft:
+            [o_controls prev: self];
+            break;
+        case kRemoteButtonRight_Hold:
+            [o_controls forward: self];
+            break;
+        case kRemoteButtonLeft_Hold:
+            [o_controls backward: self];
+            break;
+        case kRemoteButtonMenu:
+            [o_controls windowAction: self];
+            break;
 
         default:
             /* Add here whatever you want other buttons to do */
@@ -1388,6 +1403,7 @@
         [o_btn_play setToolTip: _NS("Pause")];
         [o_mi_play setTitle: _NS("Pause")];
         [o_dmi_play setTitle: _NS("Pause")];
+        [o_vmi_play setTitle: _NS("Pause")];
     }
     else
     {
@@ -1396,6 +1412,7 @@
         [o_btn_play setToolTip: _NS("Play")];
         [o_mi_play setTitle: _NS("Play")];
         [o_dmi_play setTitle: _NS("Play")];
+        [o_vmi_play setTitle: _NS("Play")];
     }
 }
 
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/macosx/Makefile.in vlc-0.8.6-svn20061008.debian/modules/gui/macosx/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/gui/macosx/Makefile.in	2006-09-18 06:30:48.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/macosx/Makefile.in	2006-10-08 12:42:51.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/macosx/playlist.m vlc-0.8.6-svn20061008.debian/modules/gui/macosx/playlist.m
--- vlc-0.8.6-svn20060918.debian/modules/gui/macosx/playlist.m	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/macosx/playlist.m	2006-10-01 11:34:21.000000000 -0400
@@ -2,7 +2,7 @@
  * playlist.m: MacOS X interface module
  *****************************************************************************
 * Copyright (C) 2002-2005 the VideoLAN team
- * $Id: playlist.m 16442 2006-08-30 22:15:52Z hartman $
+ * $Id: playlist.m 16901 2006-10-01 10:54:22Z fkuehne $
  *
  * Authors: Jon Lech Johansen <jon-vl@nanocrew.net>
  *          Derk-Jan Hartman <hartman at videola/n dot org>
@@ -368,6 +368,18 @@
 @end
 
 /*****************************************************************************
+* extension to NSOutlineView's interface to fix compilation warnings
+* and let us access these 2 functions properly
+* this uses a private Apple-API, but works finely on all current OSX releases
+* keep checking for compatiblity with future releases though
+*****************************************************************************/
+
+@interface NSOutlineView (UndocumentedSortImages)
++ (NSImage *)_defaultTableHeaderSortImage;
++ (NSImage *)_defaultTableHeaderReverseSortImage;
+@end
+
+/*****************************************************************************
  * VLCPlaylist implementation
  *****************************************************************************/
 @implementation VLCPlaylist
@@ -401,26 +413,11 @@
         @"VLCPlaylistItemPboardType", nil]];
     [o_outline_view setIntercellSpacing: NSMakeSize (0.0, 1.0)];
 
-/* We need to check whether _defaultTableHeaderSortImage exists, since it 
-belongs to an Apple hidden private API, and then can "disapear" at any time*/
-
-    if( [[NSOutlineView class] respondsToSelector:@selector(_defaultTableHeaderSortImage)] )
-    {
-        o_ascendingSortingImage = [[NSOutlineView class] _defaultTableHeaderSortImage];
-    }
-    else
-    {
-        o_ascendingSortingImage = nil;
-    }
-
-    if( [[NSOutlineView class] respondsToSelector:@selector(_defaultTableHeaderReverseSortImage)] )
-    {
-        o_descendingSortingImage = [[NSOutlineView class] _defaultTableHeaderReverseSortImage];
-    }
-    else
-    {
-        o_descendingSortingImage = nil;
-    }
+    /* this uses private Apple API which works fine on all releases incl. 10.4, 
+        * but keep checking in the future!
+        * These methods were added artificially to NSOutlineView's public interface above */
+    o_ascendingSortingImage = [[NSOutlineView class] _defaultTableHeaderSortImage];
+    o_descendingSortingImage = [[NSOutlineView class] _defaultTableHeaderReverseSortImage];
 
     o_tc_sortColumn = nil;
 
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/macosx/voutgl.m vlc-0.8.6-svn20061008.debian/modules/gui/macosx/voutgl.m
--- vlc-0.8.6-svn20060918.debian/modules/gui/macosx/voutgl.m	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/macosx/voutgl.m	2006-10-04 09:47:07.000000000 -0400
@@ -86,11 +86,9 @@
 static int  aglInit   ( vout_thread_t * p_vout );
 static void aglEnd    ( vout_thread_t * p_vout );
 static int  aglManage ( vout_thread_t * p_vout );
+static int  aglControl( vout_thread_t *, int, va_list );
 static void aglSwap   ( vout_thread_t * p_vout );
 
-static int DrawableRedraw( vlc_object_t *p_this, const char *psz_name,
-    vlc_value_t oval, vlc_value_t nval, void *param);
-
 int E_(OpenVideoGL)  ( vlc_object_t * p_this )
 {
     vout_thread_t * p_vout = (vout_thread_t *) p_this;
@@ -115,7 +113,7 @@
 
     vlc_mutex_init( p_vout, &p_vout->p_sys->lock );
 
-    var_Get( p_vout->p_vlc, "drawable", &value_drawable );
+    var_Get( p_vout->p_libvlc, "drawable", &value_drawable );
     if( value_drawable.i_int != 0 )
     {
         static const GLint ATTRIBUTES[] = { 
@@ -131,19 +129,11 @@
             AGL_DEPTH_SIZE, 24,
             AGL_NONE };
 
-        AGLDevice screen;
         AGLPixelFormat pixFormat;
 
         p_vout->p_sys->b_embedded = VLC_TRUE;
 
-        screen = GetGWorldDevice((CGrafPtr)value_drawable.i_int);
-        if( NULL == screen )
-        {
-            msg_Err( p_vout, "can't find screen device for drawable" );
-            return VLC_EGENERIC;
-        }
-        
-        pixFormat = aglChoosePixelFormat(&screen, 1, ATTRIBUTES);
+        pixFormat = aglChoosePixelFormat(NULL, 0, ATTRIBUTES);
         if( NULL == pixFormat )
         {
             msg_Err( p_vout, "no screen renderer available for required attributes." );
@@ -158,8 +148,8 @@
             return VLC_EGENERIC;
         }
         else {
-            // tell opengl to sync buffer swap with vertical retrace
-            GLint param = 1;
+            // tell opengl not to sync buffer swap with vertical retrace (too inefficient)
+            GLint param = 0;
             aglSetInteger(p_vout->p_sys->agl_ctx, AGL_SWAP_INTERVAL, &param);
             aglEnable(p_vout->p_sys->agl_ctx, AGL_SWAP_INTERVAL);
         }
@@ -167,7 +157,7 @@
         p_vout->pf_init             = aglInit;
         p_vout->pf_end              = aglEnd;
         p_vout->pf_manage           = aglManage;
-        p_vout->pf_control          = NULL;
+        p_vout->pf_control          = aglControl;
         p_vout->pf_swap             = aglSwap;
         p_vout->pf_lock             = Lock;
         p_vout->pf_unlock           = Unlock;
@@ -207,7 +197,6 @@
     vout_thread_t * p_vout = (vout_thread_t *) p_this;
     if( p_vout->p_sys->b_embedded )
     {
-        var_DelCallback(p_vout->p_vlc, "drawableredraw", DrawableRedraw, p_vout);
         aglDestroyContext(p_vout->p_sys->agl_ctx);
     }
     else
@@ -456,13 +445,38 @@
  * embedded AGL context implementation
  *****************************************************************************/
 
-static void UpdateEmbeddedGeometry( vout_thread_t *p_vout );
+static void aglSetViewport( vout_thread_t *p_vout, Rect viewBounds, Rect clipBounds );
 static void aglReshape( vout_thread_t * p_vout );
 
 static int aglInit( vout_thread_t * p_vout )
 {
-    UpdateEmbeddedGeometry(p_vout);
-    var_AddCallback(p_vout->p_vlc, "drawableredraw", DrawableRedraw, p_vout);
+    vlc_value_t val;
+
+    Rect viewBounds;    
+    Rect clipBounds;
+    
+    var_Get( p_vout->p_libvlc, "drawable", &val );
+    p_vout->p_sys->agl_drawable = (AGLDrawable)val.i_int;
+    aglSetDrawable(p_vout->p_sys->agl_ctx, p_vout->p_sys->agl_drawable);
+
+    var_Get( p_vout->p_libvlc, "drawable-view-top", &val );
+    viewBounds.top = val.i_int;
+    var_Get( p_vout->p_libvlc, "drawable-view-left", &val );
+    viewBounds.left = val.i_int;
+    var_Get( p_vout->p_libvlc, "drawable-view-bottom", &val );
+    viewBounds.bottom = val.i_int;
+    var_Get( p_vout->p_libvlc, "drawable-view-right", &val );
+    viewBounds.right = val.i_int;
+    var_Get( p_vout->p_libvlc, "drawable-clip-top", &val );
+    clipBounds.top = val.i_int;
+    var_Get( p_vout->p_libvlc, "drawable-clip-left", &val );
+    clipBounds.left = val.i_int;
+    var_Get( p_vout->p_libvlc, "drawable-clip-bottom", &val );
+    clipBounds.bottom = val.i_int;
+    var_Get( p_vout->p_libvlc, "drawable-clip-right", &val );
+    clipBounds.right = val.i_int;
+
+    aglSetViewport(p_vout, viewBounds, clipBounds);
 
     aglSetCurrentContext(p_vout->p_sys->agl_ctx);
     return VLC_SUCCESS;
@@ -475,44 +489,17 @@
 
 static void aglReshape( vout_thread_t * p_vout )
 {
-    int x, y;
-    vlc_value_t val;
-    int i_offx   = p_vout->p_sys->i_offx;
-    int i_offy   = p_vout->p_sys->i_offy;
-    int i_height = p_vout->p_sys->i_height;
-    int i_width  = p_vout->p_sys->i_width;
+    unsigned int x, y;
+    unsigned int i_height = p_vout->p_sys->i_height;
+    unsigned int i_width  = p_vout->p_sys->i_width;
 
     Lock( p_vout );
 
-    aglSetCurrentContext(p_vout->p_sys->agl_ctx);
+    vout_PlacePicture(p_vout, i_width, i_height, &x, &y, &i_width, &i_height); 
 
-    var_Get( p_vout, "macosx-stretch", &val );
-    if( val.b_bool )
-    {
-        x = i_width;
-        y = i_height;
-    }
-    else if( i_height * p_vout->fmt_in.i_visible_width *
-             p_vout->fmt_in.i_sar_num <
-             i_width * p_vout->fmt_in.i_visible_height *
-             p_vout->fmt_in.i_sar_den )
-    {
-        x = ( i_height * p_vout->fmt_in.i_visible_width *
-              p_vout->fmt_in.i_sar_num ) /
-            ( p_vout->fmt_in.i_visible_height * p_vout->fmt_in.i_sar_den);
-
-        y = i_height;
-    }
-    else
-    {
-        x = i_width;
-        y = ( i_width * p_vout->fmt_in.i_visible_height *
-              p_vout->fmt_in.i_sar_den) /
-            ( p_vout->fmt_in.i_visible_width * p_vout->fmt_in.i_sar_num  );
-    }
+    aglSetCurrentContext(p_vout->p_sys->agl_ctx);
 
-    glViewport( i_offx+( i_width - x ) / 2,
-                i_offy+( i_height - y ) / 2, x, y );
+    glViewport( p_vout->p_sys->i_offx + x, p_vout->p_sys->i_offy + y, i_width, i_height );
 
     if( p_vout->p_sys->b_got_frame )
     {
@@ -547,84 +534,80 @@
     return VLC_SUCCESS;
 }
 
+static int aglControl( vout_thread_t *p_vout, int i_query, va_list args )
+{
+    switch( i_query )
+    {
+        case VOUT_SET_VIEWPORT:
+	{
+	    Rect viewBounds, clipBounds;
+            viewBounds.top = va_arg( args, int);
+            viewBounds.left = va_arg( args, int);
+            viewBounds.bottom = va_arg( args, int);
+            viewBounds.right = va_arg( args, int);
+            clipBounds.top = va_arg( args, int);
+            clipBounds.left = va_arg( args, int);
+            clipBounds.bottom = va_arg( args, int);
+            clipBounds.right = va_arg( args, int);
+	    aglSetViewport(p_vout, viewBounds, clipBounds);
+            return VLC_SUCCESS;
+	}
+
+        case VOUT_REPARENT:
+	{
+	    AGLDrawable drawable = (AGLDrawable)va_arg( args, int);
+	    if( drawable != p_vout->p_sys->agl_drawable )
+	    {
+		p_vout->p_sys->agl_drawable = drawable;
+		aglSetDrawable(p_vout->p_sys->agl_ctx, drawable);
+	    }
+            return VLC_SUCCESS;
+	}
+
+        default:
+            return vout_vaControlDefault( p_vout, i_query, args );
+    }
+}
+
 static void aglSwap( vout_thread_t * p_vout )
 {
     p_vout->p_sys->b_got_frame = VLC_TRUE;
     aglSwapBuffers(p_vout->p_sys->agl_ctx);
 }
 
-static void UpdateEmbeddedGeometry( vout_thread_t *p_vout )
+static void aglSetViewport( vout_thread_t *p_vout, Rect viewBounds, Rect clipBounds )
 {
-    vlc_value_t val;
-    vlc_value_t valt, vall, valb, valr, valx, valy, valw, valh,
-                valportx, valporty;
-
-    Rect winBounds;    
-    Rect clientBounds;
-    
-    GLint rect[4];
-
-    var_Get( p_vout->p_vlc, "drawable", &val );
-    var_Get( p_vout->p_vlc, "drawablet", &valt );
-    var_Get( p_vout->p_vlc, "drawablel", &vall );
-    var_Get( p_vout->p_vlc, "drawableb", &valb );
-    var_Get( p_vout->p_vlc, "drawabler", &valr );
-    var_Get( p_vout->p_vlc, "drawablex", &valx );
-    var_Get( p_vout->p_vlc, "drawabley", &valy );
-    var_Get( p_vout->p_vlc, "drawablew", &valw );
-    var_Get( p_vout->p_vlc, "drawableh", &valh );
-    var_Get( p_vout->p_vlc, "drawableportx", &valportx );
-    var_Get( p_vout->p_vlc, "drawableporty", &valporty );
-
     // mozilla plugin provides coordinates based on port bounds
     // however AGL coordinates are based on window structure region
     // and are vertically flipped
+    GLint rect[4];
+    CGrafPtr port = (CGrafPtr)p_vout->p_sys->agl_drawable;
+    Rect winBounds, clientBounds;
 
-    GetWindowBounds(GetWindowFromPort((CGrafPtr)val.i_int),
+    GetWindowBounds(GetWindowFromPort(port),
         kWindowStructureRgn, &winBounds);
-    GetWindowBounds(GetWindowFromPort((CGrafPtr)val.i_int),
+    GetWindowBounds(GetWindowFromPort(port),
         kWindowContentRgn, &clientBounds);
 
     /* update video clipping bounds in drawable */
     rect[0] = (clientBounds.left-winBounds.left)
-            + vall.i_int;                       // from window left edge
+            + clipBounds.left;                  // from window left edge
     rect[1] = (winBounds.bottom-winBounds.top)
             - (clientBounds.top-winBounds.top)
-            - valb.i_int;                       // from window bottom edge
-    rect[2] = valr.i_int-vall.i_int;            // width
-    rect[3] = valb.i_int-valt.i_int;            // height
+            - clipBounds.bottom;                // from window bottom edge
+    rect[2] = clipBounds.right-clipBounds.left; // width
+    rect[3] = clipBounds.bottom-clipBounds.top; // height
     aglSetInteger(p_vout->p_sys->agl_ctx, AGL_BUFFER_RECT, rect);
     aglEnable(p_vout->p_sys->agl_ctx, AGL_BUFFER_RECT);
 
     /* update video internal bounds in drawable */
-    p_vout->p_sys->i_offx   = -vall.i_int - valportx.i_int;
-    p_vout->p_sys->i_offy   = valb.i_int + valporty.i_int - valh.i_int; 
-    p_vout->p_sys->i_width  = valw.i_int;
-    p_vout->p_sys->i_height = valh.i_int;
+    p_vout->p_sys->i_width  = viewBounds.right-viewBounds.left;
+    p_vout->p_sys->i_height = viewBounds.bottom-viewBounds.top;
+    p_vout->p_sys->i_offx   = -clipBounds.left - viewBounds.left;
+    p_vout->p_sys->i_offy   = clipBounds.bottom + viewBounds.top
+                            - p_vout->p_sys->i_height; 
 
-    if( p_vout->p_sys->agl_drawable == (AGLDrawable)val.i_int )
-    {
-        aglUpdateContext(p_vout->p_sys->agl_ctx);
-    }
-    else
-    {
-        p_vout->p_sys->agl_drawable = (AGLDrawable)val.i_int;
-        aglSetDrawable(p_vout->p_sys->agl_ctx, p_vout->p_sys->agl_drawable);
-    }
+    aglUpdateContext(p_vout->p_sys->agl_ctx);
     aglReshape( p_vout );
 }
 
-/* If we're embedded, the application is expected to indicate a
- * window change (move/resize/etc) via the "drawableredraw" value.
- */
-
-static int DrawableRedraw( vlc_object_t *p_this, const char *psz_name,
-    vlc_value_t oval, vlc_value_t nval, void *param)
-{
-    vout_thread_t *p_vout = (vout_thread_t *)param;
-
-    UpdateEmbeddedGeometry( p_vout );
-
-    return VLC_SUCCESS;
-}
-
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/macosx/vout.m vlc-0.8.6-svn20061008.debian/modules/gui/macosx/vout.m
--- vlc-0.8.6-svn20060918.debian/modules/gui/macosx/vout.m	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/macosx/vout.m	2006-09-21 11:50:22.000000000 -0400
@@ -2,7 +2,7 @@
  * vout.m: MacOS X video output module
  *****************************************************************************
  * Copyright (C) 2001-2006 the VideoLAN team
- * $Id: vout.m 16647 2006-09-14 14:58:57Z hartman $
+ * $Id: vout.m 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Colin Delacroix <colin@zoy.org>
  *          Florian G. Pflug <fgp@phlo.org>
@@ -479,124 +479,79 @@
             msg_Dbg( p_vout, "received NSRightMouseDown (generic method) or Ctrl clic" );
             [NSMenu popUpContextMenu: [[VLCMain sharedInstance] getVoutMenu] withEvent: o_event forView: [[[VLCMain sharedInstance] getControls] getVoutView]];
         }
-        else
-            [super mouseDown: o_event];
     }
+
+    [super mouseDown: o_event];
 }
 
 - (void)otherMouseDown:(NSEvent *)o_event
 {
     vlc_value_t val;
 
-    if( p_vout )
+    if( p_vout && [o_event type] == NSOtherMouseDown )
     {
-        switch( [o_event type] )
-        {
-            case NSOtherMouseDown:
-            {
-                var_Get( p_vout, "mouse-button-down", &val );
-                val.i_int |= 2;
-                var_Set( p_vout, "mouse-button-down", val );
-            }
-            break;
-
-            default:
-                [super mouseDown: o_event];
-            break;
-        }
+        var_Get( p_vout, "mouse-button-down", &val );
+        val.i_int |= 2;
+        var_Set( p_vout, "mouse-button-down", val );
     }
+
+    [super mouseDown: o_event];
 }
 
 - (void)rightMouseDown:(NSEvent *)o_event
 {
-    if( p_vout )
+    if( p_vout && [o_event type] == NSRightMouseDown )
     {
-        switch( [o_event type] )
-        {
-            case NSRightMouseDown:
-            {
-                msg_Dbg( p_vout, "received NSRightMouseDown (specific method)" );
-                [NSMenu popUpContextMenu: [[VLCMain sharedInstance] getVoutMenu] withEvent: o_event forView: [[[VLCMain sharedInstance] getControls] getVoutView]];
-            }
-            break;
-
-            default:
-                [super mouseDown: o_event];
-            break;
-        }
+        msg_Dbg( p_vout, "received NSRightMouseDown (specific method)" );
+        [NSMenu popUpContextMenu: [[VLCMain sharedInstance] getVoutMenu] withEvent: o_event forView: [[[VLCMain sharedInstance] getControls] getVoutView]];
     }
+
+    [super mouseDown: o_event];
 }
 
 - (void)mouseUp:(NSEvent *)o_event
 {
     vlc_value_t val;
 
-    if( p_vout )
+    if( p_vout && [o_event type] == NSLeftMouseUp )
     {
-        switch( [o_event type] )
-        {
-            case NSLeftMouseUp:
-            {
-                vlc_value_t b_val;
-                b_val.b_bool = VLC_TRUE;
-                var_Set( p_vout, "mouse-clicked", b_val );
-
-                var_Get( p_vout, "mouse-button-down", &val );
-                val.i_int &= ~1;
-                var_Set( p_vout, "mouse-button-down", val );
-            }
-            break;
+        vlc_value_t b_val;
+        b_val.b_bool = VLC_TRUE;
+        var_Set( p_vout, "mouse-clicked", b_val );
 
-            default:
-                [super mouseUp: o_event];
-            break;
-        }
+        var_Get( p_vout, "mouse-button-down", &val );
+        val.i_int &= ~1;
+        var_Set( p_vout, "mouse-button-down", val );
     }
+
+    [super mouseUp: o_event];
 }
 
 - (void)otherMouseUp:(NSEvent *)o_event
 {
     vlc_value_t val;
 
-    if( p_vout )
+    if( p_vout && [o_event type] == NSOtherMouseUp )
     {
-        switch( [o_event type] )
-        {
-            case NSOtherMouseUp:
-            {
-                var_Get( p_vout, "mouse-button-down", &val );
-                val.i_int &= ~2;
-                var_Set( p_vout, "mouse-button-down", val );
-            }
-            break;
-
-            default:
-                [super mouseUp: o_event];
-            break;
-        }
+        var_Get( p_vout, "mouse-button-down", &val );
+        val.i_int &= ~2;
+        var_Set( p_vout, "mouse-button-down", val );
     }
+
+    [super mouseUp: o_event];
 }
 
 - (void)rightMouseUp:(NSEvent *)o_event
 {
-    if( p_vout )
+    if( p_vout && [o_event type] == NSRightMouseUp )
     {
-        switch( [o_event type] )
-        {
-            case NSRightMouseUp:
-            {
-                /* FIXME: this isn't the appropriate place, but we can't receive
-                 * NSRightMouseDown some how */
-                msg_Dbg( p_vout, "received NSRightMouseUp" ); 
-                [NSMenu popUpContextMenu: [[VLCMain sharedInstance] getVoutMenu] withEvent: o_event forView: [[[VLCMain sharedInstance] getControls] getVoutView]];
-            }
-            break;
-
-            default:
-                [super mouseUp: o_event];
-            break;
-        }
+        /* FIXME: this isn't the appropriate place, but we can't receive
+         * NSRightMouseDown some how */
+        msg_Dbg( p_vout, "received NSRightMouseUp" ); 
+        [NSMenu popUpContextMenu: [[VLCMain sharedInstance] getVoutMenu] withEvent: o_event forView: [[[VLCMain sharedInstance] getControls] getVoutView]];
     }
+
+    [super mouseUp: o_event];
 }
 
 - (void)mouseDragged:(NSEvent *)o_event
@@ -655,6 +610,7 @@
             var_Set( p_vout, "mouse-moved", val );
         }
     }
+
     [super mouseMoved: o_event];
 }
 
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/Makefile.in vlc-0.8.6-svn20061008.debian/modules/gui/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/gui/Makefile.in	2006-09-18 06:30:47.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/Makefile.in	2006-10-08 12:42:50.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/pda/Makefile.in vlc-0.8.6-svn20061008.debian/modules/gui/pda/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/gui/pda/Makefile.in	2006-09-18 06:30:48.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/pda/Makefile.in	2006-10-08 12:42:52.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/qnx/Makefile.in vlc-0.8.6-svn20061008.debian/modules/gui/qnx/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/gui/qnx/Makefile.in	2006-09-18 06:30:49.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/qnx/Makefile.in	2006-10-08 12:42:52.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/controls/ctrl_image.cpp vlc-0.8.6-svn20061008.debian/modules/gui/skins2/controls/ctrl_image.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/controls/ctrl_image.cpp	2006-09-18 06:28:22.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/controls/ctrl_image.cpp	2006-09-21 11:50:22.000000000 -0400
@@ -2,7 +2,7 @@
  * ctrl_image.cpp
  *****************************************************************************
  * Copyright (C) 2003 the VideoLAN team
- * $Id: ctrl_image.cpp 14118 2006-02-01 18:06:48Z courmisch $
+ * $Id: ctrl_image.cpp 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Cyril Deguet     <asmax@via.ecp.fr>
  *          Olivier Teulire <ipkiss@via.ecp.fr>
@@ -100,17 +100,20 @@
         if( m_resizeMethod == kScale )
         {
             // Use scaling method
-            if( width != m_pImage->getWidth() ||
-                height != m_pImage->getHeight() )
+            if( width > 0 && height > 0 )
             {
-                OSFactory *pOsFactory = OSFactory::instance( getIntf() );
-                // Rescale the image with the actual size of the control
-                ScaledBitmap bmp( getIntf(), m_rBitmap, width, height );
-                SKINS_DELETE( m_pImage );
-                m_pImage = pOsFactory->createOSGraphics( width, height );
-                m_pImage->drawBitmap( bmp, 0, 0 );
+                if( width != m_pImage->getWidth() ||
+                    height != m_pImage->getHeight() )
+                {
+                    OSFactory *pOsFactory = OSFactory::instance( getIntf() );
+                    // Rescale the image with the actual size of the control
+                    ScaledBitmap bmp( getIntf(), m_rBitmap, width, height );
+                    SKINS_DELETE( m_pImage );
+                    m_pImage = pOsFactory->createOSGraphics( width, height );
+                    m_pImage->drawBitmap( bmp, 0, 0 );
+                }
+                rImage.drawGraphics( *m_pImage, 0, 0, xDest, yDest );
             }
-            rImage.drawGraphics( *m_pImage, 0, 0, xDest, yDest );
         }
         else
         {
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/controls/ctrl_move.cpp vlc-0.8.6-svn20061008.debian/modules/gui/skins2/controls/ctrl_move.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/controls/ctrl_move.cpp	2006-09-18 06:28:22.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/controls/ctrl_move.cpp	2006-09-21 11:50:22.000000000 -0400
@@ -2,7 +2,7 @@
  * ctrl_move.cpp
  *****************************************************************************
  * Copyright (C) 2003 the VideoLAN team
- * $Id: ctrl_move.cpp 14118 2006-02-01 18:06:48Z courmisch $
+ * $Id: ctrl_move.cpp 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Cyril Deguet     <asmax@via.ecp.fr>
  *          Olivier Teulire <ipkiss@via.ecp.fr>
@@ -86,6 +86,12 @@
 }
 
 
+void CtrlMove::onResize()
+{
+    m_rCtrl.onResize();
+}
+
+
 void CtrlMove::handleEvent( EvtGeneric &rEvent )
 {
     m_pEvt = &rEvent;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/controls/ctrl_move.hpp vlc-0.8.6-svn20061008.debian/modules/gui/skins2/controls/ctrl_move.hpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/controls/ctrl_move.hpp	2006-09-18 06:28:22.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/controls/ctrl_move.hpp	2006-09-21 11:50:22.000000000 -0400
@@ -2,7 +2,7 @@
  * ctrl_move.hpp
  *****************************************************************************
  * Copyright (C) 2003 the VideoLAN team
- * $Id: ctrl_move.hpp 14187 2006-02-07 16:37:40Z courmisch $
+ * $Id: ctrl_move.hpp 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Cyril Deguet     <asmax@via.ecp.fr>
  *          Olivier Teulire <ipkiss@via.ecp.fr>
@@ -58,7 +58,10 @@
         /// Get the position of the decorated control in the layout, if any
         virtual const Position *getPosition() const;
 
-          /// Get the type of control (custom RTTI)
+        /// Method called when the control is resized
+        virtual void onResize();
+
+        /// Get the type of control (custom RTTI)
         virtual string getType() const { return m_rCtrl.getType(); }
 
     private:
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/controls/ctrl_resize.cpp vlc-0.8.6-svn20061008.debian/modules/gui/skins2/controls/ctrl_resize.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/controls/ctrl_resize.cpp	2006-09-18 06:28:22.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/controls/ctrl_resize.cpp	2006-09-21 11:50:22.000000000 -0400
@@ -2,7 +2,7 @@
  * ctrl_resize.cpp
  *****************************************************************************
  * Copyright (C) 2003 the VideoLAN team
- * $Id: ctrl_resize.cpp 16454 2006-08-31 19:54:36Z hartman $
+ * $Id: ctrl_resize.cpp 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Cyril Deguet     <asmax@via.ecp.fr>
  *          Olivier Teulire <ipkiss@via.ecp.fr>
@@ -95,6 +95,12 @@
 }
 
 
+void CtrlResize::onResize()
+{
+    m_rCtrl.onResize();
+}
+
+
 void CtrlResize::handleEvent( EvtGeneric &rEvent )
 {
     m_pEvt = &rEvent;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/controls/ctrl_resize.hpp vlc-0.8.6-svn20061008.debian/modules/gui/skins2/controls/ctrl_resize.hpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/controls/ctrl_resize.hpp	2006-09-18 06:28:22.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/controls/ctrl_resize.hpp	2006-09-21 11:50:22.000000000 -0400
@@ -2,7 +2,7 @@
  * ctrl_resize.hpp
  *****************************************************************************
  * Copyright (C) 2003 the VideoLAN team
- * $Id: ctrl_resize.hpp 16454 2006-08-31 19:54:36Z hartman $
+ * $Id: ctrl_resize.hpp 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Cyril Deguet     <asmax@via.ecp.fr>
  *          Olivier Teulire <ipkiss@via.ecp.fr>
@@ -59,6 +59,9 @@
         /// Get the position of the decorated control in the layout, if any
         virtual const Position *getPosition() const;
 
+        /// Method called when the control is resized
+        virtual void onResize();
+
         /// Get the type of control (custom RTTI)
         virtual string getType() const { return m_rCtrl.getType(); }
 
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/controls/ctrl_slider.cpp vlc-0.8.6-svn20061008.debian/modules/gui/skins2/controls/ctrl_slider.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/controls/ctrl_slider.cpp	2006-09-18 06:28:22.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/controls/ctrl_slider.cpp	2006-09-21 11:50:22.000000000 -0400
@@ -2,7 +2,7 @@
  * ctrl_slider.cpp
  *****************************************************************************
  * Copyright (C) 2003 the VideoLAN team
- * $Id: ctrl_slider.cpp 16457 2006-08-31 20:51:12Z hartman $
+ * $Id: ctrl_slider.cpp 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Cyril Deguet     <asmax@via.ecp.fr>
  *          Olivier Teulire <ipkiss@via.ecp.fr>
@@ -27,6 +27,7 @@
 #include "../events/evt_mouse.hpp"
 #include "../events/evt_scroll.hpp"
 #include "../src/generic_bitmap.hpp"
+#include "../src/scaled_bitmap.hpp"
 #include "../src/top_window.hpp"
 #include "../src/os_factory.hpp"
 #include "../src/os_graphics.hpp"
@@ -315,18 +316,18 @@
     CtrlGeneric( pIntf, rHelp, pVisible ), m_pCursor( NULL ),
     m_rVariable( rVariable ), m_thickness( thickness ), m_rCurve( rCurve ),
     m_width( rCurve.getWidth() ), m_height( rCurve.getHeight() ),
-    m_pImgSeq( NULL ), m_nbHoriz( nbHoriz ), m_nbVert( nbVert ),
+    m_pImgSeq( pBackground ), m_nbHoriz( nbHoriz ), m_nbVert( nbVert ),
     m_padHoriz( padHoriz ), m_padVert( padVert ), m_bgWidth( 0 ),
     m_bgHeight( 0 ), m_position( 0 )
 {
     if( pBackground )
     {
         // Build the background image sequence
-        OSFactory *pOsFactory = OSFactory::instance( getIntf() );
-        m_pImgSeq = pOsFactory->createOSGraphics( pBackground->getWidth(),
-                                                  pBackground->getHeight() );
-        m_pImgSeq->drawBitmap( *pBackground, 0, 0 );
-
+        // Note: we suppose that the last padding is not included in the
+        // given image
+        // TODO: we should probably change this assumption, as it would make
+        // the code a bit simpler and it would be more natural for the skins
+        // designers
         m_bgWidth = (pBackground->getWidth() + m_padHoriz) / nbHoriz;
         m_bgHeight = (pBackground->getHeight() + m_padVert) / nbVert;
 
@@ -342,7 +343,6 @@
 CtrlSliderBg::~CtrlSliderBg()
 {
     m_rVariable.delObserver( this );
-    delete m_pImgSeq;
 }
 
 
@@ -361,12 +361,25 @@
 {
     if( m_pImgSeq )
     {
-        // Locate the right image in the background bitmap
-        int x = m_bgWidth * ( m_position % m_nbHoriz );
-        int y = m_bgHeight * ( m_position / m_nbHoriz );
-        // Draw the background image
-        rImage.drawGraphics( *m_pImgSeq, x, y, xDest, yDest,
-                             m_bgWidth - m_padHoriz, m_bgHeight - m_padVert );
+        if( m_bgWidth > 0 && m_bgHeight > 0 )
+        {
+            // Compute the resize factors
+            float factorX, factorY;
+            getResizeFactors( factorX, factorY );
+
+            // Rescale the image with the actual size of the control
+            ScaledBitmap bmp( getIntf(), *m_pImgSeq,
+                 m_bgWidth * m_nbHoriz - (int)(m_padHoriz * factorX),
+                 m_bgHeight * m_nbVert - (int)(m_padVert * factorY) );
+
+            // Locate the right image in the background bitmap
+            int x = m_bgWidth * ( m_position % m_nbHoriz );
+            int y = m_bgHeight * ( m_position / m_nbHoriz );
+            // Draw the background image
+            rImage.drawBitmap( bmp, x, y, xDest, yDest,
+                               m_bgWidth - (int)(m_padHoriz * factorX),
+                               m_bgHeight - (int)(m_padVert * factorY) );
+        }
     }
 }
 
@@ -420,6 +433,24 @@
 }
 
 
+void CtrlSliderBg::onResize()
+{
+    if( m_pImgSeq )
+    {
+        // Compute only the new size of an elementary image.
+        // The actual resizing is done in the draw() method for now...
+
+        // Compute the resize factors
+        float factorX, factorY;
+        getResizeFactors( factorX, factorY );
+
+        // Size of one elementary background image (padding included)
+        m_bgWidth = (int)((m_pImgSeq->getWidth() + m_padHoriz) * factorX / m_nbHoriz);
+        m_bgHeight = (int)((m_pImgSeq->getHeight() + m_padVert) * factorY / m_nbVert);
+    }
+}
+
+
 void CtrlSliderBg::associateCursor( CtrlSliderCursor &rCursor )
 {
     m_pCursor = &rCursor;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/controls/ctrl_slider.hpp vlc-0.8.6-svn20061008.debian/modules/gui/skins2/controls/ctrl_slider.hpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/controls/ctrl_slider.hpp	2006-09-18 06:28:22.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/controls/ctrl_slider.hpp	2006-09-21 11:50:22.000000000 -0400
@@ -2,7 +2,7 @@
  * ctrl_slider.hpp
  *****************************************************************************
  * Copyright (C) 2003 the VideoLAN team
- * $Id: ctrl_slider.hpp 16457 2006-08-31 20:51:12Z hartman $
+ * $Id: ctrl_slider.hpp 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Cyril Deguet     <asmax@via.ecp.fr>
  *          Olivier Teulire <ipkiss@via.ecp.fr>
@@ -128,6 +128,9 @@
         /// Handle an event
         virtual void handleEvent( EvtGeneric &rEvent );
 
+        /// Method called when the control is resized
+        virtual void onResize();
+
         /// Get the type of control (custom RTTI)
         virtual string getType() const { return "slider_bg"; }
 
@@ -146,7 +149,7 @@
         /// Initial size of the control
         int m_width, m_height;
         /// Background image sequence (optional)
-        OSGraphics *m_pImgSeq;
+        GenericBitmap *m_pImgSeq;
         /// Number of images in the background bitmap
         int m_nbHoriz, m_nbVert;
         /// Number of pixels between two images
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/controls/ctrl_text.cpp vlc-0.8.6-svn20061008.debian/modules/gui/skins2/controls/ctrl_text.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/controls/ctrl_text.cpp	2006-09-18 06:28:22.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/controls/ctrl_text.cpp	2006-09-21 11:50:22.000000000 -0400
@@ -2,7 +2,7 @@
  * ctrl_text.cpp
  *****************************************************************************
  * Copyright (C) 2003 the VideoLAN team
- * $Id: ctrl_text.cpp 16457 2006-08-31 20:51:12Z hartman $
+ * $Id: ctrl_text.cpp 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Cyril Deguet     <asmax@via.ecp.fr>
  *          Olivier Teulire <ipkiss@via.ecp.fr>
@@ -242,7 +242,7 @@
     m_pImgDouble = m_rFont.drawString( doubleStringWithSep, m_color );
 
     // Update the current image used, as if the control size had changed
-    onChangePosition();
+    onPositionChange();
 
     if( m_alignment == kRight && getPosition() &&
         getPosition()->getWidth() < m_pImg->getWidth() )
@@ -281,7 +281,7 @@
 }
 
 
-void CtrlText::onChangePosition()
+void CtrlText::onPositionChange()
 {
     if( m_pImg && getPosition() )
     {
@@ -303,6 +303,12 @@
 }
 
 
+void CtrlText::onResize()
+{
+    onPositionChange();
+}
+
+
 void CtrlText::CmdToManual::execute()
 {
     EvtMouse *pEvtMouse = (EvtMouse*)m_pParent->m_pEvt;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/controls/ctrl_text.hpp vlc-0.8.6-svn20061008.debian/modules/gui/skins2/controls/ctrl_text.hpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/controls/ctrl_text.hpp	2006-09-18 06:28:22.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/controls/ctrl_text.hpp	2006-09-21 11:50:22.000000000 -0400
@@ -2,7 +2,7 @@
  * ctrl_text.hpp
  *****************************************************************************
  * Copyright (C) 2003 the VideoLAN team
- * $Id: ctrl_text.hpp 16457 2006-08-31 20:51:12Z hartman $
+ * $Id: ctrl_text.hpp 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Cyril Deguet     <asmax@via.ecp.fr>
  *          Olivier Teulire <ipkiss@via.ecp.fr>
@@ -131,7 +131,9 @@
         void adjust( int &position );
 
         /// Update the behaviour of the text whenever the control size changes
-        virtual void onChangePosition();
+        virtual void onPositionChange();
+        /// Update the behaviour of the text whenever the control size changes
+        virtual void onResize();
 };
 
 
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/Makefile.in vlc-0.8.6-svn20061008.debian/modules/gui/skins2/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/Makefile.in	2006-09-18 06:30:52.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/Makefile.in	2006-10-08 12:42:55.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/parser/builder.cpp vlc-0.8.6-svn20061008.debian/modules/gui/skins2/parser/builder.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/parser/builder.cpp	2006-09-18 06:28:23.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/parser/builder.cpp	2006-09-22 11:14:30.000000000 -0400
@@ -2,7 +2,7 @@
  * builder.cpp
  *****************************************************************************
  * Copyright (C) 2003 the VideoLAN team
- * $Id: builder.cpp 16647 2006-09-14 14:58:57Z hartman $
+ * $Id: builder.cpp 16778 2006-09-21 23:56:47Z hartman $
  *
  * Authors: Cyril Deguet     <asmax@via.ecp.fr>
  *          Olivier Teulire <ipkiss@via.ecp.fr>
@@ -430,7 +430,8 @@
     const Position pos = makePosition( rData.m_leftTop, rData.m_rightBottom,
                                        rData.m_xPos, rData.m_yPos,
                                        pBmpUp->getWidth(),
-                                       pBmpUp->getHeight(), *pLayout );
+                                       pBmpUp->getHeight(), *pLayout,
+                                       rData.m_xKeepRatio, rData.m_yKeepRatio );
 
     pLayout->addControl( pButton, pos, rData.m_layer );
 
@@ -505,7 +506,8 @@
     const Position pos = makePosition( rData.m_leftTop, rData.m_rightBottom,
                                        rData.m_xPos, rData.m_yPos,
                                        pBmpUp1->getWidth(),
-                                       pBmpUp1->getHeight(), *pLayout );
+                                       pBmpUp1->getHeight(), *pLayout,
+                                       rData.m_xKeepRatio, rData.m_yKeepRatio );
 
     pLayout->addControl( pCheckbox, pos, rData.m_layer );
 
@@ -551,9 +553,10 @@
 
     // Compute the position of the control
     const Position pos = makePosition( rData.m_leftTop, rData.m_rightBottom,
-                                       rData.m_xPos,
-                                       rData.m_yPos, pBmp->getWidth(),
-                                       pBmp->getHeight(), *pLayout );
+                                       rData.m_xPos, rData.m_yPos,
+                                       pBmp->getWidth(), pBmp->getHeight(),
+                                       *pLayout, rData.m_xKeepRatio,
+                                       rData.m_yKeepRatio );
 
     // XXX: test to be changed! XXX
     if( rData.m_actionId == "move" )
@@ -660,8 +663,8 @@
     // Compute the position of the control
     const Position pos = makePosition( rData.m_leftTop, rData.m_rightBottom,
                                        rData.m_xPos, rData.m_yPos,
-                                       rData.m_width, height,
-                                       *pLayout );
+                                       rData.m_width, height, *pLayout,
+                                       rData.m_xKeepRatio, rData.m_yKeepRatio );
 
     pLayout->addControl( pText, pos, rData.m_layer );
 
@@ -708,10 +711,12 @@
 
     // XXX: resizing is not supported
     // Compute the position of the control
-    const Position pos =
-        makePosition( rData.m_leftTop, rData.m_rightBottom, rData.m_xPos,
-                      rData.m_yPos, pSeq->getWidth(),
-                      pSeq->getHeight() / rData.m_nbImages, *pLayout );
+    const Position pos = makePosition( rData.m_leftTop, rData.m_rightBottom,
+                                       rData.m_xPos, rData.m_yPos,
+                                       pSeq->getWidth(),
+                                       pSeq->getHeight() / rData.m_nbImages,
+                                       *pLayout,
+                                       rData.m_xKeepRatio, rData.m_yKeepRatio );
 
     pLayout->addControl( pRadial, pos, rData.m_layer );
 
@@ -772,7 +777,8 @@
     const Position pos = makePosition( rData.m_leftTop, rData.m_rightBottom,
                                        rData.m_xPos, rData.m_yPos,
                                        pCurve->getWidth(), pCurve->getHeight(),
-                                       *pLayout );
+                                       *pLayout,
+                                       rData.m_xKeepRatio, rData.m_yKeepRatio );
 
     pLayout->addControl( pBackground, pos, rData.m_layer );
 
@@ -852,7 +858,8 @@
     const Position pos = makePosition( rData.m_leftTop, rData.m_rightBottom,
                                        rData.m_xPos, rData.m_yPos,
                                        rData.m_width, rData.m_height,
-                                       *pLayout );
+                                       *pLayout,
+                                       rData.m_xKeepRatio, rData.m_yKeepRatio );
 
     pLayout->addControl( pList, pos, rData.m_layer );
 
@@ -916,7 +923,8 @@
     const Position pos = makePosition( rData.m_leftTop, rData.m_rightBottom,
                                        rData.m_xPos, rData.m_yPos,
                                        rData.m_width, rData.m_height,
-                                       *pLayout );
+                                       *pLayout,
+                                       rData.m_xKeepRatio, rData.m_yKeepRatio );
 
     pLayout->addControl( pTree, pos, rData.m_layer );
 
@@ -945,7 +953,8 @@
     const Position pos = makePosition( rData.m_leftTop, rData.m_rightBottom,
                                        rData.m_xPos, rData.m_yPos,
                                        rData.m_width, rData.m_height,
-                                       *pLayout );
+                                       *pLayout,
+                                       rData.m_xKeepRatio, rData.m_yKeepRatio );
 
     pLayout->addControl( pVideo, pos, rData.m_layer );
 
@@ -956,7 +965,8 @@
 const Position Builder::makePosition( const string &rLeftTop,
                                       const string &rRightBottom,
                                       int xPos, int yPos, int width,
-                                      int height, const Box &rBox ) const
+                                      int height, const Box &rBox,
+                                      bool xKeepRatio, bool yKeepRatio ) const
 {
     int left = 0, top = 0, right = 0, bottom = 0;
     Position::Ref_t refLeftTop = Position::kLeftTop;
@@ -1017,8 +1027,23 @@
         refRightBottom = Position::kRightBottom;
     }
 
+    // In "keep ratio" mode, overwrite the previously computed values with the
+    // actual ones
+    // XXX: this coupling between makePosition and the Position class should
+    // be reduced...
+    if( xKeepRatio )
+    {
+        left = xPos;
+        right = xPos + width;
+    }
+    if( yKeepRatio )
+    {
+        top = yPos;
+        bottom = yPos + height;
+    }
+
     return Position( left, top, right, bottom, rBox, refLeftTop,
-                     refRightBottom );
+                     refRightBottom, xKeepRatio, yKeepRatio );
 }
 
 
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/parser/builder_data.hpp vlc-0.8.6-svn20061008.debian/modules/gui/skins2/parser/builder_data.hpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/parser/builder_data.hpp	2006-09-18 06:28:23.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/parser/builder_data.hpp	2006-09-22 11:14:30.000000000 -0400
@@ -2,7 +2,7 @@
  * builder_data.hpp
  *****************************************************************************
  * Copyright (C) 2003 the VideoLAN team
- * $Id: builder_data.hpp 16454 2006-08-31 19:54:36Z hartman $
+ * $Id: builder_data.hpp 16778 2006-09-21 23:56:47Z hartman $
  *
  * Authors: Cyril Deguet     <asmax@via.ecp.fr>
  *          Olivier Teuliere <ipkiss@via.ecp.fr>
@@ -203,14 +203,16 @@
     /// Type definition
     struct Button
     {
-        Button( const string & id, int xPos, int yPos, const string & leftTop, const string & rightBottom, const string & visible, const string & upId, const string & downId, const string & overId, const string & actionId, const string & tooltip, const string & help, int layer, const string & windowId, const string & layoutId ):
-m_id( id ), m_xPos( xPos ), m_yPos( yPos ), m_leftTop( leftTop ), m_rightBottom( rightBottom ), m_visible( visible ), m_upId( upId ), m_downId( downId ), m_overId( overId ), m_actionId( actionId ), m_tooltip( tooltip ), m_help( help ), m_layer( layer ), m_windowId( windowId ), m_layoutId( layoutId ) {}
+        Button( const string & id, int xPos, int yPos, const string & leftTop, const string & rightBottom, bool xKeepRatio, bool yKeepRatio, const string & visible, const string & upId, const string & downId, const string & overId, const string & actionId, const string & tooltip, const string & help, int layer, const string & windowId, const string & layoutId ):
+m_id( id ), m_xPos( xPos ), m_yPos( yPos ), m_leftTop( leftTop ), m_rightBottom( rightBottom ), m_xKeepRatio( xKeepRatio ), m_yKeepRatio( yKeepRatio ), m_visible( visible ), m_upId( upId ), m_downId( downId ), m_overId( overId ), m_actionId( actionId ), m_tooltip( tooltip ), m_help( help ), m_layer( layer ), m_windowId( windowId ), m_layoutId( layoutId ) {}
 
         string m_id;
         int m_xPos;
         int m_yPos;
         string m_leftTop;
         string m_rightBottom;
+        bool m_xKeepRatio;
+        bool m_yKeepRatio;
         string m_visible;
         string m_upId;
         string m_downId;
@@ -228,14 +230,16 @@
     /// Type definition
     struct Checkbox
     {
-        Checkbox( const string & id, int xPos, int yPos, const string & leftTop, const string & rightBottom, const string & visible, const string & up1Id, const string & down1Id, const string & over1Id, const string & up2Id, const string & down2Id, const string & over2Id, const string & state, const string & action1, const string & action2, const string & tooltip1, const string & tooltip2, const string & help, int layer, const string & windowId, const string & layoutId ):
-m_id( id ), m_xPos( xPos ), m_yPos( yPos ), m_leftTop( leftTop ), m_rightBottom( rightBottom ), m_visible( visible ), m_up1Id( up1Id ), m_down1Id( down1Id ), m_over1Id( over1Id ), m_up2Id( up2Id ), m_down2Id( down2Id ), m_over2Id( over2Id ), m_state( state ), m_action1( action1 ), m_action2( action2 ), m_tooltip1( tooltip1 ), m_tooltip2( tooltip2 ), m_help( help ), m_layer( layer ), m_windowId( windowId ), m_layoutId( layoutId ) {}
+        Checkbox( const string & id, int xPos, int yPos, const string & leftTop, const string & rightBottom, bool xKeepRatio, bool yKeepRatio, const string & visible, const string & up1Id, const string & down1Id, const string & over1Id, const string & up2Id, const string & down2Id, const string & over2Id, const string & state, const string & action1, const string & action2, const string & tooltip1, const string & tooltip2, const string & help, int layer, const string & windowId, const string & layoutId ):
+m_id( id ), m_xPos( xPos ), m_yPos( yPos ), m_leftTop( leftTop ), m_rightBottom( rightBottom ), m_xKeepRatio( xKeepRatio ), m_yKeepRatio( yKeepRatio ), m_visible( visible ), m_up1Id( up1Id ), m_down1Id( down1Id ), m_over1Id( over1Id ), m_up2Id( up2Id ), m_down2Id( down2Id ), m_over2Id( over2Id ), m_state( state ), m_action1( action1 ), m_action2( action2 ), m_tooltip1( tooltip1 ), m_tooltip2( tooltip2 ), m_help( help ), m_layer( layer ), m_windowId( windowId ), m_layoutId( layoutId ) {}
 
         string m_id;
         int m_xPos;
         int m_yPos;
         string m_leftTop;
         string m_rightBottom;
+        bool m_xKeepRatio;
+        bool m_yKeepRatio;
         string m_visible;
         string m_up1Id;
         string m_down1Id;
@@ -259,14 +263,16 @@
     /// Type definition
     struct Image
     {
-        Image( const string & id, int xPos, int yPos, const string & leftTop, const string & rightBottom, const string & visible, const string & bmpId, const string & actionId, const string & action2Id, const string & resize, const string & help, int layer, const string & windowId, const string & layoutId ):
-m_id( id ), m_xPos( xPos ), m_yPos( yPos ), m_leftTop( leftTop ), m_rightBottom( rightBottom ), m_visible( visible ), m_bmpId( bmpId ), m_actionId( actionId ), m_action2Id( action2Id ), m_resize( resize ), m_help( help ), m_layer( layer ), m_windowId( windowId ), m_layoutId( layoutId ) {}
+        Image( const string & id, int xPos, int yPos, const string & leftTop, const string & rightBottom, bool xKeepRatio, bool yKeepRatio, const string & visible, const string & bmpId, const string & actionId, const string & action2Id, const string & resize, const string & help, int layer, const string & windowId, const string & layoutId ):
+m_id( id ), m_xPos( xPos ), m_yPos( yPos ), m_leftTop( leftTop ), m_rightBottom( rightBottom ), m_xKeepRatio( xKeepRatio ), m_yKeepRatio( yKeepRatio ), m_visible( visible ), m_bmpId( bmpId ), m_actionId( actionId ), m_action2Id( action2Id ), m_resize( resize ), m_help( help ), m_layer( layer ), m_windowId( windowId ), m_layoutId( layoutId ) {}
 
         string m_id;
         int m_xPos;
         int m_yPos;
         string m_leftTop;
         string m_rightBottom;
+        bool m_xKeepRatio;
+        bool m_yKeepRatio;
         string m_visible;
         string m_bmpId;
         string m_actionId;
@@ -295,8 +301,8 @@
     /// Type definition
     struct Text
     {
-        Text( const string & id, int xPos, int yPos, const string & visible, const string & fontId, const string & text, int width, const string & leftTop, const string & rightBottom, uint32_t color, const string & scrolling, const string & alignment, const string & help, int layer, const string & windowId, const string & layoutId ):
-m_id( id ), m_xPos( xPos ), m_yPos( yPos ), m_visible( visible ), m_fontId( fontId ), m_text( text ), m_width( width ), m_leftTop( leftTop ), m_rightBottom( rightBottom ), m_color( color ), m_scrolling( scrolling ), m_alignment( alignment ), m_help( help ), m_layer( layer ), m_windowId( windowId ), m_layoutId( layoutId ) {}
+        Text( const string & id, int xPos, int yPos, const string & visible, const string & fontId, const string & text, int width, const string & leftTop, const string & rightBottom, bool xKeepRatio, bool yKeepRatio, uint32_t color, const string & scrolling, const string & alignment, const string & help, int layer, const string & windowId, const string & layoutId ):
+m_id( id ), m_xPos( xPos ), m_yPos( yPos ), m_visible( visible ), m_fontId( fontId ), m_text( text ), m_width( width ), m_leftTop( leftTop ), m_rightBottom( rightBottom ), m_xKeepRatio( xKeepRatio ), m_yKeepRatio( yKeepRatio ), m_color( color ), m_scrolling( scrolling ), m_alignment( alignment ), m_help( help ), m_layer( layer ), m_windowId( windowId ), m_layoutId( layoutId ) {}
 
         string m_id;
         int m_xPos;
@@ -307,6 +313,8 @@
         int m_width;
         string m_leftTop;
         string m_rightBottom;
+        bool m_xKeepRatio;
+        bool m_yKeepRatio;
         uint32_t m_color;
         string m_scrolling;
         string m_alignment;
@@ -321,8 +329,8 @@
     /// Type definition
     struct RadialSlider
     {
-        RadialSlider( const string & id, const string & visible, int xPos, int yPos, const string & leftTop, const string & rightBottom, const string & sequence, int nbImages, float minAngle, float maxAngle, const string & value, const string & tooltip, const string & help, int layer, const string & windowId, const string & layoutId ):
-m_id( id ), m_visible( visible ), m_xPos( xPos ), m_yPos( yPos ), m_leftTop( leftTop ), m_rightBottom( rightBottom ), m_sequence( sequence ), m_nbImages( nbImages ), m_minAngle( minAngle ), m_maxAngle( maxAngle ), m_value( value ), m_tooltip( tooltip ), m_help( help ), m_layer( layer ), m_windowId( windowId ), m_layoutId( layoutId ) {}
+        RadialSlider( const string & id, const string & visible, int xPos, int yPos, const string & leftTop, const string & rightBottom, bool xKeepRatio, bool yKeepRatio, const string & sequence, int nbImages, float minAngle, float maxAngle, const string & value, const string & tooltip, const string & help, int layer, const string & windowId, const string & layoutId ):
+m_id( id ), m_visible( visible ), m_xPos( xPos ), m_yPos( yPos ), m_leftTop( leftTop ), m_rightBottom( rightBottom ), m_xKeepRatio( xKeepRatio ), m_yKeepRatio( yKeepRatio ), m_sequence( sequence ), m_nbImages( nbImages ), m_minAngle( minAngle ), m_maxAngle( maxAngle ), m_value( value ), m_tooltip( tooltip ), m_help( help ), m_layer( layer ), m_windowId( windowId ), m_layoutId( layoutId ) {}
 
         string m_id;
         string m_visible;
@@ -330,6 +338,8 @@
         int m_yPos;
         string m_leftTop;
         string m_rightBottom;
+        bool m_xKeepRatio;
+        bool m_yKeepRatio;
         string m_sequence;
         int m_nbImages;
         float m_minAngle;
@@ -347,8 +357,8 @@
     /// Type definition
     struct Slider
     {
-        Slider( const string & id, const string & visible, int xPos, int yPos, const string & leftTop, const string & rightBottom, const string & upId, const string & downId, const string & overId, const string & points, int thickness, const string & value, const string & imageId, int nbHoriz, int nbVert, int padHoriz, int padVert, const string & tooltip, const string & help, int layer, const string & windowId, const string & layoutId ):
-m_id( id ), m_visible( visible ), m_xPos( xPos ), m_yPos( yPos ), m_leftTop( leftTop ), m_rightBottom( rightBottom ), m_upId( upId ), m_downId( downId ), m_overId( overId ), m_points( points ), m_thickness( thickness ), m_value( value ), m_imageId( imageId ), m_nbHoriz( nbHoriz ), m_nbVert( nbVert ), m_padHoriz( padHoriz ), m_padVert( padVert ), m_tooltip( tooltip ), m_help( help ), m_layer( layer ), m_windowId( windowId ), m_layoutId( layoutId ) {}
+        Slider( const string & id, const string & visible, int xPos, int yPos, const string & leftTop, const string & rightBottom, bool xKeepRatio, bool yKeepRatio, const string & upId, const string & downId, const string & overId, const string & points, int thickness, const string & value, const string & imageId, int nbHoriz, int nbVert, int padHoriz, int padVert, const string & tooltip, const string & help, int layer, const string & windowId, const string & layoutId ):
+m_id( id ), m_visible( visible ), m_xPos( xPos ), m_yPos( yPos ), m_leftTop( leftTop ), m_rightBottom( rightBottom ), m_xKeepRatio( xKeepRatio ), m_yKeepRatio( yKeepRatio ), m_upId( upId ), m_downId( downId ), m_overId( overId ), m_points( points ), m_thickness( thickness ), m_value( value ), m_imageId( imageId ), m_nbHoriz( nbHoriz ), m_nbVert( nbVert ), m_padHoriz( padHoriz ), m_padVert( padVert ), m_tooltip( tooltip ), m_help( help ), m_layer( layer ), m_windowId( windowId ), m_layoutId( layoutId ) {}
 
         string m_id;
         string m_visible;
@@ -356,6 +366,8 @@
         int m_yPos;
         string m_leftTop;
         string m_rightBottom;
+        bool m_xKeepRatio;
+        bool m_yKeepRatio;
         string m_upId;
         string m_downId;
         string m_overId;
@@ -379,8 +391,8 @@
     /// Type definition
     struct List
     {
-        List( const string & id, int xPos, int yPos, const string & visible, int width, int height, const string & leftTop, const string & rightBottom, const string & fontId, const string & var, const string & bgImageId, const string & fgColor, const string & playColor, const string & bgColor1, const string & bgColor2, const string & selColor, const string & help, int layer, const string & windowId, const string & layoutId ):
-m_id( id ), m_xPos( xPos ), m_yPos( yPos ), m_visible( visible ), m_width( width ), m_height( height ), m_leftTop( leftTop ), m_rightBottom( rightBottom ), m_fontId( fontId ), m_var( var ), m_bgImageId( bgImageId ), m_fgColor( fgColor ), m_playColor( playColor ), m_bgColor1( bgColor1 ), m_bgColor2( bgColor2 ), m_selColor( selColor ), m_help( help ), m_layer( layer ), m_windowId( windowId ), m_layoutId( layoutId ) {}
+        List( const string & id, int xPos, int yPos, const string & visible, int width, int height, const string & leftTop, const string & rightBottom, bool xKeepRatio, bool yKeepRatio, const string & fontId, const string & var, const string & bgImageId, const string & fgColor, const string & playColor, const string & bgColor1, const string & bgColor2, const string & selColor, const string & help, int layer, const string & windowId, const string & layoutId ):
+m_id( id ), m_xPos( xPos ), m_yPos( yPos ), m_visible( visible ), m_width( width ), m_height( height ), m_leftTop( leftTop ), m_rightBottom( rightBottom ), m_xKeepRatio( xKeepRatio ), m_yKeepRatio( yKeepRatio ), m_fontId( fontId ), m_var( var ), m_bgImageId( bgImageId ), m_fgColor( fgColor ), m_playColor( playColor ), m_bgColor1( bgColor1 ), m_bgColor2( bgColor2 ), m_selColor( selColor ), m_help( help ), m_layer( layer ), m_windowId( windowId ), m_layoutId( layoutId ) {}
 
         string m_id;
         int m_xPos;
@@ -390,6 +402,8 @@
         int m_height;
         string m_leftTop;
         string m_rightBottom;
+        bool m_xKeepRatio;
+        bool m_yKeepRatio;
         string m_fontId;
         string m_var;
         string m_bgImageId;
@@ -409,8 +423,8 @@
     /// Type definition
     struct Tree
     {
-        Tree( const string & id, int xPos, int yPos, const string & visible, const string & flat, int width, int height, const string & leftTop, const string & rightBottom, const string & fontId, const string & var, const string & bgImageId, const string & itemImageId, const string & openImageId, const string & closedImageId, const string & fgColor, const string & playColor, const string & bgColor1, const string & bgColor2, const string & selColor, const string & help, int layer, const string & windowId, const string & layoutId ):
-m_id( id ), m_xPos( xPos ), m_yPos( yPos ), m_visible( visible ), m_flat( flat ), m_width( width ), m_height( height ), m_leftTop( leftTop ), m_rightBottom( rightBottom ), m_fontId( fontId ), m_var( var ), m_bgImageId( bgImageId ), m_itemImageId( itemImageId ), m_openImageId( openImageId ), m_closedImageId( closedImageId ), m_fgColor( fgColor ), m_playColor( playColor ), m_bgColor1( bgColor1 ), m_bgColor2( bgColor2 ), m_selColor( selColor ), m_help( help ), m_layer( layer ), m_windowId( windowId ), m_layoutId( layoutId ) {}
+        Tree( const string & id, int xPos, int yPos, const string & visible, const string & flat, int width, int height, const string & leftTop, const string & rightBottom, bool xKeepRatio, bool yKeepRatio, const string & fontId, const string & var, const string & bgImageId, const string & itemImageId, const string & openImageId, const string & closedImageId, const string & fgColor, const string & playColor, const string & bgColor1, const string & bgColor2, const string & selColor, const string & help, int layer, const string & windowId, const string & layoutId ):
+m_id( id ), m_xPos( xPos ), m_yPos( yPos ), m_visible( visible ), m_flat( flat ), m_width( width ), m_height( height ), m_leftTop( leftTop ), m_rightBottom( rightBottom ), m_xKeepRatio( xKeepRatio ), m_yKeepRatio( yKeepRatio ), m_fontId( fontId ), m_var( var ), m_bgImageId( bgImageId ), m_itemImageId( itemImageId ), m_openImageId( openImageId ), m_closedImageId( closedImageId ), m_fgColor( fgColor ), m_playColor( playColor ), m_bgColor1( bgColor1 ), m_bgColor2( bgColor2 ), m_selColor( selColor ), m_help( help ), m_layer( layer ), m_windowId( windowId ), m_layoutId( layoutId ) {}
 
         string m_id;
         int m_xPos;
@@ -421,6 +435,8 @@
         int m_height;
         string m_leftTop;
         string m_rightBottom;
+        bool m_xKeepRatio;
+        bool m_yKeepRatio;
         string m_fontId;
         string m_var;
         string m_bgImageId;
@@ -443,8 +459,8 @@
     /// Type definition
     struct Video
     {
-        Video( const string & id, int xPos, int yPos, int width, int height, const string & leftTop, const string & rightBottom, const string & visible, bool autoResize, const string & help, int layer, const string & windowId, const string & layoutId ):
-m_id( id ), m_xPos( xPos ), m_yPos( yPos ), m_width( width ), m_height( height ), m_leftTop( leftTop ), m_rightBottom( rightBottom ), m_visible( visible ), m_autoResize( autoResize ), m_help( help ), m_layer( layer ), m_windowId( windowId ), m_layoutId( layoutId ) {}
+        Video( const string & id, int xPos, int yPos, int width, int height, const string & leftTop, const string & rightBottom, bool xKeepRatio, bool yKeepRatio, const string & visible, bool autoResize, const string & help, int layer, const string & windowId, const string & layoutId ):
+m_id( id ), m_xPos( xPos ), m_yPos( yPos ), m_width( width ), m_height( height ), m_leftTop( leftTop ), m_rightBottom( rightBottom ), m_xKeepRatio( xKeepRatio ), m_yKeepRatio( yKeepRatio ), m_visible( visible ), m_autoResize( autoResize ), m_help( help ), m_layer( layer ), m_windowId( windowId ), m_layoutId( layoutId ) {}
 
         string m_id;
         int m_xPos;
@@ -453,6 +469,8 @@
         int m_height;
         string m_leftTop;
         string m_rightBottom;
+        bool m_xKeepRatio;
+        bool m_yKeepRatio;
         string m_visible;
         bool m_autoResize;
         string m_help;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/parser/builder.hpp vlc-0.8.6-svn20061008.debian/modules/gui/skins2/parser/builder.hpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/parser/builder.hpp	2006-09-18 06:28:23.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/parser/builder.hpp	2006-09-22 11:14:30.000000000 -0400
@@ -2,7 +2,7 @@
  * builder.hpp
  *****************************************************************************
  * Copyright (C) 2003 the VideoLAN team
- * $Id: builder.hpp 15249 2006-04-17 15:18:05Z asmax $
+ * $Id: builder.hpp 16778 2006-09-21 23:56:47Z hartman $
  *
  * Authors: Cyril Deguet     <asmax@via.ecp.fr>
  *          Olivier Teulire <ipkiss@via.ecp.fr>
@@ -90,7 +90,8 @@
         const Position makePosition( const string &rLeftTop,
                                      const string &rRightBottom,
                                      int xPos, int yPos, int width, int height,
-                                     const Box &rBox ) const;
+                                     const Box &rBox, bool xKeepRatio = false,
+                                     bool yKeepRatio = false ) const;
 
         // Build the full path of a file
         string getFilePath( const string &fileName ) const;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/parser/interpreter.cpp vlc-0.8.6-svn20061008.debian/modules/gui/skins2/parser/interpreter.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/parser/interpreter.cpp	2006-09-18 06:28:23.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/parser/interpreter.cpp	2006-09-22 11:14:30.000000000 -0400
@@ -2,7 +2,7 @@
  * interpreter.cpp
  *****************************************************************************
  * Copyright (C) 2003 the VideoLAN team
- * $Id: interpreter.cpp 16460 2006-08-31 22:01:13Z hartman $
+ * $Id: interpreter.cpp 16773 2006-09-21 18:46:25Z hartman $
  *
  * Authors: Cyril Deguet     <asmax@via.ecp.fr>
  *          Olivier Teulire <ipkiss@via.ecp.fr>
@@ -95,8 +95,11 @@
     m_commandMap["playlist.setRepeat(false)"] =
         CmdGenericPtr( new CmdPlaylistRepeat( getIntf(), false ) );
     VarTree &rVarTree = VlcProc::instance( getIntf() )->getPlaytreeVar();
+    m_commandMap["playlist.del()"] =
+        CmdGenericPtr( new CmdPlaytreeDel( getIntf(), rVarTree ) );
     m_commandMap["playtree.del()"] =
         CmdGenericPtr( new CmdPlaytreeDel( getIntf(), rVarTree ) );
+    REGISTER_CMD( "playlist.sort()", CmdPlaytreeSort )
     REGISTER_CMD( "playtree.sort()", CmdPlaytreeSort )
     REGISTER_CMD( "vlc.fullscreen()", CmdFullscreen )
     REGISTER_CMD( "vlc.play()", CmdPlay )
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/parser/skin_parser.cpp vlc-0.8.6-svn20061008.debian/modules/gui/skins2/parser/skin_parser.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/parser/skin_parser.cpp	2006-09-18 06:28:23.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/parser/skin_parser.cpp	2006-09-25 07:47:38.000000000 -0400
@@ -2,7 +2,7 @@
  * skin_parser.cpp
  *****************************************************************************
  * Copyright (C) 2004 the VideoLAN team
- * $Id: skin_parser.cpp 16454 2006-08-31 19:54:36Z hartman $
+ * $Id: skin_parser.cpp 16844 2006-09-25 11:47:35Z sam $
  *
  * Authors: Cyril Deguet     <asmax@via.ecp.fr>
  *
@@ -181,6 +181,8 @@
         CheckDefault( "y", "0" );
         CheckDefault( "lefttop", "lefttop" );
         CheckDefault( "rightbottom", "lefttop" );
+        CheckDefault( "xkeepratio", "false" );
+        CheckDefault( "ykeepratio", "false" );
         CheckDefault( "down", "none" );
         CheckDefault( "over", "none" );
         CheckDefault( "action", "none" );
@@ -189,7 +191,9 @@
 
         const BuilderData::Button button( uniqueId( attr["id"] ),
                 atoi( attr["x"] ) + m_xOffset, atoi( attr["y"] ) + m_yOffset,
-                attr["lefttop"], attr["rightbottom"], attr["visible"],
+                attr["lefttop"], attr["rightbottom"],
+                convertBoolean( attr["xkeepratio"] ),
+                convertBoolean( attr["ykeepratio"] ), attr["visible"],
                 attr["up"], attr["down"], attr["over"], attr["action"],
                 attr["tooltiptext"], attr["help"],
                 m_curLayer, m_curWindowId, m_curLayoutId );
@@ -208,6 +212,8 @@
         CheckDefault( "y", "0" );
         CheckDefault( "lefttop", "lefttop" );
         CheckDefault( "rightbottom", "lefttop" );
+        CheckDefault( "xkeepratio", "false" );
+        CheckDefault( "ykeepratio", "false" );
         CheckDefault( "down1", "none" );
         CheckDefault( "over1", "none" );
         CheckDefault( "down2", "none" );
@@ -220,7 +226,9 @@
 
         const BuilderData::Checkbox checkbox( uniqueId( attr["id"] ),
                 atoi( attr["x"] ) + m_xOffset, atoi( attr["y"] ) + m_yOffset,
-                attr["lefttop"], attr["rightbottom"], attr["visible"],
+                attr["lefttop"], attr["rightbottom"],
+                convertBoolean( attr["xkeepratio"] ),
+                convertBoolean( attr["ykeepratio"] ), attr["visible"],
                 attr["up1"], attr["down1"], attr["over1"],
                 attr["up2"], attr["down2"], attr["over2"], attr["state"],
                 attr["action1"], attr["action2"], attr["tooltiptext1"],
@@ -261,6 +269,8 @@
         CheckDefault( "y", "0" );
         CheckDefault( "lefttop", "lefttop" );
         CheckDefault( "rightbottom", "lefttop" );
+        CheckDefault( "xkeepratio", "false" );
+        CheckDefault( "ykeepratio", "false" );
         CheckDefault( "action", "none" );
         CheckDefault( "action2", "none" );
         CheckDefault( "resize", "mosaic" );
@@ -268,7 +278,9 @@
 
         const BuilderData::Image imageData( uniqueId( attr["id"] ),
                 atoi( attr["x"] ) + m_xOffset, atoi( attr["y"] ) + m_yOffset,
-                attr["lefttop"], attr["rightbottom"], attr["visible"],
+                attr["lefttop"], attr["rightbottom"],
+                convertBoolean( attr["xkeepratio"] ),
+                convertBoolean( attr["ykeepratio"] ), attr["visible"],
                 attr["image"], attr["action"], attr["action2"], attr["resize"],
                 attr["help"], m_curLayer, m_curWindowId, m_curLayoutId );
         m_curLayer++;
@@ -305,6 +317,8 @@
         CheckDefault( "height", "0" );
         CheckDefault( "lefttop", "lefttop" );
         CheckDefault( "rightbottom", "lefttop" );
+        CheckDefault( "xkeepratio", "false" );
+        CheckDefault( "ykeepratio", "false" );
         CheckDefault( "bgimage", "none" );
         CheckDefault( "fgcolor", "#000000" );
         CheckDefault( "playcolor", "#FF0000" );
@@ -314,16 +328,24 @@
         CheckDefault( "help", "" );
 
         m_curListId = uniqueId( attr["id"] );
-        const BuilderData::List listData( m_curListId, atoi( attr["x"] ) +
+        const BuilderData::Tree treeData( m_curListId, atoi( attr["x"] ) +
                 m_xOffset, atoi( attr["y"] ) + m_yOffset, attr["visible"],
+                attr["flat"],
                 atoi( attr["width"]), atoi( attr["height"] ),
-                attr["lefttop"], attr["rightbottom"], attr["font"],
-                "playlist", attr["bgimage"], attr["fgcolor"],
-                attr["playcolor"], attr["bgcolor1"], attr["bgcolor2"],
+                attr["lefttop"], attr["rightbottom"],
+                convertBoolean( attr["xkeepratio"] ),
+                convertBoolean( attr["ykeepratio"] ),
+                attr["font"], "playtree",
+                attr["bgimage"], attr["itemimage"],
+                attr["openimage"], attr["closedimage"],
+                attr["fgcolor"],
+                attr["playcolor"],
+                attr["bgcolor1"],
+                attr["bgcolor2"],
                 attr["selcolor"], attr["help"],
                 m_curLayer, m_curWindowId, m_curLayoutId );
         m_curLayer++;
-        m_pData->m_listList.push_back( listData );
+        m_pData->m_listTree.push_back( treeData );
     }
 
     else if( rName == "Playtree" )
@@ -338,6 +360,8 @@
         CheckDefault( "height", "0" );
         CheckDefault( "lefttop", "lefttop" );
         CheckDefault( "rightbottom", "lefttop" );
+        CheckDefault( "xkeepratio", "false" );
+        CheckDefault( "ykeepratio", "false" );
         CheckDefault( "bgimage", "none" );
         CheckDefault( "itemimage", "none" );
         CheckDefault( "openimage", "none" );
@@ -355,6 +379,8 @@
                 attr["flat"],
                 atoi( attr["width"]), atoi( attr["height"] ),
                 attr["lefttop"], attr["rightbottom"],
+                convertBoolean( attr["xkeepratio"] ),
+                convertBoolean( attr["ykeepratio"] ),
                 attr["font"], "playtree",
                 attr["bgimage"], attr["itemimage"],
                 attr["openimage"], attr["closedimage"],
@@ -376,6 +402,8 @@
         CheckDefault( "y", "0" );
         CheckDefault( "lefttop", "lefttop" );
         CheckDefault( "rightbottom", "lefttop" );
+        CheckDefault( "xkeepratio", "false" );
+        CheckDefault( "ykeepratio", "false" );
         CheckDefault( "minangle", "0" );
         CheckDefault( "maxangle", "360" );
         CheckDefault( "value", "none" );
@@ -385,7 +413,9 @@
         const BuilderData::RadialSlider radial( uniqueId( attr["id"] ),
                 attr["visible"],
                 atoi( attr["x"] ) + m_xOffset, atoi( attr["y"] ) + m_yOffset,
-                attr["lefttop"], attr["rightbottom"], attr["sequence"],
+                attr["lefttop"], attr["rightbottom"],
+                convertBoolean( attr["xkeepratio"] ),
+                convertBoolean( attr["ykeepratio"] ), attr["sequence"],
                 atoi( attr["nbImages"] ), atof( attr["minAngle"] ) * M_PI /180,
                 atof( attr["maxAngle"] ) * M_PI / 180, attr["value"],
                 attr["tooltiptext"], attr["help"], m_curLayer, m_curWindowId,
@@ -406,6 +436,8 @@
         CheckDefault( "height", "0" );
         CheckDefault( "lefttop", "lefttop" );
         CheckDefault( "rightbottom", "lefttop" );
+        CheckDefault( "xkeepratio", "false" );
+        CheckDefault( "ykeepratio", "false" );
         CheckDefault( "down", "none" );
         CheckDefault( "over", "none" );
         CheckDefault( "thickness", "10" );
@@ -427,7 +459,8 @@
         const BuilderData::Slider slider( uniqueId( attr["id"] ),
                 attr["visible"], atoi( attr["x"] ) + m_xOffset,
                 atoi( attr["y"] ) + m_yOffset, attr["lefttop"],
-                attr["rightbottom"], attr["up"], attr["down"],
+                attr["rightbottom"], convertBoolean( attr["xkeepratio"] ),
+                convertBoolean( attr["ykeepratio"] ), attr["up"], attr["down"],
                 attr["over"], attr["points"], atoi( attr["thickness"] ),
                 newValue, "none", 0, 0, 0, 0, attr["tooltiptext"],
                 attr["help"], m_curLayer, m_curWindowId, m_curLayoutId );
@@ -467,6 +500,8 @@
         CheckDefault( "width", "0" );
         CheckDefault( "lefttop", "lefttop" );
         CheckDefault( "rightbottom", "lefttop" );
+        CheckDefault( "xkeepratio", "false" );
+        CheckDefault( "ykeepratio", "false" );
         CheckDefault( "help", "" );
 
         const BuilderData::Text textData( uniqueId( attr["id"] ),
@@ -474,6 +509,8 @@
                 attr["visible"], attr["font"],
                 attr["text"], atoi( attr["width"] ),
                 attr["lefttop"], attr["rightbottom"],
+                convertBoolean( attr["xkeepratio"] ),
+                convertBoolean( attr["ykeepratio"] ),
                 convertColor( attr["color"] ),
                 attr["scrolling"], attr["alignment"],
                 attr["help"], m_curLayer, m_curWindowId, m_curLayoutId );
@@ -520,6 +557,8 @@
         CheckDefault( "height", "0" );
         CheckDefault( "lefttop", "lefttop" );
         CheckDefault( "rightbottom", "lefttop" );
+        CheckDefault( "xkeepratio", "false" );
+        CheckDefault( "ykeepratio", "false" );
         CheckDefault( "autoresize", "false" );
         CheckDefault( "help", "" );
 
@@ -527,6 +566,8 @@
                 atoi( attr["x"] ) + m_xOffset, atoi( attr["y"] ) + m_yOffset,
                 atoi( attr["width"] ), atoi( attr["height" ]),
                 attr["lefttop"], attr["rightbottom"],
+                convertBoolean( attr["xkeepratio"] ),
+                convertBoolean( attr["ykeepratio"] ),
                 attr["visible"], convertBoolean( attr["autoresize"] ),
                 attr["help"], m_curLayer, m_curWindowId, m_curLayoutId );
         m_curLayer++;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/src/scaled_bitmap.cpp vlc-0.8.6-svn20061008.debian/modules/gui/skins2/src/scaled_bitmap.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/src/scaled_bitmap.cpp	2006-09-18 06:28:22.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/src/scaled_bitmap.cpp	2006-09-21 11:50:22.000000000 -0400
@@ -2,7 +2,7 @@
  * scaled_bitmap.cpp
  *****************************************************************************
  * Copyright (C) 2003 the VideoLAN team
- * $Id: scaled_bitmap.cpp 14118 2006-02-01 18:06:48Z courmisch $
+ * $Id: scaled_bitmap.cpp 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Cyril Deguet     <asmax@via.ecp.fr>
  *          Olivier Teulire <ipkiss@via.ecp.fr>
@@ -45,10 +45,10 @@
         // Decision variables for Bresenham algorithm
         int incX1 = 2 * (srcWidth-1);
         int incX2 = incX1 - 2 * (width-1);
-        int dX = incX1 - (width-1);
 
         for( int y = 0; y < height; y++ )
         {
+            int dX = incX1 - (width-1);
             uint32_t yOffset = ((y * srcHeight) / height) * srcWidth;
             pSrcData = ((uint32_t*)rBitmap.getData()) + yOffset;
 
@@ -74,14 +74,18 @@
         // Decision variables for Bresenham algorithm
         int incX1 = 2 * (width-1);
         int incX2 = incX1 - 2 * (srcWidth-1);
-        int dX = incX1 - (srcWidth-1);
 
         for( int y = 0; y < height; y++ )
         {
+            int dX = incX1 - (srcWidth-1);
             uint32_t yOffset = ((y * srcHeight) / height) * srcWidth;
             pSrcData = ((uint32_t*)rBitmap.getData()) + yOffset;
 
-            for( int x = 0; x < width; x++ )
+            if (width == 1)
+            {
+                *(pDestData++) = *pSrcData;
+            }
+            else for( int x = 0; x < width; x++ )
             {
                 *(pDestData++) = *(pSrcData++);
 
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/src/skin_main.cpp vlc-0.8.6-svn20061008.debian/modules/gui/skins2/src/skin_main.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/src/skin_main.cpp	2006-09-18 06:28:22.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/src/skin_main.cpp	2006-10-08 12:40:55.000000000 -0400
@@ -2,7 +2,7 @@
  * skin_main.cpp
  *****************************************************************************
  * Copyright (C) 2003 the VideoLAN team
- * $Id: skin_main.cpp 16441 2006-08-30 21:36:35Z hartman $
+ * $Id: skin_main.cpp 16985 2006-10-08 12:28:17Z jpsaman $
  *
  * Authors: Cyril Deguet     <asmax@via.ecp.fr>
  *          Olivier Teulire <ipkiss@via.ecp.fr>
@@ -62,13 +62,14 @@
 //---------------------------------------------------------------------------
 // Prototypes for configuration callbacks
 //---------------------------------------------------------------------------
+#ifdef WIN32
 static int onSystrayChange( vlc_object_t *pObj, const char *pVariable,
                             vlc_value_t oldVal, vlc_value_t newVal,
                             void *pParam );
 static int onTaskBarChange( vlc_object_t *pObj, const char *pVariable,
                             vlc_value_t oldVal, vlc_value_t newVal,
                             void *pParam );
-
+#endif
 
 //---------------------------------------------------------------------------
 // Open: initialize interface
@@ -351,7 +352,7 @@
 //---------------------------------------------------------------------------
 // Callbacks
 //---------------------------------------------------------------------------
-
+#ifdef WIN32
 /// Callback for the systray configuration option
 static int onSystrayChange( vlc_object_t *pObj, const char *pVariable,
                             vlc_value_t oldVal, vlc_value_t newVal,
@@ -365,16 +366,20 @@
         return VLC_EGENERIC;
     }
 
-    AsyncQueue *pQueue = AsyncQueue::instance( pIntf );
-    if( newVal.b_bool )
+    // Check that we found the correct interface (same check as for the demux)
+    if( var_Type( pIntf, "skin-to-load" ) == VLC_VAR_STRING )
     {
-        CmdAddInTray *pCmd = new CmdAddInTray( pIntf );
-        pQueue->push( CmdGenericPtr( pCmd ) );
-    }
-    else
-    {
-        CmdRemoveFromTray *pCmd = new CmdRemoveFromTray( pIntf );
-        pQueue->push( CmdGenericPtr( pCmd ) );
+        AsyncQueue *pQueue = AsyncQueue::instance( pIntf );
+        if( newVal.b_bool )
+        {
+            CmdAddInTray *pCmd = new CmdAddInTray( pIntf );
+            pQueue->push( CmdGenericPtr( pCmd ) );
+        }
+        else
+        {
+            CmdRemoveFromTray *pCmd = new CmdRemoveFromTray( pIntf );
+            pQueue->push( CmdGenericPtr( pCmd ) );
+        }
     }
 
     vlc_object_release( pIntf );
@@ -395,22 +400,26 @@
         return VLC_EGENERIC;
     }
 
-    AsyncQueue *pQueue = AsyncQueue::instance( pIntf );
-    if( newVal.b_bool )
-    {
-        CmdAddInTaskBar *pCmd = new CmdAddInTaskBar( pIntf );
-        pQueue->push( CmdGenericPtr( pCmd ) );
-    }
-    else
+    // Check that we found the correct interface (same check as for the demux)
+    if( var_Type( pIntf, "skin-to-load" ) == VLC_VAR_STRING )
     {
-        CmdRemoveFromTaskBar *pCmd = new CmdRemoveFromTaskBar( pIntf );
-        pQueue->push( CmdGenericPtr( pCmd ) );
+        AsyncQueue *pQueue = AsyncQueue::instance( pIntf );
+        if( newVal.b_bool )
+        {
+            CmdAddInTaskBar *pCmd = new CmdAddInTaskBar( pIntf );
+            pQueue->push( CmdGenericPtr( pCmd ) );
+        }
+        else
+        {
+            CmdRemoveFromTaskBar *pCmd = new CmdRemoveFromTaskBar( pIntf );
+            pQueue->push( CmdGenericPtr( pCmd ) );
+        }
     }
 
     vlc_object_release( pIntf );
     return VLC_SUCCESS;
 }
-
+#endif
 
 //---------------------------------------------------------------------------
 // Module descriptor
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/src/top_window.cpp vlc-0.8.6-svn20061008.debian/modules/gui/skins2/src/top_window.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/src/top_window.cpp	2006-09-18 06:28:22.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/src/top_window.cpp	2006-09-22 11:14:30.000000000 -0400
@@ -2,7 +2,7 @@
  * top_window.cpp
  *****************************************************************************
  * Copyright (C) 2003 the VideoLAN team
- * $Id: top_window.cpp 16441 2006-08-30 21:36:35Z hartman $
+ * $Id: top_window.cpp 16773 2006-09-21 18:46:25Z hartman $
  *
  * Authors: Cyril Deguet     <asmax@via.ecp.fr>
  *          Olivier Teulire <ipkiss@via.ecp.fr>
@@ -439,9 +439,18 @@
     // Check that the control is the active one
     if( m_pLastHitControl && m_pLastHitControl == &rCtrl )
     {
-        // Set the tooltip text variable
-        VarManager *pVarManager = VarManager::instance( getIntf() );
-        pVarManager->getTooltipText().set( rCtrl.getTooltipText() );
+        if( rCtrl.getTooltipText().size() )
+        {
+            // Set the tooltip text variable
+            VarManager *pVarManager = VarManager::instance( getIntf() );
+            pVarManager->getTooltipText().set( rCtrl.getTooltipText() );
+            m_rWindowManager.showTooltip();
+        }
+        else
+        {
+            // Nothing to display, so hide the tooltip
+            m_rWindowManager.hideTooltip();
+        }
     }
 }
 
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/src/vlcproc.cpp vlc-0.8.6-svn20061008.debian/modules/gui/skins2/src/vlcproc.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/src/vlcproc.cpp	2006-09-18 06:28:22.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/src/vlcproc.cpp	2006-10-01 11:34:21.000000000 -0400
@@ -2,7 +2,7 @@
  * vlcproc.cpp
  *****************************************************************************
  * Copyright (C) 2003 the VideoLAN team
- * $Id: vlcproc.cpp 16441 2006-08-30 21:36:35Z hartman $
+ * $Id: vlcproc.cpp 16876 2006-09-28 15:46:15Z thresh $
  *
  * Authors: Cyril Deguet     <asmax@via.ecp.fr>
  *          Olivier Teulie <ipkiss@via.ecp.fr>
@@ -209,7 +209,7 @@
     // Reparent the vout window
     if( m_pVout )
     {
-        if( vout_Control( m_pVout, VOUT_REPARENT ) != VLC_SUCCESS )
+        if( vout_Control( m_pVout, VOUT_REPARENT, 0 ) != VLC_SUCCESS )
             vout_Control( m_pVout, VOUT_CLOSE );
     }
 }
@@ -225,7 +225,7 @@
 {
     if( m_pVout )
     {
-        if( vout_Control( m_pVout, VOUT_REPARENT ) != VLC_SUCCESS )
+        if( vout_Control( m_pVout, VOUT_REPARENT, 0 ) != VLC_SUCCESS )
             vout_Control( m_pVout, VOUT_CLOSE );
         m_pVout = NULL;
     }
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/utils/position.cpp vlc-0.8.6-svn20061008.debian/modules/gui/skins2/utils/position.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/utils/position.cpp	2006-09-18 06:28:21.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/utils/position.cpp	2006-09-22 11:14:30.000000000 -0400
@@ -2,7 +2,7 @@
  * position.cpp
  *****************************************************************************
  * Copyright (C) 2003 the VideoLAN team
- * $Id: position.cpp 14118 2006-02-01 18:06:48Z courmisch $
+ * $Id: position.cpp 16778 2006-09-21 23:56:47Z hartman $
  *
  * Authors: Cyril Deguet     <asmax@via.ecp.fr>
  *          Olivier Teulire <ipkiss@via.ecp.fr>
@@ -35,83 +35,186 @@
 
 
 Position::Position( int left, int top, int right, int bottom, const Box &rBox,
-                    Ref_t refLeftTop, Ref_t refRightBottom ):
+                    Ref_t refLeftTop, Ref_t refRightBottom, bool xKeepRatio,
+                    bool yKeepRatio ):
     m_left( left ), m_top( top ), m_right( right ), m_bottom( bottom ),
     m_rBox( rBox ), m_refLeftTop( refLeftTop ),
-    m_refRighBottom( refRightBottom )
+    m_refRighBottom( refRightBottom ), m_xKeepRatio( xKeepRatio ),
+    m_yKeepRatio( yKeepRatio )
 {
+    // Here is how the resizing algorithm works:
+    //
+    //  - if we "keep the ratio" (xkeepratio="true" in the XML), the relative
+    //    position of the control in the layout (i.e. the given rBox) is
+    //    saved, and will be kept constant. The size of the control will not
+    //    be changed, only its position may vary. To do that, we consider the
+    //    part of the layout to the left of the control (for an horizontal
+    //    resizing) and the part of the layout to the right of the control,
+    //    and we make sure that the ratio between their widths is constant.
+    //
+    //  - if we don't keep the ratio, the resizing algorithm is completely
+    //    different. We consider that the top left hand corner of the control
+    //    ("lefttop" attribute in the XML) is linked to one of the 4 corners
+    //    of the layouts ("lefttop", "leftbottom", "righttop" and
+    //    "rightbottom" values for the attribute). Same thing for the bottom
+    //    right hand corner ("rightbottom" attribute). When resizing occurs,
+    //    the linked corners will move together, and this will drive the
+    //    moving/resizing of the control.
+
+    // Initialize the horizontal ratio
+    if( m_xKeepRatio )
+    {
+        // First compute the width of the box minus the width of the control
+        int freeSpace = m_rBox.getWidth() - (m_right - m_left);
+        // Instead of computing left/right, we compute left/(left+right),
+        // which is more convenient in my opinion.
+        if( freeSpace != 0 )
+        {
+            m_xRatio = (double)m_left / (double)freeSpace;
+        }
+        else
+        {
+            // If the control has the same size as the box, we can't compute
+            // the ratio in the same way (otherwise we would divide by zero).
+            // So we consider that the intent was to keep the control centered
+            // (if you are unhappy with this, go and fix your skin :))
+            m_xRatio = 0.5;
+        }
+    }
+
+    // Initial the vertical ratio
+    if( m_yKeepRatio )
+    {
+        // First compute the width of the box minus the width of the control
+        int freeSpace = m_rBox.getHeight() - (m_bottom - m_top);
+        // Instead of computing left/right, we compute left/(left+right),
+        // which is more convenient in my opinion.
+        if( freeSpace != 0 )
+        {
+            m_yRatio = (double)m_top / (double)freeSpace;
+        }
+        else
+        {
+            // If the control has the same size as the box, we can't compute
+            // the ratio in the same way (otherwise we would divide by zero).
+            // So we consider that the intent was to keep the control centered
+            // (if you are unhappy with this, go and fix your skin :))
+            m_yRatio = 0.5;
+        }
+    }
+
 }
 
 
 int Position::getLeft() const
 {
-    switch( m_refLeftTop )
+    if( m_xKeepRatio )
     {
-        case kLeftTop:
-        case kLeftBottom:
-            return m_left;
-            break;
-        case kRightTop:
-        case kRightBottom:
-            return m_rBox.getWidth() + m_left - 1;
-            break;
+        // Ratio mode
+        // First compute the width of the box minus the width of the control
+        int freeSpace = m_rBox.getWidth() - (m_right - m_left);
+        return (int)(m_xRatio * freeSpace);
+    }
+    else
+    {
+        switch( m_refLeftTop )
+        {
+            case kLeftTop:
+            case kLeftBottom:
+                return m_left;
+                break;
+            case kRightTop:
+            case kRightBottom:
+                return m_rBox.getWidth() + m_left - 1;
+                break;
+        }
+        // Avoid a warning
+        return 0;
     }
-    // Avoid a warning
-    return 0;
 }
 
 
 int Position::getTop() const
 {
-    switch( m_refLeftTop )
+    if( m_yKeepRatio )
+    {
+        // Ratio mode
+        // First compute the height of the box minus the height of the control
+        int freeSpace = m_rBox.getHeight() - (m_bottom - m_top);
+        return (int)(m_yRatio * freeSpace);
+    }
+    else
     {
-        case kLeftTop:
-        case kRightTop:
-            return m_top;
-            break;
-        case kRightBottom:
-        case kLeftBottom:
-            return m_rBox.getHeight() + m_top - 1;
-            break;
+        switch( m_refLeftTop )
+        {
+            case kLeftTop:
+            case kRightTop:
+                return m_top;
+                break;
+            case kRightBottom:
+            case kLeftBottom:
+                return m_rBox.getHeight() + m_top - 1;
+                break;
+        }
+        // Avoid a warning
+        return 0;
     }
-    // Avoid a warning
-    return 0;
 }
 
 
 int Position::getRight() const
 {
-    switch( m_refRighBottom )
+    if( m_xKeepRatio )
     {
-        case kLeftTop:
-        case kLeftBottom:
-            return m_right;
-            break;
-        case kRightTop:
-        case kRightBottom:
-            return m_rBox.getWidth() + m_right - 1;
-            break;
+        // Ratio mode
+        // The width of the control being constant, we can use the result of
+        // getLeft() (this will avoid rounding issues).
+        return getLeft() + m_right - m_left;
+    }
+    else
+    {
+        switch( m_refRighBottom )
+        {
+            case kLeftTop:
+            case kLeftBottom:
+                return m_right;
+                break;
+            case kRightTop:
+            case kRightBottom:
+                return m_rBox.getWidth() + m_right - 1;
+                break;
+        }
+        // Avoid a warning
+        return 0;
     }
-    // Avoid a warning
-    return 0;
 }
 
 
 int Position::getBottom() const
 {
-    switch( m_refRighBottom )
+    if( m_yKeepRatio )
+    {
+        // Ratio mode
+        // The height of the control being constant, we can use the result of
+        // getTop() (this will avoid rounding issues).
+        return getTop() + m_bottom - m_top;
+    }
+    else
     {
-        case kLeftTop:
-        case kRightTop:
-            return m_bottom;
-            break;
-        case kLeftBottom:
-        case kRightBottom:
-            return m_rBox.getHeight() + m_bottom - 1;
-            break;
+        switch( m_refRighBottom )
+        {
+            case kLeftTop:
+            case kRightTop:
+                return m_bottom;
+                break;
+            case kLeftBottom:
+            case kRightBottom:
+                return m_rBox.getHeight() + m_bottom - 1;
+                break;
+        }
+        // Avoid a warning
+        return 0;
     }
-    // Avoid a warning
-    return 0;
 }
 
 
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/utils/position.hpp vlc-0.8.6-svn20061008.debian/modules/gui/skins2/utils/position.hpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/utils/position.hpp	2006-09-18 06:28:21.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/utils/position.hpp	2006-09-22 11:14:30.000000000 -0400
@@ -2,7 +2,7 @@
  * position.hpp
  *****************************************************************************
  * Copyright (C) 2003 the VideoLAN team
- * $Id: position.hpp 16457 2006-08-31 20:51:12Z hartman $
+ * $Id: position.hpp 16778 2006-09-21 23:56:47Z hartman $
  *
  * Authors: Cyril Deguet     <asmax@via.ecp.fr>
  *          Olivier Teulire <ipkiss@via.ecp.fr>
@@ -82,8 +82,8 @@
 
         /// Create a new position relative to the given box
         Position( int left, int top, int right, int bottom, const Box &rBox,
-                  Ref_t refLeftTop = kLeftTop,
-                  Ref_t refRightBottom = kLeftTop );
+                  Ref_t refLeftTop, Ref_t refRightBottom,
+                  bool xKeepRatio, bool yKeepRatio );
 
         ~Position() {}
 
@@ -108,6 +108,13 @@
         const Box &m_rBox;
         Ref_t m_refLeftTop;
         Ref_t m_refRighBottom;
+        /// "Keep ratio" mode
+        bool m_xKeepRatio;
+        bool m_yKeepRatio;
+        /// Initial width ratio (usually between 0 and 1)
+        double m_xRatio;
+        /// Initial height ratio (usually between 0 and 1)
+        double m_yRatio;
 };
 
 
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/skins2/win32/win32_dragdrop.cpp vlc-0.8.6-svn20061008.debian/modules/gui/skins2/win32/win32_dragdrop.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/skins2/win32/win32_dragdrop.cpp	2006-09-18 06:28:22.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/skins2/win32/win32_dragdrop.cpp	2006-09-22 11:14:30.000000000 -0400
@@ -2,7 +2,7 @@
  * win32_dragdrop.cpp
  *****************************************************************************
  * Copyright (C) 2003 the VideoLAN team
- * $Id: win32_dragdrop.cpp 14118 2006-02-01 18:06:48Z courmisch $
+ * $Id: win32_dragdrop.cpp 16773 2006-09-21 18:46:25Z hartman $
  *
  * Authors: Cyril Deguet     <asmax@via.ecp.fr>
  *          Olivier Teulire <ipkiss@via.ecp.fr>
@@ -158,7 +158,7 @@
         DragQueryFile( HDrop, i, psz_fileName, nameLength );
 
         // Add the file
-        CmdAddItem cmd( getIntf(), psz_fileName, m_playOnDrop );
+        CmdAddItem cmd( getIntf(), sFromLocale( psz_fileName ), m_playOnDrop );
         cmd.execute();
 
         delete[] psz_fileName;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/wince/Makefile.in vlc-0.8.6-svn20061008.debian/modules/gui/wince/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/gui/wince/Makefile.in	2006-09-18 06:30:52.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/wince/Makefile.in	2006-10-08 12:42:56.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/wxwidgets/dialogs/bookmarks.cpp vlc-0.8.6-svn20061008.debian/modules/gui/wxwidgets/dialogs/bookmarks.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/wxwidgets/dialogs/bookmarks.cpp	2006-09-18 06:28:18.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/wxwidgets/dialogs/bookmarks.cpp	2006-09-24 13:09:01.000000000 -0400
@@ -2,7 +2,7 @@
  * bookmarks.cpp : wxWindows plugin for vlc
  *****************************************************************************
  * Copyright (C) 2000-2004 the VideoLAN team
- * $Id: bookmarks.cpp 15370 2006-04-26 23:20:48Z xtophe $
+ * $Id: bookmarks.cpp 16798 2006-09-22 23:56:12Z xtophe $
  *
  * Authors: Gildas Bazin <gbazin@videolan.org>
  *
@@ -166,13 +166,13 @@
     wxButton *button_extract =
         new wxButton( panel, ButtonExtract_Event, wxU(_("Extract")) );
 
-#define ADD_TEXT "Adds a bookmark at the current position in the stream"
-#define REMOVE_TEXT "Removes the selected bookmarks"
-#define CLEAR_TEXT "Removes all the bookmarks for that stream"
-#define EDIT_TEXT "Edit the properties of a bookmark"
-#define EXTRACT_TEXT "If you select two or more bookmarks, this will " \
+#define ADD_TEXT N_("Adds a bookmark at the current position in the stream")
+#define REMOVE_TEXT N_("Removes the selected bookmarks")
+#define CLEAR_TEXT N_("Removes all the bookmarks for that stream")
+#define EDIT_TEXT N_("Edit the properties of a bookmark")
+#define EXTRACT_TEXT N_("If you select two or more bookmarks, this will " \
                "launch the streaming/transcoding wizard to allow you to " \
-              "stream or save the part of the stream between these bookmarks"
+              "stream or save the part of the stream between these bookmarks")
     button_add->SetToolTip(  wxU(_( ADD_TEXT ) ) );
     button_del->SetToolTip(  wxU(_( REMOVE_TEXT ) ) );
     button_clear->SetToolTip(  wxU(_( CLEAR_TEXT ) ) );
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/wxwidgets/dialogs/fileinfo.cpp vlc-0.8.6-svn20061008.debian/modules/gui/wxwidgets/dialogs/fileinfo.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/wxwidgets/dialogs/fileinfo.cpp	2006-09-18 06:28:18.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/wxwidgets/dialogs/fileinfo.cpp	2006-09-24 13:09:01.000000000 -0400
@@ -2,7 +2,7 @@
  * fileinfo.cpp : wxWindows plugin for vlc
  *****************************************************************************
  * Copyright (C) 2000-2004 the VideoLAN team
- * $Id: fileinfo.cpp 15044 2006-04-02 07:58:36Z zorglub $
+ * $Id: fileinfo.cpp 16798 2006-09-22 23:56:12Z xtophe $
  *
  * Authors: Sigmund Augdal Helberg <dnumgis@videolan.org>
  *
@@ -90,7 +90,7 @@
     panel_sizer->Add( notebook, 1, wxEXPAND | wxALL, 5 );
 #endif
 
-    panel_sizer->Add( new wxButton( panel, wxID_CLOSE ) ,
+    panel_sizer->Add( new wxButton( panel, wxID_CLOSE, wxU(_("&Close")) ) ,
                       0, wxALL|wxALIGN_RIGHT, 5 );
 
     panel_sizer->Layout();
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/wxwidgets/dialogs/playlist.cpp vlc-0.8.6-svn20061008.debian/modules/gui/wxwidgets/dialogs/playlist.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/wxwidgets/dialogs/playlist.cpp	2006-09-18 06:28:18.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/wxwidgets/dialogs/playlist.cpp	2006-10-08 12:40:54.000000000 -0400
@@ -2,7 +2,7 @@
  * playlist.cpp : wxWindows plugin for vlc
  *****************************************************************************
  * Copyright (C) 2000-2005 the VideoLAN team
- * $Id: playlist.cpp 16442 2006-08-30 22:15:52Z hartman $
+ * $Id: playlist.cpp 16994 2006-10-08 14:40:02Z jpsaman $
  *
  * Authors: Olivier Teulire <ipkiss@via.ecp.fr>
  *          Clment Stenac <zorglub@videolan.org>
@@ -1307,7 +1307,7 @@
     /* Put the items in the playlist node */
     for( size_t i = 0; i < filenames.GetCount(); i++ )
     {
-        const char *psz_utf8 = wxDnDFromLocale( filenames[i] );
+        char *psz_utf8 = wxDnDFromLocale( filenames[i] );
         playlist_item_t *p_item =
             playlist_ItemNew( p->p_playlist, psz_utf8, psz_utf8 );
         playlist_NodeAddItem( p->p_playlist, p_item, p->i_current_view,
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/wxwidgets/dialogs/preferences.cpp vlc-0.8.6-svn20061008.debian/modules/gui/wxwidgets/dialogs/preferences.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/wxwidgets/dialogs/preferences.cpp	2006-09-18 06:28:18.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/wxwidgets/dialogs/preferences.cpp	2006-09-24 13:09:01.000000000 -0400
@@ -2,7 +2,7 @@
  * preferences.cpp : wxWindows plugin for vlc
  *****************************************************************************
  * Copyright (C) 2000-2004 the VideoLAN team
- * $Id: preferences.cpp 15370 2006-04-26 23:20:48Z xtophe $
+ * $Id: preferences.cpp 16798 2006-09-22 23:56:12Z xtophe $
  *
  * Authors: Gildas Bazin <gbazin@netcourrier.com>
  *
@@ -410,7 +410,7 @@
                         i_image = 6; break;
                 }
                 current_item = AppendItem( root_item,
-                                           wxU( config_data->psz_name ),
+                                           wxU( _(config_data->psz_name) ),
                                            i_image, -1, config_data );
 
                 break;
@@ -483,7 +483,7 @@
                 #else
                 i_image = -1;
                 #endif
-                AppendItem( current_item, wxU( config_data->psz_name ),
+                AppendItem( current_item, wxU( _(config_data->psz_name) ),
                             i_image, -1, config_data );
                 break;
             }
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/wxwidgets/dialogs/preferences_widgets.cpp vlc-0.8.6-svn20061008.debian/modules/gui/wxwidgets/dialogs/preferences_widgets.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/wxwidgets/dialogs/preferences_widgets.cpp	2006-09-18 06:28:18.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/wxwidgets/dialogs/preferences_widgets.cpp	2006-09-24 13:09:01.000000000 -0400
@@ -2,7 +2,7 @@
  * preferences_widgets.cpp : wxWindows plugin for vlc
  *****************************************************************************
  * Copyright (C) 2000-2004 the VideoLAN team
- * $Id: preferences_widgets.cpp 16441 2006-08-30 21:36:35Z hartman $
+ * $Id: preferences_widgets.cpp 16798 2006-09-22 23:56:12Z xtophe $
  *
  * Authors: Gildas Bazin <gbazin@videolan.org>
  *          Sigmund Augdal Helberg <dnumgis@videolan.org>
@@ -709,7 +709,7 @@
 #if defined( __WXMSW__ )
                              wxOPEN
 #else
-                             wxOPEN | wxSAVE
+                             wxOPEN
 #endif
                            );
         if( dialog.ShowModal() == wxID_OK )
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/wxwidgets/Makefile.in vlc-0.8.6-svn20061008.debian/modules/gui/wxwidgets/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/gui/wxwidgets/Makefile.in	2006-09-18 06:30:53.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/wxwidgets/Makefile.in	2006-10-08 12:42:57.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/wxwidgets/menus.cpp vlc-0.8.6-svn20061008.debian/modules/gui/wxwidgets/menus.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/wxwidgets/menus.cpp	2006-09-18 06:28:21.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/wxwidgets/menus.cpp	2006-09-22 11:14:30.000000000 -0400
@@ -2,7 +2,7 @@
  * menus.cpp : wxWidgets plugin for vlc
  *****************************************************************************
  * Copyright (C) 2000-2004 the VideoLAN team
- * $Id: menus.cpp 16457 2006-08-31 20:51:12Z hartman $
+ * $Id: menus.cpp 16774 2006-09-21 19:29:10Z hartman $
  *
  * Authors: Gildas Bazin <gbazin@videolan.org>
  *
@@ -174,6 +174,7 @@
                                                  FIND_PARENT );
     if( p_dec_obj != NULL )
     {
+        vlc_object_t *p_object = p_dec_obj;
         PUSH_VAR( "ffmpeg-pp-q" );
         vlc_object_release( p_dec_obj );
     }
diff -uNr vlc-0.8.6-svn20060918.debian/modules/gui/wxwidgets/video.cpp vlc-0.8.6-svn20061008.debian/modules/gui/wxwidgets/video.cpp
--- vlc-0.8.6-svn20060918.debian/modules/gui/wxwidgets/video.cpp	2006-09-18 06:28:21.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/gui/wxwidgets/video.cpp	2006-10-01 11:34:21.000000000 -0400
@@ -2,7 +2,7 @@
  * video.cpp : wxWidgets plugin for vlc
  *****************************************************************************
  * Copyright (C) 2000-2004, 2003 the VideoLAN team
- * $Id: video.cpp 16442 2006-08-30 22:15:52Z hartman $
+ * $Id: video.cpp 16876 2006-09-28 15:46:15Z thresh $
  *
  * Authors: Gildas Bazin <gbazin@videolan.org>
  *
@@ -154,11 +154,11 @@
         if( !p_intf->psz_switch_intf )
         {
             if( vout_Control( p_vout, VOUT_CLOSE ) != VLC_SUCCESS )
-                vout_Control( p_vout, VOUT_REPARENT );
+                vout_Control( p_vout, VOUT_REPARENT, 0 );
         }
         else
         {
-            if( vout_Control( p_vout, VOUT_REPARENT ) != VLC_SUCCESS )
+            if( vout_Control( p_vout, VOUT_REPARENT, 0 ) != VLC_SUCCESS )
                 vout_Control( p_vout, VOUT_CLOSE );
         }
     }
diff -uNr vlc-0.8.6-svn20060918.debian/modules/Makefile.in vlc-0.8.6-svn20061008.debian/modules/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/Makefile.in	2006-09-18 06:30:32.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/Makefile.in	2006-10-08 12:42:33.000000000 -0400
@@ -115,12 +115,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -128,6 +129,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -152,9 +155,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -231,7 +231,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -246,7 +248,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/misc/dummy/Makefile.in vlc-0.8.6-svn20061008.debian/modules/misc/dummy/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/misc/dummy/Makefile.in	2006-09-18 06:30:55.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/misc/dummy/Makefile.in	2006-10-08 12:42:59.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/misc/freetype.c vlc-0.8.6-svn20061008.debian/modules/misc/freetype.c
--- vlc-0.8.6-svn20060918.debian/modules/misc/freetype.c	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/misc/freetype.c	2006-10-08 12:40:56.000000000 -0400
@@ -2,7 +2,7 @@
  * freetype.c : Put text on the video, using freetype2
  *****************************************************************************
  * Copyright (C) 2002 - 2005 the VideoLAN team
- * $Id: freetype.c 16544 2006-09-07 23:05:11Z hartman $
+ * $Id: freetype.c 16987 2006-10-08 12:54:12Z jpsaman $
  *
  * Authors: Sigmund Augdal Helberg <dnumgis@videolan.org>
  *          Gildas Bazin <gbazin@videolan.org>
@@ -761,7 +761,7 @@
         i_out_bytes_left = i_out_bytes;
         p_in_buffer = psz_string;
         p_out_buffer = (char *)psz_unicode;
-        i_ret = vlc_iconv( iconv_handle, &p_in_buffer, &i_in_bytes,
+        i_ret = vlc_iconv( iconv_handle, (const char**)&p_in_buffer, &i_in_bytes,
                            &p_out_buffer, &i_out_bytes_left );
 
         vlc_iconv_close( iconv_handle );
@@ -780,7 +780,7 @@
     {
         uint32_t *p_fribidi_string;
         int start_pos, pos = 0;
-        
+
         p_fribidi_string = malloc( (i_string_length + 1) * sizeof(uint32_t) );
 
         /* Do bidi conversion line-by-line */
diff -uNr vlc-0.8.6-svn20060918.debian/modules/misc/gnutls.c vlc-0.8.6-svn20061008.debian/modules/misc/gnutls.c
--- vlc-0.8.6-svn20060918.debian/modules/misc/gnutls.c	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/misc/gnutls.c	2006-09-22 11:14:31.000000000 -0400
@@ -2,7 +2,7 @@
  * gnutls.c
  *****************************************************************************
  * Copyright (C) 2004-2006 Rmi Denis-Courmont
- * $Id: gnutls.c 16434 2006-08-30 15:18:13Z hartman $
+ * $Id: gnutls.c 16775 2006-09-21 20:35:23Z hartman $
  *
  * Authors: Rmi Denis-Courmont <rem # videolan.org>
  *
@@ -21,17 +21,12 @@
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
  *****************************************************************************/
 
-/*
- * TODO:
- * - fix FIXMEs
- */
-
-
 /*****************************************************************************
  * Preamble
  *****************************************************************************/
 #include <stdlib.h>
 #include <errno.h>
+#include <time.h>
 #include <vlc/vlc.h>
 
 #include <sys/types.h>
@@ -305,56 +300,128 @@
     return 0;
 }
 
+
+typedef struct
+{
+    int flag;
+    const char *msg;
+} error_msg_t;
+
+static const error_msg_t cert_errors[] =
+{
+    { GNUTLS_CERT_INVALID,
+        "Certificate could not be verified" },
+    { GNUTLS_CERT_REVOKED,
+        "Certificate was revoked" },
+    { GNUTLS_CERT_SIGNER_NOT_FOUND,
+        "Certificate's signer was not found" },
+    { GNUTLS_CERT_SIGNER_NOT_CA,
+        "Certificate's signer is not a CA" },
+    { GNUTLS_CERT_INSECURE_ALGORITHM,
+        "Insecure certificate signature algorithm" },
+    { 0, NULL }
+};
+
+
 static int
-gnutls_HandshakeAndValidate( tls_session_t *p_session )
+gnutls_HandshakeAndValidate( tls_session_t *session )
 {
-    int val;
+    int val = gnutls_ContinueHandshake( session );
+    if( val )
+        return val;
 
-    val = gnutls_ContinueHandshake( p_session );
-    if( val == 0 )
-    {
-        unsigned status;
-        tls_session_sys_t *p_sys;
+    tls_session_sys_t *p_sys = (tls_session_sys_t *)(session->p_sys);
 
-        p_sys = (tls_session_sys_t *)(p_session->p_sys);
-        /* certificates chain verification */
-        val = gnutls_certificate_verify_peers2( p_sys->session, &status );
+    /* certificates chain verification */
+    unsigned status;
+    val = gnutls_certificate_verify_peers2( p_sys->session, &status );
 
-        if( val )
+    if( val )
+    {
+        msg_Err( session, "Certificate verification failed: %s",
+                 gnutls_strerror( val ) );
+        goto error;
+    }
+
+    if( status )
+    {
+        const error_msg_t *e;
+        msg_Err( session, "TLS session: access denied" );
+        for( e = cert_errors; e->flag; e++ )
         {
-            msg_Err( p_session, "TLS certificate verification failed: %s",
-                     gnutls_strerror( val ) );
-            p_session->pf_close( p_session );
-            return -1;
+            if( status & e->flag )
+            {
+                msg_Err( session, e->msg );
+                status &= ~e->flag;
+            }
         }
 
         if( status )
-        {
-            msg_Warn( p_session, "TLS session: access denied" );
-            if( status & GNUTLS_CERT_INVALID )
-                msg_Dbg( p_session, "certificate could not be verified" );
-            if( status & GNUTLS_CERT_REVOKED )
-                msg_Dbg( p_session, "certificate was revoked" );
-            if( status & GNUTLS_CERT_SIGNER_NOT_FOUND )
-                msg_Dbg( p_session, "certificate's signer was not found" );
-            if( status & GNUTLS_CERT_SIGNER_NOT_CA )
-                msg_Dbg( p_session, "certificate's signer is not a CA" );
-            p_session->pf_close( p_session );
-            return -1;
-        }
+            msg_Err( session,
+                     "unknown certificate error (you found a bug in VLC)" );
+
+        goto error;
+    }
+
+    /* certificate (host)name verification */
+    const gnutls_datum *data = gnutls_certificate_get_peers( p_sys->session,
+                                                             &(size_t){ 0 } );
+    if( data == NULL )
+    {
+        msg_Err( session, "Peer certificate not available" );
+        goto error;
+    }
+
+    gnutls_x509_crt cert;
+    val = gnutls_x509_crt_init( &cert );
+    if( val )
+    {
+        msg_Err( session, "x509 fatal error: %s", gnutls_strerror( val ) );
+        goto error;
+    }
 
-        msg_Dbg( p_session, "TLS certificate verified" );
-        if( ( p_sys->psz_hostname != NULL )
-         && gnutls_VerifyHostname( (vlc_object_t *)p_session, p_sys->session,
-                                   p_sys->psz_hostname ) )
+    val = gnutls_x509_crt_import( cert, data, GNUTLS_X509_FMT_DER );
+    if( val )
+    {
+        msg_Err( session, "Certificate import error: %s",
+                 gnutls_strerror( val ) );
+        gnutls_x509_crt_deinit( cert );
+        goto crt_error;
+    }
+
+    if( p_sys->psz_hostname != NULL )
+    {
+        if ( !gnutls_x509_crt_check_hostname( cert, p_sys->psz_hostname ) )
         {
-            p_session->pf_close( p_session );
-            return -1;
+            msg_Err( session, "Certificate does not match \"%s\"",
+                     p_sys->psz_hostname );
+            goto crt_error;
         }
-        return 0;
+    }
+    else
+        msg_Warn( session, "Certificate and hostname were not verified" );
+
+    if( gnutls_x509_crt_get_expiration_time( cert ) < time( NULL ) )
+    {
+        msg_Err( session, "Certificate expired" );
+        goto crt_error;
     }
 
-    return val;
+    if( gnutls_x509_crt_get_activation_time( cert ) > time ( NULL ) )
+    {
+        msg_Err( session, "Certificate not yet valid" );
+        goto crt_error;
+    }
+
+    gnutls_x509_crt_deinit( cert );
+    msg_Dbg( session, "TLS/x509 certificate verified" );
+    return 0;
+
+crt_error:
+    gnutls_x509_crt_deinit( cert );
+error:
+    session->pf_close( session );
+    return -1;
 }
 
 /**
@@ -1009,7 +1076,6 @@
     /* No certificate validation by default */
     p_sys->pf_handshake2 = gnutls_ContinueHandshake;
 
-    /* FIXME: check for errors */
     vlc_mutex_init( p_server, &p_sys->cache_lock );
 
     /* Sets server's credentials */
@@ -1069,10 +1135,16 @@
 }
 
 
+#ifdef LIBVLC_USE_PTHREAD
+GCRY_THREAD_OPTION_PTHREAD_IMPL;
+# define gcry_threads_vlc gcry_threads_pthread
+#else
 /**
  * gcrypt thread option VLC implementation
  */
-vlc_object_t *__p_gcry_data;
+
+# define NEED_THREAD_CONTEXT 1
+static vlc_object_t *__p_gcry_data;
 
 static int gcry_vlc_mutex_init( void **p_sys )
 {
@@ -1119,6 +1191,7 @@
     gcry_vlc_mutex_lock,
     gcry_vlc_mutex_unlock
 };
+#endif
 
 
 /*****************************************************************************
@@ -1141,9 +1214,9 @@
 
     if( count.i_int == 0)
     {
-        const char *psz_version;
-
+#ifdef NEED_THREAD_CONTEXT
         __p_gcry_data = VLC_OBJECT( p_this->p_vlc );
+#endif
 
         gcry_control (GCRYCTL_SET_THREAD_CBS, &gcry_threads_vlc);
         if( gnutls_global_init( ) )
@@ -1152,11 +1225,8 @@
             vlc_mutex_unlock( lock.p_address );
             return VLC_EGENERIC;
         }
-        /*
-         * FIXME: in fact, we currently depends on 1.0.17, but it breaks on
-         * Debian which as a patched 1.0.16 (which we can use).
-         */
-        psz_version = gnutls_check_version( "1.0.16" );
+
+        const char *psz_version = gnutls_check_version( "1.2.9" );
         if( psz_version == NULL )
         {
             gnutls_global_deinit( );
diff -uNr vlc-0.8.6-svn20060918.debian/modules/misc/logger.c vlc-0.8.6-svn20061008.debian/modules/misc/logger.c
--- vlc-0.8.6-svn20060918.debian/modules/misc/logger.c	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/misc/logger.c	2006-10-04 13:12:43.000000000 -0400
@@ -2,7 +2,7 @@
  * logger.c : file logging plugin for vlc
  *****************************************************************************
  * Copyright (C) 2002 the VideoLAN team
- * $Id: logger.c 15045 2006-04-02 09:44:19Z courmisch $
+ * $Id: logger.c 16939 2006-10-04 17:12:43Z sam $
  *
  * Authors: Samuel Hocevar <sam@zoy.org>
  *
@@ -243,7 +243,7 @@
 
         /* Open the log file and remove any buffering for the stream */
         msg_Dbg( p_intf, "opening logfile `%s'", psz_file );
-        p_intf->p_sys->p_file = utf8_fopen( psz_file, "wt" );
+        p_intf->p_sys->p_file = utf8_fopen( psz_file, "at" );
         if( p_intf->p_sys->p_file == NULL )
         {
             msg_Err( p_intf, "error opening logfile `%s'", psz_file );
diff -uNr vlc-0.8.6-svn20060918.debian/modules/misc/Makefile.in vlc-0.8.6-svn20061008.debian/modules/misc/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/misc/Makefile.in	2006-09-18 06:30:55.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/misc/Makefile.in	2006-10-08 12:42:59.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/misc/memcpy/Makefile.in vlc-0.8.6-svn20061008.debian/modules/misc/memcpy/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/misc/memcpy/Makefile.in	2006-09-18 06:30:55.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/misc/memcpy/Makefile.in	2006-10-08 12:42:59.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/misc/network/Makefile.in vlc-0.8.6-svn20061008.debian/modules/misc/network/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/misc/network/Makefile.in	2006-09-18 06:30:56.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/misc/network/Makefile.in	2006-10-08 12:43:00.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/misc/playlist/Makefile.in vlc-0.8.6-svn20061008.debian/modules/misc/playlist/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/misc/playlist/Makefile.in	2006-09-18 06:30:56.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/misc/playlist/Makefile.in	2006-10-08 12:43:00.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/misc/playlist/xspf.c vlc-0.8.6-svn20061008.debian/modules/misc/playlist/xspf.c
--- vlc-0.8.6-svn20060918.debian/modules/misc/playlist/xspf.c	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/misc/playlist/xspf.c	2006-09-22 11:14:31.000000000 -0400
@@ -23,8 +23,10 @@
 #include <stdio.h>
 #include <vlc/vlc.h>
 #include <vlc/intf.h>
+
 #include "vlc_meta.h"
 #include "vlc_strings.h"
+#include "charset.h"
 #include "xspf.h"
 #include "charset.h"
 
diff -uNr vlc-0.8.6-svn20060918.debian/modules/misc/rtsp.c vlc-0.8.6-svn20061008.debian/modules/misc/rtsp.c
--- vlc-0.8.6-svn20060918.debian/modules/misc/rtsp.c	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/misc/rtsp.c	2006-10-08 12:40:56.000000000 -0400
@@ -2,7 +2,7 @@
  * rtsp.c: rtsp VoD server module
  *****************************************************************************
  * Copyright (C) 2003-2006 the VideoLAN team
- * $Id: rtsp.c 16442 2006-08-30 22:15:52Z hartman $
+ * $Id: rtsp.c 16987 2006-10-08 12:54:12Z jpsaman $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *          Gildas Bazin <gbazin@videolan.org>
@@ -771,7 +771,7 @@
 
         case HTTPD_MSG_PLAY:
         {
-            char *psz_output, *psz_position, ip[NI_MAXNUMERICHOST];
+            char *psz_output, ip[NI_MAXNUMERICHOST];
             int i, i_port_audio = 0, i_port_video = 0;
 
             /* for now only multicast so easy */
@@ -1193,9 +1193,9 @@
         sizeof( "i=*\r\n" ) + strlen( p_media->psz_session_description ) +
         sizeof( "u=*\r\n" ) + strlen( p_media->psz_session_url ) +
         sizeof( "e=*\r\n" ) + strlen( p_media->psz_session_email ) +
+        sizeof( "c=IN IP4 0.0.0.0\r\n" ) + 20 + 10 +
         sizeof( "t=0 0\r\n" ) + /* FIXME */
         sizeof( "a=tool:"PACKAGE_STRING"\r\n" ) +
-        sizeof( "c=IN IP4 0.0.0.0\r\n" ) + 20 + 10 +
         sizeof( "a=range:npt=0-1000000000.000\r\n" );
 
     psz_control = (ipv == '6') ? p_media->psz_rtsp_control_v6
@@ -1231,11 +1231,10 @@
     if( *p_media->psz_session_email )
         p += sprintf( p, "e=%s\r\n", p_media->psz_session_email );
 
+    p += sprintf( p, "c=IN IP%c %s\r\n", ipv, ipv == '6' ? "::" : "0.0.0.0" );
     p += sprintf( p, "t=0 0\r\n" ); /* FIXME */
     p += sprintf( p, "a=tool:"PACKAGE_STRING"\r\n" );
 
-    p += sprintf( p, "c=IN IP%c %s\r\n", ipv, ipv == '6' ? "::" : "0.0.0.0" );
-
     if( p_media->i_length > 0 )
     {
         lldiv_t d = lldiv( p_media->i_length / 1000, 1000 );
diff -uNr vlc-0.8.6-svn20060918.debian/modules/misc/testsuite/Makefile.in vlc-0.8.6-svn20061008.debian/modules/misc/testsuite/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/misc/testsuite/Makefile.in	2006-09-18 06:30:56.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/misc/testsuite/Makefile.in	2006-10-08 12:43:00.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/misc/xml/libxml.c vlc-0.8.6-svn20061008.debian/modules/misc/xml/libxml.c
--- vlc-0.8.6-svn20060918.debian/modules/misc/xml/libxml.c	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/misc/xml/libxml.c	2006-10-08 12:40:55.000000000 -0400
@@ -2,7 +2,7 @@
  * libxml.c: XML parser using libxml2
  *****************************************************************************
  * Copyright (C) 2004 the VideoLAN team
- * $Id: libxml.c 14958 2006-03-29 07:33:35Z fkuehne $
+ * $Id: libxml.c 16994 2006-10-08 14:40:02Z jpsaman $
  *
  * Authors: Gildas Bazin <gbazin@videolan.org>
  *
@@ -120,9 +120,6 @@
     xml_reader_t *p_reader;
     xml_reader_sys_t *p_sys;
     xmlTextReaderPtr p_libxml_reader;
-    xmlParserInputBufferPtr p_read_context;
-
-    p_read_context = malloc( sizeof( xmlParserInputBuffer ) );
 
     p_libxml_reader = xmlReaderForIO( StreamRead, NULL, p_stream,
                                       NULL, NULL, 0 );
@@ -216,7 +213,7 @@
     const xmlChar *psz_name =
         xmlTextReaderConstName( p_reader->p_sys->p_reader );
 
-    if( psz_name ) return strdup( psz_name );
+    if( psz_name ) return strdup( (const char *)psz_name );
     else return 0;
 }
 
@@ -225,7 +222,7 @@
     const xmlChar *psz_value =
         xmlTextReaderConstValue( p_reader->p_sys->p_reader );
 
-    if( psz_value ) return strdup( psz_value );
+    if( psz_value ) return strdup( (const char *)psz_value );
     else return 0;
 }
 
diff -uNr vlc-0.8.6-svn20060918.debian/modules/misc/xml/Makefile.in vlc-0.8.6-svn20061008.debian/modules/misc/xml/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/misc/xml/Makefile.in	2006-09-18 06:30:57.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/misc/xml/Makefile.in	2006-10-08 12:43:01.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/mux/Makefile.in vlc-0.8.6-svn20061008.debian/modules/mux/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/mux/Makefile.in	2006-09-18 06:30:57.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/mux/Makefile.in	2006-10-08 12:43:01.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/mux/mp4.c vlc-0.8.6-svn20061008.debian/modules/mux/mp4.c
--- vlc-0.8.6-svn20060918.debian/modules/mux/mp4.c	2006-09-18 06:28:27.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/mux/mp4.c	2006-09-21 11:50:22.000000000 -0400
@@ -2,7 +2,7 @@
  * mp4.c: mp4/mov muxer
  *****************************************************************************
  * Copyright (C) 2001, 2002, 2003, 2006 the VideoLAN team
- * $Id: mp4.c 15006 2006-03-31 16:39:23Z zorglub $
+ * $Id: mp4.c 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *          Gildas Bazin <gbazin at videolan dot org>
@@ -118,6 +118,7 @@
     struct
     {
         int     i_profile;
+        int     i_profile_compat;
         int     i_level;
 
         int     i_sps;
@@ -440,7 +441,8 @@
     p_stream->i_dts_start   = 0;
     p_stream->i_duration    = 0;
     p_stream->avc.i_profile = 77;
-    p_stream->avc.i_level   = 51;
+    p_stream->avc.i_profile_compat = 64;
+    p_stream->avc.i_level   = 30;
     p_stream->avc.i_sps     = 0;
     p_stream->avc.sps       = NULL;
     p_stream->avc.i_pps     = 0;
@@ -721,6 +723,7 @@
             memcpy( tk->avc.sps, &last[4], i_size );
 
             tk->avc.i_profile = tk->avc.sps[1];
+            tk->avc.i_profile = tk->avc.sps[2];
             tk->avc.i_level   = tk->avc.sps[3];
         }
         else if( (last[4]&0x1f) == 8 && tk->avc.i_pps <= 0 )   /* PPS */
@@ -930,7 +933,7 @@
     avcC = box_new( "avcC" );
     bo_add_8( avcC, 1 );      /* configuration version */
     bo_add_8( avcC, p_stream->avc.i_profile );
-    bo_add_8( avcC, p_stream->avc.i_profile );     /* profile compatible ??? */
+    bo_add_8( avcC, p_stream->avc.i_profile_compat );
     bo_add_8( avcC, p_stream->avc.i_level );       /* level, 5.1 */
     bo_add_8( avcC, 0xff );   /* 0b11111100 | lengthsize = 0x11 */
 
diff -uNr vlc-0.8.6-svn20060918.debian/modules/mux/mpeg/Makefile.in vlc-0.8.6-svn20061008.debian/modules/mux/mpeg/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/mux/mpeg/Makefile.in	2006-09-18 06:30:57.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/mux/mpeg/Makefile.in	2006-10-08 12:43:02.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/mux/rtp/Makefile.in vlc-0.8.6-svn20061008.debian/modules/mux/rtp/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/mux/rtp/Makefile.in	2006-09-18 06:30:57.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/mux/rtp/Makefile.in	2006-10-08 12:43:02.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/packetizer/h264.c vlc-0.8.6-svn20061008.debian/modules/packetizer/h264.c
--- vlc-0.8.6-svn20060918.debian/modules/packetizer/h264.c	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/packetizer/h264.c	2006-09-22 11:14:31.000000000 -0400
@@ -2,7 +2,7 @@
  * h264.c: h264/avc video packetizer
  *****************************************************************************
  * Copyright (C) 2001, 2002, 2006 the VideoLAN team
- * $Id: h264.c 14918 2006-03-25 12:54:27Z fkuehne $
+ * $Id: h264.c 16773 2006-09-21 18:46:25Z hartman $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *          Eric Petit <titer@videolan.org>
@@ -84,6 +84,7 @@
     int i_nal_ref_idc;
     int i_idr_pic_id;
     int i_frame_num;
+    int i_frame_type;
 };
 
 enum
@@ -121,6 +122,8 @@
 
 /*****************************************************************************
  * Open: probe the packetizer and return score
+ * When opening after demux, the packetizer is only loaded AFTER the decoder
+ * That means that what you set in fmt_out is ignored by the decoder in this special case
  *****************************************************************************/
 static int Open( vlc_object_t *p_this )
 {
@@ -131,6 +134,7 @@
         p_dec->fmt_in.i_codec != VLC_FOURCC( 'H', '2', '6', '4') &&
         p_dec->fmt_in.i_codec != VLC_FOURCC( 'V', 'S', 'S', 'H') &&
         p_dec->fmt_in.i_codec != VLC_FOURCC( 'v', 's', 's', 'h') &&
+        p_dec->fmt_in.i_codec != VLC_FOURCC( 'D', 'A', 'V', 'C') &&
         ( p_dec->fmt_in.i_codec != VLC_FOURCC( 'a', 'v', 'c', '1') ||
           p_dec->fmt_in.i_extra < 7 ) )
     {
@@ -161,16 +165,18 @@
     p_sys->i_nal_ref_idc = -1;
     p_sys->i_idr_pic_id = -1;
     p_sys->i_frame_num = -1;
+    p_sys->i_frame_type = 0;
 
     /* Setup properties */
     es_format_Copy( &p_dec->fmt_out, &p_dec->fmt_in );
     p_dec->fmt_out.i_codec = VLC_FOURCC( 'h', '2', '6', '4' );
-    /* FIXME: FFMPEG isn't happy at all if you leave this */
-    if( p_dec->fmt_out.i_extra ) free( p_dec->fmt_out.p_extra );
-    p_dec->fmt_out.i_extra = 0; p_dec->fmt_out.p_extra = 0;
 
     if( p_dec->fmt_in.i_codec == VLC_FOURCC( 'a', 'v', 'c', '1' ) )
     {
+        /* This type of stream is produced by mp4 and matroska
+         * when we want to store it in another streamformat, you need to convert
+         * The fmt_in.p_extra should ALWAYS contain the avcC
+         * The fmt_out.p_extra should contain all the SPS and PPS with 4 byte startcodes */
         uint8_t *p = &((uint8_t*)p_dec->fmt_in.p_extra)[4];
         int i_sps, i_pps;
         int i;
@@ -180,7 +186,6 @@
 
         /* Read SPS */
         i_sps = (*p++)&0x1f;
-
         for( i = 0; i < i_sps; i++ )
         {
             int i_length = GetWBE( p );
@@ -206,11 +211,25 @@
         msg_Dbg( p_dec, "avcC length size=%d, sps=%d, pps=%d",
                  p_sys->i_avcC_length_size, i_sps, i_pps );
 
+        /* FIXME: FFMPEG isn't happy at all if you leave this */
+        if( p_dec->fmt_out.i_extra ) free( p_dec->fmt_out.p_extra );
+        p_dec->fmt_out.i_extra = 0; p_dec->fmt_out.p_extra = NULL;
+        
+        /* Set the new extradata */
+        p_dec->fmt_out.i_extra = p_sys->p_pps->i_buffer + p_sys->p_sps->i_buffer;
+        p_dec->fmt_out.p_extra = (uint8_t*)malloc( p_dec->fmt_out.i_extra );
+        memcpy( p_dec->fmt_out.p_extra, p_sys->p_sps->p_buffer, p_sys->p_sps->i_buffer);
+        memcpy( p_dec->fmt_out.p_extra+p_sys->p_sps->i_buffer, p_sys->p_pps->p_buffer, p_sys->p_pps->i_buffer);
+
         /* Set callback */
         p_dec->pf_packetize = PacketizeAVC1;
     }
     else
     {
+        /* This type of stream contains data with 3 of 4 byte startcodes 
+         * The fmt_in.p_extra MAY contain SPS/PPS with 4 byte startcodes
+         * The fmt_out.p_extra should be the same */
+         
         /* Set callback */
         p_dec->pf_packetize = Packetize;
 
@@ -251,6 +270,8 @@
 
 /****************************************************************************
  * Packetize: the whole thing
+ * Search for the startcodes 3 or more bytes
+ * Feed ParseNALBlock ALWAYS with 4 byte startcode prepended NALs
  ****************************************************************************/
 static block_t *Packetize( decoder_t *p_dec, block_t **pp_block )
 {
@@ -266,6 +287,7 @@
         switch( p_sys->i_state )
         {
             case STATE_NOSYNC:
+                /* Skip until 3 byte startcode 0 0 1 */
                 if( block_FindStartcodeFromOffset( &p_sys->bytestream,
                       &p_sys->i_offset, p_sys->startcode+1, 3 ) == VLC_SUCCESS)
                 {
@@ -274,6 +296,7 @@
 
                 if( p_sys->i_offset )
                 {
+                    /* skip the data */
                     block_SkipBytes( &p_sys->bytestream, p_sys->i_offset );
                     p_sys->i_offset = 0;
                     block_BytestreamFlush( &p_sys->bytestream );
@@ -288,7 +311,7 @@
                 p_sys->i_offset = 1; /* To find next startcode */
 
             case STATE_NEXT_SYNC:
-                /* Find the next startcode */
+                /* Find the next 3 byte startcode 0 0 1*/
                 if( block_FindStartcodeFromOffset( &p_sys->bytestream,
                       &p_sys->i_offset, p_sys->startcode+1, 3 ) != VLC_SUCCESS)
                 {
@@ -297,14 +320,17 @@
                 }
 
                 /* Get the new fragment and set the pts/dts */
-                p_pic = block_New( p_dec, p_sys->i_offset );
+                p_pic = block_New( p_dec, p_sys->i_offset +1 );
                 p_pic->i_pts = p_sys->bytestream.p_block->i_pts;
                 p_pic->i_dts = p_sys->bytestream.p_block->i_dts;
+                /* Force 4 byte startcode 0 0 0 1 */
+                p_pic->p_buffer[0] = 0;
 
-                block_GetBytes( &p_sys->bytestream, p_pic->p_buffer,
-                                p_pic->i_buffer );
+                block_GetBytes( &p_sys->bytestream, &p_pic->p_buffer[1],
+                                p_pic->i_buffer-1 );
 
-                if( !p_pic->p_buffer[p_pic->i_buffer-1] ) p_pic->i_buffer--;
+                /* Remove trailing 0 bytes */
+                while( p_pic->i_buffer && (!p_pic->p_buffer[p_pic->i_buffer-1] ) ) p_pic->i_buffer--;
                 p_sys->i_offset = 0;
 
                 /* Parse the NAL */
@@ -329,7 +355,9 @@
 }
 
 /****************************************************************************
- * PacketizeAVC1: the whole thing
+ * PacketizeAVC1: Takes VCL blocks of data and creates annexe B type NAL stream
+ * Will always use 4 byte 0 0 0 1 startcodes
+ * Will prepend a SPS and PPS before each keyframe
  ****************************************************************************/
 static block_t *PacketizeAVC1( decoder_t *p_dec, block_t **pp_block )
 {
@@ -343,22 +371,6 @@
     p_block = *pp_block;
     *pp_block = NULL;
 
-#if 0
-    if( //(p_block->i_flags & BLOCK_FLAG_TYPE_I) &&
-        p_sys->p_sps && p_sys->p_pps )
-    {
-        block_t *p_pic;
-        block_t *p_sps = block_Duplicate( p_sys->p_sps );
-        block_t *p_pps = block_Duplicate( p_sys->p_pps );
-        p_sps->i_dts = p_pps->i_dts = p_block->i_dts;
-        p_sps->i_pts = p_pps->i_pts = p_block->i_pts;
-        p_pic = ParseNALBlock( p_dec, p_sps );
-        if( p_pic ) block_ChainAppend( &p_ret, p_pic );
-        p_pic = ParseNALBlock( p_dec, p_pps );
-        if( p_pic ) block_ChainAppend( &p_ret, p_pic );
-    }
-#endif
-
     for( p = p_block->p_buffer; p < &p_block->p_buffer[p_block->i_buffer]; )
     {
         block_t *p_pic;
@@ -394,15 +406,16 @@
 {
     block_t *p_nal;
 
-    p_nal = block_New( p_dec, 3 + i_size );
+    p_nal = block_New( p_dec, 4 + i_size );
 
     /* Add start code */
     p_nal->p_buffer[0] = 0x00;
     p_nal->p_buffer[1] = 0x00;
-    p_nal->p_buffer[2] = 0x01;
+    p_nal->p_buffer[2] = 0x00;
+    p_nal->p_buffer[3] = 0x01;
 
     /* Copy nalu */
-    memcpy( &p_nal->p_buffer[3], p, i_size );
+    memcpy( &p_nal->p_buffer[4], p, i_size );
 
     return p_nal;
 }
@@ -451,21 +464,39 @@
 }
 
 
+/*****************************************************************************
+ * ParseNALBlock: parses annexB type NALs
+ * All p_frag blocks are required to start with 0 0 0 1 4-byte startcode 
+ *****************************************************************************/
 static block_t *ParseNALBlock( decoder_t *p_dec, block_t *p_frag )
 {
     decoder_sys_t *p_sys = p_dec->p_sys;
     block_t *p_pic = NULL;
 
-    const int i_nal_ref_idc = (p_frag->p_buffer[3] >> 5)&0x03;
-    const int i_nal_type = p_frag->p_buffer[3]&0x1f;
+    const int i_nal_ref_idc = (p_frag->p_buffer[4] >> 5)&0x03;
+    const int i_nal_type = p_frag->p_buffer[4]&0x1f;
 
 #define OUTPUT \
-    do {                                                \
-        p_pic = block_ChainGather( p_sys->p_frame );    \
-        p_pic->i_length = 0;    /* FIXME */             \
-                                                        \
-        p_sys->p_frame = NULL;                          \
-        p_sys->b_slice = VLC_FALSE;                     \
+    do {                                                      \
+        p_pic = block_ChainGather( p_sys->p_frame );          \
+        p_pic->i_length = 0;    /* FIXME */                   \
+        p_pic->i_flags |= p_sys->i_frame_type;                \
+                                                              \
+        p_sys->i_frame_type = 0;                              \
+        p_sys->p_frame = NULL;                                \
+        p_sys->b_slice = VLC_FALSE;                           \
+                                                              \
+        if( ( p_pic->i_flags & BLOCK_FLAG_TYPE_I ) &&         \
+              p_sys->p_sps && p_sys->p_pps )                  \
+        {                                                     \
+            block_t *p_sps = block_Duplicate( p_sys->p_sps ); \
+            block_t *p_pps = block_Duplicate( p_sys->p_pps ); \
+            p_sps->i_dts = p_pps->i_dts = p_pic->i_dts;       \
+            p_sps->i_pts = p_pps->i_pts = p_pic->i_pts;       \
+            block_ChainAppend( &p_sps, p_pps );               \
+            block_ChainAppend( &p_sps, p_pic );               \
+            p_pic = block_ChainGather( p_sps );               \
+        }                                                     \
     } while(0)
 
 
@@ -488,13 +519,13 @@
     else if( i_nal_type >= NAL_SLICE && i_nal_type <= NAL_SLICE_IDR )
     {
         uint8_t *dec;
-        int i_dec, i_first_mb, i_slice_type, i_frame_num, i_pic_flags = 0;
+        int i_dec, i_first_mb, i_slice_type, i_frame_num;
         vlc_bool_t b_pic = VLC_FALSE;
         bs_t s;
 
         /* do not convert the whole frame */
-        nal_get_decoded( &dec, &i_dec, &p_frag->p_buffer[4],
-                         __MIN( p_frag->i_buffer - 4, 60 ) );
+        nal_get_decoded( &dec, &i_dec, &p_frag->p_buffer[5],
+                         __MIN( p_frag->i_buffer - 5, 60 ) );
         bs_init( &s, dec, i_dec );
 
         /* first_mb_in_slice */
@@ -503,21 +534,21 @@
         /* slice_type */
         switch( (i_slice_type = bs_read_ue( &s )) )
         {
-            case 0: case 5:
-                i_pic_flags = BLOCK_FLAG_TYPE_P;
-                break;
-            case 1: case 6:
-                i_pic_flags = BLOCK_FLAG_TYPE_B;
-                break;
-            case 2: case 7:
-                i_pic_flags = BLOCK_FLAG_TYPE_I;
-                break;
-            case 3: case 8: /* SP */
-                i_pic_flags = BLOCK_FLAG_TYPE_P;
-                break;
-            case 4: case 9:
-                i_pic_flags = BLOCK_FLAG_TYPE_I;
-                break;
+        case 0: case 5:
+            p_sys->i_frame_type = BLOCK_FLAG_TYPE_P;
+            break;
+        case 1: case 6:
+            p_sys->i_frame_type = BLOCK_FLAG_TYPE_B;
+            break;
+        case 2: case 7:
+            p_sys->i_frame_type = BLOCK_FLAG_TYPE_I;
+            break;
+        case 3: case 8: /* SP */
+            p_sys->i_frame_type = BLOCK_FLAG_TYPE_P;
+            break;
+        case 4: case 9:
+            p_sys->i_frame_type = BLOCK_FLAG_TYPE_I;
+            break;
         }
 
         /* pic_parameter_set_id */
@@ -573,8 +604,8 @@
 
         p_sys->b_sps = VLC_TRUE;
 
-        nal_get_decoded( &dec, &i_dec, &p_frag->p_buffer[4],
-                         p_frag->i_buffer - 4 );
+        nal_get_decoded( &dec, &i_dec, &p_frag->p_buffer[5],
+                         p_frag->i_buffer - 5 );
 
         bs_init( &s, dec, i_dec );
         /* Skip profile(8), constraint_set012, reserver(5), level(8) */
@@ -679,13 +710,19 @@
 
         free( dec );
 
-
         if( p_sys->b_slice ) OUTPUT;
+
+        /* We have a new SPS */
+        if( p_sys->p_sps ) block_Release( p_sys->p_sps );
+        p_sys->p_sps = p_frag;
+
+        /* Do not append the SPS because we will insert it on keyframes */
+        return p_pic;
     }
     else if( i_nal_type == NAL_PPS )
     {
         bs_t s;
-        bs_init( &s, &p_frag->p_buffer[4], p_frag->i_buffer - 4 );
+        bs_init( &s, &p_frag->p_buffer[5], p_frag->i_buffer - 5 );
 
         if( !p_sys->b_pps ) msg_Dbg( p_dec, "found NAL_PPS" );
         p_sys->b_pps = VLC_TRUE;
@@ -693,6 +730,13 @@
         /* TODO */
 
         if( p_sys->b_slice ) OUTPUT;
+
+        /* We have a new PPS */
+        if( p_sys->p_pps ) block_Release( p_sys->p_pps );
+        p_sys->p_pps = p_frag;
+
+        /* Do not append the PPS because we will insert it on keyframes */
+        return p_pic;
     }
     else if( i_nal_type == NAL_AU_DELIMITER ||
              i_nal_type == NAL_SEI ||
diff -uNr vlc-0.8.6-svn20060918.debian/modules/packetizer/Makefile.in vlc-0.8.6-svn20061008.debian/modules/packetizer/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/packetizer/Makefile.in	2006-09-18 06:30:58.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/packetizer/Makefile.in	2006-10-08 12:43:02.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/services_discovery/Makefile.in vlc-0.8.6-svn20061008.debian/modules/services_discovery/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/services_discovery/Makefile.in	2006-09-18 06:30:58.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/services_discovery/Makefile.in	2006-10-08 12:43:03.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/services_discovery/upnp_intel.cpp vlc-0.8.6-svn20061008.debian/modules/services_discovery/upnp_intel.cpp
--- vlc-0.8.6-svn20060918.debian/modules/services_discovery/upnp_intel.cpp	2006-09-18 06:28:28.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/services_discovery/upnp_intel.cpp	2006-09-21 11:50:22.000000000 -0400
@@ -2,7 +2,7 @@
  * Upnp_intell.cpp :  UPnP discovery module (Intel SDK)
  *****************************************************************************
  * Copyright (C) 2004-2006 the VideoLAN team
- * $Id: upnp_intel.cpp 14727 2006-03-11 23:19:59Z dionoea $
+ * $Id: upnp_intel.cpp 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Rmi Denis-Courmont <rem # videolan.org> (original plugin)
  *          Christian Henz <henz # c-lab.de>
@@ -411,7 +411,9 @@
     if ( !textNode ) return 0;
 
     const char* resultString = ixmlNode_getNodeValue( textNode );
-    char* resultXML = convert_xml_special_chars( resultString );
+    char* resultXML = strdup( resultString );
+    
+    resolve_xml_special_chars( resultXML );
 
     IXML_Document* browseDoc = ixmlParseBuffer( resultXML );
 
diff -uNr vlc-0.8.6-svn20060918.debian/modules/stream_out/bridge.c vlc-0.8.6-svn20061008.debian/modules/stream_out/bridge.c
--- vlc-0.8.6-svn20060918.debian/modules/stream_out/bridge.c	2006-09-18 06:28:17.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/stream_out/bridge.c	2006-09-21 11:50:22.000000000 -0400
@@ -2,7 +2,7 @@
  * bridge.c: bridge stream output module
  *****************************************************************************
  * Copyright (C) 2005 the VideoLAN team
- * $Id: bridge.c 15000 2006-03-31 15:30:32Z zorglub $
+ * $Id: bridge.c 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Christophe Massiot <massiot@via.ecp.fr>
  *
@@ -40,7 +40,7 @@
 
 #define DELAY_TEXT N_("Delay")
 #define DELAY_LONGTEXT N_("Pictures coming from the picture video outputs " \
-        "will be delayed accord to thi value (in milliseconds, should be "\
+        "will be delayed according to this value (in milliseconds, should be "\
         ">= 100 ms). For high values, you will need to raise caching values." )
 
 #define ID_OFFSET_TEXT N_("ID Offset")
diff -uNr vlc-0.8.6-svn20060918.debian/modules/stream_out/Makefile.in vlc-0.8.6-svn20061008.debian/modules/stream_out/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/stream_out/Makefile.in	2006-09-18 06:30:59.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/stream_out/Makefile.in	2006-10-08 12:43:04.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/stream_out/mosaic_bridge.c vlc-0.8.6-svn20061008.debian/modules/stream_out/mosaic_bridge.c
--- vlc-0.8.6-svn20060918.debian/modules/stream_out/mosaic_bridge.c	2006-09-18 06:28:17.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/stream_out/mosaic_bridge.c	2006-10-08 12:40:54.000000000 -0400
@@ -2,7 +2,7 @@
  * mosaic_bridge.c:
  *****************************************************************************
  * Copyright (C) 2004-2005 the VideoLAN team
- * $Id: mosaic_bridge.c 14912 2006-03-25 10:57:34Z zorglub $
+ * $Id: mosaic_bridge.c 16987 2006-10-08 12:54:12Z jpsaman $
  *
  * Authors: Antoine Cellerier <dionoea@videolan.org>
  *          Christophe Massiot <massiot@via.ecp.fr>
@@ -48,7 +48,7 @@
     decoder_t       *p_decoder;
     image_handler_t *p_image; /* filter for resizing */
     int i_height, i_width;
-    int i_sar_num, i_sar_den;
+    unsigned int i_sar_num, i_sar_den;
     char *psz_id;
     vlc_bool_t b_inited;
 };
@@ -431,7 +431,10 @@
 
         if ( p_sys->i_height || p_sys->i_width )
         {
-            video_format_t fmt_out = {0}, fmt_in = {0};
+            video_format_t fmt_out, fmt_in;
+
+            memset( &fmt_in, 0, sizeof(video_format_t) );
+            memset( &fmt_out, 0, sizeof(video_format_t) );
             fmt_in = p_sys->p_decoder->fmt_out.video;
 
             fmt_out.i_chroma = VLC_FOURCC('Y','U','V','A');
diff -uNr vlc-0.8.6-svn20060918.debian/modules/stream_out/rtp.c vlc-0.8.6-svn20061008.debian/modules/stream_out/rtp.c
--- vlc-0.8.6-svn20060918.debian/modules/stream_out/rtp.c	2006-09-18 06:28:17.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/stream_out/rtp.c	2006-10-08 12:40:54.000000000 -0400
@@ -2,7 +2,7 @@
  * rtp.c: rtp stream output module
  *****************************************************************************
  * Copyright (C) 2003-2004 the VideoLAN team
- * $Id: rtp.c 16610 2006-09-11 08:27:37Z sam $
+ * $Id: rtp.c 16986 2006-10-08 12:37:14Z jpsaman $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *
@@ -25,16 +25,17 @@
  * Preamble
  *****************************************************************************/
 #include <stdlib.h>
+
+#include <vlc/vlc.h>
+#include <vlc/input.h>
+#include <vlc/sout.h>
+
 #ifdef HAVE_UNISTD_H
 #   include <unistd.h>
 #endif
 
 #include <errno.h>
 
-#include <vlc/vlc.h>
-#include <vlc/input.h>
-#include <vlc/sout.h>
-
 #include "vlc_httpd.h"
 #include "vlc_url.h"
 #include "network.h"
@@ -524,17 +525,11 @@
         }
 
         /* create the SDP for a muxed stream (only once) */
-        /* FIXME  http://www.faqs.org/rfcs/rfc2327.html
-           All text fields should be UTF-8 encoded. Use global a:charset to announce this.
+        /* FIXME  http://www.faqs.org/rfcs/rfc4566.html
            o= - should be local username (no spaces allowed)
-           o= time should be hashed with some other value to garantue uniqueness
-           o= we need IP6 support?
+           o= time should be hashed with some other value to garantee uniqueness
            o= don't use the localhost address. use fully qualified domain name or IP4 address
-           p= international phone number (pass via vars?)
-           c= IP6 support
-           a= recvonly (missing)
-           a= type:broadcast (missing)
-           a= charset: (normally charset should be UTF-8, this can be used to override s= and i=)
+	   a= source-filter: we need our source address
            a= x-plgroup: (missing)
            RTP packets need to get the correct src IP address  */
         if( net_AddressIsMulticast( (vlc_object_t *)p_stream, p_sys->psz_destination ) )
@@ -555,9 +550,11 @@
                   "i=%s\r\n"
                   "u=%s\r\n"
                   "e=%s\r\n"
+                  "c=IN IP%c %s%s\r\n"
                   "t=0 0\r\n" /* permanent stream */ /* when scheduled from vlm, we should set this info correctly */
                   "a=tool:"PACKAGE_STRING"\r\n"
-                  "c=IN IP%c %s%s\r\n"
+                  "a=recvonly\r\n"
+                  "a=type:broadcast\r\n"
                   "m=video %d RTP/AVP %d\r\n"
                   "a=rtpmap:%d %s\r\n",
                   p_sys->i_sdp_id, p_sys->i_sdp_version,
@@ -937,6 +934,68 @@
     s[2*i_data] = '\0';
 }
 
+static const char basis_64[] =
+    "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
+
+int ap_base64encode_len(int len)
+{
+    return ((len + 2) / 3 * 4) + 1;
+}
+
+int ap_base64encode_binary(char *encoded,
+                                       const unsigned char *string, int len)
+{
+    int i;
+    char *p;
+
+    p = encoded;
+    for (i = 0; i < len - 2; i += 3) {
+        *p++ = basis_64[(string[i] >> 2) & 0x3F];
+        *p++ = basis_64[((string[i] & 0x3) << 4) |
+                        ((int) (string[i + 1] & 0xF0) >> 4)];
+        *p++ = basis_64[((string[i + 1] & 0xF) << 2) |
+                        ((int) (string[i + 2] & 0xC0) >> 6)];
+        *p++ = basis_64[string[i + 2] & 0x3F];
+    }
+    if (i < len) {
+        *p++ = basis_64[(string[i] >> 2) & 0x3F];
+        if (i == (len - 1)) {
+            *p++ = basis_64[((string[i] & 0x3) << 4)];
+            *p++ = '=';
+        }
+        else {
+            *p++ = basis_64[((string[i] & 0x3) << 4) |
+                            ((int) (string[i + 1] & 0xF0) >> 4)];
+            *p++ = basis_64[((string[i + 1] & 0xF) << 2)];
+        }
+        *p++ = '=';
+    }
+
+    *p++ = '\0';
+    return p - encoded;
+}
+
+int ap_base64encode(char *encoded, const char *string, int len)
+{
+    return ap_base64encode_binary(encoded, (const unsigned char *) string, len);
+}
+
+char *b64_encode(char *buf, int len)
+{
+    int elen;
+    char *out;
+
+    if(len == 0)
+        len = strlen(buf);
+
+    elen = ap_base64encode_len(len);
+    out = (char *) malloc(sizeof(char) * (elen + 1));
+
+    ap_base64encode(out, buf, len);
+
+    return out;
+}
+
 static sout_stream_id_t *Add( sout_stream_t *p_stream, es_format_t *p_fmt )
 {
     sout_instance_t   *p_sout = p_stream->p_sout;
@@ -1092,7 +1151,60 @@
             id->i_clock_rate = 90000;
             id->psz_rtpmap = strdup( "H264/90000" );
             id->pf_packetize = rtp_packetize_h264;
-            id->psz_fmtp = strdup( "packetization-mode=1" );
+            if( p_fmt->i_extra > 0 )
+            {
+                uint8_t *p_buffer = p_fmt->p_extra;
+                int     i_buffer = p_fmt->i_extra;
+                char    *p_64_sps = NULL;
+                char    *p_64_pps = NULL;
+                char    hexa[6];
+
+                while( i_buffer > 4 && 
+                    p_buffer[0] == 0 && p_buffer[1] == 0 &&
+                    p_buffer[2] == 0 && p_buffer[3] == 1 )
+                {
+                    const int i_nal_type = p_buffer[4]&0x1f;
+                    int i_offset    = 1;
+                    int i_size      = 0;
+                    int i_startcode = 0;
+                    int i_encoded   = 0;
+
+                    msg_Dbg( p_stream, "we found a startcode for NAL with TYPE:%d", i_nal_type );
+
+                    for( i_offset = 1; i_offset+3 < i_buffer ; i_offset++)
+                    {
+                        if( p_buffer[i_offset] == 0 && p_buffer[i_offset+1] == 0 && p_buffer[i_offset+2] == 0 && p_buffer[i_offset+3] == 1 )
+                        {
+                            /* we found another startcode */
+                            i_startcode = i_offset;
+                            break;
+                        } 
+                    }
+                    i_size = i_startcode ? i_startcode : i_buffer;
+                    if( i_nal_type == 7 )
+                    {
+                        p_64_sps = (char *)malloc( ap_base64encode_len( i_size - 4) );
+                        i_encoded = ap_base64encode_binary( p_64_sps, &p_buffer[4], i_size - 4 );
+                        p_64_sps[i_encoded] = '\0';
+                        sprintf_hexa( hexa, &p_buffer[5], 3 );
+                        hexa[6] = '\0'; 
+                    }
+                    if( i_nal_type == 8 )
+                    {
+                        p_64_pps = (char *)malloc( ap_base64encode_len( i_size - 4) );
+                        i_encoded = ap_base64encode_binary( p_64_pps, &p_buffer[4], i_size - 4 );
+                        p_64_pps[i_encoded] = '\0';
+                    }
+                    i_buffer -= i_size;
+                    p_buffer += i_size;
+                }
+                /* FIXME: All this is a bit unsafe */
+                asprintf( &id->psz_fmtp, "packetization-mode=1;profile-level-id=%s;sprop-parameter-sets=%s,%s;", hexa, p_64_sps, p_64_pps );
+                free( p_64_sps );
+                free( p_64_pps );
+            }
+            else
+                id->psz_fmtp = strdup( "packetization-mode=1" );
             break;
 
         case VLC_FOURCC( 'm', 'p', '4', 'v' ):
@@ -2370,37 +2482,36 @@
     int     i_count = ( in->i_buffer + i_max - 1 ) / i_max;
     uint8_t *p_data = in->p_buffer;
     int     i_data  = in->i_buffer;
-    int     i;
+    block_t *out;
+    int     i_nal_type;
+    int     i_payload;
 
-    if( i_data <= i_max )
+    while( i_data > 5 &&
+           ( p_data[0] != 0x00 || p_data[1] != 0x00 || p_data[2] != 0x01 || /* startcode */
+            (p_data[3]&0x1f) < 1 || (p_data[3]&0x1f) > 23 ) ) /* naltype should be between 1 and 23 */
     {
-        /* NAL */
-        int           i_payload;
-        block_t *out;
-        uint8_t *p = p_data;
-        int      i_rest = in->i_buffer;
-
-        while( i_rest > 4 &&
-               ( p[0] != 0x00 || p[1] != 0x00 || p[2] != 0x01 ) )
-        {
-            p++;
-            i_rest--;
-        }
+        p_data++;
+        i_data--;
+    }
 
-        if (i_rest < 4)
-            return VLC_SUCCESS;
- 
-        p+=3;
-        i_rest-=3;
+    if( i_data < 5 )
+        return VLC_SUCCESS;
 
-        i_payload = __MIN( i_max, i_rest );
+    p_data+=3;
+    i_data-=3;
+    i_nal_type = p_data[0]&0x1f;
+    
+    if( i_data <= i_max ) /* The whole pack will fit in one rtp payload */
+    {
+        /* single NAL */
+        i_payload = __MIN( i_max, i_data );
         out = block_New( p_stream, 12 + i_payload );
 
         /* rtp common header */
         rtp_packetize_common( id, out, 1,
                               in->i_pts > 0 ? in->i_pts : in->i_dts );
 
-        memcpy( &out->p_buffer[12], p, i_payload );
+        memcpy( &out->p_buffer[12], p_data, i_payload );
 
         out->i_buffer   = 12 + i_payload;
         out->i_dts    = in->i_dts;
@@ -2413,40 +2524,24 @@
     else
     {
         /* FU-A */
-        int           i_payload;
-        block_t *out;
-        uint8_t *p = p_data;
-        int      i_rest = in->i_buffer;
-        int start=1, end=0, first=0, nalh=-1;
+        uint8_t     nalh; /* The nalheader byte */
+        int i=0, start=1, end=0, first=0;
  
-        while( i_rest > 4 &&
-               ( p[0] != 0x00 || p[1] != 0x00 || p[2] != 0x01 ) )
-        {
-            p++;
-            i_rest--;
-        }
-
-        if (i_rest < 4)
-            return VLC_SUCCESS;
-
-        p+=3;
-        i_rest-=3;
-
-        nalh = *p;
-        p++;
-        i_rest--;
+        nalh = *p_data;
+        p_data++;
+        i_data--;
 
         i_max   = id->i_mtu - 14;
-        i_count = ( i_rest + i_max - 1 ) / i_max;
+        i_count = ( i_data + i_max - 1 ) / i_max;
 
         /*msg_Dbg( p_stream, "nal-out fragmented %02x %d", nalh, i_rest);*/
 
-        i=0;
-        while (end==0){
-                i_payload = __MIN( i_max, i_rest );
-                out = block_New( p_stream, 14 + i_payload );
+        while( end == 0 )
+        {
+            i_payload = __MIN( i_max, i_data );
+            out = block_New( p_stream, 14 + i_payload );
 
-            if (i_rest==i_payload)
+            if( i_data == i_payload )
                 end = 1;
 
             /* rtp common header */
@@ -2458,22 +2553,22 @@
             /* FU header */
             out->p_buffer[13] = (start<<7)|(end<<6)|(nalh&0x1f);
 
-            memcpy( &out->p_buffer[14], p+first, i_payload );
+            memcpy( &out->p_buffer[14], p_data+first, i_payload );
  
             out->i_buffer   = 14 + i_payload;
 
             // not sure what of these should be used and what it does :)
-            out->i_dts    = in->i_dts + i * in->i_length / i_count;
-            out->i_length = in->i_length / i_count;
-            //out->i_dts    = in->i_dts;
-            //out->i_length = in->i_length;
+            out->i_pts    = in->i_pts;
+            out->i_dts    = in->i_dts;
+            //out->i_dts    = in->i_dts + i * in->i_length / i_count;
+            //out->i_length = in->i_length / i_count;
 
             rtp_packetize_send( id, out );
 
             /*msg_Dbg( p_stream, "nal-out fragmented: frag %d %d %02x %02x %d", start,end,
             out->p_buffer[12], out->p_buffer[13], i_payload );*/
 
-            i_rest -= i_payload;
+            i_data -= i_payload;
             first += i_payload;
             i++;
             start=0;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/stream_out/switcher.c vlc-0.8.6-svn20061008.debian/modules/stream_out/switcher.c
--- vlc-0.8.6-svn20060918.debian/modules/stream_out/switcher.c	2006-09-18 06:28:17.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/stream_out/switcher.c	2006-10-08 12:40:54.000000000 -0400
@@ -2,7 +2,7 @@
  * switcher.c: MPEG2 video switcher module
  *****************************************************************************
  * Copyright (C) 2004 the VideoLAN team
- * $Id: switcher.c 14820 2006-03-19 01:27:21Z xtophe $
+ * $Id: switcher.c 16987 2006-10-08 12:54:12Z jpsaman $
  *
  * Authors: Christophe Massiot <massiot@via.ecp.fr>
  *
@@ -51,7 +51,6 @@
 #define SOUT_CFG_PREFIX "sout-switcher-"
 #define MAX_PICTURES 10
 #define MAX_AUDIO 30
-#define AVCODEC_MAX_VIDEO_FRAME_SIZE (3*1024*1024)
 #define MAX_THRESHOLD 99999999
 
 /*****************************************************************************
@@ -163,7 +162,7 @@
     AVCodec         *ff_enc;
     AVCodecContext  *ff_enc_c;
     AVFrame         *p_frame;
-    char            *p_buffer_out;
+    uint8_t         *p_buffer_out;
     int             i_nb_pred;
     int16_t         *p_samples;
 };
@@ -651,7 +650,7 @@
 {
     sout_stream_sys_t *p_sys = p_stream->p_sys;
     char psz_buffer[10];
-    int i_len = net_ReadNonBlock( p_stream, p_sys->i_fd, NULL, psz_buffer,
+    int i_len = net_ReadNonBlock( p_stream, p_sys->i_fd, NULL, (uint8_t *)&psz_buffer[0],
                                   sizeof( psz_buffer ), 0 );
 
     if ( i_len > 0 )
@@ -779,7 +778,7 @@
             return 0;
         }
 
-        id->p_buffer_out = malloc( AVCODEC_MAX_VIDEO_FRAME_SIZE );
+        id->p_buffer_out = malloc( id->ff_enc_c->width * id->ff_enc_c->height * 3 );
         id->p_frame = avcodec_alloc_frame();
         id->p_frame->linesize[0] = p_sys->p_pictures[p_sys->i_cmd-1].p[0].i_pitch;
         id->p_frame->linesize[1] = p_sys->p_pictures[p_sys->i_cmd-1].p[1].i_pitch;
@@ -833,7 +832,7 @@
     }
 
     i_out = avcodec_encode_video( id->ff_enc_c, id->p_buffer_out,
-                                  AVCODEC_MAX_VIDEO_FRAME_SIZE,
+                                  id->ff_enc_c->width * id->ff_enc_c->height * 3,
                                   id->p_frame );
 
     if ( i_out <= 0 )
@@ -847,7 +846,7 @@
         int mb_height = (id->ff_enc_c->height + 15) / 16;
         int h_chroma_shift, v_chroma_shift;
         int i;
-        
+
         avcodec_get_chroma_sub_sample( id->ff_enc_c->pix_fmt, &h_chroma_shift,
                                        &v_chroma_shift );
 
@@ -859,7 +858,7 @@
                                     id->ff_enc_c->coded_frame->mb_type,
                                     (mb_width + 1) * mb_height
                                       * sizeof(id->p_frame->mb_type[0]));
-        
+
         for ( i = 0; i < 2; i++ )
         {
             int stride = ((16 * mb_width )
@@ -942,4 +941,3 @@
 
     return p_out;
 }
-
diff -uNr vlc-0.8.6-svn20060918.debian/modules/stream_out/transcode.c vlc-0.8.6-svn20061008.debian/modules/stream_out/transcode.c
--- vlc-0.8.6-svn20060918.debian/modules/stream_out/transcode.c	2006-09-18 06:28:17.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/stream_out/transcode.c	2006-09-22 11:14:30.000000000 -0400
@@ -2,7 +2,7 @@
  * transcode.c: transcoding stream output module
  *****************************************************************************
  * Copyright (C) 2003-2004 the VideoLAN team
- * $Id: transcode.c 16601 2006-09-10 20:21:46Z zorglub $
+ * $Id: transcode.c 16774 2006-09-21 19:29:10Z hartman $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *          Gildas Bazin <gbazin@videolan.org>
@@ -503,8 +503,8 @@
 
     if( p_sys->i_acodec )
     {
-        if( (strncmp( (char *)&p_sys->i_acodec, "mp3", 3) == 0) &&
-                            (p_sys->i_channels > 2) )
+        if( p_sys->i_acodec == VLC_FOURCC('m','p','3',0) &&
+            p_sys->i_channels > 2 )
         {
             msg_Warn( p_stream, "%d channels invalid for mp3, forcing to 2",
                       p_sys->i_channels );
@@ -623,28 +623,20 @@
     p_sys->i_canvas_height = val.i_int;
     
     var_Get( p_stream, SOUT_CFG_PREFIX "canvas-aspect", &val );
-    if ( val.psz_string )
+    p_sys->i_canvas_aspect = 0;
+    if( val.psz_string && *val.psz_string )
     {
         char *psz_parser = strchr( val.psz_string, ':' );
-
         if( psz_parser )
         {
             *psz_parser++ = '\0';
-            p_sys->i_canvas_aspect = atoi( val.psz_string ) * VOUT_ASPECT_FACTOR
-                / atoi( psz_parser );
-        }
-        else
-        {
-            msg_Warn( p_stream, "bad aspect ratio %s", val.psz_string );
-            p_sys->i_canvas_aspect = 0;
+            p_sys->i_canvas_aspect = atoi( val.psz_string ) *
+                VOUT_ASPECT_FACTOR / atoi( psz_parser );
         }
+        else msg_Warn( p_stream, "bad aspect ratio %s", val.psz_string );
 
-        free( val.psz_string );
-    }
-    else
-    {
-        p_sys->i_canvas_aspect = 0;
     }
+    if( val.psz_string ) free( val.psz_string );
 
     var_Get( p_stream, SOUT_CFG_PREFIX "threads", &val );
     p_sys->i_threads = val.i_int;
@@ -1295,7 +1287,7 @@
     {
         msg_Err( p_stream, "cannot find encoder (%s)", p_sys->psz_aenc );
         module_Unneed( id->p_decoder, id->p_decoder->p_module );
-        id->p_decoder->p_module = 0;
+        id->p_decoder->p_module = NULL;
         return VLC_EGENERIC;
     }
     id->p_encoder->fmt_in.audio.i_format = id->p_encoder->fmt_in.i_codec;
@@ -1344,11 +1336,11 @@
 
     if( fmt_last.audio.i_channels != id->p_encoder->fmt_in.audio.i_channels )
     {
-        msg_Err( p_stream, "no audio filter found for mixing from"
-                 " %i to %i channels", fmt_last.audio.i_channels,
-                 id->p_encoder->fmt_in.audio.i_channels );
-#if 0
-        /* FIXME : this might work, but only if the encoder is restarted */
+#if 1
+        module_Unneed( id->p_encoder, id->p_encoder->p_module );
+        id->p_encoder->p_module = NULL;
+
+        /* This might work, but only if the encoder is restarted */
         id->p_encoder->fmt_in.audio.i_channels = fmt_last.audio.i_channels;
         id->p_encoder->fmt_out.audio.i_channels = fmt_last.audio.i_channels;
 
@@ -1358,7 +1350,30 @@
         id->p_encoder->fmt_out.audio.i_physical_channels =
             id->p_encoder->fmt_out.audio.i_original_channels =
                 fmt_last.audio.i_physical_channels;
+
+        msg_Dbg( p_stream, "number of audio channels for mixing changed, "
+                 "trying to reopen the encoder for mixing %i to %i channels",
+                 fmt_last.audio.i_channels,
+                 id->p_encoder->fmt_in.audio.i_channels );
+
+        /* reload encoder */
+        id->p_encoder->p_cfg = p_stream->p_sys->p_audio_cfg;
+        id->p_encoder->p_module =
+            module_Need( id->p_encoder, "encoder", p_sys->psz_aenc, VLC_TRUE );
+        if( !id->p_encoder->p_module )
+        {
+            msg_Err( p_stream, "cannot find encoder (%s)", p_sys->psz_aenc );
+            transcode_audio_close( p_stream, id );
+            return VLC_EGENERIC;
+        }
+        id->p_encoder->fmt_in.audio.i_format = id->p_encoder->fmt_in.i_codec;
+        id->p_encoder->fmt_in.audio.i_bitspersample =
+            audio_BitsPerSample( id->p_encoder->fmt_in.i_codec );
 #else
+        msg_Err( p_stream, "no audio filter found for mixing from"
+                 " %i to %i channels", fmt_last.audio.i_channels,
+                 id->p_encoder->fmt_in.audio.i_channels );
+
         transcode_audio_close( p_stream, id );
         return VLC_EGENERIC;
 #endif
@@ -1394,12 +1409,12 @@
     /* Close decoder */
     if( id->p_decoder->p_module )
         module_Unneed( id->p_decoder, id->p_decoder->p_module );
-    id->p_decoder->p_module = 0;
+    id->p_decoder->p_module = NULL;
 
     /* Close encoder */
     if( id->p_encoder->p_module )
         module_Unneed( id->p_encoder, id->p_encoder->p_module );
-    id->p_encoder->p_module = 0;
+    id->p_encoder->p_module = NULL;
 
     /* Close filters */
     for( i = 0; i < id->i_filter; i++ )
@@ -2222,7 +2237,8 @@
         /* Check if we have a subpicture to overlay */
         if( p_sys->p_spu )
         {
-            p_subpic = spu_SortSubpictures( p_sys->p_spu, p_pic->date );
+            p_subpic = spu_SortSubpictures( p_sys->p_spu, p_pic->date,
+                       VLC_FALSE /* Fixme: check if stream is paused */ );
             /* TODO: get another pic */
         }
 
@@ -2797,7 +2813,7 @@
     /* Check if we have a subpicture to send */
     if( p_sys->p_spu && in->i_dts > 0)
     {
-        p_subpic = spu_SortSubpictures( p_sys->p_spu, in->i_dts );
+        p_subpic = spu_SortSubpictures( p_sys->p_spu, in->i_dts, VLC_FALSE );
     }
     else
     {
diff -uNr vlc-0.8.6-svn20060918.debian/modules/stream_out/transrate/Makefile.in vlc-0.8.6-svn20061008.debian/modules/stream_out/transrate/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/stream_out/transrate/Makefile.in	2006-09-18 06:30:59.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/stream_out/transrate/Makefile.in	2006-10-08 12:43:04.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/video_chroma/i420_rgb8.c vlc-0.8.6-svn20061008.debian/modules/video_chroma/i420_rgb8.c
--- vlc-0.8.6-svn20060918.debian/modules/video_chroma/i420_rgb8.c	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/video_chroma/i420_rgb8.c	2006-10-08 12:40:56.000000000 -0400
@@ -2,7 +2,7 @@
  * i420_rgb8.c : YUV to bitmap RGB conversion module for vlc
  *****************************************************************************
  * Copyright (C) 2000 the VideoLAN team
- * $Id: i420_rgb8.c 13905 2006-01-12 23:10:04Z dionoea $
+ * $Id: i420_rgb8.c 16987 2006-10-08 12:54:12Z jpsaman $
  *
  * Authors: Samuel Hocevar <sam@zoy.org>
  *
@@ -47,7 +47,7 @@
     uint8_t *p_v   = p_src->V_PIXELS;
 
     vlc_bool_t  b_hscale;                         /* horizontal scaling type */
-    unsigned int i_vscale;                          /* vertical scaling type */
+    int         i_vscale;                          /* vertical scaling type */
     unsigned int i_x, i_y;                /* horizontal and vertical indexes */
     unsigned int i_real_y;                                          /* y % 4 */
     int          i_right_margin;
diff -uNr vlc-0.8.6-svn20060918.debian/modules/video_chroma/Makefile.in vlc-0.8.6-svn20061008.debian/modules/video_chroma/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/video_chroma/Makefile.in	2006-09-18 06:31:00.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/video_chroma/Makefile.in	2006-10-08 12:43:05.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/video_filter/logo.c vlc-0.8.6-svn20061008.debian/modules/video_filter/logo.c
--- vlc-0.8.6-svn20060918.debian/modules/video_filter/logo.c	2006-09-18 06:28:28.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/video_filter/logo.c	2006-09-21 11:50:22.000000000 -0400
@@ -2,7 +2,7 @@
  * logo.c : logo video plugin for vlc
  *****************************************************************************
  * Copyright (C) 2003-2006 the VideoLAN team
- * $Id: logo.c 15002 2006-03-31 16:12:31Z fkuehne $
+ * $Id: logo.c 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Gildas Bazin <gbazin@videolan.org>
  *          Simon Latapie <garf@videolan.org>
@@ -707,7 +707,6 @@
 {
     filter_t *p_filter = (filter_t *)p_this;
     filter_sys_t *p_sys;
-    vlc_object_t *p_input;
     logo_list_t *p_logo_list;
 
     /* Allocate structure */
@@ -726,43 +725,32 @@
     }
 
     /* Hook used for callback variables */
-    p_input = vlc_object_find( p_this, VLC_OBJECT_INPUT, FIND_PARENT );
-    if( !p_input )
-    {
-        free( p_sys );
-        free( p_logo_list );
-        return VLC_ENOOBJ;
-    }
-
     p_logo_list->psz_filename =
-        var_CreateGetString( p_input->p_libvlc , "logo-file" );
+        var_CreateGetString( p_filter->p_libvlc , "logo-file" );
     if( !p_logo_list->psz_filename || !*p_logo_list->psz_filename )
     {
         msg_Err( p_this, "logo file not specified" );
-        vlc_object_release( p_input );
-        //if( p_sys->psz_filename ) free( p_sys->psz_filename );
         free( p_sys );
         free( p_logo_list );
         return VLC_EGENERIC;
     }
 
-    p_sys->posx = var_CreateGetInteger( p_input->p_libvlc , "logo-x" );
-    p_sys->posy = var_CreateGetInteger( p_input->p_libvlc , "logo-y" );
-    p_sys->pos = var_CreateGetInteger( p_input->p_libvlc , "logo-position" );
+    p_sys->posx = var_CreateGetInteger( p_filter->p_libvlc , "logo-x" );
+    p_sys->posy = var_CreateGetInteger( p_filter->p_libvlc , "logo-y" );
+    p_sys->pos = var_CreateGetInteger( p_filter->p_libvlc , "logo-position" );
     p_logo_list->i_alpha = __MAX( __MIN( var_CreateGetInteger(
-                           p_input->p_libvlc, "logo-transparency"), 255 ), 0 );
+                           p_filter->p_libvlc, "logo-transparency"), 255 ), 0 );
     p_logo_list->i_delay =
-                    var_CreateGetInteger( p_input->p_libvlc , "logo-delay" );
+                    var_CreateGetInteger( p_filter->p_libvlc , "logo-delay" );
     p_logo_list->i_repeat =
-                    var_CreateGetInteger( p_input->p_libvlc , "logo-repeat" );
+                    var_CreateGetInteger( p_filter->p_libvlc , "logo-repeat" );
 
-    var_AddCallback( p_input->p_libvlc, "logo-file", LogoCallback, p_sys );
-    var_AddCallback( p_input->p_libvlc, "logo-x", LogoCallback, p_sys );
-    var_AddCallback( p_input->p_libvlc, "logo-y", LogoCallback, p_sys );
-    var_AddCallback( p_input->p_libvlc, "logo-position", LogoCallback, p_sys );
-    var_AddCallback( p_input->p_libvlc, "logo-transparency", LogoCallback, p_sys );
-    var_AddCallback( p_input->p_libvlc, "logo-repeat", LogoCallback, p_sys );
-    vlc_object_release( p_input );
+    var_AddCallback( p_filter->p_libvlc, "logo-file", LogoCallback, p_sys );
+    var_AddCallback( p_filter->p_libvlc, "logo-x", LogoCallback, p_sys );
+    var_AddCallback( p_filter->p_libvlc, "logo-y", LogoCallback, p_sys );
+    var_AddCallback( p_filter->p_libvlc, "logo-position", LogoCallback, p_sys );
+    var_AddCallback( p_filter->p_libvlc, "logo-transparency", LogoCallback, p_sys );
+    var_AddCallback( p_filter->p_libvlc, "logo-repeat", LogoCallback, p_sys );
 
     vlc_mutex_init( p_filter, &p_logo_list->lock );
     vlc_mutex_lock( &p_logo_list->lock );
@@ -787,7 +775,6 @@
 {
     filter_t *p_filter = (filter_t *)p_this;
     filter_sys_t *p_sys = p_filter->p_sys;
-    vlc_object_t *p_input;
 
     vlc_mutex_destroy( &p_sys->p_logo_list->lock );
     FreeLogoList( p_sys->p_logo_list );
@@ -795,17 +782,13 @@
     free( p_sys );
 
     /* Delete the logo variables from INPUT */
-    p_input = vlc_object_find( p_this, VLC_OBJECT_INPUT, FIND_PARENT );
-    if( !p_input ) return;
-
-    var_Destroy( p_input->p_libvlc , "logo-file" );
-    var_Destroy( p_input->p_libvlc , "logo-x" );
-    var_Destroy( p_input->p_libvlc , "logo-y" );
-    var_Destroy( p_input->p_libvlc , "logo-delay" );
-    var_Destroy( p_input->p_libvlc , "logo-repeat" );
-    var_Destroy( p_input->p_libvlc , "logo-position" );
-    var_Destroy( p_input->p_libvlc , "logo-transparency" );
-    vlc_object_release( p_input );
+    var_Destroy( p_filter->p_libvlc , "logo-file" );
+    var_Destroy( p_filter->p_libvlc , "logo-x" );
+    var_Destroy( p_filter->p_libvlc , "logo-y" );
+    var_Destroy( p_filter->p_libvlc , "logo-delay" );
+    var_Destroy( p_filter->p_libvlc , "logo-repeat" );
+    var_Destroy( p_filter->p_libvlc , "logo-position" );
+    var_Destroy( p_filter->p_libvlc , "logo-transparency" );
 }
 
 /*****************************************************************************
diff -uNr vlc-0.8.6-svn20060918.debian/modules/video_filter/Makefile.in vlc-0.8.6-svn20061008.debian/modules/video_filter/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/video_filter/Makefile.in	2006-09-18 06:31:02.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/video_filter/Makefile.in	2006-10-08 12:43:06.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/video_filter/marq.c vlc-0.8.6-svn20061008.debian/modules/video_filter/marq.c
--- vlc-0.8.6-svn20060918.debian/modules/video_filter/marq.c	2006-09-18 06:28:28.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/video_filter/marq.c	2006-09-21 11:50:22.000000000 -0400
@@ -2,7 +2,7 @@
  * marq.c : marquee display video plugin for vlc
  *****************************************************************************
  * Copyright (C) 2003-2005 the VideoLAN team
- * $Id: marq.c 15002 2006-03-31 16:12:31Z fkuehne $
+ * $Id: marq.c 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Mark Moriarty
  *
@@ -149,7 +149,6 @@
 {
     filter_t *p_filter = (filter_t *)p_this;
     filter_sys_t *p_sys;
-    vlc_object_t *p_input;
 
     /* Allocate structure */
     p_sys = p_filter->p_sys = malloc( sizeof( filter_sys_t ) );
@@ -159,36 +158,26 @@
         return VLC_ENOMEM;
     }
 
-    /* Hook used for callback variables */
-    p_input = vlc_object_find( p_this, VLC_OBJECT_INPUT, FIND_ANYWHERE );
-    if( !p_input )
-    {
-        return VLC_ENOOBJ;
-    }
-
     p_sys->p_style = malloc( sizeof( text_style_t ) );
     memcpy( p_sys->p_style, &default_text_style, sizeof( text_style_t ) );
 
-    p_sys->i_xoff = var_CreateGetInteger( p_input->p_libvlc , "marq-x" );
-    p_sys->i_yoff = var_CreateGetInteger( p_input->p_libvlc , "marq-y" );
-    p_sys->i_timeout = var_CreateGetInteger( p_input->p_libvlc , "marq-timeout" );
-    p_sys->i_pos = var_CreateGetInteger( p_input->p_libvlc , "marq-position" );
-    p_sys->psz_marquee =  var_CreateGetString( p_input->p_libvlc, "marq-marquee" );
-    p_sys->p_style->i_font_alpha = 255 - var_CreateGetInteger( p_input->p_libvlc , "marq-opacity" );
-    p_sys->p_style->i_font_color = var_CreateGetInteger( p_input->p_libvlc , "marq-color" );
-    p_sys->p_style->i_font_size  = var_CreateGetInteger( p_input->p_libvlc , "marq-size" );
-
-    var_AddCallback( p_input->p_libvlc, "marq-x", MarqueeCallback, p_sys );
-    var_AddCallback( p_input->p_libvlc, "marq-y", MarqueeCallback, p_sys );
-    var_AddCallback( p_input->p_libvlc, "marq-marquee", MarqueeCallback, p_sys );
-    var_AddCallback( p_input->p_libvlc, "marq-timeout", MarqueeCallback, p_sys );
-    var_AddCallback( p_input->p_libvlc, "marq-position", MarqueeCallback, p_sys );
-    var_AddCallback( p_input->p_libvlc, "marq-color", MarqueeCallback, p_sys );
-    var_AddCallback( p_input->p_libvlc, "marq-opacity", MarqueeCallback, p_sys );
-    var_AddCallback( p_input->p_libvlc, "marq-size", MarqueeCallback, p_sys );
-
-    vlc_object_release( p_input );
-
+    p_sys->i_xoff = var_CreateGetInteger( p_filter->p_libvlc , "marq-x" );
+    p_sys->i_yoff = var_CreateGetInteger( p_filter->p_libvlc , "marq-y" );
+    p_sys->i_timeout = var_CreateGetInteger( p_filter->p_libvlc , "marq-timeout" );
+    p_sys->i_pos = var_CreateGetInteger( p_filter->p_libvlc , "marq-position" );
+    p_sys->psz_marquee =  var_CreateGetString( p_filter->p_libvlc, "marq-marquee" );
+    p_sys->p_style->i_font_alpha = 255 - var_CreateGetInteger( p_filter->p_libvlc , "marq-opacity" );
+    p_sys->p_style->i_font_color = var_CreateGetInteger( p_filter->p_libvlc , "marq-color" );
+    p_sys->p_style->i_font_size  = var_CreateGetInteger( p_filter->p_libvlc , "marq-size" );
+
+    var_AddCallback( p_filter->p_libvlc, "marq-x", MarqueeCallback, p_sys );
+    var_AddCallback( p_filter->p_libvlc, "marq-y", MarqueeCallback, p_sys );
+    var_AddCallback( p_filter->p_libvlc, "marq-marquee", MarqueeCallback, p_sys );
+    var_AddCallback( p_filter->p_libvlc, "marq-timeout", MarqueeCallback, p_sys );
+    var_AddCallback( p_filter->p_libvlc, "marq-position", MarqueeCallback, p_sys );
+    var_AddCallback( p_filter->p_libvlc, "marq-color", MarqueeCallback, p_sys );
+    var_AddCallback( p_filter->p_libvlc, "marq-opacity", MarqueeCallback, p_sys );
+    var_AddCallback( p_filter->p_libvlc, "marq-size", MarqueeCallback, p_sys );
 
     /* Misc init */
     p_filter->pf_sub_filter = Filter;
@@ -204,37 +193,29 @@
 {
     filter_t *p_filter = (filter_t *)p_this;
     filter_sys_t *p_sys = p_filter->p_sys;
-    vlc_object_t *p_input;
 
     if( p_sys->p_style ) free( p_sys->p_style );
     if( p_sys->psz_marquee ) free( p_sys->psz_marquee );
     free( p_sys );
 
     /* Delete the marquee variables */
-    p_input = vlc_object_find( p_this, VLC_OBJECT_INPUT, FIND_ANYWHERE );
-    if( !p_input )
-    {
-        return;
-    }
-    var_DelCallback( p_input->p_libvlc, "marq-x", MarqueeCallback, p_sys );
-    var_DelCallback( p_input->p_libvlc, "marq-y", MarqueeCallback, p_sys );
-    var_DelCallback( p_input->p_libvlc, "marq-marquee", MarqueeCallback, p_sys );
-    var_DelCallback( p_input->p_libvlc, "marq-timeout", MarqueeCallback, p_sys );
-    var_DelCallback( p_input->p_libvlc, "marq-position", MarqueeCallback, p_sys );
-    var_DelCallback( p_input->p_libvlc, "marq-color", MarqueeCallback, p_sys );
-    var_DelCallback( p_input->p_libvlc, "marq-opacity", MarqueeCallback, p_sys );
-    var_DelCallback( p_input->p_libvlc, "marq-size", MarqueeCallback, p_sys );
-
-    var_Destroy( p_input->p_libvlc , "marq-marquee" );
-    var_Destroy( p_input->p_libvlc , "marq-x" );
-    var_Destroy( p_input->p_libvlc , "marq-y" );
-    var_Destroy( p_input->p_libvlc , "marq-timeout" );
-    var_Destroy( p_input->p_libvlc , "marq-position" );
-    var_Destroy( p_input->p_libvlc , "marq-color");
-    var_Destroy( p_input->p_libvlc , "marq-opacity");
-    var_Destroy( p_input->p_libvlc , "marq-size");
-
-    vlc_object_release( p_input );
+    var_DelCallback( p_filter->p_libvlc, "marq-x", MarqueeCallback, p_sys );
+    var_DelCallback( p_filter->p_libvlc, "marq-y", MarqueeCallback, p_sys );
+    var_DelCallback( p_filter->p_libvlc, "marq-marquee", MarqueeCallback, p_sys );
+    var_DelCallback( p_filter->p_libvlc, "marq-timeout", MarqueeCallback, p_sys );
+    var_DelCallback( p_filter->p_libvlc, "marq-position", MarqueeCallback, p_sys );
+    var_DelCallback( p_filter->p_libvlc, "marq-color", MarqueeCallback, p_sys );
+    var_DelCallback( p_filter->p_libvlc, "marq-opacity", MarqueeCallback, p_sys );
+    var_DelCallback( p_filter->p_libvlc, "marq-size", MarqueeCallback, p_sys );
+
+    var_Destroy( p_filter->p_libvlc , "marq-marquee" );
+    var_Destroy( p_filter->p_libvlc , "marq-x" );
+    var_Destroy( p_filter->p_libvlc , "marq-y" );
+    var_Destroy( p_filter->p_libvlc , "marq-timeout" );
+    var_Destroy( p_filter->p_libvlc , "marq-position" );
+    var_Destroy( p_filter->p_libvlc , "marq-color");
+    var_Destroy( p_filter->p_libvlc , "marq-opacity");
+    var_Destroy( p_filter->p_libvlc , "marq-size");
 }
 
 /****************************************************************************
diff -uNr vlc-0.8.6-svn20060918.debian/modules/video_filter/swscale/Makefile.in vlc-0.8.6-svn20061008.debian/modules/video_filter/swscale/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/video_filter/swscale/Makefile.in	2006-09-18 06:31:02.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/video_filter/swscale/Makefile.in	2006-10-08 12:43:06.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/video_filter/time.c vlc-0.8.6-svn20061008.debian/modules/video_filter/time.c
--- vlc-0.8.6-svn20060918.debian/modules/video_filter/time.c	2006-09-18 06:28:28.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/video_filter/time.c	2006-09-21 11:50:22.000000000 -0400
@@ -2,7 +2,7 @@
  * time.c : time display video plugin for vlc
  *****************************************************************************
  * Copyright (C) 2003-2005 the VideoLAN team
- * $Id: time.c 15002 2006-03-31 16:12:31Z fkuehne $
+ * $Id: time.c 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Sigmund Augdal Helberg <dnumgis@videolan.org>
  *
@@ -132,7 +132,6 @@
 {
     filter_t *p_filter = (filter_t *)p_this;
     filter_sys_t *p_sys;
-    vlc_object_t *p_input;
 
     /* Allocate structure */
     p_sys = p_filter->p_sys = malloc( sizeof( filter_sys_t ) );
@@ -141,34 +140,27 @@
         msg_Err( p_filter, "out of memory" );
         return VLC_ENOMEM;
     }
-    /* Hook used for callback variables */
-    p_input = vlc_object_find( p_this, VLC_OBJECT_INPUT, FIND_ANYWHERE );
-    if( !p_input )
-    {
-        return VLC_ENOOBJ;
-    }
 
     p_sys->p_style = malloc( sizeof( text_style_t ) );
     memcpy( p_sys->p_style, &default_text_style, sizeof( text_style_t ) );
 
-    p_sys->i_xoff = var_CreateGetInteger( p_input->p_libvlc , "time-x" );
-    p_sys->i_yoff = var_CreateGetInteger( p_input->p_libvlc , "time-y" );
-    p_sys->psz_format = var_CreateGetString( p_input->p_libvlc, "time-format" );
-    p_sys->i_pos = var_CreateGetInteger( p_input->p_libvlc , "time-position" );
+    /* Hook used for callback variables */
+    p_sys->i_xoff = var_CreateGetInteger( p_filter->p_libvlc , "time-x" );
+    p_sys->i_yoff = var_CreateGetInteger( p_filter->p_libvlc , "time-y" );
+    p_sys->psz_format = var_CreateGetString( p_filter->p_libvlc, "time-format" );
+    p_sys->i_pos = var_CreateGetInteger( p_filter->p_libvlc , "time-position" );
     
-    p_sys->p_style->i_font_alpha = 255 - var_CreateGetInteger( p_input->p_libvlc , "time-opacity" );
-    p_sys->p_style->i_font_color = var_CreateGetInteger( p_input->p_libvlc , "time-color" );
-    p_sys->p_style->i_font_size = var_CreateGetInteger( p_input->p_libvlc , "time-size" );
+    p_sys->p_style->i_font_alpha = 255 - var_CreateGetInteger( p_filter->p_libvlc , "time-opacity" );
+    p_sys->p_style->i_font_color = var_CreateGetInteger( p_filter->p_libvlc , "time-color" );
+    p_sys->p_style->i_font_size = var_CreateGetInteger( p_filter->p_libvlc , "time-size" );
    
-    var_AddCallback( p_input->p_libvlc, "time-x", TimeCallback, p_sys );
-    var_AddCallback( p_input->p_libvlc, "time-y", TimeCallback, p_sys );
-    var_AddCallback( p_input->p_libvlc, "time-format", TimeCallback, p_sys );
-    var_AddCallback( p_input->p_libvlc, "time-position", TimeCallback, p_sys );
-    var_AddCallback( p_input->p_libvlc, "time-color", TimeCallback, p_sys );
-    var_AddCallback( p_input->p_libvlc, "time-opacity", TimeCallback, p_sys );
-    var_AddCallback( p_input->p_libvlc, "time-size", TimeCallback, p_sys );
-
-    vlc_object_release( p_input );
+    var_AddCallback( p_filter->p_libvlc, "time-x", TimeCallback, p_sys );
+    var_AddCallback( p_filter->p_libvlc, "time-y", TimeCallback, p_sys );
+    var_AddCallback( p_filter->p_libvlc, "time-format", TimeCallback, p_sys );
+    var_AddCallback( p_filter->p_libvlc, "time-position", TimeCallback, p_sys );
+    var_AddCallback( p_filter->p_libvlc, "time-color", TimeCallback, p_sys );
+    var_AddCallback( p_filter->p_libvlc, "time-opacity", TimeCallback, p_sys );
+    var_AddCallback( p_filter->p_libvlc, "time-size", TimeCallback, p_sys );
 
     /* Misc init */
     p_filter->pf_sub_filter = Filter;
@@ -183,26 +175,19 @@
 {
     filter_t *p_filter = (filter_t *)p_this;
     filter_sys_t *p_sys = p_filter->p_sys;
-    vlc_object_t *p_input;
 
     if( p_sys->p_style ) free( p_sys->p_style );
     if( p_sys->psz_format ) free( p_sys->psz_format );
     free( p_sys );
+
     /* Delete the time variables */
-    p_input = vlc_object_find( p_this, VLC_OBJECT_INPUT, FIND_ANYWHERE );
-    if( !p_input )
-    {
-        return;
-    }
-    var_Destroy( p_input->p_libvlc , "time-format" );
-    var_Destroy( p_input->p_libvlc , "time-x" );
-    var_Destroy( p_input->p_libvlc , "time-y" );
-    var_Destroy( p_input->p_libvlc , "time-position" );
-    var_Destroy( p_input->p_libvlc , "time-color");
-    var_Destroy( p_input->p_libvlc , "time-opacity");
-    var_Destroy( p_input->p_libvlc , "time-size");
-   
-    vlc_object_release( p_input );
+    var_Destroy( p_filter->p_libvlc , "time-format" );
+    var_Destroy( p_filter->p_libvlc , "time-x" );
+    var_Destroy( p_filter->p_libvlc , "time-y" );
+    var_Destroy( p_filter->p_libvlc , "time-position" );
+    var_Destroy( p_filter->p_libvlc , "time-color");
+    var_Destroy( p_filter->p_libvlc , "time-opacity");
+    var_Destroy( p_filter->p_libvlc , "time-size");
 }
 
 static char *FormatTime(char *tformat )
diff -uNr vlc-0.8.6-svn20060918.debian/modules/video_output/directx/directx.c vlc-0.8.6-svn20061008.debian/modules/video_output/directx/directx.c
--- vlc-0.8.6-svn20060918.debian/modules/video_output/directx/directx.c	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/video_output/directx/directx.c	2006-10-04 09:47:07.000000000 -0400
@@ -2,7 +2,7 @@
  * vout.c: Windows DirectX video output display method
  *****************************************************************************
  * Copyright (C) 2001-2004 the VideoLAN team
- * $Id: directx.c 15002 2006-03-31 16:12:31Z fkuehne $
+ * $Id: directx.c 16931 2006-10-03 09:04:50Z damienf $
  *
  * Authors: Gildas Bazin <gbazin@videolan.org>
  *
@@ -58,11 +58,26 @@
 #include "vout.h"
 
 /*****************************************************************************
+ * picture_sys_t: direct buffer method descriptor
+ *****************************************************************************
+ * This structure is part of the picture descriptor, it describes the
+ * DirectX specific properties of a direct buffer.
+ *****************************************************************************/
+struct picture_sys_t
+{
+    LPDIRECTDRAWSURFACE2 p_surface;
+    LPDIRECTDRAWSURFACE2 p_front_surface;
+    DDSURFACEDESC        ddsd;
+};
+
+/*****************************************************************************
  * DirectDraw GUIDs.
  * Defining them here allows us to get rid of the dxguid library during
  * the linking stage.
  *****************************************************************************/
 #include <initguid.h>
+#undef GUID_EXT
+#define GUID_EXT
 DEFINE_GUID( IID_IDirectDraw2, 0xB3A6F3E0,0x2B43,0x11CF,0xA2,0xDE,0x00,0xAA,0x00,0xB9,0x33,0x56 );
 DEFINE_GUID( IID_IDirectDrawSurface2, 0x57805885,0x6eec,0x11cf,0x94,0x41,0xa8,0x23,0x03,0xc1,0x0e,0x27 );
 
@@ -908,7 +923,7 @@
                     rect.left = monitor_info.rcWork.left;
                     rect.top = monitor_info.rcWork.top;
                     msg_Dbg( p_vout, "DirectXEnumCallback: setting window "
-                             "position to %d,%d", rect.left, rect.top );
+                             "position to %ld,%ld", rect.left, rect.top );
                     SetWindowPos( p_vout->p_sys->hwnd, NULL,
                                   rect.left, rect.top, 0, 0,
                                   SWP_NOSIZE | SWP_NOZORDER | SWP_NOACTIVATE );
@@ -1040,7 +1055,7 @@
         p_vout->p_sys->rect_display.bottom = GetSystemMetrics(SM_CYSCREEN);
     }
 
-    msg_Dbg( p_vout, "screen dimensions (%ix%i,%ix%i)",
+    msg_Dbg( p_vout, "screen dimensions (%lix%li,%lix%li)",
              p_vout->p_sys->rect_display.left,
              p_vout->p_sys->rect_display.top,
              p_vout->p_sys->rect_display.right,
diff -uNr vlc-0.8.6-svn20060918.debian/modules/video_output/directx/events.c vlc-0.8.6-svn20061008.debian/modules/video_output/directx/events.c
--- vlc-0.8.6-svn20060918.debian/modules/video_output/directx/events.c	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/video_output/directx/events.c	2006-10-04 09:47:07.000000000 -0400
@@ -2,7 +2,7 @@
  * events.c: Windows DirectX video output events handler
  *****************************************************************************
  * Copyright (C) 2001-2004 the VideoLAN team
- * $Id: events.c 16442 2006-08-30 22:15:52Z hartman $
+ * $Id: events.c 16931 2006-10-03 09:04:50Z damienf $
  *
  * Authors: Gildas Bazin <gbazin@videolan.org>
  *
@@ -44,7 +44,12 @@
 #include <windowsx.h>
 #include <shellapi.h>
 
+#ifdef MODULE_NAME_IS_vout_directx
 #include <ddraw.h>
+#endif
+#ifdef MODULE_NAME_IS_glwin32
+#include <GL/gl.h>
+#endif
 
 #include "vlc_keys.h"
 #include "vout.h"
@@ -261,7 +266,7 @@
                     val.i_int |= KEY_MODIFIER_ALT;
                 }
 
-                var_Set( p_event->p_vlc, "key-pressed", val );
+                var_Set( p_event->p_libvlc, "key-pressed", val );
             }
             break;
 
@@ -289,7 +294,7 @@
                     val.i_int |= KEY_MODIFIER_ALT;
                 }
 
-                var_Set( p_event->p_vlc, "key-pressed", val );
+                var_Set( p_event->p_libvlc, "key-pressed", val );
             }
             break;
 
@@ -301,7 +306,8 @@
 
 #ifdef MODULE_NAME_IS_glwin32
                 val.psz_string = strdup( VOUT_TITLE " (OpenGL output)" );
-#else
+#endif
+#ifdef MODULE_NAME_IS_vout_directx
                 if( p_event->p_vout->p_sys->b_using_overlay ) val.psz_string = 
                 strdup( VOUT_TITLE " (hardware YUV overlay DirectX output)" );
                 else if( p_event->p_vout->p_sys->b_hw_yuv ) val.psz_string = 
@@ -421,7 +427,7 @@
          * then fine, otherwise return with an error. */
         if( !GetClassInfo( hInstance, _T("VLC DirectX"), &wndclass ) )
         {
-            msg_Err( p_vout, "DirectXCreateWindow RegisterClass FAILED" );
+            msg_Err( p_vout, "DirectXCreateWindow RegisterClass FAILED (err=%lu)", GetLastError() );
             return VLC_EGENERIC;
         }
     }
@@ -436,7 +442,7 @@
          * then fine, otherwise return with an error. */
         if( !GetClassInfo( hInstance, _T("VLC DirectX video"), &wndclass ) )
         {
-            msg_Err( p_vout, "DirectXCreateWindow RegisterClass FAILED" );
+            msg_Err( p_vout, "DirectXCreateWindow RegisterClass FAILED (err=%lu)", GetLastError() );
             return VLC_EGENERIC;
         }
     }
@@ -481,9 +487,9 @@
                     _T(VOUT_TITLE) _T(" (DirectX Output)"),  /* window title */
                     i_style,                                 /* window style */
                     (p_vout->p_sys->i_window_x < 0) ? CW_USEDEFAULT :
-                        p_vout->p_sys->i_window_x,   /* default X coordinate */
+                        (UINT)p_vout->p_sys->i_window_x,   /* default X coordinate */
                     (p_vout->p_sys->i_window_y < 0) ? CW_USEDEFAULT :
-                        p_vout->p_sys->i_window_y,   /* default Y coordinate */
+                        (UINT)p_vout->p_sys->i_window_y,   /* default Y coordinate */
                     rect_window.right - rect_window.left,    /* window width */
                     rect_window.bottom - rect_window.top,   /* window height */
                     p_vout->p_sys->hparent,                 /* parent window */
@@ -493,7 +499,7 @@
 
     if( !p_vout->p_sys->hwnd )
     {
-        msg_Warn( p_vout, "DirectXCreateWindow create window FAILED" );
+        msg_Warn( p_vout, "DirectXCreateWindow create window FAILED (err=%lu)", GetLastError() );
         return VLC_EGENERIC;
     }
 
@@ -519,20 +525,33 @@
                             NULL, NULL, hInstance, NULL );
     }
 
-    /* Now display the window */
-    ShowWindow( p_vout->p_sys->hwnd, SW_SHOW );
-
-    /* Create video sub-window. This sub window will always exactly match
-     * the size of the video, which allows us to use crazy overlay colorkeys
-     * without having them shown outside of the video area. */
-    SendMessage( p_vout->p_sys->hwnd, WM_VLC_CREATE_VIDEO_WIN, 0, 0 );
-
     /* Append a "Always On Top" entry in the system menu */
     hMenu = GetSystemMenu( p_vout->p_sys->hwnd, FALSE );
     AppendMenu( hMenu, MF_SEPARATOR, 0, _T("") );
     AppendMenu( hMenu, MF_STRING | MF_UNCHECKED,
                        IDM_TOGGLE_ON_TOP, _T("Always on &Top") );
 
+    /* Create video sub-window. This sub window will always exactly match
+     * the size of the video, which allows us to use crazy overlay colorkeys
+     * without having them shown outside of the video area. */
+    p_vout->p_sys->hvideownd =
+    CreateWindow( _T("VLC DirectX video"), _T(""),   /* window class */
+        WS_CHILD | WS_VISIBLE,                   /* window style */
+        0, 0,
+        p_vout->render.i_width,         /* default width */
+        p_vout->render.i_height,        /* default height */
+        p_vout->p_sys->hwnd,                    /* parent window */
+        NULL, hInstance,
+        (LPVOID)p_vout );            /* send p_vout to WM_CREATE */
+
+    if( !p_vout->p_sys->hvideownd )
+    msg_Warn( p_vout, "can't create video sub-window" );
+    else
+    msg_Dbg( p_vout, "created video sub-window" );
+
+    /* Now display the window */
+    ShowWindow( p_vout->p_sys->hwnd, SW_SHOW );
+
     return VLC_SUCCESS;
 }
 
@@ -613,6 +632,7 @@
     rect_dest.top = point.y + i_y;
     rect_dest.bottom = rect_dest.top + i_height;
 
+#ifdef MODULE_NAME_IS_vout_directx
     /* Apply overlay hardware constraints */
     if( p_vout->p_sys->b_using_overlay )
     {
@@ -626,6 +646,7 @@
                 p_vout->p_sys->i_align_dest_size / 2 ) & 
                 ~p_vout->p_sys->i_align_dest_size) + rect_dest.left;
     }
+#endif
 
     /* UpdateOverlay directdraw function doesn't automatically clip to the
      * display size so we need to do it otherwise it will fail */
@@ -675,6 +696,7 @@
       (rect_dest.bottom - rect_dest_clipped.bottom) *
       p_vout->fmt_out.i_visible_height / (rect_dest.bottom - rect_dest.top);
 
+#ifdef MODULE_NAME_IS_vout_directx
     /* Apply overlay hardware constraints */
     if( p_vout->p_sys->b_using_overlay )
     {
@@ -689,6 +711,7 @@
                 p_vout->p_sys->i_align_src_size / 2 ) & 
                 ~p_vout->p_sys->i_align_src_size) + rect_src_clipped.left;
     }
+#endif
 
 #if 0
     msg_Dbg( p_vout, "DirectXUpdateRects image_src_clipped"
@@ -704,8 +727,10 @@
     rect_dest_clipped.top -= p_vout->p_sys->rect_display.top;
     rect_dest_clipped.bottom -= p_vout->p_sys->rect_display.top;
 
+#ifdef MODULE_NAME_IS_vout_directx
     if( p_vout->p_sys->b_using_overlay )
         E_(DirectXUpdateOverlay)( p_vout );
+#endif
 
     /* Signal the change in size/position */
     p_vout->p_sys->i_changes |= DX_POSITION_CHANGE;
@@ -737,10 +762,17 @@
         /* Store p_vout for future use */
         p_vout = (vout_thread_t *)((CREATESTRUCT *)lParam)->lpCreateParams;
         SetWindowLongPtr( hwnd, GWLP_USERDATA, (LONG_PTR)p_vout );
+        return TRUE;
     }
     else
     {
         p_vout = (vout_thread_t *)GetWindowLongPtr( hwnd, GWLP_USERDATA );
+        if( !p_vout )
+        {
+            /* Hmmm mozilla does manage somehow to save the pointer to our
+             * windowproc and still calls it after the vout has been closed. */
+            return DefWindowProc(hwnd, message, wParam, lParam);
+        }
     }
 
     /* Catch the screensaver and the monitor turn-off */
@@ -751,13 +783,6 @@
         return 0; /* this stops them from happening */
     }
 
-    if( !p_vout )
-    {
-        /* Hmmm mozilla does manage somehow to save the pointer to our
-         * windowproc and still calls it after the vout has been closed. */
-        return DefWindowProc(hwnd, message, wParam, lParam);
-    }
-
     if( hwnd == p_vout->p_sys->hvideownd )
         return DefWindowProc(hwnd, message, wParam, lParam);
 
@@ -808,30 +833,12 @@
         }
         break;
 
-    case WM_VLC_CREATE_VIDEO_WIN:
-        /* Create video sub-window */
-        p_vout->p_sys->hvideownd =
-            CreateWindow( _T("VLC DirectX video"), _T(""),   /* window class */
-                    WS_CHILD | WS_VISIBLE,                   /* window style */
-                    CW_USEDEFAULT, CW_USEDEFAULT,     /* default coordinates */
-                    CW_USEDEFAULT, CW_USEDEFAULT,
-                    hwnd,                                   /* parent window */
-                    NULL, GetModuleHandle(NULL),
-                    (LPVOID)p_vout );            /* send p_vout to WM_CREATE */
-
-        if( !p_vout->p_sys->hvideownd )
-            msg_Warn( p_vout, "can't create video sub-window" );
-        else
-            msg_Dbg( p_vout, "created video sub-window" );
-        break;
-
     case WM_PAINT:
     case WM_NCPAINT:
     case WM_ERASEBKGND:
         /* We do not want to relay these messages to the parent window
          * because we rely on the background color for the overlay. */
         return DefWindowProc(hwnd, message, wParam, lParam);
-        break;
 
     default:
         //msg_Dbg( p_vout, "WinProc WM Default %i", message );
diff -uNr vlc-0.8.6-svn20060918.debian/modules/video_output/directx/glwin32.c vlc-0.8.6-svn20061008.debian/modules/video_output/directx/glwin32.c
--- vlc-0.8.6-svn20060918.debian/modules/video_output/directx/glwin32.c	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/video_output/directx/glwin32.c	2006-10-04 09:47:07.000000000 -0400
@@ -2,7 +2,7 @@
  * glwin32.c: Windows OpenGL provider
  *****************************************************************************
  * Copyright (C) 2001-2004 the VideoLAN team
- * $Id: glwin32.c 15002 2006-03-31 16:12:31Z fkuehne $
+ * $Id: glwin32.c 16931 2006-10-03 09:04:50Z damienf $
  *
  * Authors: Gildas Bazin <gbazin@videolan.org>
  *
@@ -104,10 +104,6 @@
     p_vout->pf_manage = Manage;
     p_vout->pf_swap = GLSwapBuffers;
 
-    p_vout->p_sys->p_ddobject = NULL;
-    p_vout->p_sys->p_display = NULL;
-    p_vout->p_sys->p_current_surface = NULL;
-    p_vout->p_sys->p_clipper = NULL;
     p_vout->p_sys->hwnd = p_vout->p_sys->hvideownd = NULL;
     p_vout->p_sys->hparent = p_vout->p_sys->hfswnd = NULL;
     p_vout->p_sys->i_changes = 0;
@@ -485,8 +481,3 @@
 {
     SwapBuffers( p_vout->p_sys->hGLDC );
 }
-
-int E_(DirectXUpdateOverlay)( vout_thread_t *p_vout )
-{
-    return 1;
-}
diff -uNr vlc-0.8.6-svn20060918.debian/modules/video_output/directx/Makefile.in vlc-0.8.6-svn20061008.debian/modules/video_output/directx/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/video_output/directx/Makefile.in	2006-09-18 06:31:03.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/video_output/directx/Makefile.in	2006-10-08 12:43:08.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/video_output/directx/vout.h vlc-0.8.6-svn20061008.debian/modules/video_output/directx/vout.h
--- vlc-0.8.6-svn20060918.debian/modules/video_output/directx/vout.h	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/video_output/directx/vout.h	2006-10-04 09:47:07.000000000 -0400
@@ -2,7 +2,7 @@
  * vout.h: Windows DirectX video output header file
  *****************************************************************************
  * Copyright (C) 2001-2004 the VideoLAN team
- * $Id: vout.h 13905 2006-01-12 23:10:04Z dionoea $
+ * $Id: vout.h 16931 2006-10-03 09:04:50Z damienf $
  *
  * Authors: Gildas Bazin <gbazin@videolan.org>
  *
@@ -40,12 +40,6 @@
  *****************************************************************************/
 struct vout_sys_t
 {
-    LPDIRECTDRAW2        p_ddobject;                    /* DirectDraw object */
-    LPDIRECTDRAWSURFACE2 p_display;                        /* Display device */
-    LPDIRECTDRAWSURFACE2 p_current_surface;   /* surface currently displayed */
-    LPDIRECTDRAWCLIPPER  p_clipper;             /* clipper used for blitting */
-    HINSTANCE            hddraw_dll;       /* handle of the opened ddraw dll */
-
     HWND                 hwnd;                  /* Handle of the main window */
     HWND                 hvideownd;        /* Handle of the video sub-window */
     HWND                 hparent;             /* Handle of the parent window */
@@ -58,15 +52,13 @@
     HMONITOR             (WINAPI* MonitorFromWindow)( HWND, DWORD );
     BOOL                 (WINAPI* GetMonitorInfo)( HMONITOR, LPMONITORINFO );
 
-    vlc_bool_t   b_using_overlay;         /* Are we using an overlay surface */
-    vlc_bool_t   b_use_sysmem;   /* Should we use system memory for surfaces */
-    vlc_bool_t   b_hw_yuv;    /* Should we use hardware YUV->RGB conversions */
-    vlc_bool_t   b_3buf_overlay;   /* Should we use triple buffered overlays */
-
     /* size of the display */
     RECT         rect_display;
     int          i_display_depth;
 
+    /* size of the overall window (including black bands) */
+    RECT         rect_parent;
+
     /* Window position and size */
     int          i_window_x;
     int          i_window_y;
@@ -74,66 +66,66 @@
     int          i_window_height;
     int          i_window_style;
 
+    volatile uint16_t i_changes;        /* changes made to the video display */
+
+    /* Mouse */
+    volatile vlc_bool_t b_cursor_hidden;
+    volatile mtime_t    i_lastmoved;
+
+    /* Misc */
+    vlc_bool_t      b_on_top_change;
+
+    vlc_bool_t      b_wallpaper;
+
+    /* screensaver system settings to be restored when vout is closed */
+    UINT i_spi_lowpowertimeout;
+    UINT i_spi_powerofftimeout;
+    UINT i_spi_screensavetimeout;
+
     /* Coordinates of src and dest images (used when blitting to display) */
     RECT         rect_src;
     RECT         rect_src_clipped;
     RECT         rect_dest;
     RECT         rect_dest_clipped;
-    RECT         rect_parent;
 
+#ifdef MODULE_NAME_IS_vout_directx
     /* Overlay alignment restrictions */
     int          i_align_src_boundary;
     int          i_align_src_size;
     int          i_align_dest_boundary;
     int          i_align_dest_size;
 
+    vlc_bool_t   b_using_overlay;         /* Are we using an overlay surface */
+    vlc_bool_t   b_use_sysmem;   /* Should we use system memory for surfaces */
+    vlc_bool_t   b_hw_yuv;    /* Should we use hardware YUV->RGB conversions */
+    vlc_bool_t   b_3buf_overlay;   /* Should we use triple buffered overlays */
+
     /* DDraw capabilities */
     int          b_caps_overlay_clipping;
 
     int          i_rgb_colorkey;      /* colorkey in RGB used by the overlay */
     int          i_colorkey;                 /* colorkey used by the overlay */
 
-    volatile uint16_t i_changes;        /* changes made to the video display */
-
-    /* Mouse */
-    volatile vlc_bool_t b_cursor_hidden;
-    volatile mtime_t    i_lastmoved;
-
-    /* Misc */
-    vlc_bool_t      b_on_top_change;
-
-    vlc_bool_t      b_wallpaper;
     COLORREF        color_bkg;
     COLORREF        color_bkgtxt;
 
+    LPDIRECTDRAW2        p_ddobject;                    /* DirectDraw object */
+    LPDIRECTDRAWSURFACE2 p_display;                        /* Display device */
+    LPDIRECTDRAWSURFACE2 p_current_surface;   /* surface currently displayed */
+    LPDIRECTDRAWCLIPPER  p_clipper;             /* clipper used for blitting */
+    HINSTANCE            hddraw_dll;       /* handle of the opened ddraw dll */
+#endif
+
 #ifdef MODULE_NAME_IS_glwin32
     HDC hGLDC;
     HGLRC hGLRC;
 #endif
 
-    /* screensaver system settings to be restored when vout is closed */
-    UINT i_spi_lowpowertimeout;
-    UINT i_spi_powerofftimeout;
-    UINT i_spi_screensavetimeout;
-
     event_thread_t *p_event;
     vlc_mutex_t    lock;
 };
 
 /*****************************************************************************
- * picture_sys_t: direct buffer method descriptor
- *****************************************************************************
- * This structure is part of the picture descriptor, it describes the
- * DirectX specific properties of a direct buffer.
- *****************************************************************************/
-struct picture_sys_t
-{
-    LPDIRECTDRAWSURFACE2 p_surface;
-    DDSURFACEDESC        ddsd;
-    LPDIRECTDRAWSURFACE2 p_front_surface;
-};
-
-/*****************************************************************************
  * Prototypes from vout.c
  *****************************************************************************/
 int E_(DirectXUpdateOverlay)( vout_thread_t *p_vout );
@@ -149,8 +141,7 @@
  *****************************************************************************/
 #define WM_VLC_HIDE_MOUSE WM_APP
 #define WM_VLC_SHOW_MOUSE WM_APP + 1
-#define WM_VLC_CREATE_VIDEO_WIN WM_APP + 2
-#define WM_VLC_CHANGE_TEXT WM_APP + 3
+#define WM_VLC_CHANGE_TEXT WM_APP + 2
 #define IDM_TOGGLE_ON_TOP WM_USER + 1
 #define DX_POSITION_CHANGE 0x1000
 #define DX_WALLPAPER_CHANGE 0x2000
diff -uNr vlc-0.8.6-svn20060918.debian/modules/video_output/Makefile.in vlc-0.8.6-svn20061008.debian/modules/video_output/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/video_output/Makefile.in	2006-09-18 06:31:03.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/video_output/Makefile.in	2006-10-08 12:43:07.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/video_output/qte/Makefile.in vlc-0.8.6-svn20061008.debian/modules/video_output/qte/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/video_output/qte/Makefile.in	2006-09-18 06:31:03.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/video_output/qte/Makefile.in	2006-10-08 12:43:08.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/video_output/sdl.c vlc-0.8.6-svn20061008.debian/modules/video_output/sdl.c
--- vlc-0.8.6-svn20060918.debian/modules/video_output/sdl.c	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/video_output/sdl.c	2006-10-08 12:40:55.000000000 -0400
@@ -2,7 +2,7 @@
  * sdl.c: SDL video output display method
  *****************************************************************************
  * Copyright (C) 1998-2001 the VideoLAN team
- * $Id: sdl.c 15002 2006-03-31 16:12:31Z fkuehne $
+ * $Id: sdl.c 16987 2006-10-08 12:54:12Z jpsaman $
  *
  * Authors: Samuel Hocevar <sam@zoy.org>
  *          Pierre Baillet <oct@zoy.org>
@@ -327,7 +327,7 @@
 {
     SDL_Event event;                                            /* SDL event */
     vlc_value_t val;
-    int i_width, i_height, i_x, i_y;
+    unsigned int i_width, i_height, i_x, i_y;
 
     /* Process events */
     while( SDL_PollEvent(&event) )
@@ -576,7 +576,7 @@
  *****************************************************************************/
 static void Display( vout_thread_t *p_vout, picture_t *p_pic )
 {
-    int x, y, w, h;
+    unsigned int x, y, w, h;
     SDL_Rect disp;
 
     vout_PlacePicture( p_vout, p_vout->p_sys->i_width, p_vout->p_sys->i_height,
diff -uNr vlc-0.8.6-svn20060918.debian/modules/video_output/x11/glx.c vlc-0.8.6-svn20061008.debian/modules/video_output/x11/glx.c
--- vlc-0.8.6-svn20060918.debian/modules/video_output/x11/glx.c	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/video_output/x11/glx.c	2006-10-08 12:40:55.000000000 -0400
@@ -2,7 +2,7 @@
  * glx.c: GLX OpenGL provider
  *****************************************************************************
  * Copyright (C) 2004 the VideoLAN team
- * $Id: glx.c 16442 2006-08-30 22:15:52Z hartman $
+ * $Id: glx.c 16987 2006-10-08 12:54:12Z jpsaman $
  *
  * Authors: Cyril Deguet <asmax@videolan.org>
  *          Gildas Bazin <gbazin@videolan.org>
@@ -339,7 +339,7 @@
 static void SwapBuffers( vout_thread_t *p_vout )
 {
     vout_sys_t *p_sys = p_vout->p_sys;
-    int i_width, i_height, i_x, i_y;
+    unsigned int i_width, i_height, i_x, i_y;
 
     vout_PlacePicture( p_vout, p_vout->p_sys->p_win->i_width,
                        p_vout->p_sys->p_win->i_height,
diff -uNr vlc-0.8.6-svn20060918.debian/modules/video_output/x11/Makefile.in vlc-0.8.6-svn20061008.debian/modules/video_output/x11/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/video_output/x11/Makefile.in	2006-09-18 06:31:04.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/video_output/x11/Makefile.in	2006-10-08 12:43:09.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/video_output/x11/xcommon.c vlc-0.8.6-svn20061008.debian/modules/video_output/x11/xcommon.c
--- vlc-0.8.6-svn20060918.debian/modules/video_output/x11/xcommon.c	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/video_output/x11/xcommon.c	2006-10-08 12:40:55.000000000 -0400
@@ -2,7 +2,7 @@
  * xcommon.c: Functions common to the X11 and XVideo plugins
  *****************************************************************************
  * Copyright (C) 1998-2006 the VideoLAN team
- * $Id: xcommon.c 15526 2006-05-02 19:21:23Z bigben $
+ * $Id: xcommon.c 16977 2006-10-08 09:41:25Z jpsaman $
  *
  * Authors: Vincent Seguin <seguin@via.ecp.fr>
  *          Sam Hocevar <sam@zoy.org>
@@ -356,7 +356,7 @@
  *****************************************************************************/
 static int InitVideo( vout_thread_t *p_vout )
 {
-    int i_index;
+    unsigned int i_index = 0;
     picture_t *p_pic;
 
     I_OUTPUTPICTURES = 0;
@@ -498,7 +498,7 @@
  *****************************************************************************/
 static void DisplayVideo( vout_thread_t *p_vout, picture_t *p_pic )
 {
-    int i_width, i_height, i_x, i_y;
+    unsigned int i_width, i_height, i_x, i_y;
 
     vout_PlacePicture( p_vout, p_vout->p_sys->p_win->i_width,
                        p_vout->p_sys->p_win->i_height,
@@ -791,7 +791,7 @@
         /* Mouse move */
         else if( xevent.type == MotionNotify )
         {
-            int i_width, i_height, i_x, i_y;
+            unsigned int i_width, i_height, i_x, i_y;
             vlc_value_t val;
 
             /* somewhat different use for vout_PlacePicture:
@@ -919,7 +919,7 @@
      */
     if( p_vout->i_changes & VOUT_SIZE_CHANGE )
     {
-        int i_width, i_height, i_x, i_y;
+        unsigned int i_width, i_height, i_x, i_y;
 
         p_vout->i_changes &= ~VOUT_SIZE_CHANGE;
 
@@ -1100,7 +1100,8 @@
     else
     {
         Window dummy1;
-        unsigned int dummy2, dummy3;
+        int dummy2, dummy3;
+        unsigned int dummy4, dummy5;
 
         /* Select events we are interested in. */
         XSelectInput( p_vout->p_sys->p_display, p_win->owner_window,
@@ -1111,7 +1112,7 @@
                       &dummy1, &dummy2, &dummy3,
                       &p_win->i_width,
                       &p_win->i_height,
-                      &dummy2, &dummy3 );
+                      &dummy4, &dummy5 );
 
         /* We are already configured */
         b_configure_notify = VLC_TRUE;
@@ -1806,7 +1807,8 @@
 {
     XvAdaptorInfo *p_adaptor;
     unsigned int i;
-    int i_adaptor, i_num_adaptors, i_requested_adaptor;
+    unsigned int i_adaptor, i_num_adaptors;
+    int i_requested_adaptor;
     int i_selected_port;
 
     switch( XvQueryExtension( p_vout->p_sys->p_display, &i, &i, &i, &i, &i ) )
@@ -1858,7 +1860,7 @@
 
         /* If we requested an adaptor and it's not this one, we aren't
          * interested */
-        if( i_requested_adaptor != -1 && i_adaptor != i_requested_adaptor )
+        if( i_requested_adaptor != -1 && ((int)i_adaptor != i_requested_adaptor) )
         {
             continue;
         }
@@ -2083,7 +2085,7 @@
                                     &xvisual_template, &i_count );
             if( p_xvisual == NULL )
             {
-            
+
                 msg_Err( p_vout, "no TrueColor visual available" );
                 return VLC_EGENERIC;
             }
@@ -2266,10 +2268,10 @@
     /* Create XImage. p_data will be automatically freed */
 #ifdef MODULE_NAME_IS_xvideo
     p_image = XvCreateImage( p_display, i_xvport, i_chroma,
-                             p_data, i_width, i_height );
+                             (char *)p_data, i_width, i_height );
 #elif defined(MODULE_NAME_IS_x11)
     p_image = XCreateImage( p_display, p_visual, i_depth, ZPixmap, 0,
-                            p_data, i_width, i_height, i_quantum, 0 );
+                            (char *)p_data, i_width, i_height, i_quantum, 0 );
 #endif
     if( p_image == NULL )
     {
@@ -2346,7 +2348,8 @@
     vlc_bool_t b_arg;
     unsigned int i_width, i_height;
     unsigned int *pi_width, *pi_height;
-
+    Drawable d = 0;
+    
     switch( i_query )
     {
         case VOUT_GET_SIZE:
@@ -2392,10 +2395,16 @@
 
        case VOUT_REPARENT:
             vlc_mutex_lock( &p_vout->p_sys->lock );
+            if( i_query == VOUT_REPARENT ) d = (Drawable)va_arg( args, int );
+            if( !d )
             XReparentWindow( p_vout->p_sys->p_display,
                              p_vout->p_sys->original_window.base_window,
                              DefaultRootWindow( p_vout->p_sys->p_display ),
                              0, 0 );
+            else
+            XReparentWindow( p_vout->p_sys->p_display,
+                             p_vout->p_sys->original_window.base_window,
+                             d, 0, 0); 
             XSync( p_vout->p_sys->p_display, False );
             p_vout->p_sys->original_window.owner_window = 0;
             vlc_mutex_unlock( &p_vout->p_sys->lock );
diff -uNr vlc-0.8.6-svn20060918.debian/modules/video_output/x11/xcommon.h vlc-0.8.6-svn20061008.debian/modules/video_output/x11/xcommon.h
--- vlc-0.8.6-svn20060918.debian/modules/video_output/x11/xcommon.h	2006-09-18 06:28:25.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/video_output/x11/xcommon.h	2006-10-08 12:40:55.000000000 -0400
@@ -2,7 +2,7 @@
  * xcommon.h: Defines common to the X11 and XVideo plugins
  *****************************************************************************
  * Copyright (C) 1998-2001 the VideoLAN team
- * $Id: xcommon.h 13905 2006-01-12 23:10:04Z dionoea $
+ * $Id: xcommon.h 16977 2006-10-08 09:41:25Z jpsaman $
  *
  * Authors: Vincent Seguin <seguin@via.ecp.fr>
  *          Samuel Hocevar <sam@zoy.org>
@@ -117,10 +117,10 @@
 #endif
 
     /* Screen saver properties */
-    unsigned int        i_ss_timeout;                             /* timeout */
-    unsigned int        i_ss_interval;           /* interval between changes */
-    unsigned int        i_ss_blanking;                      /* blanking mode */
-    unsigned int        i_ss_exposure;                      /* exposure mode */
+    int                 i_ss_timeout;                             /* timeout */
+    int                 i_ss_interval;           /* interval between changes */
+    int                 i_ss_blanking;                      /* blanking mode */
+    int                 i_ss_exposure;                      /* exposure mode */
 #ifdef DPMSINFO_IN_DPMS_H
     BOOL                b_ss_dpms;                              /* DPMS mode */
 #endif
diff -uNr vlc-0.8.6-svn20060918.debian/modules/visualization/galaktos/Makefile.in vlc-0.8.6-svn20061008.debian/modules/visualization/galaktos/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/visualization/galaktos/Makefile.in	2006-09-18 06:31:05.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/visualization/galaktos/Makefile.in	2006-10-08 12:43:10.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/visualization/Makefile.in vlc-0.8.6-svn20061008.debian/modules/visualization/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/visualization/Makefile.in	2006-09-18 06:31:04.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/visualization/Makefile.in	2006-10-08 12:43:09.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/modules/visualization/visual/Makefile.in vlc-0.8.6-svn20061008.debian/modules/visualization/visual/Makefile.in
--- vlc-0.8.6-svn20060918.debian/modules/visualization/visual/Makefile.in	2006-09-18 06:31:05.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/modules/visualization/visual/Makefile.in	2006-10-08 12:43:11.000000000 -0400
@@ -118,12 +118,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -131,6 +132,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -155,9 +158,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -234,7 +234,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -249,7 +251,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/mozilla/control/npolibvlc.cpp vlc-0.8.6-svn20061008.debian/mozilla/control/npolibvlc.cpp
--- vlc-0.8.6-svn20060918.debian/mozilla/control/npolibvlc.cpp	1969-12-31 19:00:00.000000000 -0500
+++ vlc-0.8.6-svn20061008.debian/mozilla/control/npolibvlc.cpp	2006-10-04 09:47:08.000000000 -0400
@@ -0,0 +1,1124 @@
+/*****************************************************************************
+ * npolibvlc.cpp: official Javascript APIs
+ *****************************************************************************
+ * Copyright (C) 2002-2006 the VideoLAN team
+ *
+ * Authors: Damien Fouilleul <Damien.Fouilleul@laposte.net>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
+ *****************************************************************************/
+
+#include "config.h"
+
+#include <stdio.h>
+#include <string.h>
+#include <stdlib.h>
+
+/* Mozilla stuff */
+#ifdef HAVE_MOZILLA_CONFIG_H
+#   include <mozilla-config.h>
+#endif
+
+#include "npolibvlc.h"
+#include "vlcplugin.h"
+
+/*
+** implementation of libvlc root object
+*/
+
+LibvlcRootNPObject::LibvlcRootNPObject(NPP instance, const NPClass *aClass) :
+        RuntimeNPObject(instance, aClass)
+{
+    audioObj = NPN_CreateObject(instance, RuntimeNPClass<LibvlcAudioNPObject>::getClass());
+    inputObj = NPN_CreateObject(instance, RuntimeNPClass<LibvlcInputNPObject>::getClass());
+    playlistObj = NPN_CreateObject(instance, RuntimeNPClass<LibvlcPlaylistNPObject>::getClass());
+    videoObj = NPN_CreateObject(instance,RuntimeNPClass<LibvlcVideoNPObject>::getClass());
+}
+
+LibvlcRootNPObject::~LibvlcRootNPObject()
+{
+    NPN_ReleaseObject(audioObj);
+    NPN_ReleaseObject(inputObj);
+    NPN_ReleaseObject(playlistObj);
+    NPN_ReleaseObject(videoObj);
+}
+
+const NPUTF8 * const LibvlcRootNPObject::propertyNames[] = 
+{
+    "audio",
+    "input",
+    "playlist",
+    "video",
+};
+
+const int LibvlcRootNPObject::propertyCount = sizeof(LibvlcRootNPObject::propertyNames)/sizeof(NPUTF8 *);
+
+enum LibvlcRootNPObjectPropertyIds
+{
+    ID_audio = 0,
+    ID_input,
+    ID_playlist,
+    ID_video,
+};
+
+RuntimeNPObject::InvokeResult LibvlcRootNPObject::getProperty(int index, NPVariant &result)
+{
+    switch( index )
+    {
+        case ID_audio:
+            OBJECT_TO_NPVARIANT(NPN_RetainObject(audioObj), result);
+            return INVOKERESULT_NO_ERROR;
+        case ID_input:
+            OBJECT_TO_NPVARIANT(NPN_RetainObject(inputObj), result);
+            return INVOKERESULT_NO_ERROR;
+        case ID_playlist:
+            OBJECT_TO_NPVARIANT(NPN_RetainObject(playlistObj), result);
+            return INVOKERESULT_NO_ERROR;
+        case ID_video:
+            OBJECT_TO_NPVARIANT(NPN_RetainObject(videoObj), result);
+            return INVOKERESULT_NO_ERROR;
+    }
+    return INVOKERESULT_GENERIC_ERROR;
+}
+
+const NPUTF8 * const LibvlcRootNPObject::methodNames[] =
+{
+    /* no methods */
+};
+
+const int LibvlcRootNPObject::methodCount = sizeof(LibvlcRootNPObject::methodNames)/sizeof(NPUTF8 *);
+
+/*
+** implementation of libvlc audio object
+*/
+
+const NPUTF8 * const LibvlcAudioNPObject::propertyNames[] = 
+{
+    "mute",
+    "volume",
+};
+
+const int LibvlcAudioNPObject::propertyCount = sizeof(LibvlcAudioNPObject::propertyNames)/sizeof(NPUTF8 *);
+
+enum LibvlcAudioNPObjectPropertyIds
+{
+    ID_mute,
+    ID_volume,
+};
+
+RuntimeNPObject::InvokeResult LibvlcAudioNPObject::getProperty(int index, NPVariant &result)
+{
+    VlcPlugin *p_plugin = reinterpret_cast<VlcPlugin *>(_instance->pdata);
+    if( p_plugin )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        switch( index )
+        {
+            case ID_mute:
+            {
+                vlc_bool_t muted = libvlc_audio_get_mute(p_plugin->getVLC(), &ex);
+                if( libvlc_exception_raised(&ex) )
+                {
+                    NPN_SetException(this, libvlc_exception_get_message(&ex));
+                    libvlc_exception_clear(&ex);
+                    return INVOKERESULT_GENERIC_ERROR;
+                }
+                BOOLEAN_TO_NPVARIANT(muted, result);
+                return INVOKERESULT_NO_ERROR;
+            }
+            case ID_volume:
+            {
+                int volume = libvlc_audio_get_volume(p_plugin->getVLC(), &ex);
+                if( libvlc_exception_raised(&ex) )
+                {
+                    NPN_SetException(this, libvlc_exception_get_message(&ex));
+                    libvlc_exception_clear(&ex);
+                    return INVOKERESULT_GENERIC_ERROR;
+                }
+                INT32_TO_NPVARIANT(volume, result);
+                return INVOKERESULT_NO_ERROR;
+            }
+        }
+    }
+    return INVOKERESULT_GENERIC_ERROR;
+}
+
+RuntimeNPObject::InvokeResult LibvlcAudioNPObject::setProperty(int index, const NPVariant &value)
+{
+    VlcPlugin *p_plugin = reinterpret_cast<VlcPlugin *>(_instance->pdata);
+    if( p_plugin )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        switch( index )
+        {
+            case ID_mute:
+                if( NPVARIANT_IS_BOOLEAN(value) )
+                {
+                    libvlc_audio_set_mute(p_plugin->getVLC(),
+                                          NPVARIANT_TO_BOOLEAN(value), &ex);
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    return INVOKERESULT_NO_ERROR;
+                }
+                return INVOKERESULT_INVALID_VALUE;
+            case ID_volume:
+                if( isNumberValue(value) )
+                {
+                    libvlc_audio_set_volume(p_plugin->getVLC(),
+                                            numberValue(value), &ex);
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    return INVOKERESULT_NO_ERROR;
+                }
+                return INVOKERESULT_INVALID_VALUE;
+        }
+    }
+    return INVOKERESULT_GENERIC_ERROR;
+}
+
+const NPUTF8 * const LibvlcAudioNPObject::methodNames[] =
+{
+    "toggleMute",
+};
+
+const int LibvlcAudioNPObject::methodCount = sizeof(LibvlcAudioNPObject::methodNames)/sizeof(NPUTF8 *);
+
+enum LibvlcAudioNPObjectMethodIds
+{
+    ID_togglemute,
+};
+
+RuntimeNPObject::InvokeResult LibvlcAudioNPObject::invoke(int index, const NPVariant *args, uint32_t argCount, NPVariant &result)
+{
+    VlcPlugin *p_plugin = reinterpret_cast<VlcPlugin *>(_instance->pdata);
+    if( p_plugin )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        switch( index )
+        {
+            case ID_togglemute:
+                if( argCount == 0 )
+                {
+                    libvlc_audio_toggle_mute(p_plugin->getVLC(), &ex);
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    else
+                    {
+                        VOID_TO_NPVARIANT(result);
+                        return INVOKERESULT_NO_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            default:
+                return INVOKERESULT_NO_SUCH_METHOD;
+        }
+    }
+    return INVOKERESULT_GENERIC_ERROR;
+}
+
+/*
+** implementation of libvlc input object
+*/
+
+const NPUTF8 * const LibvlcInputNPObject::propertyNames[] = 
+{
+    "length",
+    "position",
+    "time",
+    "state",
+    "rate",
+    "fps",
+    "hasVout",
+};
+
+const int LibvlcInputNPObject::propertyCount = sizeof(LibvlcInputNPObject::propertyNames)/sizeof(NPUTF8 *);
+
+enum LibvlcInputNPObjectPropertyIds
+{
+    ID_length,
+    ID_position,
+    ID_time,
+    ID_state,
+    ID_rate,
+    ID_fps,
+    ID_hasvout,
+};
+
+RuntimeNPObject::InvokeResult LibvlcInputNPObject::getProperty(int index, NPVariant &result)
+{
+    VlcPlugin *p_plugin = reinterpret_cast<VlcPlugin *>(_instance->pdata);
+    if( p_plugin )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_plugin->getVLC(), &ex);
+        if( libvlc_exception_raised(&ex) )
+        {
+            if( index != ID_state )
+            {
+                NPN_SetException(this, libvlc_exception_get_message(&ex));
+                libvlc_exception_clear(&ex);
+                return INVOKERESULT_GENERIC_ERROR;
+            }
+            else
+            {
+                /* for input state, return CLOSED rather than an exception */
+                INT32_TO_NPVARIANT(0, result);
+                return INVOKERESULT_NO_ERROR;
+            }
+        }
+
+        switch( index )
+        {
+            case ID_length:
+            {
+                double val = (double)libvlc_input_get_length(p_input, &ex);
+                libvlc_input_free(p_input);
+                if( libvlc_exception_raised(&ex) )
+                {
+                    NPN_SetException(this, libvlc_exception_get_message(&ex));
+                    libvlc_exception_clear(&ex);
+                    return INVOKERESULT_GENERIC_ERROR;
+                }
+                DOUBLE_TO_NPVARIANT(val, result);
+                return INVOKERESULT_NO_ERROR;
+            }
+            case ID_position:
+            {
+                double val = libvlc_input_get_position(p_input, &ex);
+                libvlc_input_free(p_input);
+                if( libvlc_exception_raised(&ex) )
+                {
+                    NPN_SetException(this, libvlc_exception_get_message(&ex));
+                    libvlc_exception_clear(&ex);
+                    return INVOKERESULT_GENERIC_ERROR;
+                }
+                DOUBLE_TO_NPVARIANT(val, result);
+                return INVOKERESULT_NO_ERROR;
+            }
+            case ID_time:
+            {
+                double val = (double)libvlc_input_get_time(p_input, &ex);
+                libvlc_input_free(p_input);
+                if( libvlc_exception_raised(&ex) )
+                {
+                    NPN_SetException(this, libvlc_exception_get_message(&ex));
+                    libvlc_exception_clear(&ex);
+                    return INVOKERESULT_GENERIC_ERROR;
+                }
+                DOUBLE_TO_NPVARIANT(val, result);
+                return INVOKERESULT_NO_ERROR;
+            }
+            case ID_state:
+            {
+                int val = libvlc_input_get_state(p_input, &ex);
+                libvlc_input_free(p_input);
+                if( libvlc_exception_raised(&ex) )
+                {
+                    NPN_SetException(this, libvlc_exception_get_message(&ex));
+                    libvlc_exception_clear(&ex);
+                    return INVOKERESULT_GENERIC_ERROR;
+                }
+                INT32_TO_NPVARIANT(val, result);
+                return INVOKERESULT_NO_ERROR;
+            }
+            case ID_rate:
+            {
+                float val = libvlc_input_get_rate(p_input, &ex);
+                libvlc_input_free(p_input);
+                if( libvlc_exception_raised(&ex) )
+                {
+                    NPN_SetException(this, libvlc_exception_get_message(&ex));
+                    libvlc_exception_clear(&ex);
+                    return INVOKERESULT_GENERIC_ERROR;
+                }
+                DOUBLE_TO_NPVARIANT(val, result);
+                return INVOKERESULT_NO_ERROR;
+            }
+            case ID_fps:
+            {
+                double val = libvlc_input_get_fps(p_input, &ex);
+                libvlc_input_free(p_input);
+                if( libvlc_exception_raised(&ex) )
+                {
+                    NPN_SetException(this, libvlc_exception_get_message(&ex));
+                    libvlc_exception_clear(&ex);
+                    return INVOKERESULT_GENERIC_ERROR;
+                }
+                DOUBLE_TO_NPVARIANT(val, result);
+                return INVOKERESULT_NO_ERROR;
+            }
+            case ID_hasvout:
+            {
+                vlc_bool_t val = libvlc_input_has_vout(p_input, &ex);
+                libvlc_input_free(p_input);
+                if( libvlc_exception_raised(&ex) )
+                {
+                    NPN_SetException(this, libvlc_exception_get_message(&ex));
+                    libvlc_exception_clear(&ex);
+                    return INVOKERESULT_GENERIC_ERROR;
+                }
+                BOOLEAN_TO_NPVARIANT(val, result);
+                return INVOKERESULT_NO_ERROR;
+            }
+        }
+        libvlc_input_free(p_input);
+    }
+    return INVOKERESULT_GENERIC_ERROR;
+}
+
+RuntimeNPObject::InvokeResult LibvlcInputNPObject::setProperty(int index, const NPVariant &value)
+{
+    VlcPlugin *p_plugin = reinterpret_cast<VlcPlugin *>(_instance->pdata);
+    if( p_plugin )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_plugin->getVLC(), &ex);
+        if( libvlc_exception_raised(&ex) )
+        {
+            NPN_SetException(this, libvlc_exception_get_message(&ex));
+            libvlc_exception_clear(&ex);
+            return INVOKERESULT_GENERIC_ERROR;
+        }
+
+        switch( index )
+        {
+            case ID_position:
+            {
+                if( ! NPVARIANT_IS_DOUBLE(value) )
+                {
+                    libvlc_input_free(p_input);
+                    return INVOKERESULT_INVALID_VALUE;
+                }
+
+                float val = (float)NPVARIANT_TO_DOUBLE(value);
+                libvlc_input_set_position(p_input, val, &ex);
+                libvlc_input_free(p_input);
+                if( libvlc_exception_raised(&ex) )
+                {
+                    NPN_SetException(this, libvlc_exception_get_message(&ex));
+                    libvlc_exception_clear(&ex);
+                    return INVOKERESULT_GENERIC_ERROR;
+                }
+                return INVOKERESULT_NO_ERROR;
+            }
+            case ID_time:
+            {
+                vlc_int64_t val;
+                if( NPVARIANT_IS_INT32(value) )
+                    val = (vlc_int64_t)NPVARIANT_TO_INT32(value);
+                else if( NPVARIANT_IS_DOUBLE(value) )
+                    val = (vlc_int64_t)NPVARIANT_TO_DOUBLE(value);
+                else
+                {
+                    libvlc_input_free(p_input);
+                    return INVOKERESULT_INVALID_VALUE;
+                }
+
+                libvlc_input_set_time(p_input, val, &ex);
+                libvlc_input_free(p_input);
+                if( libvlc_exception_raised(&ex) )
+                {
+                    NPN_SetException(this, libvlc_exception_get_message(&ex));
+                    libvlc_exception_clear(&ex);
+                    return INVOKERESULT_GENERIC_ERROR;
+                }
+                return INVOKERESULT_NO_ERROR;
+            }
+            case ID_rate:
+            {
+                float val;
+                if( NPVARIANT_IS_INT32(value) )
+                    val = (float)NPVARIANT_TO_INT32(value);
+                else if( NPVARIANT_IS_DOUBLE(value) )
+                    val = (float)NPVARIANT_TO_DOUBLE(value);
+                else
+                {
+                    libvlc_input_free(p_input);
+                    return INVOKERESULT_INVALID_VALUE;
+                }
+
+                libvlc_input_set_rate(p_input, val, &ex);
+                libvlc_input_free(p_input);
+                if( libvlc_exception_raised(&ex) )
+                {
+                    NPN_SetException(this, libvlc_exception_get_message(&ex));
+                    libvlc_exception_clear(&ex);
+                    return INVOKERESULT_GENERIC_ERROR;
+                }
+                return INVOKERESULT_NO_ERROR;
+            }
+        }
+        libvlc_input_free(p_input);
+    }
+    return INVOKERESULT_GENERIC_ERROR;
+}
+
+const NPUTF8 * const LibvlcInputNPObject::methodNames[] =
+{
+    /* no methods */
+};
+
+const int LibvlcInputNPObject::methodCount = sizeof(LibvlcInputNPObject::methodNames)/sizeof(NPUTF8 *);
+
+/*
+** implementation of libvlc playlist object
+*/
+
+
+const NPUTF8 * const LibvlcPlaylistNPObject::propertyNames[] = 
+{
+    "itemCount",
+    "isPlaying",
+};
+
+const int LibvlcPlaylistNPObject::propertyCount = sizeof(LibvlcPlaylistNPObject::propertyNames)/sizeof(NPUTF8 *);
+
+enum LibvlcPlaylistNPObjectPropertyIds
+{
+    ID_itemcount,
+    ID_isplaying,
+};
+
+RuntimeNPObject::InvokeResult LibvlcPlaylistNPObject::getProperty(int index, NPVariant &result)
+{
+    VlcPlugin *p_plugin = reinterpret_cast<VlcPlugin *>(_instance->pdata);
+    if( p_plugin )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        switch( index )
+        {
+            case ID_itemcount:
+            {
+                int val = libvlc_playlist_items_count(p_plugin->getVLC(), &ex);
+                if( libvlc_exception_raised(&ex) )
+                {
+                    NPN_SetException(this, libvlc_exception_get_message(&ex));
+                    libvlc_exception_clear(&ex);
+                    return INVOKERESULT_GENERIC_ERROR;
+                }
+                INT32_TO_NPVARIANT(val, result);
+                return INVOKERESULT_NO_ERROR;
+            }
+            case ID_isplaying:
+            {
+                int val = libvlc_playlist_isplaying(p_plugin->getVLC(), &ex);
+                if( libvlc_exception_raised(&ex) )
+                {
+                    NPN_SetException(this, libvlc_exception_get_message(&ex));
+                    libvlc_exception_clear(&ex);
+                    return INVOKERESULT_GENERIC_ERROR;
+                }
+                BOOLEAN_TO_NPVARIANT(val, result);
+                return INVOKERESULT_NO_ERROR;
+            }
+        }
+    }
+    return INVOKERESULT_GENERIC_ERROR;
+}
+
+const NPUTF8 * const LibvlcPlaylistNPObject::methodNames[] =
+{
+    "add",
+    "play",
+    "togglePause",
+    "stop",
+    "next",
+    "prev",
+    "clear",
+    "removeItem"
+};
+
+const int LibvlcPlaylistNPObject::methodCount = sizeof(LibvlcPlaylistNPObject::methodNames)/sizeof(NPUTF8 *);
+
+enum LibvlcPlaylistNPObjectMethodIds
+{
+    ID_add,
+    ID_play,
+    ID_togglepause,
+    ID_stop,
+    ID_next,
+    ID_prev,
+    ID_clear,
+    ID_removeitem,
+};
+
+RuntimeNPObject::InvokeResult LibvlcPlaylistNPObject::invoke(int index, const NPVariant *args, uint32_t argCount, NPVariant &result)
+{
+    VlcPlugin *p_plugin = reinterpret_cast<VlcPlugin *>(_instance->pdata);
+    if( p_plugin )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        switch( index )
+        {
+            case ID_add:
+            {
+                if( (argCount < 1) || (argCount > 3) )
+                    return INVOKERESULT_NO_SUCH_METHOD;
+
+                char *url = NULL;
+
+                // grab URL
+                if( NPVARIANT_IS_STRING(args[0]) )
+                {
+                    char *s = stringValue(NPVARIANT_TO_STRING(args[0]));
+                    if( s )
+                    {
+                        url = p_plugin->getAbsoluteURL(s);
+                        delete s;
+                        if( ! url )
+                            // what happened ?
+                            return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    else
+                        return INVOKERESULT_OUT_OF_MEMORY;
+                }
+                else
+                    return INVOKERESULT_NO_SUCH_METHOD;
+
+                char *name = NULL;
+
+                // grab name if available
+                if( argCount > 1 )
+                {
+                    if( NPVARIANT_IS_NULL(args[1]) )
+                    {
+                        // do nothing
+                    }
+                    else if( NPVARIANT_IS_STRING(args[1]) )
+                    {
+                        name = stringValue(NPVARIANT_TO_STRING(args[0]));
+                    }
+                    else
+                        return INVOKERESULT_NO_SUCH_METHOD;
+                }
+
+                int i_options = 0;
+                char** ppsz_options = NULL;
+
+                // grab options if available
+                if( argCount > 2 )
+                {
+                    if( NPVARIANT_IS_NULL(args[2]) )
+                    {
+                        // do nothing
+                    }
+                    else if( NPVARIANT_IS_STRING(args[2]) )
+                    {
+                        parseOptions(NPVARIANT_TO_STRING(args[2]), &i_options, &ppsz_options);
+
+                    }
+                    else if( NPVARIANT_IS_OBJECT(args[2]) )
+                    {
+                        parseOptions(NPVARIANT_TO_OBJECT(args[2]), &i_options, &ppsz_options);
+                    }
+                }
+
+                int item = libvlc_playlist_add_extended(p_plugin->getVLC(),
+                                                        url,
+                                                        name,
+                                                        i_options,
+                                                        const_cast<const char **>(ppsz_options),
+                                                        &ex);
+                delete url;
+                delete name;
+                for( int i=0; i< i_options; ++i )
+                {
+                    if( ppsz_options[i] )
+                        free(ppsz_options[i]);
+                }
+                if( ppsz_options )
+                    free(ppsz_options);
+                if( libvlc_exception_raised(&ex) )
+                {
+                    NPN_SetException(this, libvlc_exception_get_message(&ex));
+                    libvlc_exception_clear(&ex);
+                    return INVOKERESULT_GENERIC_ERROR;
+                }
+                else
+                {
+                    INT32_TO_NPVARIANT(item, result);
+                    return INVOKERESULT_NO_ERROR;
+                }
+            }
+            case ID_play:
+                if( argCount == 0 )
+                {
+                    libvlc_playlist_play(p_plugin->getVLC(), -1, 0, NULL, &ex);
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    else
+                    {
+                        VOID_TO_NPVARIANT(result);
+                        return INVOKERESULT_NO_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_togglepause:
+                if( argCount == 0 )
+                {
+                    libvlc_playlist_pause(p_plugin->getVLC(), &ex);
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    else
+                    {
+                        VOID_TO_NPVARIANT(result);
+                        return INVOKERESULT_NO_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_stop:
+                if( argCount == 0 )
+                {
+                    libvlc_playlist_stop(p_plugin->getVLC(), &ex);
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    else
+                    {
+                        VOID_TO_NPVARIANT(result);
+                        return INVOKERESULT_NO_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_next:
+                if( argCount == 0 )
+                {
+                    libvlc_playlist_next(p_plugin->getVLC(), &ex);
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    else
+                    {
+                        VOID_TO_NPVARIANT(result);
+                        return INVOKERESULT_NO_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_prev:
+                if( argCount == 0 )
+                {
+                    libvlc_playlist_prev(p_plugin->getVLC(), &ex);
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    else
+                    {
+                        VOID_TO_NPVARIANT(result);
+                        return INVOKERESULT_NO_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_clear:
+                if( argCount == 0 )
+                {
+                    libvlc_playlist_clear(p_plugin->getVLC(), &ex);
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    else
+                    {
+                        VOID_TO_NPVARIANT(result);
+                        return INVOKERESULT_NO_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_removeitem:
+                if( (argCount == 1) && isNumberValue(args[0]) )
+                {
+                    libvlc_playlist_delete_item(p_plugin->getVLC(), numberValue(args[0]), &ex);
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    else
+                    {
+                        VOID_TO_NPVARIANT(result);
+                        return INVOKERESULT_NO_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            default:
+                return INVOKERESULT_NO_SUCH_METHOD;
+        }
+    }
+    return INVOKERESULT_GENERIC_ERROR;
+}
+ 
+void LibvlcPlaylistNPObject::parseOptions(const NPString &s, int *i_options, char*** ppsz_options)
+{
+    if( s.utf8length )
+    {
+        char *val = stringValue(s);
+        if( val )
+        {
+            long capacity = 16;
+            char **options = (char **)malloc(capacity*sizeof(char *));
+            if( options )
+            {
+                int nOptions = 0;
+
+                char *end = val + s.utf8length;
+                while( val < end )
+                {
+                    // skip leading blanks
+                    while( (val < end)
+                        && ((*val == ' ' ) || (*val == '\t')) )
+                        ++val;
+
+                    char *start = val;
+                    // skip till we get a blank character
+                    while( (val < end)
+                        && (*val != ' ' )
+                        && (*val != '\t') )
+                    {
+                        char c = *(val++);
+                        if( ('\'' == c) || ('"' == c) )
+                        {
+                            // skip till end of string
+                            while( (val < end) && (*(val++) != c ) );
+                        }
+                    }
+
+                    if( val > start )
+                    {
+                        if( nOptions == capacity )
+                        {
+                            capacity += 16;
+                            char **moreOptions = (char **)realloc(options, capacity*sizeof(char*)); 
+                            if( ! moreOptions )
+                            {
+                                /* failed to allocate more memory */
+                                delete val;
+                                /* return what we got so far */
+                                *i_options = nOptions;
+                                *ppsz_options = options;
+                                break;
+                            }
+                            options = moreOptions;
+                        }
+                        *(val++) = '\0';
+                        options[nOptions++] = strdup(start);
+                    }
+                    else
+                        // must be end of string
+                        break;
+                }
+                *i_options = nOptions;
+                *ppsz_options = options;
+            }
+            delete val;
+        }
+    }
+}
+
+void LibvlcPlaylistNPObject::parseOptions(NPObject *obj, int *i_options, char*** ppsz_options)
+{
+    /* WARNING: Safari does not implement NPN_HasProperty/NPN_HasMethod */
+
+    NPVariant value;
+
+    /* we are expecting to have a Javascript Array object */
+    NPIdentifier propId = NPN_GetStringIdentifier("length");
+    if( NPN_GetProperty(_instance, obj, propId, &value) )
+    {
+        int count = numberValue(value);
+        NPN_ReleaseVariantValue(&value);
+
+        if( count )
+        {
+            long capacity = 16;
+            char **options = (char **)malloc(capacity*sizeof(char *));
+            if( options )
+            {
+                int nOptions = 0;
+
+                while( nOptions < count )
+                {
+                    propId = NPN_GetIntIdentifier(nOptions);
+                    if( ! NPN_GetProperty(_instance, obj, propId, &value) )
+                        /* return what we got so far */
+                        break;
+
+                    if( ! NPVARIANT_IS_STRING(value) )
+                    {
+                        /* return what we got so far */
+                        NPN_ReleaseVariantValue(&value);
+                        break;
+                    }
+
+                    if( nOptions == capacity )
+                    {
+                        capacity += 16;
+                        char **moreOptions = (char **)realloc(options, capacity*sizeof(char*)); 
+                        if( ! moreOptions )
+                        {
+                            /* failed to allocate more memory */
+                            NPN_ReleaseVariantValue(&value);
+                            /* return what we got so far */
+                            *i_options = nOptions;
+                            *ppsz_options = options;
+                            break;
+                        }
+                        options = moreOptions;
+                    }
+
+                    options[nOptions++] = stringValue(value);
+                }
+                *i_options = nOptions;
+                *ppsz_options = options;
+            }
+        }
+    }
+}
+
+/*
+** implementation of libvlc video object
+*/
+
+const NPUTF8 * const LibvlcVideoNPObject::propertyNames[] = 
+{
+    "fullscreen",
+    "height",
+    "width",
+};
+
+enum LibvlcVideoNPObjectPropertyIds
+{
+    ID_fullscreen,
+    ID_height,
+    ID_width,
+};
+
+const int LibvlcVideoNPObject::propertyCount = sizeof(LibvlcVideoNPObject::propertyNames)/sizeof(NPUTF8 *);
+
+RuntimeNPObject::InvokeResult LibvlcVideoNPObject::getProperty(int index, NPVariant &result)
+{
+    VlcPlugin *p_plugin = reinterpret_cast<VlcPlugin *>(_instance->pdata);
+    if( p_plugin )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_plugin->getVLC(), &ex);
+        if( libvlc_exception_raised(&ex) )
+        {
+            NPN_SetException(this, libvlc_exception_get_message(&ex));
+            libvlc_exception_clear(&ex);
+            return INVOKERESULT_GENERIC_ERROR;
+        }
+
+        switch( index )
+        {
+            case ID_fullscreen:
+            {
+                int val = libvlc_get_fullscreen(p_input, &ex);
+                libvlc_input_free(p_input);
+                if( libvlc_exception_raised(&ex) )
+                {
+                    NPN_SetException(this, libvlc_exception_get_message(&ex));
+                    libvlc_exception_clear(&ex);
+                    return INVOKERESULT_GENERIC_ERROR;
+                }
+                BOOLEAN_TO_NPVARIANT(val, result);
+                return INVOKERESULT_NO_ERROR;
+            }
+            case ID_height:
+            {
+                int val = libvlc_video_get_height(p_input, &ex);
+                libvlc_input_free(p_input);
+                if( libvlc_exception_raised(&ex) )
+                {
+                    NPN_SetException(this, libvlc_exception_get_message(&ex));
+                    libvlc_exception_clear(&ex);
+                    return INVOKERESULT_GENERIC_ERROR;
+                }
+                INT32_TO_NPVARIANT(val, result);
+                return INVOKERESULT_NO_ERROR;
+            }
+            case ID_width:
+            {
+                int val = libvlc_video_get_width(p_input, &ex);
+                libvlc_input_free(p_input);
+                if( libvlc_exception_raised(&ex) )
+                {
+                    NPN_SetException(this, libvlc_exception_get_message(&ex));
+                    libvlc_exception_clear(&ex);
+                    return INVOKERESULT_GENERIC_ERROR;
+                }
+                INT32_TO_NPVARIANT(val, result);
+                return INVOKERESULT_NO_ERROR;
+            }
+        }
+        libvlc_input_free(p_input);
+    }
+    return INVOKERESULT_GENERIC_ERROR;
+}
+
+RuntimeNPObject::InvokeResult LibvlcVideoNPObject::setProperty(int index, const NPVariant &value)
+{
+    VlcPlugin *p_plugin = reinterpret_cast<VlcPlugin *>(_instance->pdata);
+    if( p_plugin )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_plugin->getVLC(), &ex);
+        if( libvlc_exception_raised(&ex) )
+        {
+            NPN_SetException(this, libvlc_exception_get_message(&ex));
+            libvlc_exception_clear(&ex);
+            return INVOKERESULT_GENERIC_ERROR;
+        }
+
+        switch( index )
+        {
+            case ID_fullscreen:
+            {
+                if( ! NPVARIANT_IS_BOOLEAN(value) )
+                {
+                    libvlc_input_free(p_input);
+                    return INVOKERESULT_INVALID_VALUE;
+                }
+
+                int val = NPVARIANT_TO_BOOLEAN(value);
+                libvlc_set_fullscreen(p_input, val, &ex);
+                libvlc_input_free(p_input);
+                if( libvlc_exception_raised(&ex) )
+                {
+                    NPN_SetException(this, libvlc_exception_get_message(&ex));
+                    libvlc_exception_clear(&ex);
+                    return INVOKERESULT_GENERIC_ERROR;
+                }
+                return INVOKERESULT_NO_ERROR;
+            }
+        }
+        libvlc_input_free(p_input);
+    }
+    return INVOKERESULT_GENERIC_ERROR;
+}
+
+const NPUTF8 * const LibvlcVideoNPObject::methodNames[] =
+{
+    "toggleFullscreen",
+};
+
+enum LibvlcVideoNPObjectMethodIds
+{
+    ID_togglefullscreen,
+};
+
+const int LibvlcVideoNPObject::methodCount = sizeof(LibvlcVideoNPObject::methodNames)/sizeof(NPUTF8 *);
+
+RuntimeNPObject::InvokeResult LibvlcVideoNPObject::invoke(int index, const NPVariant *args, uint32_t argCount, NPVariant &result)
+{
+    VlcPlugin *p_plugin = reinterpret_cast<VlcPlugin *>(_instance->pdata);
+    if( p_plugin )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_plugin->getVLC(), &ex);
+        if( libvlc_exception_raised(&ex) )
+        {
+            NPN_SetException(this, libvlc_exception_get_message(&ex));
+            libvlc_exception_clear(&ex);
+            return INVOKERESULT_GENERIC_ERROR;
+        }
+
+        switch( index )
+        {
+            case ID_togglefullscreen:
+                if( argCount == 0 )
+                {
+                    libvlc_toggle_fullscreen(p_input, &ex);
+                    libvlc_input_free(p_input);
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    else
+                    {
+                        VOID_TO_NPVARIANT(result);
+                        return INVOKERESULT_NO_ERROR;
+                    }
+                }
+                else
+                {
+                    /* cannot get input, probably not playing */
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                    }
+                    return INVOKERESULT_GENERIC_ERROR;
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            default:
+                return INVOKERESULT_NO_SUCH_METHOD;
+        }
+    }
+    return INVOKERESULT_GENERIC_ERROR;
+}
+
diff -uNr vlc-0.8.6-svn20060918.debian/mozilla/control/npolibvlc.h vlc-0.8.6-svn20061008.debian/mozilla/control/npolibvlc.h
--- vlc-0.8.6-svn20060918.debian/mozilla/control/npolibvlc.h	1969-12-31 19:00:00.000000000 -0500
+++ vlc-0.8.6-svn20061008.debian/mozilla/control/npolibvlc.h	2006-10-04 09:47:08.000000000 -0400
@@ -0,0 +1,135 @@
+/*****************************************************************************
+ * npolibvlc.h: official Javascript APIs
+ *****************************************************************************
+ * Copyright (C) 2002-2006 the VideoLAN team
+ *
+ * Authors: Damien Fouilleul <damien.fouilleul@laposte.net>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
+ *****************************************************************************/
+
+/*
+** defined runtime script objects
+*/
+
+#include "nporuntime.h"
+
+class LibvlcRootNPObject: public RuntimeNPObject
+{
+protected:
+    friend class RuntimeNPClass<LibvlcRootNPObject>;
+
+    LibvlcRootNPObject(NPP instance, const NPClass *aClass);
+    virtual ~LibvlcRootNPObject();
+
+    static const int propertyCount;
+    static const NPUTF8 * const propertyNames[];
+
+    InvokeResult getProperty(int index, NPVariant &result);
+
+    static const int methodCount;
+    static const NPUTF8 * const methodNames[];
+
+    NPObject *audioObj;
+    NPObject *inputObj;
+    NPObject *playlistObj;
+    NPObject *videoObj;
+};
+
+class LibvlcAudioNPObject: public RuntimeNPObject
+{
+protected:
+    LibvlcAudioNPObject(NPP instance, const NPClass *aClass) :
+        RuntimeNPObject(instance, aClass) {};
+    virtual ~LibvlcAudioNPObject() {};
+
+    friend class RuntimeNPClass<LibvlcAudioNPObject>;
+
+    static const int propertyCount;
+    static const NPUTF8 * const propertyNames[];
+
+    InvokeResult getProperty(int index, NPVariant &result);
+    InvokeResult setProperty(int index, const NPVariant &value);
+
+    static const int methodCount;
+    static const NPUTF8 * const methodNames[];
+
+    InvokeResult invoke(int index, const NPVariant *args, uint32_t argCount, NPVariant &result);
+};
+
+class LibvlcInputNPObject: public RuntimeNPObject
+{
+protected:
+    friend class RuntimeNPClass<LibvlcInputNPObject>;
+
+    LibvlcInputNPObject(NPP instance, const NPClass *aClass) :
+        RuntimeNPObject(instance, aClass) {};
+	
+    virtual ~LibvlcInputNPObject() {};
+
+    static const int propertyCount;
+    static const NPUTF8 * const propertyNames[];
+
+    InvokeResult getProperty(int index, NPVariant &result);
+    InvokeResult setProperty(int index, const NPVariant &value);
+
+    static const int methodCount;
+    static const NPUTF8 * const methodNames[];
+};
+
+class LibvlcPlaylistNPObject: public RuntimeNPObject
+{
+protected:
+    friend class RuntimeNPClass<LibvlcPlaylistNPObject>;
+
+    LibvlcPlaylistNPObject(NPP instance, const NPClass *aClass) :
+        RuntimeNPObject(instance, aClass) {};
+    virtual ~LibvlcPlaylistNPObject() {};
+
+    static const int propertyCount;
+    static const NPUTF8 * const propertyNames[];
+
+    InvokeResult getProperty(int index, NPVariant &result);
+
+    static const int methodCount;
+    static const NPUTF8 * const methodNames[];
+
+    InvokeResult invoke(int index, const NPVariant *args, uint32_t argCount, NPVariant &result);
+
+    void parseOptions(const NPString &s, int *i_options, char*** ppsz_options);
+    void parseOptions(NPObject *obj, int *i_options, char*** ppsz_options);
+};
+
+class LibvlcVideoNPObject: public RuntimeNPObject
+{
+protected:
+    friend class RuntimeNPClass<LibvlcVideoNPObject>;
+
+    LibvlcVideoNPObject(NPP instance, const NPClass *aClass) :
+        RuntimeNPObject(instance, aClass) {};
+    virtual ~LibvlcVideoNPObject() {};
+
+    static const int propertyCount;
+    static const NPUTF8 * const propertyNames[];
+
+    InvokeResult getProperty(int index, NPVariant &result);
+    InvokeResult setProperty(int index, const NPVariant &value);
+
+    static const int methodCount;
+    static const NPUTF8 * const methodNames[];
+
+    InvokeResult invoke(int index, const NPVariant *args, uint32_t argCount, NPVariant &result);
+};
+
diff -uNr vlc-0.8.6-svn20060918.debian/mozilla/control/nporuntime.cpp vlc-0.8.6-svn20061008.debian/mozilla/control/nporuntime.cpp
--- vlc-0.8.6-svn20060918.debian/mozilla/control/nporuntime.cpp	1969-12-31 19:00:00.000000000 -0500
+++ vlc-0.8.6-svn20061008.debian/mozilla/control/nporuntime.cpp	2006-10-04 09:47:08.000000000 -0400
@@ -0,0 +1,113 @@
+/*****************************************************************************
+ * runtime.cpp: support for NPRuntime API for Netscape Script-able plugins
+ *              FYI: http://www.mozilla.org/projects/plugins/npruntime.html
+ *****************************************************************************
+ * Copyright (C) 2005 the VideoLAN team
+ *
+ * Authors: Damien Fouilleul <Damien.Fouilleul@laposte.net>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
+ *****************************************************************************/
+
+#include "config.h"
+
+#include <stdio.h>
+#include <string.h>
+#include <stdlib.h>
+
+/* Mozilla stuff */
+#ifdef HAVE_MOZILLA_CONFIG_H
+#   include <mozilla-config.h>
+#endif
+
+#include "nporuntime.h"
+#include "vlcplugin.h"
+
+char* RuntimeNPObject::stringValue(const NPString &s)
+{
+    NPUTF8 *val = new NPUTF8[s.utf8length+1];
+    if( val )
+    {
+        strncpy(val, s.utf8characters, s.utf8length);
+        val[s.utf8length] = '\0';
+    }
+    return val;
+}
+
+char* RuntimeNPObject::stringValue(const NPVariant &v)
+{
+    char *s = NULL;
+    if( NPVARIANT_IS_STRING(v) ) 
+    {
+        return stringValue(NPVARIANT_TO_STRING(v));
+    }
+    return s;
+}
+
+RuntimeNPObject::InvokeResult RuntimeNPObject::getProperty(int index, NPVariant &result)
+{
+    /* default behaviour */
+    return INVOKERESULT_GENERIC_ERROR;
+}
+
+RuntimeNPObject::InvokeResult RuntimeNPObject::setProperty(int index, const NPVariant &value)
+{
+    /* default behaviour */
+    return INVOKERESULT_GENERIC_ERROR;
+}
+
+RuntimeNPObject::InvokeResult RuntimeNPObject::removeProperty(int index)
+{
+    /* default behaviour */
+    return INVOKERESULT_GENERIC_ERROR;
+}
+
+RuntimeNPObject::InvokeResult RuntimeNPObject::invoke(int index, const NPVariant *args, uint32_t argCount, NPVariant &result)
+{
+    /* default beahviour */
+    return INVOKERESULT_GENERIC_ERROR;
+}
+
+RuntimeNPObject::InvokeResult RuntimeNPObject::invokeDefault(const NPVariant *args, uint32_t argCount, NPVariant &result)
+{
+    /* return void */
+    VOID_TO_NPVARIANT(result);
+    return INVOKERESULT_NO_ERROR;
+}
+
+bool RuntimeNPObject::returnInvokeResult(RuntimeNPObject::InvokeResult result)
+{
+    switch( result )
+    {
+        case INVOKERESULT_NO_ERROR:
+            return true;
+        case INVOKERESULT_GENERIC_ERROR:
+            break;
+        case INVOKERESULT_NO_SUCH_METHOD:
+            NPN_SetException(this, "No such method or arguments mismatch");
+            break;
+        case INVOKERESULT_INVALID_ARGS:
+            NPN_SetException(this, "Invalid arguments");
+            break;
+        case INVOKERESULT_INVALID_VALUE:
+            NPN_SetException(this, "Invalid value in assignment");
+            break;
+        case INVOKERESULT_OUT_OF_MEMORY:
+            NPN_SetException(this, "Out of memory");
+            break;
+    }
+    return false;
+}
+
diff -uNr vlc-0.8.6-svn20060918.debian/mozilla/control/nporuntime.h vlc-0.8.6-svn20061008.debian/mozilla/control/nporuntime.h
--- vlc-0.8.6-svn20060918.debian/mozilla/control/nporuntime.h	1969-12-31 19:00:00.000000000 -0500
+++ vlc-0.8.6-svn20061008.debian/mozilla/control/nporuntime.h	2006-10-04 09:47:08.000000000 -0400
@@ -0,0 +1,321 @@
+/*****************************************************************************
+ * runtime.cpp: support for NPRuntime API for Netscape Script-able plugins
+ *              FYI: http://www.mozilla.org/projects/plugins/npruntime.html
+ *****************************************************************************
+ * Copyright (C) 2002-2005 the VideoLAN team
+ * $Id: RuntimeNPObject.h 14466 2006-02-22 23:34:54Z dionoea $
+ *
+ * Authors: Damien Fouilleul <damien.fouilleul@laposte.net>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
+ *****************************************************************************/
+
+#ifndef __NPORUNTIME_H__
+#define __NPORUNTIME_H__
+
+/*
+** support framework for runtime script objects
+*/
+
+#include <npapi.h>
+#include <npruntime.h>
+
+static void RuntimeNPClassDeallocate(NPObject *npobj);
+static void RuntimeNPClassInvalidate(NPObject *npobj);
+static bool RuntimeNPClassInvokeDefault(NPObject *npobj,
+                                        const NPVariant *args,
+                                        uint32_t argCount,
+                                        NPVariant *result);
+
+class RuntimeNPObject : public NPObject
+{
+public:
+
+    /*
+    ** utility functions
+    */
+
+    static bool isNumberValue(const NPVariant &v)
+    {
+        return NPVARIANT_IS_INT32(v)
+            || NPVARIANT_IS_DOUBLE(v);
+    };
+
+    static int numberValue(const NPVariant &v)
+    {
+        switch( v.type ) {
+            case NPVariantType_Int32:
+                return NPVARIANT_TO_INT32(v);
+            case NPVariantType_Double:
+                return(int)NPVARIANT_TO_DOUBLE(v);
+            default:
+                return 0;
+        }
+    };
+
+    static char* stringValue(const NPString &v);
+    static char* stringValue(const NPVariant &v);
+
+protected:
+
+    RuntimeNPObject(NPP instance, const NPClass *aClass) :
+        _instance(instance)
+    {
+        _class = const_cast<NPClass *>(aClass);
+        referenceCount = 1;
+    };
+    virtual ~RuntimeNPObject() {};
+
+    enum InvokeResult
+    {
+        INVOKERESULT_NO_ERROR       = 0,    /* returns no error */
+        INVOKERESULT_GENERIC_ERROR  = 1,    /* returns error */
+        INVOKERESULT_NO_SUCH_METHOD = 2,    /* throws method does not exist */
+        INVOKERESULT_INVALID_ARGS   = 3,    /* throws invalid arguments */
+        INVOKERESULT_INVALID_VALUE  = 4,    /* throws invalid value in assignment */
+        INVOKERESULT_OUT_OF_MEMORY  = 5,    /* throws out of memory */
+    };
+
+    friend void RuntimeNPClassDeallocate(NPObject *npobj);
+    friend void RuntimeNPClassInvalidate(NPObject *npobj);
+    template <class RuntimeNPObject> friend bool RuntimeNPClassGetProperty(NPObject *npobj, NPIdentifier name, NPVariant *result);
+    template <class RuntimeNPObject> friend bool RuntimeNPClassSetProperty(NPObject *npobj, NPIdentifier name, const NPVariant *value);
+    template <class RuntimeNPObject> friend bool RuntimeNPClassRemoveProperty(NPObject *npobj, NPIdentifier name);
+    template <class RuntimeNPObject> friend bool RuntimeNPClassInvoke(NPObject *npobj, NPIdentifier name,
+                                                    const NPVariant *args, uint32_t argCount,
+                                                    NPVariant *result);
+    friend bool RuntimeNPClassInvokeDefault(NPObject *npobj,
+                                            const NPVariant *args,
+                                            uint32_t argCount,
+                                            NPVariant *result);
+
+    virtual InvokeResult getProperty(int index, NPVariant &result);
+    virtual InvokeResult setProperty(int index, const NPVariant &value);
+    virtual InvokeResult removeProperty(int index);
+    virtual InvokeResult invoke(int index, const NPVariant *args, uint32_t argCount, NPVariant &result);
+    virtual InvokeResult invokeDefault(const NPVariant *args, uint32_t argCount, NPVariant &result);
+
+    bool returnInvokeResult(InvokeResult result);
+
+    NPP _instance;
+};
+
+template<class T> class RuntimeNPClass : public NPClass
+{
+public:
+    static NPClass *getClass()
+    {
+        static NPClass *singleton = new RuntimeNPClass<T>;
+        return singleton;
+    }
+
+protected:
+    RuntimeNPClass();
+    virtual ~RuntimeNPClass();
+
+    template <class RuntimeNPObject> friend NPObject *RuntimeNPClassAllocate(NPP instance, NPClass *aClass);
+    template <class RuntimeNPObject> friend bool RuntimeNPClassHasMethod(NPObject *npobj, NPIdentifier name);
+    template <class RuntimeNPObject> friend bool RuntimeNPClassHasProperty(NPObject *npobj, NPIdentifier name);
+    template <class RuntimeNPObject> friend bool RuntimeNPClassGetProperty(NPObject *npobj, NPIdentifier name, NPVariant *result);
+    template <class RuntimeNPObject> friend bool RuntimeNPClassSetProperty(NPObject *npobj, NPIdentifier name, const NPVariant *value);
+    template <class RuntimeNPObject> friend bool RuntimeNPClassRemoveProperty(NPObject *npobj, NPIdentifier name);
+    template <class RuntimeNPObject> friend bool RuntimeNPClassInvoke(NPObject *npobj, NPIdentifier name,
+                                                                      const NPVariant *args, uint32_t argCount,
+                                                                      NPVariant *result);
+
+    RuntimeNPObject *create(NPP instance) const;
+
+    int indexOfMethod(NPIdentifier name) const;
+    int indexOfProperty(NPIdentifier name) const;
+
+private:
+    NPIdentifier *propertyIdentifiers;
+    NPIdentifier *methodIdentifiers;
+};
+
+template<class T>
+static NPObject *RuntimeNPClassAllocate(NPP instance, NPClass *aClass)
+{
+    const RuntimeNPClass<T> *vClass = static_cast<RuntimeNPClass<T> *>(aClass);
+    return (NPObject *)vClass->create(instance);
+}
+
+static void RuntimeNPClassDeallocate(NPObject *npobj)
+{
+    RuntimeNPObject *vObj = static_cast<RuntimeNPObject *>(npobj);
+    delete vObj;
+}
+
+static void RuntimeNPClassInvalidate(NPObject *npobj)
+{
+    RuntimeNPObject *vObj = static_cast<RuntimeNPObject *>(npobj);
+    vObj->_instance = NULL;
+}
+
+template<class T>
+static bool RuntimeNPClassHasMethod(NPObject *npobj, NPIdentifier name)
+{
+    const RuntimeNPClass<T> *vClass = static_cast<RuntimeNPClass<T> *>(npobj->_class);
+    return vClass->indexOfMethod(name) != -1;
+}
+
+template<class T>
+static bool RuntimeNPClassHasProperty(NPObject *npobj, NPIdentifier name)
+{
+    const RuntimeNPClass<T> *vClass = static_cast<RuntimeNPClass<T> *>(npobj->_class);
+    return vClass->indexOfProperty(name) != -1;
+}
+
+template<class T>
+static bool RuntimeNPClassGetProperty(NPObject *npobj, NPIdentifier name, NPVariant *result)
+{
+    const RuntimeNPClass<T> *vClass = static_cast<RuntimeNPClass<T> *>(npobj->_class);
+    int index = vClass->indexOfProperty(name);
+    if( index != -1 )
+    {
+        RuntimeNPObject *vObj = static_cast<RuntimeNPObject *>(npobj);
+        return vObj->returnInvokeResult(vObj->getProperty(index, *result));
+    }
+    return false;
+}
+
+template<class T>
+static bool RuntimeNPClassSetProperty(NPObject *npobj, NPIdentifier name, const NPVariant *value)
+{
+    const RuntimeNPClass<T> *vClass = static_cast<RuntimeNPClass<T> *>(npobj->_class);
+    int index = vClass->indexOfProperty(name);
+    if( index != -1 )
+    {
+        RuntimeNPObject *vObj = static_cast<RuntimeNPObject *>(npobj);
+        return vObj->returnInvokeResult(vObj->setProperty(index, *value));
+    }
+    return false;
+}
+
+template<class T>
+static bool RuntimeNPClassRemoveProperty(NPObject *npobj, NPIdentifier name)
+{
+    const RuntimeNPClass<T> *vClass = static_cast<RuntimeNPClass<T> *>(npobj->_class);
+    int index = vClass->indexOfProperty(name);
+    if( index != -1 )
+    {
+        RuntimeNPObject *vObj = static_cast<RuntimeNPObject *>(npobj);
+        return vObj->returnInvokeResult(vObj->removeProperty(index));
+    }
+    return false;
+}
+
+template<class T>
+static bool RuntimeNPClassInvoke(NPObject *npobj, NPIdentifier name,
+                                    const NPVariant *args, uint32_t argCount,
+                                    NPVariant *result)
+{
+    const RuntimeNPClass<T> *vClass = static_cast<RuntimeNPClass<T> *>(npobj->_class);
+    int index = vClass->indexOfMethod(name);
+    if( index != -1 )
+    {
+        RuntimeNPObject *vObj = static_cast<RuntimeNPObject *>(npobj);
+        return vObj->returnInvokeResult(vObj->invoke(index, args, argCount, *result));
+
+    }
+    return false;
+}
+
+static bool RuntimeNPClassInvokeDefault(NPObject *npobj,
+                                           const NPVariant *args,
+                                           uint32_t argCount,
+                                           NPVariant *result)
+{
+    RuntimeNPObject *vObj = static_cast<RuntimeNPObject *>(npobj);
+    return vObj->returnInvokeResult(vObj->invokeDefault(args, argCount, *result));
+}
+
+template<class T>
+RuntimeNPClass<T>::RuntimeNPClass()
+{
+    // retreive property identifiers from names
+    if( T::propertyCount > 0 )
+    {
+        propertyIdentifiers = new NPIdentifier[T::propertyCount];
+        if( propertyIdentifiers )
+            NPN_GetStringIdentifiers(const_cast<const NPUTF8**>(T::propertyNames),
+                T::propertyCount, propertyIdentifiers);
+    }
+
+    // retreive method identifiers from names
+    if( T::methodCount > 0 )
+    {
+        methodIdentifiers = new NPIdentifier[T::methodCount];
+        if( methodIdentifiers )
+            NPN_GetStringIdentifiers(const_cast<const NPUTF8**>(T::methodNames),
+                T::methodCount, methodIdentifiers);
+    }
+
+    // fill in NPClass structure
+    structVersion  = NP_CLASS_STRUCT_VERSION;
+    allocate       = &RuntimeNPClassAllocate<T>;
+    deallocate     = &RuntimeNPClassDeallocate;
+    invalidate     = &RuntimeNPClassInvalidate;
+    hasMethod      = &RuntimeNPClassHasMethod<T>;
+    invoke         = &RuntimeNPClassInvoke<T>;
+    invokeDefault  = &RuntimeNPClassInvokeDefault;
+    hasProperty    = &RuntimeNPClassHasProperty<T>;
+    getProperty    = &RuntimeNPClassGetProperty<T>;
+    setProperty    = &RuntimeNPClassSetProperty<T>;
+    removeProperty = &RuntimeNPClassRemoveProperty<T>;
+}
+
+template<class T>
+RuntimeNPClass<T>::~RuntimeNPClass()
+{
+    delete propertyIdentifiers;
+    delete methodIdentifiers;
+}
+
+template<class T>
+RuntimeNPObject *RuntimeNPClass<T>::create(NPP instance) const
+{
+    return new T(instance, this);
+}
+
+template<class T>
+int RuntimeNPClass<T>::indexOfMethod(NPIdentifier name) const
+{
+    if( methodIdentifiers )
+    {
+        for(int c=0; c< T::methodCount; ++c )
+        {
+            if( name == methodIdentifiers[c] )
+                return c;
+        }
+    }
+    return -1;
+}
+
+template<class T>
+int RuntimeNPClass<T>::indexOfProperty(NPIdentifier name) const
+{
+    if( propertyIdentifiers )
+    {
+        for(int c=0; c< T::propertyCount; ++c )
+        {
+            if( name == propertyIdentifiers[c] )
+                return c;
+        }
+    }
+    return -1;
+}
+
+#endif
diff -uNr vlc-0.8.6-svn20060918.debian/mozilla/control/npovlc.cpp vlc-0.8.6-svn20061008.debian/mozilla/control/npovlc.cpp
--- vlc-0.8.6-svn20060918.debian/mozilla/control/npovlc.cpp	1969-12-31 19:00:00.000000000 -0500
+++ vlc-0.8.6-svn20061008.debian/mozilla/control/npovlc.cpp	2006-10-04 09:47:08.000000000 -0400
@@ -0,0 +1,682 @@
+/*****************************************************************************
+ * npovlc.cpp: deprecated VLC apis implemented in late XPCOM interface
+ *****************************************************************************
+ * Copyright (C) 2002-2006 the VideoLAN team
+ *
+ * Authors: Damien Fouilleul <Damien.Fouilleul@laposte.net>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
+ *****************************************************************************/
+
+#include "config.h"
+
+#include <stdio.h>
+#include <string.h>
+#include <stdlib.h>
+
+#include <vlc/vlc.h>
+
+/* Mozilla stuff */
+#ifdef HAVE_MOZILLA_CONFIG_H
+#   include <mozilla-config.h>
+#endif
+
+#include "npovlc.h"
+#include "vlcplugin.h"
+
+/*
+** implementation of vlc root object
+*/
+
+const NPUTF8 * const VlcNPObject::propertyNames[] =
+{
+    /* no properties */
+};
+
+const int VlcNPObject::propertyCount = sizeof(VlcNPObject::propertyNames)/sizeof(NPUTF8 *);
+
+const NPUTF8 * const VlcNPObject::methodNames[] =
+{
+    "play",                 /* deprecated */
+    "pause",                /* deprecated */
+    "stop",                 /* deprecated */
+    "fullscreen",           /* deprecated */
+    "set_volume",           /* deprecated */
+    "get_volume",           /* deprecated */
+    "mute",                 /* deprecated */
+    "get_int_variable",     /* deprecated */
+    "set_int_variable",     /* deprecated */
+    "get_bool_variable",    /* deprecated */
+    "set_bool_variable",    /* deprecated */
+    "get_str_variable",     /* deprecated */
+    "set_str_variable",     /* deprecated */
+    "clear_playlist",       /* deprecated */
+    "add_item",             /* deprecated */
+    "next",                 /* deprecated */
+    "previous",             /* deprecated */
+    "isplaying",            /* deprecated */
+    "get_length",           /* deprecated */
+    "get_position",         /* deprecated */
+    "get_time",             /* deprecated */
+    "seek",                 /* deprecated */
+};
+
+enum VlcNPObjectMethodIds
+{
+    ID_play = 0,
+    ID_pause,
+    ID_stop,
+    ID_fullscreen,
+    ID_set_volume,
+    ID_get_volume,
+    ID_mute,
+    ID_get_int_variable,
+    ID_set_int_variable,
+    ID_get_bool_variable,
+    ID_set_bool_variable,
+    ID_get_str_variable,
+    ID_set_str_variable,
+    ID_clear_playlist,
+    ID_add_item,
+    ID_next,
+    ID_previous,
+    ID_isplaying,
+    ID_get_length,
+    ID_get_position,
+    ID_get_time,
+    ID_seek,
+};
+
+const int VlcNPObject::methodCount = sizeof(VlcNPObject::methodNames)/sizeof(NPUTF8 *);
+
+RuntimeNPObject::InvokeResult VlcNPObject::invoke(int index, const NPVariant *args, uint32_t argCount, NPVariant &result)
+{
+    VlcPlugin *p_plugin = reinterpret_cast<VlcPlugin *>(_instance->pdata);
+    if( p_plugin )
+    {
+        libvlc_exception_t ex;
+        libvlc_exception_init(&ex);
+
+        switch( index )
+        {
+            case ID_play: /* deprecated */
+                if( argCount == 0 )
+                {
+                    libvlc_playlist_play(p_plugin->getVLC(), -1, 0, NULL, &ex);
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    else
+                    {
+                        VOID_TO_NPVARIANT(result);
+                        return INVOKERESULT_NO_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_pause: /* deprecated */
+                if( argCount == 0 )
+                {
+                    libvlc_playlist_pause(p_plugin->getVLC(), &ex);
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    else
+                    {
+                        VOID_TO_NPVARIANT(result);
+                        return INVOKERESULT_NO_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_stop: /* deprecated */
+                if( argCount == 0 )
+                {
+                    libvlc_playlist_stop(p_plugin->getVLC(), &ex);
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    else
+                    {
+                        VOID_TO_NPVARIANT(result);
+                        return INVOKERESULT_NO_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_fullscreen: /* deprecated */
+                if( argCount == 0 )
+                {
+                    libvlc_input_t *p_input = libvlc_playlist_get_input(p_plugin->getVLC(), &ex);
+                    if( p_input )
+                    {
+                        libvlc_toggle_fullscreen(p_input, &ex);
+                        libvlc_input_free(p_input);
+                        if( libvlc_exception_raised(&ex) )
+                        {
+                            NPN_SetException(this, libvlc_exception_get_message(&ex));
+                            libvlc_exception_clear(&ex);
+                            return INVOKERESULT_GENERIC_ERROR;
+                        }
+                        else
+                        {
+                            VOID_TO_NPVARIANT(result);
+                            return INVOKERESULT_NO_ERROR;
+                        }
+                    }
+                    else
+                    {
+                        /* cannot get input, probably not playing */
+                        if( libvlc_exception_raised(&ex) )
+                        {
+                            NPN_SetException(this, libvlc_exception_get_message(&ex));
+                            libvlc_exception_clear(&ex);
+                        }
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_set_volume: /* deprecated */
+                if( (argCount == 1) && isNumberValue(args[0]) )
+                {
+                    libvlc_audio_set_volume(p_plugin->getVLC(), numberValue(args[0]), &ex);
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    else
+                    {
+                        VOID_TO_NPVARIANT(result);
+                        return INVOKERESULT_NO_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_get_volume: /* deprecated */
+                if( argCount == 0 )
+                {
+                    int val = libvlc_audio_get_volume(p_plugin->getVLC(), &ex);
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    else
+                    {
+                        INT32_TO_NPVARIANT(val, result);
+                        return INVOKERESULT_NO_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_mute: /* deprecated */
+                if( argCount == 0 )
+                {
+                    libvlc_audio_toggle_mute(p_plugin->getVLC(), &ex);
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    else
+                    {
+                        VOID_TO_NPVARIANT(result);
+                        return INVOKERESULT_NO_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_get_int_variable: /* deprecated */
+                if( (argCount == 1) && NPVARIANT_IS_STRING(args[0]) )
+                {
+                    char *s = stringValue(NPVARIANT_TO_STRING(args[0]));
+                    if( s )
+                    {
+                        int vlc_id = libvlc_get_vlc_id(p_plugin->getVLC());
+                        vlc_value_t val;
+                        if( VLC_SUCCESS == VLC_VariableGet(vlc_id, s, &val) )
+                        {
+                            delete s;
+                            INT32_TO_NPVARIANT(val.i_int, result);
+                            return INVOKERESULT_NO_ERROR;
+                        }
+                        else
+                        {
+                            delete s;
+                            return INVOKERESULT_INVALID_ARGS;
+                        }
+                    }
+                    else
+                        return INVOKERESULT_OUT_OF_MEMORY;
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_set_int_variable: /* deprecated */
+                if( (argCount == 2)
+                    && NPVARIANT_IS_STRING(args[0])
+                    && isNumberValue(args[1]) )
+                {
+                    char *s = stringValue(NPVARIANT_TO_STRING(args[0]));
+                    if( s )
+                    {
+                        int vlc_id = libvlc_get_vlc_id(p_plugin->getVLC());
+                        vlc_value_t val;
+                        val.i_int = numberValue(args[1]);
+                        if( VLC_SUCCESS == VLC_VariableSet(vlc_id, s, val) )
+                        {
+                            delete s;
+                            VOID_TO_NPVARIANT(result);
+                            return INVOKERESULT_NO_ERROR;
+                        }
+                        else
+                        {
+                            delete s;
+                            return INVOKERESULT_INVALID_ARGS;
+                        }
+                    }
+                    else
+                        return INVOKERESULT_OUT_OF_MEMORY;
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_get_bool_variable: /* deprecated */
+                if( (argCount == 1) && NPVARIANT_IS_STRING(args[0]) )
+                {
+                    char *s = stringValue(NPVARIANT_TO_STRING(args[0]));
+                    if( s )
+                    {
+                        int vlc_id = libvlc_get_vlc_id(p_plugin->getVLC());
+                        vlc_value_t val;
+                        if( VLC_SUCCESS == VLC_VariableGet(vlc_id, s, &val) )
+                        {
+                            delete s;
+                            BOOLEAN_TO_NPVARIANT(val.b_bool, result);
+                            return INVOKERESULT_NO_ERROR;
+                        }
+                        else
+                        {
+                            delete s;
+                            return INVOKERESULT_INVALID_ARGS;
+                        }
+                    }
+                    else
+                        return INVOKERESULT_OUT_OF_MEMORY;
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_set_bool_variable: /* deprecated */
+                if( (argCount == 2)
+                    && NPVARIANT_IS_STRING(args[0])
+                    && NPVARIANT_IS_BOOLEAN(args[1]) )
+                {
+                    char *s = stringValue(NPVARIANT_TO_STRING(args[0]));
+                    if( s )
+                    {
+                        int vlc_id = libvlc_get_vlc_id(p_plugin->getVLC());
+                        vlc_value_t val;
+                        val.b_bool = NPVARIANT_TO_BOOLEAN(args[1]);
+                        if( VLC_SUCCESS == VLC_VariableSet(vlc_id, s, val) )
+                        {
+                            delete s;
+                            VOID_TO_NPVARIANT(result);
+                            return INVOKERESULT_NO_ERROR;
+                        }
+                        else
+                        {
+                            delete s;
+                            return INVOKERESULT_INVALID_ARGS;
+                        }
+                    }
+                    else
+                        return INVOKERESULT_OUT_OF_MEMORY;
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_get_str_variable: /* deprecated */
+                if( (argCount == 1) && NPVARIANT_IS_STRING(args[0]) )
+                {
+                    char *s = stringValue(NPVARIANT_TO_STRING(args[0]));
+                    if( s )
+                    {
+                        int vlc_id = libvlc_get_vlc_id(p_plugin->getVLC());
+                        vlc_value_t val;
+                        if( VLC_SUCCESS == VLC_VariableGet(vlc_id, s, &val) )
+                        {
+                            delete s;
+                            if( val.psz_string )
+                            {
+                                int len = strlen(val.psz_string);
+                                NPUTF8 *retval = (NPUTF8 *)NPN_MemAlloc(len);
+                                if( retval )
+                                {
+                                    memcpy(retval, val.psz_string, len);
+                                    STRINGN_TO_NPVARIANT(retval, len, result);
+                                    free(val.psz_string);
+                                    return INVOKERESULT_NO_ERROR;
+                                }
+                                else
+                                {
+                                    return INVOKERESULT_OUT_OF_MEMORY;
+                                }
+                            }
+                            else
+                            {
+                                /* null string */
+                                NULL_TO_NPVARIANT(result);
+                                return INVOKERESULT_NO_ERROR;
+                            }
+                        }
+                        else
+                        {
+                            delete s;
+                            return INVOKERESULT_INVALID_ARGS;
+                        }
+                    }
+                    else
+                        return INVOKERESULT_OUT_OF_MEMORY;
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_set_str_variable: /* deprecated */
+                if( (argCount == 2)
+                    && NPVARIANT_IS_STRING(args[0])
+                    && NPVARIANT_IS_STRING(args[1]) )
+                {
+                    char *s = stringValue(NPVARIANT_TO_STRING(args[0]));
+                    if( s )
+                    {
+                        int vlc_id = libvlc_get_vlc_id(p_plugin->getVLC());
+                        vlc_value_t val;
+                        val.psz_string = stringValue(NPVARIANT_TO_STRING(args[1]));
+                        if( val.psz_string )
+                        {
+                            if( VLC_SUCCESS == VLC_VariableSet(vlc_id, s, val) )
+                            {
+                                delete s;
+                                delete val.psz_string;
+                                VOID_TO_NPVARIANT(result);
+                                return INVOKERESULT_NO_ERROR;
+                            }
+                            else
+                            {
+                                delete s;
+                                delete val.psz_string;
+                                return INVOKERESULT_INVALID_ARGS;
+                            }
+                        }
+                        else
+                        {
+                            delete s;
+                            return INVOKERESULT_OUT_OF_MEMORY;
+                        }
+                    }
+                    else
+                        return INVOKERESULT_OUT_OF_MEMORY;
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_clear_playlist: /* deprecated */
+                if( argCount == 0 )
+                {
+                    libvlc_playlist_clear(p_plugin->getVLC(), &ex);
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    else
+                    {
+                        VOID_TO_NPVARIANT(result);
+                        return INVOKERESULT_NO_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_add_item: /* deprecated */
+                if( (argCount == 1) && NPVARIANT_IS_STRING(args[0]) )
+                {
+                    char *s = stringValue(NPVARIANT_TO_STRING(args[0]));
+                    if( s )
+                    {
+                        char *url = p_plugin->getAbsoluteURL(s);
+                        delete s;
+                        if( ! url )
+                            // what happened ?
+                            return INVOKERESULT_GENERIC_ERROR;
+                             
+                        int item = libvlc_playlist_add(p_plugin->getVLC(), url, NULL, &ex);
+                        free(url);
+                        if( libvlc_exception_raised(&ex) )
+                        {
+                            NPN_SetException(this, libvlc_exception_get_message(&ex));
+                            libvlc_exception_clear(&ex);
+                            return INVOKERESULT_GENERIC_ERROR;
+                        }
+                        else
+                        {
+                            INT32_TO_NPVARIANT(item, result);
+                            return INVOKERESULT_NO_ERROR;
+                        }
+                    }
+                    else
+                        return INVOKERESULT_OUT_OF_MEMORY;
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_next: /* deprecated */
+                if( argCount == 0 )
+                {
+                    libvlc_playlist_next(p_plugin->getVLC(), &ex);
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    else
+                    {
+                        VOID_TO_NPVARIANT(result);
+                        return INVOKERESULT_NO_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_previous: /* deprecated */
+                if( argCount == 0 )
+                {
+                    libvlc_playlist_prev(p_plugin->getVLC(), &ex);
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    else
+                    {
+                        VOID_TO_NPVARIANT(result);
+                        return INVOKERESULT_NO_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_isplaying: /* deprecated */
+                if( argCount == 0 )
+                {
+                    int isplaying = libvlc_playlist_isplaying(p_plugin->getVLC(), &ex);
+                    if( libvlc_exception_raised(&ex) )
+                    {
+                        NPN_SetException(this, libvlc_exception_get_message(&ex));
+                        libvlc_exception_clear(&ex);
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                    else
+                    {
+                        BOOLEAN_TO_NPVARIANT(isplaying, result);
+                        return INVOKERESULT_NO_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_get_length: /* deprecated */
+                if( argCount == 0 )
+                {
+                    libvlc_input_t *p_input = libvlc_playlist_get_input(p_plugin->getVLC(), &ex);
+                    if( p_input )
+                    {
+                        vlc_int64_t val = libvlc_input_get_length(p_input, &ex);
+                        libvlc_input_free(p_input);
+                        if( libvlc_exception_raised(&ex) )
+                        {
+                            NPN_SetException(this, libvlc_exception_get_message(&ex));
+                            libvlc_exception_clear(&ex);
+                            return INVOKERESULT_GENERIC_ERROR;
+                        }
+                        else
+                        {
+                            INT32_TO_NPVARIANT((uint32_t)(val/1000LL), result);
+                            return INVOKERESULT_NO_ERROR;
+                        }
+                    }
+                    else
+                    {
+                        /* cannot get input, probably not playing */
+                        if( libvlc_exception_raised(&ex) )
+                        {
+                            NPN_SetException(this, libvlc_exception_get_message(&ex));
+                            libvlc_exception_clear(&ex);
+                        }
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_get_position: /* deprecated */
+                if( argCount == 0 )
+                {
+                    libvlc_input_t *p_input = libvlc_playlist_get_input(p_plugin->getVLC(), &ex);
+                    if( p_input )
+                    {
+                        float val = libvlc_input_get_position(p_input, &ex);
+                        libvlc_input_free(p_input);
+                        if( libvlc_exception_raised(&ex) )
+                        {
+                            NPN_SetException(this, libvlc_exception_get_message(&ex));
+                            libvlc_exception_clear(&ex);
+                            return INVOKERESULT_GENERIC_ERROR;
+                        }
+                        else
+                        {
+                            DOUBLE_TO_NPVARIANT((double)val, result);
+                            return INVOKERESULT_NO_ERROR;
+                        }
+                    }
+                    else
+                    {
+                        /* cannot get input, probably not playing */
+                        if( libvlc_exception_raised(&ex) )
+                        {
+                            NPN_SetException(this, libvlc_exception_get_message(&ex));
+                            libvlc_exception_clear(&ex);
+                        }
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_get_time: /* deprecated */
+                if( argCount == 0 )
+                {
+                    libvlc_input_t *p_input = libvlc_playlist_get_input(p_plugin->getVLC(), &ex);
+                    if( p_input )
+                    {
+                        vlc_int64_t val = libvlc_input_get_time(p_input, &ex);
+                        libvlc_input_free(p_input);
+                        if( libvlc_exception_raised(&ex) )
+                        {
+                            NPN_SetException(this, libvlc_exception_get_message(&ex));
+                            libvlc_exception_clear(&ex);
+                            return INVOKERESULT_GENERIC_ERROR;
+                        }
+                        else
+                        {
+                            DOUBLE_TO_NPVARIANT((uint32_t)(val/1000LL), result);
+                            return INVOKERESULT_NO_ERROR;
+                        }
+                    }
+                    else
+                    {
+                        /* cannot get input, probably not playing */
+                        if( libvlc_exception_raised(&ex) )
+                        {
+                            NPN_SetException(this, libvlc_exception_get_message(&ex));
+                            libvlc_exception_clear(&ex);
+                        }
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            case ID_seek: /* deprecated */
+                if( (argCount == 2)
+                  && isNumberValue(args[0])
+                  && NPVARIANT_IS_BOOLEAN(args[1]) )
+                {
+                    libvlc_input_t *p_input = libvlc_playlist_get_input(p_plugin->getVLC(), &ex);
+                    if( p_input )
+                    {
+                        vlc_int64_t pos = 0;
+                        if( NPVARIANT_IS_INT32(args[0]) )
+                            pos = (vlc_int64_t)NPVARIANT_TO_INT32(args[0]);
+                        else
+                            pos = (vlc_int64_t)NPVARIANT_TO_DOUBLE(args[0]);
+
+                        if( NPVARIANT_TO_BOOLEAN(args[1]) )
+                        {
+                            /* relative seek */
+                            vlc_int64_t from = libvlc_input_get_time(p_input, &ex);
+                            if( libvlc_exception_raised(&ex) )
+                            {
+                                libvlc_input_free(p_input);
+                                NPN_SetException(this, libvlc_exception_get_message(&ex));
+                                libvlc_exception_clear(&ex);
+                                return INVOKERESULT_GENERIC_ERROR;
+                            }
+                            pos += from;
+                        }
+                        /* jump to time */
+                        libvlc_input_set_time(p_input, pos, &ex);
+                        libvlc_input_free(p_input);
+                        if( libvlc_exception_raised(&ex) )
+                        {
+                            NPN_SetException(this, libvlc_exception_get_message(&ex));
+                            libvlc_exception_clear(&ex);
+                            return INVOKERESULT_GENERIC_ERROR;
+                        }
+                        VOID_TO_NPVARIANT(result);
+                        return INVOKERESULT_NO_ERROR;
+                    }
+                    else
+                    {
+                        /* cannot get input, probably not playing */
+                        if( libvlc_exception_raised(&ex) )
+                        {
+                            NPN_SetException(this, libvlc_exception_get_message(&ex));
+                            libvlc_exception_clear(&ex);
+                        }
+                        return INVOKERESULT_GENERIC_ERROR;
+                    }
+                }
+                return INVOKERESULT_NO_SUCH_METHOD;
+            default:
+                return INVOKERESULT_NO_SUCH_METHOD;
+        }
+    }
+    return INVOKERESULT_GENERIC_ERROR;
+}
+
diff -uNr vlc-0.8.6-svn20060918.debian/mozilla/control/npovlc.h vlc-0.8.6-svn20061008.debian/mozilla/control/npovlc.h
--- vlc-0.8.6-svn20060918.debian/mozilla/control/npovlc.h	1969-12-31 19:00:00.000000000 -0500
+++ vlc-0.8.6-svn20061008.debian/mozilla/control/npovlc.h	2006-10-04 09:47:08.000000000 -0400
@@ -0,0 +1,46 @@
+/*****************************************************************************
+ * npovlc.h: deprecated APIs implemented in late XPCOM interface
+ *****************************************************************************
+ * Copyright (C) 2002-2006 the VideoLAN team
+ *
+ * Authors: Damien Fouilleul <damien.fouilleul@laposte.net>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
+ *****************************************************************************/
+
+/*
+** defined runtime script objects
+*/
+
+#include "nporuntime.h"
+
+class VlcNPObject: public RuntimeNPObject
+{
+protected:
+    friend class RuntimeNPClass<VlcNPObject>;
+
+    VlcNPObject(NPP instance, const NPClass *aClass) :
+        RuntimeNPObject(instance, aClass) {};
+    virtual ~VlcNPObject() {};
+
+    static const int propertyCount;
+    static const NPUTF8 * const propertyNames[];
+
+    static const int methodCount;
+    static const NPUTF8 * const methodNames[];
+
+    virtual InvokeResult invoke(int index, const NPVariant *args, uint32_t argCount, NPVariant &result);
+};
+
diff -uNr vlc-0.8.6-svn20060918.debian/mozilla/Makefile.in vlc-0.8.6-svn20061008.debian/mozilla/Makefile.in
--- vlc-0.8.6-svn20060918.debian/mozilla/Makefile.in	2006-09-18 06:31:06.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/mozilla/Makefile.in	2006-10-08 12:43:11.000000000 -0400
@@ -121,12 +121,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -134,6 +135,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -158,9 +161,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -237,7 +237,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -252,7 +254,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
@@ -305,18 +306,20 @@
 
 noinst_LIBRARIES = $(noinst_LIBRARIES_mozilla)
 
-MOSTLYCLEANFILES = $(npvlc_DATA) $(vlcintf_xpt_DATA) $(am__append_1)
+MOSTLYCLEANFILES = $(npvlc_DATA) $(am__append_1)
 CLEANFILES = stamp-pic $(BUILT_SOURCES) $(am__append_2)
-EXTRA_DIST = $(DIST_sources) vlcintf.idl npvlc_rc.rc vlc.r
+EXTRA_DIST = $(DIST_sources) npvlc_rc.rc vlc.r
 
 SOURCES_mozilla_common = \
 	vlcshell.cpp \
 	vlcplugin.cpp \
 	vlcplugin.h \
-	vlcpeer.cpp \
-	vlcpeer.h \
-	vlcruntime.cpp \
-	vlcruntime.h \
+	control/npolibvlc.cpp \
+	control/npolibvlc.h \
+	control/npovlc.cpp \
+	control/npovlc.h \
+	control/nporuntime.cpp \
+	control/nporuntime.h \
 	support/classinfo.h
 
 
@@ -381,9 +384,6 @@
 
 @BUILD_MOZILLA_TRUE@noinst_LIBRARIES_mozilla = libnpvlc.a
 
-@BUILD_MOZILLA_TRUE@BUILT_SOURCES = vlcintf.h
-@BUILD_MOZILLA_TRUE@vlcintf_xpt_DATA = vlcintf.xpt
-
 # FIXME: name is incorrect on Win32 & Darwin
 @BUILD_MOZILLA_TRUE@@USE_LIBTOOL_TRUE@npvlc_LTLIBRARIES = libvlcplugin.la
 @BUILD_MOZILLA_TRUE@@USE_LIBTOOL_FALSE@npvlc_DATA = $(npvlc)
@@ -404,8 +404,6 @@
 
 LDFLAGS_libnpvlc = $(LDFLAGS_npvlc) `$(VLC_CONFIG) --libs mozilla vlc builtin pic`
 libnpvlc_a_DEPENDENCIES = $(DATA_npvlc_rc)
-
-vlcintf_xptdir = $(libdir)/mozilla/components
 subdir = mozilla
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
 mkinstalldirs = $(SHELL) $(top_srcdir)/autotools/mkinstalldirs
@@ -416,12 +414,13 @@
 libnpvlc_a_AR = $(AR) cru
 libnpvlc_a_LIBADD =
 am__libnpvlc_a_SOURCES_DIST = vlcshell.cpp vlcplugin.cpp vlcplugin.h \
-	vlcpeer.cpp vlcpeer.h vlcruntime.cpp vlcruntime.h \
+	control/npolibvlc.cpp control/npolibvlc.h control/npovlc.cpp \
+	control/npovlc.h control/nporuntime.cpp control/nporuntime.h \
 	support/classinfo.h support/npunix.c support/npwin.cpp \
 	support/npmac.cpp
 am__objects_1 = libnpvlc_a-vlcshell.$(OBJEXT) \
-	libnpvlc_a-vlcplugin.$(OBJEXT) libnpvlc_a-vlcpeer.$(OBJEXT) \
-	libnpvlc_a-vlcruntime.$(OBJEXT)
+	libnpvlc_a-vlcplugin.$(OBJEXT) libnpvlc_a-npolibvlc.$(OBJEXT) \
+	libnpvlc_a-npovlc.$(OBJEXT) libnpvlc_a-nporuntime.$(OBJEXT)
 @BUILD_MOZILLA_TRUE@@HAVE_DARWIN_FALSE@@HAVE_WIN32_FALSE@am__objects_2 = \
 @BUILD_MOZILLA_TRUE@@HAVE_DARWIN_FALSE@@HAVE_WIN32_FALSE@	libnpvlc_a-npunix.$(OBJEXT)
 @BUILD_MOZILLA_TRUE@@HAVE_DARWIN_TRUE@@HAVE_WIN32_FALSE@am__objects_2 = \
@@ -434,11 +433,13 @@
 
 libvlcplugin_la_DEPENDENCIES = ../src/libvlc.la
 am__libvlcplugin_la_SOURCES_DIST = vlcshell.cpp vlcplugin.cpp \
-	vlcplugin.h vlcpeer.cpp vlcpeer.h vlcruntime.cpp vlcruntime.h \
-	support/classinfo.h support/npunix.c support/npwin.cpp \
-	support/npmac.cpp
+	vlcplugin.h control/npolibvlc.cpp control/npolibvlc.h \
+	control/npovlc.cpp control/npovlc.h control/nporuntime.cpp \
+	control/nporuntime.h support/classinfo.h support/npunix.c \
+	support/npwin.cpp support/npmac.cpp
 am__objects_3 = libvlcplugin_la-vlcshell.lo libvlcplugin_la-vlcplugin.lo \
-	libvlcplugin_la-vlcpeer.lo libvlcplugin_la-vlcruntime.lo
+	libvlcplugin_la-npolibvlc.lo libvlcplugin_la-npovlc.lo \
+	libvlcplugin_la-nporuntime.lo
 @BUILD_MOZILLA_TRUE@@HAVE_DARWIN_FALSE@@HAVE_WIN32_FALSE@am__objects_4 = \
 @BUILD_MOZILLA_TRUE@@HAVE_DARWIN_FALSE@@HAVE_WIN32_FALSE@	libvlcplugin_la-npunix.lo
 @BUILD_MOZILLA_TRUE@@HAVE_DARWIN_TRUE@@HAVE_WIN32_FALSE@am__objects_4 = \
@@ -452,18 +453,20 @@
 depcomp = $(SHELL) $(top_srcdir)/autotools/depcomp
 am__depfiles_maybe = depfiles
 @AMDEP_TRUE@DEP_FILES = ./$(DEPDIR)/libnpvlc_a-npmac.Po \
+@AMDEP_TRUE@	./$(DEPDIR)/libnpvlc_a-npolibvlc.Po \
+@AMDEP_TRUE@	./$(DEPDIR)/libnpvlc_a-nporuntime.Po \
+@AMDEP_TRUE@	./$(DEPDIR)/libnpvlc_a-npovlc.Po \
 @AMDEP_TRUE@	./$(DEPDIR)/libnpvlc_a-npunix.Po \
 @AMDEP_TRUE@	./$(DEPDIR)/libnpvlc_a-npwin.Po \
-@AMDEP_TRUE@	./$(DEPDIR)/libnpvlc_a-vlcpeer.Po \
 @AMDEP_TRUE@	./$(DEPDIR)/libnpvlc_a-vlcplugin.Po \
-@AMDEP_TRUE@	./$(DEPDIR)/libnpvlc_a-vlcruntime.Po \
 @AMDEP_TRUE@	./$(DEPDIR)/libnpvlc_a-vlcshell.Po \
 @AMDEP_TRUE@	./$(DEPDIR)/libvlcplugin_la-npmac.Plo \
+@AMDEP_TRUE@	./$(DEPDIR)/libvlcplugin_la-npolibvlc.Plo \
+@AMDEP_TRUE@	./$(DEPDIR)/libvlcplugin_la-nporuntime.Plo \
+@AMDEP_TRUE@	./$(DEPDIR)/libvlcplugin_la-npovlc.Plo \
 @AMDEP_TRUE@	./$(DEPDIR)/libvlcplugin_la-npunix.Plo \
 @AMDEP_TRUE@	./$(DEPDIR)/libvlcplugin_la-npwin.Plo \
-@AMDEP_TRUE@	./$(DEPDIR)/libvlcplugin_la-vlcpeer.Plo \
 @AMDEP_TRUE@	./$(DEPDIR)/libvlcplugin_la-vlcplugin.Plo \
-@AMDEP_TRUE@	./$(DEPDIR)/libvlcplugin_la-vlcruntime.Plo \
 @AMDEP_TRUE@	./$(DEPDIR)/libvlcplugin_la-vlcshell.Plo
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
 	$(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)
@@ -482,14 +485,12 @@
 	$(AM_LDFLAGS) $(LDFLAGS) -o $@
 DIST_SOURCES = $(am__libnpvlc_a_SOURCES_DIST) \
 	$(am__libvlcplugin_la_SOURCES_DIST)
-DATA = $(noinst_DATA) $(noinst_npvlc_rc_DATA) $(npvlc_DATA) \
-	$(vlcintf_xpt_DATA)
+DATA = $(noinst_DATA) $(noinst_npvlc_rc_DATA) $(npvlc_DATA)
 
 DIST_COMMON = $(srcdir)/Makefile.in Makefile.am
 SOURCES = $(libnpvlc_a_SOURCES) $(libvlcplugin_la_SOURCES)
 
-all: $(BUILT_SOURCES)
-	$(MAKE) $(AM_MAKEFLAGS) all-am
+all: all-am
 
 .SUFFIXES:
 .SUFFIXES: .c .cpp .lo .o .obj
@@ -543,18 +544,20 @@
 	-rm -f *.tab.c
 
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libnpvlc_a-npmac.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libnpvlc_a-npolibvlc.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libnpvlc_a-nporuntime.Po@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libnpvlc_a-npovlc.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libnpvlc_a-npunix.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libnpvlc_a-npwin.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libnpvlc_a-vlcpeer.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libnpvlc_a-vlcplugin.Po@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libnpvlc_a-vlcruntime.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libnpvlc_a-vlcshell.Po@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libvlcplugin_la-npmac.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libvlcplugin_la-npolibvlc.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libvlcplugin_la-nporuntime.Plo@am__quote@
+@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libvlcplugin_la-npovlc.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libvlcplugin_la-npunix.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libvlcplugin_la-npwin.Plo@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libvlcplugin_la-vlcpeer.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libvlcplugin_la-vlcplugin.Plo@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libvlcplugin_la-vlcruntime.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/libvlcplugin_la-vlcshell.Plo@am__quote@
 
 .c.o:
@@ -755,71 +758,104 @@
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCXX_FALSE@	$(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -c -o libnpvlc_a-vlcplugin.lo `test -f 'vlcplugin.cpp' || echo '$(srcdir)/'`vlcplugin.cpp
 
-libnpvlc_a-vlcpeer.o: vlcpeer.cpp
-@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -MT libnpvlc_a-vlcpeer.o -MD -MP -MF "$(DEPDIR)/libnpvlc_a-vlcpeer.Tpo" \
-@am__fastdepCXX_TRUE@	  -c -o libnpvlc_a-vlcpeer.o `test -f 'vlcpeer.cpp' || echo '$(srcdir)/'`vlcpeer.cpp; \
-@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libnpvlc_a-vlcpeer.Tpo" "$(DEPDIR)/libnpvlc_a-vlcpeer.Po"; \
-@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libnpvlc_a-vlcpeer.Tpo"; exit 1; \
+libnpvlc_a-npolibvlc.o: control/npolibvlc.cpp
+@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -MT libnpvlc_a-npolibvlc.o -MD -MP -MF "$(DEPDIR)/libnpvlc_a-npolibvlc.Tpo" \
+@am__fastdepCXX_TRUE@	  -c -o libnpvlc_a-npolibvlc.o `test -f 'control/npolibvlc.cpp' || echo '$(srcdir)/'`control/npolibvlc.cpp; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libnpvlc_a-npolibvlc.Tpo" "$(DEPDIR)/libnpvlc_a-npolibvlc.Po"; \
+@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libnpvlc_a-npolibvlc.Tpo"; exit 1; \
+@am__fastdepCXX_TRUE@	fi
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='control/npolibvlc.cpp' object='libnpvlc_a-npolibvlc.o' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libnpvlc_a-npolibvlc.Po' tmpdepfile='$(DEPDIR)/libnpvlc_a-npolibvlc.TPo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -c -o libnpvlc_a-npolibvlc.o `test -f 'control/npolibvlc.cpp' || echo '$(srcdir)/'`control/npolibvlc.cpp
+
+libnpvlc_a-npolibvlc.obj: control/npolibvlc.cpp
+@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -MT libnpvlc_a-npolibvlc.obj -MD -MP -MF "$(DEPDIR)/libnpvlc_a-npolibvlc.Tpo" \
+@am__fastdepCXX_TRUE@	  -c -o libnpvlc_a-npolibvlc.obj `if test -f 'control/npolibvlc.cpp'; then $(CYGPATH_W) 'control/npolibvlc.cpp'; else $(CYGPATH_W) '$(srcdir)/control/npolibvlc.cpp'; fi`; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libnpvlc_a-npolibvlc.Tpo" "$(DEPDIR)/libnpvlc_a-npolibvlc.Po"; \
+@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libnpvlc_a-npolibvlc.Tpo"; exit 1; \
+@am__fastdepCXX_TRUE@	fi
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='control/npolibvlc.cpp' object='libnpvlc_a-npolibvlc.obj' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libnpvlc_a-npolibvlc.Po' tmpdepfile='$(DEPDIR)/libnpvlc_a-npolibvlc.TPo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -c -o libnpvlc_a-npolibvlc.obj `if test -f 'control/npolibvlc.cpp'; then $(CYGPATH_W) 'control/npolibvlc.cpp'; else $(CYGPATH_W) '$(srcdir)/control/npolibvlc.cpp'; fi`
+
+libnpvlc_a-npolibvlc.lo: control/npolibvlc.cpp
+@am__fastdepCXX_TRUE@	if $(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -MT libnpvlc_a-npolibvlc.lo -MD -MP -MF "$(DEPDIR)/libnpvlc_a-npolibvlc.Tpo" \
+@am__fastdepCXX_TRUE@	  -c -o libnpvlc_a-npolibvlc.lo `test -f 'control/npolibvlc.cpp' || echo '$(srcdir)/'`control/npolibvlc.cpp; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libnpvlc_a-npolibvlc.Tpo" "$(DEPDIR)/libnpvlc_a-npolibvlc.Plo"; \
+@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libnpvlc_a-npolibvlc.Tpo"; exit 1; \
+@am__fastdepCXX_TRUE@	fi
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='control/npolibvlc.cpp' object='libnpvlc_a-npolibvlc.lo' libtool=yes @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libnpvlc_a-npolibvlc.Plo' tmpdepfile='$(DEPDIR)/libnpvlc_a-npolibvlc.TPlo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCXX_FALSE@	$(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -c -o libnpvlc_a-npolibvlc.lo `test -f 'control/npolibvlc.cpp' || echo '$(srcdir)/'`control/npolibvlc.cpp
+
+libnpvlc_a-npovlc.o: control/npovlc.cpp
+@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -MT libnpvlc_a-npovlc.o -MD -MP -MF "$(DEPDIR)/libnpvlc_a-npovlc.Tpo" \
+@am__fastdepCXX_TRUE@	  -c -o libnpvlc_a-npovlc.o `test -f 'control/npovlc.cpp' || echo '$(srcdir)/'`control/npovlc.cpp; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libnpvlc_a-npovlc.Tpo" "$(DEPDIR)/libnpvlc_a-npovlc.Po"; \
+@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libnpvlc_a-npovlc.Tpo"; exit 1; \
 @am__fastdepCXX_TRUE@	fi
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='vlcpeer.cpp' object='libnpvlc_a-vlcpeer.o' libtool=no @AMDEPBACKSLASH@
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libnpvlc_a-vlcpeer.Po' tmpdepfile='$(DEPDIR)/libnpvlc_a-vlcpeer.TPo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='control/npovlc.cpp' object='libnpvlc_a-npovlc.o' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libnpvlc_a-npovlc.Po' tmpdepfile='$(DEPDIR)/libnpvlc_a-npovlc.TPo' @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
-@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -c -o libnpvlc_a-vlcpeer.o `test -f 'vlcpeer.cpp' || echo '$(srcdir)/'`vlcpeer.cpp
+@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -c -o libnpvlc_a-npovlc.o `test -f 'control/npovlc.cpp' || echo '$(srcdir)/'`control/npovlc.cpp
 
-libnpvlc_a-vlcpeer.obj: vlcpeer.cpp
-@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -MT libnpvlc_a-vlcpeer.obj -MD -MP -MF "$(DEPDIR)/libnpvlc_a-vlcpeer.Tpo" \
-@am__fastdepCXX_TRUE@	  -c -o libnpvlc_a-vlcpeer.obj `if test -f 'vlcpeer.cpp'; then $(CYGPATH_W) 'vlcpeer.cpp'; else $(CYGPATH_W) '$(srcdir)/vlcpeer.cpp'; fi`; \
-@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libnpvlc_a-vlcpeer.Tpo" "$(DEPDIR)/libnpvlc_a-vlcpeer.Po"; \
-@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libnpvlc_a-vlcpeer.Tpo"; exit 1; \
+libnpvlc_a-npovlc.obj: control/npovlc.cpp
+@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -MT libnpvlc_a-npovlc.obj -MD -MP -MF "$(DEPDIR)/libnpvlc_a-npovlc.Tpo" \
+@am__fastdepCXX_TRUE@	  -c -o libnpvlc_a-npovlc.obj `if test -f 'control/npovlc.cpp'; then $(CYGPATH_W) 'control/npovlc.cpp'; else $(CYGPATH_W) '$(srcdir)/control/npovlc.cpp'; fi`; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libnpvlc_a-npovlc.Tpo" "$(DEPDIR)/libnpvlc_a-npovlc.Po"; \
+@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libnpvlc_a-npovlc.Tpo"; exit 1; \
 @am__fastdepCXX_TRUE@	fi
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='vlcpeer.cpp' object='libnpvlc_a-vlcpeer.obj' libtool=no @AMDEPBACKSLASH@
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libnpvlc_a-vlcpeer.Po' tmpdepfile='$(DEPDIR)/libnpvlc_a-vlcpeer.TPo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='control/npovlc.cpp' object='libnpvlc_a-npovlc.obj' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libnpvlc_a-npovlc.Po' tmpdepfile='$(DEPDIR)/libnpvlc_a-npovlc.TPo' @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
-@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -c -o libnpvlc_a-vlcpeer.obj `if test -f 'vlcpeer.cpp'; then $(CYGPATH_W) 'vlcpeer.cpp'; else $(CYGPATH_W) '$(srcdir)/vlcpeer.cpp'; fi`
+@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -c -o libnpvlc_a-npovlc.obj `if test -f 'control/npovlc.cpp'; then $(CYGPATH_W) 'control/npovlc.cpp'; else $(CYGPATH_W) '$(srcdir)/control/npovlc.cpp'; fi`
 
-libnpvlc_a-vlcpeer.lo: vlcpeer.cpp
-@am__fastdepCXX_TRUE@	if $(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -MT libnpvlc_a-vlcpeer.lo -MD -MP -MF "$(DEPDIR)/libnpvlc_a-vlcpeer.Tpo" \
-@am__fastdepCXX_TRUE@	  -c -o libnpvlc_a-vlcpeer.lo `test -f 'vlcpeer.cpp' || echo '$(srcdir)/'`vlcpeer.cpp; \
-@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libnpvlc_a-vlcpeer.Tpo" "$(DEPDIR)/libnpvlc_a-vlcpeer.Plo"; \
-@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libnpvlc_a-vlcpeer.Tpo"; exit 1; \
+libnpvlc_a-npovlc.lo: control/npovlc.cpp
+@am__fastdepCXX_TRUE@	if $(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -MT libnpvlc_a-npovlc.lo -MD -MP -MF "$(DEPDIR)/libnpvlc_a-npovlc.Tpo" \
+@am__fastdepCXX_TRUE@	  -c -o libnpvlc_a-npovlc.lo `test -f 'control/npovlc.cpp' || echo '$(srcdir)/'`control/npovlc.cpp; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libnpvlc_a-npovlc.Tpo" "$(DEPDIR)/libnpvlc_a-npovlc.Plo"; \
+@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libnpvlc_a-npovlc.Tpo"; exit 1; \
 @am__fastdepCXX_TRUE@	fi
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='vlcpeer.cpp' object='libnpvlc_a-vlcpeer.lo' libtool=yes @AMDEPBACKSLASH@
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libnpvlc_a-vlcpeer.Plo' tmpdepfile='$(DEPDIR)/libnpvlc_a-vlcpeer.TPlo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='control/npovlc.cpp' object='libnpvlc_a-npovlc.lo' libtool=yes @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libnpvlc_a-npovlc.Plo' tmpdepfile='$(DEPDIR)/libnpvlc_a-npovlc.TPlo' @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
-@am__fastdepCXX_FALSE@	$(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -c -o libnpvlc_a-vlcpeer.lo `test -f 'vlcpeer.cpp' || echo '$(srcdir)/'`vlcpeer.cpp
+@am__fastdepCXX_FALSE@	$(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -c -o libnpvlc_a-npovlc.lo `test -f 'control/npovlc.cpp' || echo '$(srcdir)/'`control/npovlc.cpp
 
-libnpvlc_a-vlcruntime.o: vlcruntime.cpp
-@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -MT libnpvlc_a-vlcruntime.o -MD -MP -MF "$(DEPDIR)/libnpvlc_a-vlcruntime.Tpo" \
-@am__fastdepCXX_TRUE@	  -c -o libnpvlc_a-vlcruntime.o `test -f 'vlcruntime.cpp' || echo '$(srcdir)/'`vlcruntime.cpp; \
-@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libnpvlc_a-vlcruntime.Tpo" "$(DEPDIR)/libnpvlc_a-vlcruntime.Po"; \
-@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libnpvlc_a-vlcruntime.Tpo"; exit 1; \
+libnpvlc_a-nporuntime.o: control/nporuntime.cpp
+@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -MT libnpvlc_a-nporuntime.o -MD -MP -MF "$(DEPDIR)/libnpvlc_a-nporuntime.Tpo" \
+@am__fastdepCXX_TRUE@	  -c -o libnpvlc_a-nporuntime.o `test -f 'control/nporuntime.cpp' || echo '$(srcdir)/'`control/nporuntime.cpp; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libnpvlc_a-nporuntime.Tpo" "$(DEPDIR)/libnpvlc_a-nporuntime.Po"; \
+@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libnpvlc_a-nporuntime.Tpo"; exit 1; \
 @am__fastdepCXX_TRUE@	fi
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='vlcruntime.cpp' object='libnpvlc_a-vlcruntime.o' libtool=no @AMDEPBACKSLASH@
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libnpvlc_a-vlcruntime.Po' tmpdepfile='$(DEPDIR)/libnpvlc_a-vlcruntime.TPo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='control/nporuntime.cpp' object='libnpvlc_a-nporuntime.o' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libnpvlc_a-nporuntime.Po' tmpdepfile='$(DEPDIR)/libnpvlc_a-nporuntime.TPo' @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
-@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -c -o libnpvlc_a-vlcruntime.o `test -f 'vlcruntime.cpp' || echo '$(srcdir)/'`vlcruntime.cpp
+@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -c -o libnpvlc_a-nporuntime.o `test -f 'control/nporuntime.cpp' || echo '$(srcdir)/'`control/nporuntime.cpp
 
-libnpvlc_a-vlcruntime.obj: vlcruntime.cpp
-@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -MT libnpvlc_a-vlcruntime.obj -MD -MP -MF "$(DEPDIR)/libnpvlc_a-vlcruntime.Tpo" \
-@am__fastdepCXX_TRUE@	  -c -o libnpvlc_a-vlcruntime.obj `if test -f 'vlcruntime.cpp'; then $(CYGPATH_W) 'vlcruntime.cpp'; else $(CYGPATH_W) '$(srcdir)/vlcruntime.cpp'; fi`; \
-@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libnpvlc_a-vlcruntime.Tpo" "$(DEPDIR)/libnpvlc_a-vlcruntime.Po"; \
-@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libnpvlc_a-vlcruntime.Tpo"; exit 1; \
+libnpvlc_a-nporuntime.obj: control/nporuntime.cpp
+@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -MT libnpvlc_a-nporuntime.obj -MD -MP -MF "$(DEPDIR)/libnpvlc_a-nporuntime.Tpo" \
+@am__fastdepCXX_TRUE@	  -c -o libnpvlc_a-nporuntime.obj `if test -f 'control/nporuntime.cpp'; then $(CYGPATH_W) 'control/nporuntime.cpp'; else $(CYGPATH_W) '$(srcdir)/control/nporuntime.cpp'; fi`; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libnpvlc_a-nporuntime.Tpo" "$(DEPDIR)/libnpvlc_a-nporuntime.Po"; \
+@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libnpvlc_a-nporuntime.Tpo"; exit 1; \
 @am__fastdepCXX_TRUE@	fi
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='vlcruntime.cpp' object='libnpvlc_a-vlcruntime.obj' libtool=no @AMDEPBACKSLASH@
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libnpvlc_a-vlcruntime.Po' tmpdepfile='$(DEPDIR)/libnpvlc_a-vlcruntime.TPo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='control/nporuntime.cpp' object='libnpvlc_a-nporuntime.obj' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libnpvlc_a-nporuntime.Po' tmpdepfile='$(DEPDIR)/libnpvlc_a-nporuntime.TPo' @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
-@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -c -o libnpvlc_a-vlcruntime.obj `if test -f 'vlcruntime.cpp'; then $(CYGPATH_W) 'vlcruntime.cpp'; else $(CYGPATH_W) '$(srcdir)/vlcruntime.cpp'; fi`
+@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -c -o libnpvlc_a-nporuntime.obj `if test -f 'control/nporuntime.cpp'; then $(CYGPATH_W) 'control/nporuntime.cpp'; else $(CYGPATH_W) '$(srcdir)/control/nporuntime.cpp'; fi`
 
-libnpvlc_a-vlcruntime.lo: vlcruntime.cpp
-@am__fastdepCXX_TRUE@	if $(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -MT libnpvlc_a-vlcruntime.lo -MD -MP -MF "$(DEPDIR)/libnpvlc_a-vlcruntime.Tpo" \
-@am__fastdepCXX_TRUE@	  -c -o libnpvlc_a-vlcruntime.lo `test -f 'vlcruntime.cpp' || echo '$(srcdir)/'`vlcruntime.cpp; \
-@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libnpvlc_a-vlcruntime.Tpo" "$(DEPDIR)/libnpvlc_a-vlcruntime.Plo"; \
-@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libnpvlc_a-vlcruntime.Tpo"; exit 1; \
+libnpvlc_a-nporuntime.lo: control/nporuntime.cpp
+@am__fastdepCXX_TRUE@	if $(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -MT libnpvlc_a-nporuntime.lo -MD -MP -MF "$(DEPDIR)/libnpvlc_a-nporuntime.Tpo" \
+@am__fastdepCXX_TRUE@	  -c -o libnpvlc_a-nporuntime.lo `test -f 'control/nporuntime.cpp' || echo '$(srcdir)/'`control/nporuntime.cpp; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libnpvlc_a-nporuntime.Tpo" "$(DEPDIR)/libnpvlc_a-nporuntime.Plo"; \
+@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libnpvlc_a-nporuntime.Tpo"; exit 1; \
 @am__fastdepCXX_TRUE@	fi
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='vlcruntime.cpp' object='libnpvlc_a-vlcruntime.lo' libtool=yes @AMDEPBACKSLASH@
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libnpvlc_a-vlcruntime.Plo' tmpdepfile='$(DEPDIR)/libnpvlc_a-vlcruntime.TPlo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='control/nporuntime.cpp' object='libnpvlc_a-nporuntime.lo' libtool=yes @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libnpvlc_a-nporuntime.Plo' tmpdepfile='$(DEPDIR)/libnpvlc_a-nporuntime.TPlo' @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
-@am__fastdepCXX_FALSE@	$(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -c -o libnpvlc_a-vlcruntime.lo `test -f 'vlcruntime.cpp' || echo '$(srcdir)/'`vlcruntime.cpp
+@am__fastdepCXX_FALSE@	$(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -c -o libnpvlc_a-nporuntime.lo `test -f 'control/nporuntime.cpp' || echo '$(srcdir)/'`control/nporuntime.cpp
 
 libnpvlc_a-npmac.o: support/npmac.cpp
 @am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libnpvlc_a_CXXFLAGS) $(CXXFLAGS) -MT libnpvlc_a-npmac.o -MD -MP -MF "$(DEPDIR)/libnpvlc_a-npmac.Tpo" \
@@ -953,71 +989,104 @@
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCXX_FALSE@	$(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -c -o libvlcplugin_la-vlcplugin.lo `test -f 'vlcplugin.cpp' || echo '$(srcdir)/'`vlcplugin.cpp
 
-libvlcplugin_la-vlcpeer.o: vlcpeer.cpp
-@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -MT libvlcplugin_la-vlcpeer.o -MD -MP -MF "$(DEPDIR)/libvlcplugin_la-vlcpeer.Tpo" \
-@am__fastdepCXX_TRUE@	  -c -o libvlcplugin_la-vlcpeer.o `test -f 'vlcpeer.cpp' || echo '$(srcdir)/'`vlcpeer.cpp; \
-@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libvlcplugin_la-vlcpeer.Tpo" "$(DEPDIR)/libvlcplugin_la-vlcpeer.Po"; \
-@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libvlcplugin_la-vlcpeer.Tpo"; exit 1; \
+libvlcplugin_la-npolibvlc.o: control/npolibvlc.cpp
+@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -MT libvlcplugin_la-npolibvlc.o -MD -MP -MF "$(DEPDIR)/libvlcplugin_la-npolibvlc.Tpo" \
+@am__fastdepCXX_TRUE@	  -c -o libvlcplugin_la-npolibvlc.o `test -f 'control/npolibvlc.cpp' || echo '$(srcdir)/'`control/npolibvlc.cpp; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libvlcplugin_la-npolibvlc.Tpo" "$(DEPDIR)/libvlcplugin_la-npolibvlc.Po"; \
+@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libvlcplugin_la-npolibvlc.Tpo"; exit 1; \
+@am__fastdepCXX_TRUE@	fi
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='control/npolibvlc.cpp' object='libvlcplugin_la-npolibvlc.o' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libvlcplugin_la-npolibvlc.Po' tmpdepfile='$(DEPDIR)/libvlcplugin_la-npolibvlc.TPo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -c -o libvlcplugin_la-npolibvlc.o `test -f 'control/npolibvlc.cpp' || echo '$(srcdir)/'`control/npolibvlc.cpp
+
+libvlcplugin_la-npolibvlc.obj: control/npolibvlc.cpp
+@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -MT libvlcplugin_la-npolibvlc.obj -MD -MP -MF "$(DEPDIR)/libvlcplugin_la-npolibvlc.Tpo" \
+@am__fastdepCXX_TRUE@	  -c -o libvlcplugin_la-npolibvlc.obj `if test -f 'control/npolibvlc.cpp'; then $(CYGPATH_W) 'control/npolibvlc.cpp'; else $(CYGPATH_W) '$(srcdir)/control/npolibvlc.cpp'; fi`; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libvlcplugin_la-npolibvlc.Tpo" "$(DEPDIR)/libvlcplugin_la-npolibvlc.Po"; \
+@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libvlcplugin_la-npolibvlc.Tpo"; exit 1; \
 @am__fastdepCXX_TRUE@	fi
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='vlcpeer.cpp' object='libvlcplugin_la-vlcpeer.o' libtool=no @AMDEPBACKSLASH@
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libvlcplugin_la-vlcpeer.Po' tmpdepfile='$(DEPDIR)/libvlcplugin_la-vlcpeer.TPo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='control/npolibvlc.cpp' object='libvlcplugin_la-npolibvlc.obj' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libvlcplugin_la-npolibvlc.Po' tmpdepfile='$(DEPDIR)/libvlcplugin_la-npolibvlc.TPo' @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
-@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -c -o libvlcplugin_la-vlcpeer.o `test -f 'vlcpeer.cpp' || echo '$(srcdir)/'`vlcpeer.cpp
+@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -c -o libvlcplugin_la-npolibvlc.obj `if test -f 'control/npolibvlc.cpp'; then $(CYGPATH_W) 'control/npolibvlc.cpp'; else $(CYGPATH_W) '$(srcdir)/control/npolibvlc.cpp'; fi`
 
-libvlcplugin_la-vlcpeer.obj: vlcpeer.cpp
-@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -MT libvlcplugin_la-vlcpeer.obj -MD -MP -MF "$(DEPDIR)/libvlcplugin_la-vlcpeer.Tpo" \
-@am__fastdepCXX_TRUE@	  -c -o libvlcplugin_la-vlcpeer.obj `if test -f 'vlcpeer.cpp'; then $(CYGPATH_W) 'vlcpeer.cpp'; else $(CYGPATH_W) '$(srcdir)/vlcpeer.cpp'; fi`; \
-@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libvlcplugin_la-vlcpeer.Tpo" "$(DEPDIR)/libvlcplugin_la-vlcpeer.Po"; \
-@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libvlcplugin_la-vlcpeer.Tpo"; exit 1; \
+libvlcplugin_la-npolibvlc.lo: control/npolibvlc.cpp
+@am__fastdepCXX_TRUE@	if $(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -MT libvlcplugin_la-npolibvlc.lo -MD -MP -MF "$(DEPDIR)/libvlcplugin_la-npolibvlc.Tpo" \
+@am__fastdepCXX_TRUE@	  -c -o libvlcplugin_la-npolibvlc.lo `test -f 'control/npolibvlc.cpp' || echo '$(srcdir)/'`control/npolibvlc.cpp; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libvlcplugin_la-npolibvlc.Tpo" "$(DEPDIR)/libvlcplugin_la-npolibvlc.Plo"; \
+@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libvlcplugin_la-npolibvlc.Tpo"; exit 1; \
 @am__fastdepCXX_TRUE@	fi
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='vlcpeer.cpp' object='libvlcplugin_la-vlcpeer.obj' libtool=no @AMDEPBACKSLASH@
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libvlcplugin_la-vlcpeer.Po' tmpdepfile='$(DEPDIR)/libvlcplugin_la-vlcpeer.TPo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='control/npolibvlc.cpp' object='libvlcplugin_la-npolibvlc.lo' libtool=yes @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libvlcplugin_la-npolibvlc.Plo' tmpdepfile='$(DEPDIR)/libvlcplugin_la-npolibvlc.TPlo' @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
-@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -c -o libvlcplugin_la-vlcpeer.obj `if test -f 'vlcpeer.cpp'; then $(CYGPATH_W) 'vlcpeer.cpp'; else $(CYGPATH_W) '$(srcdir)/vlcpeer.cpp'; fi`
+@am__fastdepCXX_FALSE@	$(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -c -o libvlcplugin_la-npolibvlc.lo `test -f 'control/npolibvlc.cpp' || echo '$(srcdir)/'`control/npolibvlc.cpp
 
-libvlcplugin_la-vlcpeer.lo: vlcpeer.cpp
-@am__fastdepCXX_TRUE@	if $(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -MT libvlcplugin_la-vlcpeer.lo -MD -MP -MF "$(DEPDIR)/libvlcplugin_la-vlcpeer.Tpo" \
-@am__fastdepCXX_TRUE@	  -c -o libvlcplugin_la-vlcpeer.lo `test -f 'vlcpeer.cpp' || echo '$(srcdir)/'`vlcpeer.cpp; \
-@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libvlcplugin_la-vlcpeer.Tpo" "$(DEPDIR)/libvlcplugin_la-vlcpeer.Plo"; \
-@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libvlcplugin_la-vlcpeer.Tpo"; exit 1; \
+libvlcplugin_la-npovlc.o: control/npovlc.cpp
+@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -MT libvlcplugin_la-npovlc.o -MD -MP -MF "$(DEPDIR)/libvlcplugin_la-npovlc.Tpo" \
+@am__fastdepCXX_TRUE@	  -c -o libvlcplugin_la-npovlc.o `test -f 'control/npovlc.cpp' || echo '$(srcdir)/'`control/npovlc.cpp; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libvlcplugin_la-npovlc.Tpo" "$(DEPDIR)/libvlcplugin_la-npovlc.Po"; \
+@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libvlcplugin_la-npovlc.Tpo"; exit 1; \
 @am__fastdepCXX_TRUE@	fi
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='vlcpeer.cpp' object='libvlcplugin_la-vlcpeer.lo' libtool=yes @AMDEPBACKSLASH@
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libvlcplugin_la-vlcpeer.Plo' tmpdepfile='$(DEPDIR)/libvlcplugin_la-vlcpeer.TPlo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='control/npovlc.cpp' object='libvlcplugin_la-npovlc.o' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libvlcplugin_la-npovlc.Po' tmpdepfile='$(DEPDIR)/libvlcplugin_la-npovlc.TPo' @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
-@am__fastdepCXX_FALSE@	$(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -c -o libvlcplugin_la-vlcpeer.lo `test -f 'vlcpeer.cpp' || echo '$(srcdir)/'`vlcpeer.cpp
+@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -c -o libvlcplugin_la-npovlc.o `test -f 'control/npovlc.cpp' || echo '$(srcdir)/'`control/npovlc.cpp
 
-libvlcplugin_la-vlcruntime.o: vlcruntime.cpp
-@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -MT libvlcplugin_la-vlcruntime.o -MD -MP -MF "$(DEPDIR)/libvlcplugin_la-vlcruntime.Tpo" \
-@am__fastdepCXX_TRUE@	  -c -o libvlcplugin_la-vlcruntime.o `test -f 'vlcruntime.cpp' || echo '$(srcdir)/'`vlcruntime.cpp; \
-@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libvlcplugin_la-vlcruntime.Tpo" "$(DEPDIR)/libvlcplugin_la-vlcruntime.Po"; \
-@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libvlcplugin_la-vlcruntime.Tpo"; exit 1; \
+libvlcplugin_la-npovlc.obj: control/npovlc.cpp
+@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -MT libvlcplugin_la-npovlc.obj -MD -MP -MF "$(DEPDIR)/libvlcplugin_la-npovlc.Tpo" \
+@am__fastdepCXX_TRUE@	  -c -o libvlcplugin_la-npovlc.obj `if test -f 'control/npovlc.cpp'; then $(CYGPATH_W) 'control/npovlc.cpp'; else $(CYGPATH_W) '$(srcdir)/control/npovlc.cpp'; fi`; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libvlcplugin_la-npovlc.Tpo" "$(DEPDIR)/libvlcplugin_la-npovlc.Po"; \
+@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libvlcplugin_la-npovlc.Tpo"; exit 1; \
 @am__fastdepCXX_TRUE@	fi
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='vlcruntime.cpp' object='libvlcplugin_la-vlcruntime.o' libtool=no @AMDEPBACKSLASH@
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libvlcplugin_la-vlcruntime.Po' tmpdepfile='$(DEPDIR)/libvlcplugin_la-vlcruntime.TPo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='control/npovlc.cpp' object='libvlcplugin_la-npovlc.obj' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libvlcplugin_la-npovlc.Po' tmpdepfile='$(DEPDIR)/libvlcplugin_la-npovlc.TPo' @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
-@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -c -o libvlcplugin_la-vlcruntime.o `test -f 'vlcruntime.cpp' || echo '$(srcdir)/'`vlcruntime.cpp
+@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -c -o libvlcplugin_la-npovlc.obj `if test -f 'control/npovlc.cpp'; then $(CYGPATH_W) 'control/npovlc.cpp'; else $(CYGPATH_W) '$(srcdir)/control/npovlc.cpp'; fi`
 
-libvlcplugin_la-vlcruntime.obj: vlcruntime.cpp
-@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -MT libvlcplugin_la-vlcruntime.obj -MD -MP -MF "$(DEPDIR)/libvlcplugin_la-vlcruntime.Tpo" \
-@am__fastdepCXX_TRUE@	  -c -o libvlcplugin_la-vlcruntime.obj `if test -f 'vlcruntime.cpp'; then $(CYGPATH_W) 'vlcruntime.cpp'; else $(CYGPATH_W) '$(srcdir)/vlcruntime.cpp'; fi`; \
-@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libvlcplugin_la-vlcruntime.Tpo" "$(DEPDIR)/libvlcplugin_la-vlcruntime.Po"; \
-@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libvlcplugin_la-vlcruntime.Tpo"; exit 1; \
+libvlcplugin_la-npovlc.lo: control/npovlc.cpp
+@am__fastdepCXX_TRUE@	if $(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -MT libvlcplugin_la-npovlc.lo -MD -MP -MF "$(DEPDIR)/libvlcplugin_la-npovlc.Tpo" \
+@am__fastdepCXX_TRUE@	  -c -o libvlcplugin_la-npovlc.lo `test -f 'control/npovlc.cpp' || echo '$(srcdir)/'`control/npovlc.cpp; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libvlcplugin_la-npovlc.Tpo" "$(DEPDIR)/libvlcplugin_la-npovlc.Plo"; \
+@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libvlcplugin_la-npovlc.Tpo"; exit 1; \
 @am__fastdepCXX_TRUE@	fi
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='vlcruntime.cpp' object='libvlcplugin_la-vlcruntime.obj' libtool=no @AMDEPBACKSLASH@
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libvlcplugin_la-vlcruntime.Po' tmpdepfile='$(DEPDIR)/libvlcplugin_la-vlcruntime.TPo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='control/npovlc.cpp' object='libvlcplugin_la-npovlc.lo' libtool=yes @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libvlcplugin_la-npovlc.Plo' tmpdepfile='$(DEPDIR)/libvlcplugin_la-npovlc.TPlo' @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
-@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -c -o libvlcplugin_la-vlcruntime.obj `if test -f 'vlcruntime.cpp'; then $(CYGPATH_W) 'vlcruntime.cpp'; else $(CYGPATH_W) '$(srcdir)/vlcruntime.cpp'; fi`
+@am__fastdepCXX_FALSE@	$(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -c -o libvlcplugin_la-npovlc.lo `test -f 'control/npovlc.cpp' || echo '$(srcdir)/'`control/npovlc.cpp
 
-libvlcplugin_la-vlcruntime.lo: vlcruntime.cpp
-@am__fastdepCXX_TRUE@	if $(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -MT libvlcplugin_la-vlcruntime.lo -MD -MP -MF "$(DEPDIR)/libvlcplugin_la-vlcruntime.Tpo" \
-@am__fastdepCXX_TRUE@	  -c -o libvlcplugin_la-vlcruntime.lo `test -f 'vlcruntime.cpp' || echo '$(srcdir)/'`vlcruntime.cpp; \
-@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libvlcplugin_la-vlcruntime.Tpo" "$(DEPDIR)/libvlcplugin_la-vlcruntime.Plo"; \
-@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libvlcplugin_la-vlcruntime.Tpo"; exit 1; \
+libvlcplugin_la-nporuntime.o: control/nporuntime.cpp
+@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -MT libvlcplugin_la-nporuntime.o -MD -MP -MF "$(DEPDIR)/libvlcplugin_la-nporuntime.Tpo" \
+@am__fastdepCXX_TRUE@	  -c -o libvlcplugin_la-nporuntime.o `test -f 'control/nporuntime.cpp' || echo '$(srcdir)/'`control/nporuntime.cpp; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libvlcplugin_la-nporuntime.Tpo" "$(DEPDIR)/libvlcplugin_la-nporuntime.Po"; \
+@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libvlcplugin_la-nporuntime.Tpo"; exit 1; \
 @am__fastdepCXX_TRUE@	fi
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='vlcruntime.cpp' object='libvlcplugin_la-vlcruntime.lo' libtool=yes @AMDEPBACKSLASH@
-@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libvlcplugin_la-vlcruntime.Plo' tmpdepfile='$(DEPDIR)/libvlcplugin_la-vlcruntime.TPlo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='control/nporuntime.cpp' object='libvlcplugin_la-nporuntime.o' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libvlcplugin_la-nporuntime.Po' tmpdepfile='$(DEPDIR)/libvlcplugin_la-nporuntime.TPo' @AMDEPBACKSLASH@
 @AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
-@am__fastdepCXX_FALSE@	$(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -c -o libvlcplugin_la-vlcruntime.lo `test -f 'vlcruntime.cpp' || echo '$(srcdir)/'`vlcruntime.cpp
+@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -c -o libvlcplugin_la-nporuntime.o `test -f 'control/nporuntime.cpp' || echo '$(srcdir)/'`control/nporuntime.cpp
+
+libvlcplugin_la-nporuntime.obj: control/nporuntime.cpp
+@am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -MT libvlcplugin_la-nporuntime.obj -MD -MP -MF "$(DEPDIR)/libvlcplugin_la-nporuntime.Tpo" \
+@am__fastdepCXX_TRUE@	  -c -o libvlcplugin_la-nporuntime.obj `if test -f 'control/nporuntime.cpp'; then $(CYGPATH_W) 'control/nporuntime.cpp'; else $(CYGPATH_W) '$(srcdir)/control/nporuntime.cpp'; fi`; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libvlcplugin_la-nporuntime.Tpo" "$(DEPDIR)/libvlcplugin_la-nporuntime.Po"; \
+@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libvlcplugin_la-nporuntime.Tpo"; exit 1; \
+@am__fastdepCXX_TRUE@	fi
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='control/nporuntime.cpp' object='libvlcplugin_la-nporuntime.obj' libtool=no @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libvlcplugin_la-nporuntime.Po' tmpdepfile='$(DEPDIR)/libvlcplugin_la-nporuntime.TPo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCXX_FALSE@	$(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -c -o libvlcplugin_la-nporuntime.obj `if test -f 'control/nporuntime.cpp'; then $(CYGPATH_W) 'control/nporuntime.cpp'; else $(CYGPATH_W) '$(srcdir)/control/nporuntime.cpp'; fi`
+
+libvlcplugin_la-nporuntime.lo: control/nporuntime.cpp
+@am__fastdepCXX_TRUE@	if $(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -MT libvlcplugin_la-nporuntime.lo -MD -MP -MF "$(DEPDIR)/libvlcplugin_la-nporuntime.Tpo" \
+@am__fastdepCXX_TRUE@	  -c -o libvlcplugin_la-nporuntime.lo `test -f 'control/nporuntime.cpp' || echo '$(srcdir)/'`control/nporuntime.cpp; \
+@am__fastdepCXX_TRUE@	then mv -f "$(DEPDIR)/libvlcplugin_la-nporuntime.Tpo" "$(DEPDIR)/libvlcplugin_la-nporuntime.Plo"; \
+@am__fastdepCXX_TRUE@	else rm -f "$(DEPDIR)/libvlcplugin_la-nporuntime.Tpo"; exit 1; \
+@am__fastdepCXX_TRUE@	fi
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	source='control/nporuntime.cpp' object='libvlcplugin_la-nporuntime.lo' libtool=yes @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	depfile='$(DEPDIR)/libvlcplugin_la-nporuntime.Plo' tmpdepfile='$(DEPDIR)/libvlcplugin_la-nporuntime.TPlo' @AMDEPBACKSLASH@
+@AMDEP_TRUE@@am__fastdepCXX_FALSE@	$(CXXDEPMODE) $(depcomp) @AMDEPBACKSLASH@
+@am__fastdepCXX_FALSE@	$(LIBTOOL) --mode=compile $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -c -o libvlcplugin_la-nporuntime.lo `test -f 'control/nporuntime.cpp' || echo '$(srcdir)/'`control/nporuntime.cpp
 
 libvlcplugin_la-npmac.o: support/npmac.cpp
 @am__fastdepCXX_TRUE@	if $(CXX) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libvlcplugin_la_CXXFLAGS) $(CXXFLAGS) -MT libvlcplugin_la-npmac.o -MD -MP -MF "$(DEPDIR)/libvlcplugin_la-npmac.Tpo" \
@@ -1130,24 +1199,6 @@
 	  echo " rm -f $(DESTDIR)$(npvlcdir)/$$f"; \
 	  rm -f $(DESTDIR)$(npvlcdir)/$$f; \
 	done
-vlcintf_xptDATA_INSTALL = $(INSTALL_DATA)
-install-vlcintf_xptDATA: $(vlcintf_xpt_DATA)
-	@$(NORMAL_INSTALL)
-	$(mkinstalldirs) $(DESTDIR)$(vlcintf_xptdir)
-	@list='$(vlcintf_xpt_DATA)'; for p in $$list; do \
-	  if test -f "$$p"; then d=; else d="$(srcdir)/"; fi; \
-	  f="`echo $$p | sed -e 's|^.*/||'`"; \
-	  echo " $(vlcintf_xptDATA_INSTALL) $$d$$p $(DESTDIR)$(vlcintf_xptdir)/$$f"; \
-	  $(vlcintf_xptDATA_INSTALL) $$d$$p $(DESTDIR)$(vlcintf_xptdir)/$$f; \
-	done
-
-uninstall-vlcintf_xptDATA:
-	@$(NORMAL_UNINSTALL)
-	@list='$(vlcintf_xpt_DATA)'; for p in $$list; do \
-	  f="`echo $$p | sed -e 's|^.*/||'`"; \
-	  echo " rm -f $(DESTDIR)$(vlcintf_xptdir)/$$f"; \
-	  rm -f $(DESTDIR)$(vlcintf_xptdir)/$$f; \
-	done
 
 ETAGS = etags
 ETAGSFLAGS =
@@ -1208,7 +1259,7 @@
 distdir = $(top_distdir)/$(PACKAGE)-$(VERSION)
 
 distdir: $(DISTFILES)
-	$(mkinstalldirs) $(distdir)/support
+	$(mkinstalldirs) $(distdir)/control $(distdir)/support
 	@srcdirstrip=`echo "$(srcdir)" | sed 's|.|.|g'`; \
 	topsrcdirstrip=`echo "$(top_srcdir)" | sed 's|.|.|g'`; \
 	list='$(DISTFILES)'; for file in $$list; do \
@@ -1236,14 +1287,12 @@
 	  fi; \
 	done
 check-am: all-am
-check: $(BUILT_SOURCES)
-	$(MAKE) $(AM_MAKEFLAGS) check-am
+check: check-am
 all-am: Makefile $(LIBRARIES) $(LTLIBRARIES) $(DATA)
 
 installdirs:
-	$(mkinstalldirs) $(DESTDIR)$(npvlcdir) $(DESTDIR)$(noinst_npvlc_rcdir) $(DESTDIR)$(npvlcdir) $(DESTDIR)$(vlcintf_xptdir)
-install: $(BUILT_SOURCES)
-	$(MAKE) $(AM_MAKEFLAGS) install-am
+	$(mkinstalldirs) $(DESTDIR)$(npvlcdir) $(DESTDIR)$(noinst_npvlc_rcdir) $(DESTDIR)$(npvlcdir)
+install: install-am
 install-exec: install-exec-am
 install-data: install-data-am
 uninstall: uninstall-am
@@ -1269,7 +1318,6 @@
 maintainer-clean-generic:
 	@echo "This command is intended for maintainers to use"
 	@echo "it deletes files that may require special tools to rebuild."
-	-test -z "$(BUILT_SOURCES)" || rm -f $(BUILT_SOURCES)
 clean: clean-am
 
 clean-am: clean-generic clean-libtool clean-noinstLIBRARIES \
@@ -1290,7 +1338,7 @@
 info-am:
 
 install-data-am: install-noinst_npvlc_rcDATA install-npvlcDATA \
-	install-npvlcLTLIBRARIES install-vlcintf_xptDATA
+	install-npvlcLTLIBRARIES
 
 install-exec-am:
 
@@ -1319,8 +1367,7 @@
 ps-am:
 
 uninstall-am: uninstall-info-am uninstall-noinst_npvlc_rcDATA \
-	uninstall-npvlcDATA uninstall-npvlcLTLIBRARIES \
-	uninstall-vlcintf_xptDATA
+	uninstall-npvlcDATA uninstall-npvlcLTLIBRARIES
 
 .PHONY: CTAGS GTAGS all all-am check check-am clean clean-generic \
 	clean-libtool clean-noinstLIBRARIES clean-npvlcLTLIBRARIES \
@@ -1329,13 +1376,13 @@
 	info-am install install-am install-data install-data-am \
 	install-exec install-exec-am install-info install-info-am \
 	install-man install-noinst_npvlc_rcDATA install-npvlcDATA \
-	install-npvlcLTLIBRARIES install-strip install-vlcintf_xptDATA \
-	installcheck installcheck-am installdirs maintainer-clean \
+	install-npvlcLTLIBRARIES install-strip installcheck \
+	installcheck-am installdirs maintainer-clean \
 	maintainer-clean-generic mostlyclean mostlyclean-compile \
 	mostlyclean-generic mostlyclean-libtool pdf pdf-am ps ps-am \
 	tags uninstall uninstall-am uninstall-info-am \
 	uninstall-noinst_npvlc_rcDATA uninstall-npvlcDATA \
-	uninstall-npvlcLTLIBRARIES uninstall-vlcintf_xptDATA
+	uninstall-npvlcLTLIBRARIES
 
 
 @BUILD_MOZILLA_TRUE@@HAVE_WIN32_TRUE@npvlc_rc.$(OBJEXT): npvlc_rc.rc
@@ -1388,20 +1435,11 @@
 @BUILD_MOZILLA_TRUE@@HAVE_DARWIN_TRUE@@HAVE_WIN32_FALSE@	  done ; \
 @BUILD_MOZILLA_TRUE@@HAVE_DARWIN_TRUE@@HAVE_WIN32_FALSE@	fi
 
-@BUILD_MOZILLA_TRUE@$(SOURCES_mozilla): vlcintf.h
-
 $(npvlc): $(libnpvlc_a_OBJECTS) $(libnpvlc_a_DEPENDENCIES) stamp-pic
 	$(CXXLINK) $(libnpvlc_a_OBJECTS) $(DATA_npvlc_rc) \
 	 $(LDFLAGS_libnpvlc)
 # Cygwin work-around
 	@if test -f "$@.exe"; then mv -f "$@.exe" "$@"; fi
-vlcintf.xpt: vlcintf.idl
-	$(XPIDL) $(XPIDL_INCL) \
-	  -m typelib -o vlcintf $(srcdir)/vlcintf.idl
-
-vlcintf.h: vlcintf.idl
-	$(XPIDL) $(XPIDL_INCL) \
-	  -m header -o vlcintf $(srcdir)/vlcintf.idl
 
 ###############################################################################
 # Stamp rules
diff -uNr vlc-0.8.6-svn20060918.debian/mozilla/npvlc_rc.rc vlc-0.8.6-svn20061008.debian/mozilla/npvlc_rc.rc
--- vlc-0.8.6-svn20060918.debian/mozilla/npvlc_rc.rc	2006-09-18 06:28:50.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/mozilla/npvlc_rc.rc	2006-10-04 09:47:09.000000000 -0400
@@ -40,7 +40,7 @@
             VALUE "CompanyName", "VideoLAN Team\0"
             VALUE "LegalCopyright", "Copyright VideoLAN \251 1996-2006\0"
             VALUE "MIMEType", "audio/mpeg|audio/x-mpeg|video/mpeg|video/x-mpeg|video/mpeg-system|video/x-mpeg-system|video/mpeg4|audio/mpeg4|application/mpeg4-iod|application/mpeg4-muxcodetable|video/x-msvideo|video/quicktime|application/x-ogg|application/ogg|application/x-vlc-plugin|video/x-ms-asf-plugin|video/x-ms-asf|application/x-mplayer2|video/x-ms-wmv|application/x-google-vlc-plugin|audio/wav|audio/x-wav\0"
-            VALUE "FileExtents", "mp2,mp3,mpga,mpega|mp2,mp3,mpga,mpega|mpg,mpeg,mpe|mpg,mpeg,mpe|mpg,mpeg,vob|mpg,mpeg,vob|mp4,mpg4|mp4,mpg4|mp4,mpg4|mp4,mpg4|avi|mov,qt|ogg|ogg|||wav|wav\0"
+            VALUE "FileExtents", "mp2,mp3,mpga,mpega|mp2,mp3,mpga,mpega|mpg,mpeg,mpe|mpg,mpeg,mpe|mpg,mpeg,vob|mpg,mpeg,vob|mp4,mpg4|mp4,mpg4|mp4,mpg4|mp4,mpg4|avi|mov,qt|ogg|ogg|vlc||||wmv||wav|wav\0"
             VALUE "FileOpenName", "MPEG audio|MPEG audio|MPEG video|MPEG video|MPEG video|MPEG video|MPEG-4 video|MPEG-4 audio|MPEG-4 video|MPEG-4 video|AVI video|QuickTime video|Ogg stream|Ogg stream|VLC plugin|||||Google VLC plugin|WAV audio|WAV audio\0"
         END
     END
diff -uNr vlc-0.8.6-svn20060918.debian/mozilla/support/npmac.cpp vlc-0.8.6-svn20061008.debian/mozilla/support/npmac.cpp
--- vlc-0.8.6-svn20060918.debian/mozilla/support/npmac.cpp	2006-09-18 06:28:50.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/mozilla/support/npmac.cpp	2006-10-04 09:47:09.000000000 -0400
@@ -94,7 +94,7 @@
 #endif
 
 
-#ifdef XP_MACOSX && !TARGET_RT_MAC_CFM
+#if defined(XP_MACOSX) && defined(__POWERPC__) && (!defined(TARGET_RT_MAC_CFM))
 
 // glue for mapping outgoing Macho function pointers to TVectors
 struct TFPtoTVGlue{
@@ -399,7 +399,7 @@
     int navMinorVers = gNetscapeFuncs.version & 0xFF;
     if( navMinorVers >= 14 )
     {   
-	return CallNPN_GetStringIdentifierProc( gNetscapeFuncs.getstringidentifier, name);
+        return CallNPN_GetStringIdentifierProc( gNetscapeFuncs.getstringidentifier, name);
     }
     return NULL;
 }
@@ -409,7 +409,7 @@
     int navMinorVers = gNetscapeFuncs.version & 0xFF;
     if( navMinorVers >= 14 )
     {   
-	CallNPN_GetStringIdentifiersProc( gNetscapeFuncs.getstringidentifiers, names, nameCount, identifiers);
+        CallNPN_GetStringIdentifiersProc( gNetscapeFuncs.getstringidentifiers, names, nameCount, identifiers);
     }
 }
 
@@ -418,7 +418,7 @@
     int navMinorVers = gNetscapeFuncs.version & 0xFF;
     if( navMinorVers >= 14 )
     {   
-	return CallNPN_GetIntIdentifierProc( gNetscapeFuncs.getintidentifier, intid);
+        return CallNPN_GetIntIdentifierProc( gNetscapeFuncs.getintidentifier, intid);
     }
     return NULL;
 }
@@ -428,7 +428,7 @@
     int navMinorVers = gNetscapeFuncs.version & 0xFF;
     if( navMinorVers >= 14 )
     {   
-	return CallNPN_IdentifierIsStringProc( gNetscapeFuncs.identifierisstring, identifier);
+        return CallNPN_IdentifierIsStringProc( gNetscapeFuncs.identifierisstring, identifier);
     }
     return false;
 }
@@ -438,7 +438,7 @@
     int navMinorVers = gNetscapeFuncs.version & 0xFF;
     if( navMinorVers >= 14 )
     {   
-	return CallNPN_UTF8FromIdentifierProc( gNetscapeFuncs.utf8fromidentifier, identifier);
+        return CallNPN_UTF8FromIdentifierProc( gNetscapeFuncs.utf8fromidentifier, identifier);
     }
     return NULL;
 }
@@ -448,7 +448,7 @@
     int navMinorVers = gNetscapeFuncs.version & 0xFF;
     if( navMinorVers >= 14 )
     {   
-	return CallNPN_IntFromIdentifierProc( gNetscapeFuncs.intfromidentifier, identifier);
+        return CallNPN_IntFromIdentifierProc( gNetscapeFuncs.intfromidentifier, identifier);
     }
     return 0;
 }
@@ -458,7 +458,7 @@
     int navMinorVers = gNetscapeFuncs.version & 0xFF;
     if( navMinorVers >= 14 )
     {   
-	return CallNPN_CreateObjectProc( gNetscapeFuncs.createobject, instance, aClass);
+        return CallNPN_CreateObjectProc( gNetscapeFuncs.createobject, instance, aClass);
     }
     return NULL;
 }
@@ -468,7 +468,7 @@
     int navMinorVers = gNetscapeFuncs.version & 0xFF;
     if( navMinorVers >= 14 )
     {   
-	return CallNPN_RetainObjectProc( gNetscapeFuncs.retainobject, npobj);
+        return CallNPN_RetainObjectProc( gNetscapeFuncs.retainobject, npobj);
     }
     return NULL;
 }
@@ -478,7 +478,7 @@
     int navMinorVers = gNetscapeFuncs.version & 0xFF;
     if( navMinorVers >= 14 )
     {   
-	CallNPN_ReleaseObjectProc( gNetscapeFuncs.releaseobject, npobj);
+        CallNPN_ReleaseObjectProc( gNetscapeFuncs.releaseobject, npobj);
     }
 }
 
@@ -487,7 +487,7 @@
     int navMinorVers = gNetscapeFuncs.version & 0xFF;
     if( navMinorVers >= 14 )
     {   
-	return CallNPN_InvokeProc( gNetscapeFuncs.invoke, instance, npobj, methodName, args, argCount, result);
+        return CallNPN_InvokeProc( gNetscapeFuncs.invoke, instance, npobj, methodName, args, argCount, result);
     }
     return false;
 }
@@ -497,7 +497,7 @@
     int navMinorVers = gNetscapeFuncs.version & 0xFF;
     if( navMinorVers >= 14 )
     {   
-	return CallNPN_InvokeDefaultProc( gNetscapeFuncs.invokeDefault, instance, npobj, args, argCount, result);
+        return CallNPN_InvokeDefaultProc( gNetscapeFuncs.invokeDefault, instance, npobj, args, argCount, result);
     }
     return false;
 }
@@ -507,7 +507,7 @@
     int navMinorVers = gNetscapeFuncs.version & 0xFF;
     if( navMinorVers >= 14 )
     {   
-	return CallNPN_EvaluateProc( gNetscapeFuncs.evaluate, instance, npobj, script, result);
+        return CallNPN_EvaluateProc( gNetscapeFuncs.evaluate, instance, npobj, script, result);
     }
     return false;
 }
@@ -517,7 +517,7 @@
     int navMinorVers = gNetscapeFuncs.version & 0xFF;
     if( navMinorVers >= 14 )
     {   
-	return CallNPN_GetPropertyProc( gNetscapeFuncs.getproperty, instance, npobj, propertyName, result);
+        return CallNPN_GetPropertyProc( gNetscapeFuncs.getproperty, instance, npobj, propertyName, result);
     }
     return false;
 }
@@ -527,7 +527,7 @@
     int navMinorVers = gNetscapeFuncs.version & 0xFF;
     if( navMinorVers >= 14 )
     {   
-	return CallNPN_SetPropertyProc( gNetscapeFuncs.setproperty, instance, npobj, propertyName, value);
+        return CallNPN_SetPropertyProc( gNetscapeFuncs.setproperty, instance, npobj, propertyName, value);
     }
     return false;
 }
@@ -537,7 +537,7 @@
     int navMinorVers = gNetscapeFuncs.version & 0xFF;
     if( navMinorVers >= 14 )
     {   
-	return CallNPN_RemovePropertyProc( gNetscapeFuncs.removeproperty, instance, npobj, propertyName);
+        return CallNPN_RemovePropertyProc( gNetscapeFuncs.removeproperty, instance, npobj, propertyName);
     }
     return false;
 }
@@ -547,7 +547,7 @@
     int navMinorVers = gNetscapeFuncs.version & 0xFF;
     if( navMinorVers >= 14 )
     {   
-	return CallNPN_HasPropertyProc( gNetscapeFuncs.hasproperty, instance, npobj, propertyName);
+        return CallNPN_HasPropertyProc( gNetscapeFuncs.hasproperty, instance, npobj, propertyName);
     }
     return false;
 }
@@ -557,7 +557,7 @@
     int navMinorVers = gNetscapeFuncs.version & 0xFF;
     if( navMinorVers >= 14 )
     {   
-	return CallNPN_HasMethodProc( gNetscapeFuncs.hasmethod, instance, npobj, methodName);
+        return CallNPN_HasMethodProc( gNetscapeFuncs.hasmethod, instance, npobj, methodName);
     }
     return false;
 }
@@ -567,7 +567,7 @@
     int navMinorVers = gNetscapeFuncs.version & 0xFF;
     if( navMinorVers >= 14 )
     {   
-	CallNPN_ReleaseVariantValueProc( gNetscapeFuncs.releasevariantvalue, variant);
+        CallNPN_ReleaseVariantValueProc( gNetscapeFuncs.releasevariantvalue, variant);
     }
 }
 
@@ -576,7 +576,7 @@
     int navMinorVers = gNetscapeFuncs.version & 0xFF;
     if( navMinorVers >= 14 )
     {   
-	CallNPN_SetExceptionProc( gNetscapeFuncs.setexception, npobj, message);
+        CallNPN_SetExceptionProc( gNetscapeFuncs.setexception, npobj, message);
     }
 }
 
@@ -967,27 +967,27 @@
         gNetscapeFuncs.forceredraw      = (NPN_ForceRedrawUPP)HOST_TO_PLUGIN_GLUE(forceredraw, nsTable->forceredraw);
         if( navMinorVers >= 14 )
         {   
-	    // NPRuntime support 
-	    gNetscapeFuncs.getstringidentifier  = (NPN_GetStringIdentifierUPP)HOST_TO_PLUGIN_GLUE(getstringidentifier, nsTable->getstringidentifier);
-	    gNetscapeFuncs.getstringidentifiers = (NPN_GetStringIdentifiersUPP)HOST_TO_PLUGIN_GLUE(getstringidentifiers, nsTable->getstringidentifiers);
-	    gNetscapeFuncs.getintidentifier     = (NPN_GetIntIdentifierUPP)HOST_TO_PLUGIN_GLUE(getintidentifier, nsTable->getintidentifier);
-	    gNetscapeFuncs.identifierisstring   = (NPN_IdentifierIsStringUPP)HOST_TO_PLUGIN_GLUE(identifierisstring, nsTable->identifierisstring);
-	    gNetscapeFuncs.utf8fromidentifier   = (NPN_UTF8FromIdentifierUPP)HOST_TO_PLUGIN_GLUE(utf8fromidentifier, nsTable->utf8fromidentifier);
-	    gNetscapeFuncs.intfromidentifier    = (NPN_IntFromIdentifierUPP)HOST_TO_PLUGIN_GLUE(intfromidentifier, nsTable->intfromidentifier);
-	    gNetscapeFuncs.createobject         = (NPN_CreateObjectUPP)HOST_TO_PLUGIN_GLUE(createobject, nsTable->createobject);
-	    gNetscapeFuncs.retainobject         = (NPN_RetainObjectUPP)HOST_TO_PLUGIN_GLUE(retainobject, nsTable->retainobject);
-	    gNetscapeFuncs.releaseobject        = (NPN_ReleaseObjectUPP)HOST_TO_PLUGIN_GLUE(releaseobject, nsTable->releaseobject);
-	    gNetscapeFuncs.invoke               = (NPN_InvokeUPP)HOST_TO_PLUGIN_GLUE(invoke, nsTable->invoke);
-	    gNetscapeFuncs.invokeDefault        = (NPN_InvokeDefaultUPP)HOST_TO_PLUGIN_GLUE(invokeDefault, nsTable->invokeDefault);
-	    gNetscapeFuncs.evaluate             = (NPN_EvaluateUPP)HOST_TO_PLUGIN_GLUE(evaluate, nsTable->evaluate);
-	    gNetscapeFuncs.getproperty          = (NPN_GetPropertyUPP)HOST_TO_PLUGIN_GLUE(getproperty, nsTable->getproperty);
-	    gNetscapeFuncs.setproperty          = (NPN_SetPropertyUPP)HOST_TO_PLUGIN_GLUE(setproperty, nsTable->setproperty);
-	    gNetscapeFuncs.removeproperty       = (NPN_RemovePropertyUPP)HOST_TO_PLUGIN_GLUE(removeproperty, nsTable->removeproperty);
-	    gNetscapeFuncs.hasproperty          = (NPN_HasPropertyUPP)HOST_TO_PLUGIN_GLUE(hasproperty, nsTable->hasproperty);
-	    gNetscapeFuncs.hasmethod            = (NPN_HasMethodUPP)HOST_TO_PLUGIN_GLUE(hasmethod, nsTable->hasmethod);
-	    gNetscapeFuncs.releasevariantvalue  = (NPN_ReleaseVariantValueUPP)HOST_TO_PLUGIN_GLUE(releasevariantvalue, nsTable->releasevariantvalue);
-	    gNetscapeFuncs.setexception         = (NPN_SetExceptionUPP)HOST_TO_PLUGIN_GLUE(setexception, nsTable->setexception);
-	}
+            // NPRuntime support 
+            gNetscapeFuncs.getstringidentifier  = (NPN_GetStringIdentifierUPP)HOST_TO_PLUGIN_GLUE(getstringidentifier, nsTable->getstringidentifier);
+            gNetscapeFuncs.getstringidentifiers = (NPN_GetStringIdentifiersUPP)HOST_TO_PLUGIN_GLUE(getstringidentifiers, nsTable->getstringidentifiers);
+            gNetscapeFuncs.getintidentifier     = (NPN_GetIntIdentifierUPP)HOST_TO_PLUGIN_GLUE(getintidentifier, nsTable->getintidentifier);
+            gNetscapeFuncs.identifierisstring   = (NPN_IdentifierIsStringUPP)HOST_TO_PLUGIN_GLUE(identifierisstring, nsTable->identifierisstring);
+            gNetscapeFuncs.utf8fromidentifier   = (NPN_UTF8FromIdentifierUPP)HOST_TO_PLUGIN_GLUE(utf8fromidentifier, nsTable->utf8fromidentifier);
+            gNetscapeFuncs.intfromidentifier    = (NPN_IntFromIdentifierUPP)HOST_TO_PLUGIN_GLUE(intfromidentifier, nsTable->intfromidentifier);
+            gNetscapeFuncs.createobject         = (NPN_CreateObjectUPP)HOST_TO_PLUGIN_GLUE(createobject, nsTable->createobject);
+            gNetscapeFuncs.retainobject         = (NPN_RetainObjectUPP)HOST_TO_PLUGIN_GLUE(retainobject, nsTable->retainobject);
+            gNetscapeFuncs.releaseobject        = (NPN_ReleaseObjectUPP)HOST_TO_PLUGIN_GLUE(releaseobject, nsTable->releaseobject);
+            gNetscapeFuncs.invoke               = (NPN_InvokeUPP)HOST_TO_PLUGIN_GLUE(invoke, nsTable->invoke);
+            gNetscapeFuncs.invokeDefault        = (NPN_InvokeDefaultUPP)HOST_TO_PLUGIN_GLUE(invokeDefault, nsTable->invokeDefault);
+            gNetscapeFuncs.evaluate             = (NPN_EvaluateUPP)HOST_TO_PLUGIN_GLUE(evaluate, nsTable->evaluate);
+            gNetscapeFuncs.getproperty          = (NPN_GetPropertyUPP)HOST_TO_PLUGIN_GLUE(getproperty, nsTable->getproperty);
+            gNetscapeFuncs.setproperty          = (NPN_SetPropertyUPP)HOST_TO_PLUGIN_GLUE(setproperty, nsTable->setproperty);
+            gNetscapeFuncs.removeproperty       = (NPN_RemovePropertyUPP)HOST_TO_PLUGIN_GLUE(removeproperty, nsTable->removeproperty);
+            gNetscapeFuncs.hasproperty          = (NPN_HasPropertyUPP)HOST_TO_PLUGIN_GLUE(hasproperty, nsTable->hasproperty);
+            gNetscapeFuncs.hasmethod            = (NPN_HasMethodUPP)HOST_TO_PLUGIN_GLUE(hasmethod, nsTable->hasmethod);
+            gNetscapeFuncs.releasevariantvalue  = (NPN_ReleaseVariantValueUPP)HOST_TO_PLUGIN_GLUE(releasevariantvalue, nsTable->releasevariantvalue);
+            gNetscapeFuncs.setexception         = (NPN_SetExceptionUPP)HOST_TO_PLUGIN_GLUE(setexception, nsTable->setexception);
+        }
 
         //
         // Set up the plugin function table that Netscape will use to
@@ -1111,26 +1111,26 @@
     gNetscapeFuncs.forceredraw      = nsTable->forceredraw;
     if( navMinorVers >= 14 )
     {   
-	// NPRuntime support 
-	gNetscapeFuncs.getstringidentifier  = nsTable->getstringidentifier;
-	gNetscapeFuncs.getstringidentifiers = nsTable->getstringidentifiers;
-	gNetscapeFuncs.getintidentifier     = nsTable->getintidentifier;
-	gNetscapeFuncs.identifierisstring   = nsTable->identifierisstring;
-	gNetscapeFuncs.utf8fromidentifier   = nsTable->utf8fromidentifier;
-	gNetscapeFuncs.intfromidentifier    = nsTable->intfromidentifier;
-	gNetscapeFuncs.createobject         = nsTable->createobject;
-	gNetscapeFuncs.retainobject         = nsTable->retainobject;
-	gNetscapeFuncs.releaseobject        = nsTable->releaseobject;
-	gNetscapeFuncs.invoke               = nsTable->invoke;
-	gNetscapeFuncs.invokeDefault        = nsTable->invokeDefault;
-	gNetscapeFuncs.evaluate             = nsTable->evaluate;
-	gNetscapeFuncs.getproperty          = nsTable->getproperty;
-	gNetscapeFuncs.setproperty          = nsTable->setproperty;
-	gNetscapeFuncs.removeproperty       = nsTable->removeproperty;
-	gNetscapeFuncs.hasproperty          = nsTable->hasproperty;
-	gNetscapeFuncs.hasmethod            = nsTable->hasmethod;
-	gNetscapeFuncs.releasevariantvalue  = nsTable->releasevariantvalue;
-	gNetscapeFuncs.setexception         = nsTable->setexception;
+        // NPRuntime support 
+        gNetscapeFuncs.getstringidentifier  = nsTable->getstringidentifier;
+        gNetscapeFuncs.getstringidentifiers = nsTable->getstringidentifiers;
+        gNetscapeFuncs.getintidentifier     = nsTable->getintidentifier;
+        gNetscapeFuncs.identifierisstring   = nsTable->identifierisstring;
+        gNetscapeFuncs.utf8fromidentifier   = nsTable->utf8fromidentifier;
+        gNetscapeFuncs.intfromidentifier    = nsTable->intfromidentifier;
+        gNetscapeFuncs.createobject         = nsTable->createobject;
+        gNetscapeFuncs.retainobject         = nsTable->retainobject;
+        gNetscapeFuncs.releaseobject        = nsTable->releaseobject;
+        gNetscapeFuncs.invoke               = nsTable->invoke;
+        gNetscapeFuncs.invokeDefault        = nsTable->invokeDefault;
+        gNetscapeFuncs.evaluate             = nsTable->evaluate;
+        gNetscapeFuncs.getproperty          = nsTable->getproperty;
+        gNetscapeFuncs.setproperty          = nsTable->setproperty;
+        gNetscapeFuncs.removeproperty       = nsTable->removeproperty;
+        gNetscapeFuncs.hasproperty          = nsTable->hasproperty;
+        gNetscapeFuncs.hasmethod            = nsTable->hasmethod;
+        gNetscapeFuncs.releasevariantvalue  = nsTable->releasevariantvalue;
+        gNetscapeFuncs.setexception         = nsTable->setexception;
     }
     return NPP_Initialize();
 }
@@ -1156,7 +1156,7 @@
 
     pluginFuncs->version    = (NP_VERSION_MAJOR << 8) + NP_VERSION_MINOR;
     pluginFuncs->size       = sizeof(NPPluginFuncs);
-    pluginFuncs->newp       = Private_New;
+    pluginFuncs->newp       = NewNPP_NewProc(Private_New);
     pluginFuncs->destroy    = NewNPP_DestroyProc(Private_Destroy);
     pluginFuncs->setwindow  = NewNPP_SetWindowProc(Private_SetWindow);
     pluginFuncs->newstream  = NewNPP_NewStreamProc(Private_NewStream);
diff -uNr vlc-0.8.6-svn20060918.debian/mozilla/vlcintf.idl vlc-0.8.6-svn20061008.debian/mozilla/vlcintf.idl
--- vlc-0.8.6-svn20060918.debian/mozilla/vlcintf.idl	2006-09-18 06:28:50.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/mozilla/vlcintf.idl	1969-12-31 19:00:00.000000000 -0500
@@ -1,42 +0,0 @@
-
-#include "nsISupports.idl"
-
-[scriptable, uuid(ea92ef52-afe4-4212-bacb-dfe9fca94cd6)]
-
-interface VlcIntf : nsISupports
-{
-    /* Basic playback control */
-    void play();
-    void pause();
-    void stop();
- 
-    /* Audio/Video control */
-    void fullscreen();
-    void set_volume( in PRInt64 i_volume );
-    PRInt64 get_volume();
-    void mute();
-
-    /* Get/Set variable */
-    void set_int_variable( in string psz_var, in PRInt64 i_value );
-    void set_bool_variable( in string psz_var, in PRBool b_value );
-    void set_str_variable( in string psz_var, in string psz_value );
-     
-    PRInt64 get_int_variable( in string psz_var );
-    PRBool get_bool_variable( in string psz_var );
-    string get_str_variable( in string psz_var );
-
-    /* Playlist management */
-    void clear_playlist();
-    void add_item( in string psz_name);
-    void next();
-    void previous();
- 
-    /* Status accessors */
-    PRBool isplaying();
-    PRInt64 get_length();
-    PRInt64 get_position();
-    PRInt64 get_time();
-
-    void seek( in PRInt64 i_secs, in PRInt64 b_relative);
-};
-
diff -uNr vlc-0.8.6-svn20060918.debian/mozilla/vlcpeer.cpp vlc-0.8.6-svn20061008.debian/mozilla/vlcpeer.cpp
--- vlc-0.8.6-svn20060918.debian/mozilla/vlcpeer.cpp	2006-09-18 06:28:50.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/mozilla/vlcpeer.cpp	1969-12-31 19:00:00.000000000 -0500
@@ -1,314 +0,0 @@
-/*****************************************************************************
- * vlcpeer.cpp: scriptable peer descriptor
- *****************************************************************************
- * Copyright (C) 2002-2005 the VideoLAN team
- * $Id: vlcpeer.cpp 14915 2006-03-25 12:15:49Z zorglub $
- *
- * Authors: Samuel Hocevar <sam@zoy.org>
- *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 2 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
- *****************************************************************************/
-
-/*****************************************************************************
- * Preamble
- *****************************************************************************/
-#include "config.h"
-
-#include <vlc/vlc.h>
-
-#ifdef DEBUG
-/* We do not want to use nsDebug.h */
-#   undef DEBUG
-#endif
-
-#ifdef HAVE_MOZILLA_CONFIG_H
-#   include <mozilla-config.h>
-#endif
-#include <nsISupports.h>
-#include <nsMemory.h>
-#include <npapi.h>
-
-#if !defined(XP_MACOSX) && !defined(XP_UNIX) && !defined(XP_WIN)
-#define XP_UNIX 1
-#elif defined(XP_MACOSX)
-#undef XP_UNIX
-#endif
-
-#include "vlcpeer.h"
-#include "vlcplugin.h"
-
-NS_IMPL_ISUPPORTS2( VlcPeer, VlcIntf, nsIClassInfo )
-
-/*****************************************************************************
- * Scriptable peer constructor and destructor
- *****************************************************************************/
-VlcPeer::VlcPeer()
-{
-    NS_INIT_ISUPPORTS();
-}
-
-VlcPeer::VlcPeer( VlcPlugin * plugin )
-{
-    NS_INIT_ISUPPORTS();
-    p_plugin = plugin;
-}
-
-VlcPeer::~VlcPeer()
-{
-    ;
-}
-
-/*****************************************************************************
- * Scriptable peer methods
- *****************************************************************************/
-void VlcPeer::Disable()
-{
-    p_plugin = NULL;
-}
-
-/*****************************************************************************
- * Scriptable peer plugin methods
- *****************************************************************************/
-NS_IMETHODIMP VlcPeer::Play()
-{
-    if( p_plugin )
-    {
-        if( !p_plugin->b_stream && p_plugin->psz_target )
-        {
-            VLC_AddTarget( p_plugin->i_vlc, p_plugin->psz_target, 0, 0,
-                           PLAYLIST_APPEND | PLAYLIST_GO, PLAYLIST_END );
-            p_plugin->b_stream = 1;
-        }
-
-        VLC_Play( p_plugin->i_vlc );
-    }
-    return NS_OK;
-}
-
-NS_IMETHODIMP VlcPeer::Pause()
-{
-    if( p_plugin )
-    {
-        VLC_Pause( p_plugin->i_vlc );
-    }
-    return NS_OK;
-}
-
-NS_IMETHODIMP VlcPeer::Stop()
-{
-    if( p_plugin )
-    {
-        VLC_Stop( p_plugin->i_vlc );
-        p_plugin->b_stream = 0;
-    }
-    return NS_OK;
-}
-
-NS_IMETHODIMP VlcPeer::Fullscreen()
-{
-    if( p_plugin )
-    {
-#ifdef XP_MACOSX
-#else
-        VLC_FullScreen( p_plugin->i_vlc );
-#endif
-    }
-    return NS_OK;
-}
-
-/* Set/Get vlc variables */
-NS_IMETHODIMP VlcPeer::Set_int_variable(const char *psz_var, PRInt64 value )
-{
-    vlc_value_t val;
-    val.i_int = value;
-    if( p_plugin )
-    {
-        VLC_VariableSet( p_plugin->i_vlc, psz_var, val );
-    }
-    return NS_OK;
-}
-
-NS_IMETHODIMP VlcPeer::Set_str_variable(const char *psz_var, const char *value )
-{
-    vlc_value_t val;
-    val.psz_string = strdup( value );
-    if( p_plugin )
-    {
-        VLC_VariableSet( p_plugin->i_vlc, psz_var, val );
-    }
-    return NS_OK;
-}
-
-NS_IMETHODIMP VlcPeer::Set_bool_variable(const char *psz_var, PRBool value )
-{
-    vlc_value_t val;
-    val.b_bool = value >= 1 ? VLC_TRUE : VLC_FALSE;
-    if( p_plugin )
-    {
-        VLC_VariableSet( p_plugin->i_vlc, psz_var, val );
-    }
-    return NS_OK;
-}
-
-NS_IMETHODIMP VlcPeer::Get_int_variable( const char *psz_var, PRInt64 *result )
-{
-    vlc_value_t val;
-    if( p_plugin )
-    {
-        VLC_VariableGet( p_plugin->i_vlc, psz_var, &val );
-        *result = (PRInt64)val.i_int;
-    }
-    return NS_OK;
-}
-
-NS_IMETHODIMP VlcPeer::Get_bool_variable(  const char *psz_var,PRBool *result )
-{
-    vlc_value_t val;
-    if( p_plugin )
-    {
-        VLC_VariableGet( p_plugin->i_vlc, psz_var, &val );
-        *result = (PRBool)val.b_bool;
-    }
-    return NS_OK;
-}
-
-NS_IMETHODIMP VlcPeer::Get_str_variable( const char *psz_var, char **result )
-{
-    vlc_value_t val;
-    if( p_plugin )
-    {
-        VLC_VariableGet( p_plugin->i_vlc, psz_var, &val );
-        if( val.psz_string )
-        {
-            *result = strdup( val.psz_string );
-        }
-        else
-        {
-            *result = strdup( "" );
-        }
-    }
-    return NS_OK;
-}
-
-/* Playlist control */
-NS_IMETHODIMP VlcPeer::Clear_playlist()
-{
-    if( p_plugin )
-    {
-        VLC_PlaylistClear( p_plugin->i_vlc );
-    }
-    return NS_OK;
-}
-
-NS_IMETHODIMP VlcPeer::Add_item( const char *psz_item )
-{
-     if( p_plugin )
-     {
-          VLC_AddTarget( p_plugin->i_vlc, psz_item, NULL, 0,
-                         PLAYLIST_APPEND, PLAYLIST_END);
-     }
-     return NS_OK;
-}
-
-
-NS_IMETHODIMP VlcPeer::Isplaying( PRBool *b_playing )
-{
-    if( p_plugin->i_vlc )
-    {
-        *b_playing = VLC_IsPlaying( p_plugin->i_vlc );
-    }
-    return NS_OK;
-}
-
-NS_IMETHODIMP VlcPeer::Get_position( PRInt64 *i_position )
-{
-    if( p_plugin->i_vlc )
-    {
-        *i_position = (PRInt64)VLC_PositionGet( p_plugin->i_vlc );
-    }
-    return NS_OK;
-}
-
-NS_IMETHODIMP VlcPeer::Get_time( PRInt64 *i_time )
-{
-    if( p_plugin->i_vlc )
-    {
-        *i_time = VLC_TimeGet( p_plugin->i_vlc );
-    }
-    return NS_OK;
-}
-
-NS_IMETHODIMP VlcPeer::Get_length( PRInt64 *i_length )
-{
-    if( p_plugin->i_vlc )
-    {
-        *i_length = VLC_LengthGet( p_plugin->i_vlc );
-    }
-    return NS_OK;
-}
-
-NS_IMETHODIMP VlcPeer::Seek( PRInt64 i_secs, PRInt64 b_relative )
-{
-    if( p_plugin->i_vlc )
-    {
-        VLC_TimeSet( p_plugin->i_vlc, i_secs, b_relative );
-    }
-    return NS_OK;
-}
-
-NS_IMETHODIMP VlcPeer::Next()
-{
-    if( p_plugin->i_vlc )
-    {
-        VLC_PlaylistNext( p_plugin->i_vlc);
-    }
-    return NS_OK;
-}
-
-NS_IMETHODIMP VlcPeer::Previous()
-{
-    if( p_plugin->i_vlc )
-    {
-        VLC_PlaylistPrev( p_plugin->i_vlc );
-    }
-    return NS_OK;
-}
-
-NS_IMETHODIMP VlcPeer::Set_volume( PRInt64 i_volume )
-{
-    if( p_plugin->i_vlc )
-    {
-        VLC_VolumeSet( p_plugin->i_vlc, i_volume );
-    }
-    return NS_OK;
-}
-
-NS_IMETHODIMP VlcPeer::Get_volume( PRInt64 *i_volume )
-{
-    if( p_plugin->i_vlc )
-    {
-        *i_volume = VLC_VolumeGet( p_plugin->i_vlc );
-    }
-    return NS_OK;
-}
-
-NS_IMETHODIMP VlcPeer::Mute()
-{
-    if( p_plugin->i_vlc )
-    {
-        VLC_VolumeMute( p_plugin->i_vlc );
-    }
-    return NS_OK;
-}
diff -uNr vlc-0.8.6-svn20060918.debian/mozilla/vlcpeer.h vlc-0.8.6-svn20061008.debian/mozilla/vlcpeer.h
--- vlc-0.8.6-svn20060918.debian/mozilla/vlcpeer.h	2006-09-18 06:28:50.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/mozilla/vlcpeer.h	1969-12-31 19:00:00.000000000 -0500
@@ -1,61 +0,0 @@
-/*****************************************************************************
- * vlcpeer.h: scriptable peer descriptor
- *****************************************************************************
- * Copyright (C) 2002-2005 the VideoLAN team
- * $Id: vlcpeer.h 15273 2006-04-19 09:13:26Z damienf $
- *
- * Authors: Samuel Hocevar <sam@zoy.org>
- *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 2 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
- *****************************************************************************/
-#ifndef __VLCPEER_H__
-#define __VLCPEER_H__
-
-#include "vlcintf.h"
-#include "support/classinfo.h"
-
-class VlcPlugin;
-
-class VlcPeer : public VlcIntf, public ClassInfo
-{
-public:
-    NS_DECL_ISUPPORTS
-    NS_DECL_VLCINTF
-
-    // These flags are used by the DOM and security systems to signal that
-    // JavaScript callers are allowed to call this object's scriptable methods.
-    NS_IMETHOD GetFlags(PRUint32 *aFlags)
-    {
-        *aFlags = nsIClassInfo::PLUGIN_OBJECT | nsIClassInfo::DOM_OBJECT;
-        return NS_OK;
-    }
-
-    NS_IMETHOD GetImplementationLanguage(PRUint32 *aImplementationLanguage)
-    {
-        *aImplementationLanguage = nsIProgrammingLanguage::CPLUSPLUS;
-        return NS_OK;
-    }
-
-             VlcPeer();
-             VlcPeer( VlcPlugin * );
-    virtual ~VlcPeer();
-
-    void     Disable();
-
-private:
-    VlcPlugin * p_plugin;
-};
-
-#endif
diff -uNr vlc-0.8.6-svn20060918.debian/mozilla/vlcplugin.cpp vlc-0.8.6-svn20061008.debian/mozilla/vlcplugin.cpp
--- vlc-0.8.6-svn20060918.debian/mozilla/vlcplugin.cpp	2006-09-18 06:28:50.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/mozilla/vlcplugin.cpp	2006-10-04 09:47:09.000000000 -0400
@@ -2,9 +2,10 @@
  * vlcplugin.cpp: a VLC plugin for Mozilla
  *****************************************************************************
  * Copyright (C) 2002-2005 the VideoLAN team
- * $Id: vlcplugin.cpp 15273 2006-04-19 09:13:26Z damienf $
+ * $Id: vlcplugin.cpp 16931 2006-10-03 09:04:50Z damienf $
  *
  * Authors: Samuel Hocevar <sam@zoy.org>
+ *          Damien Fouilleul <damienf.fouilleul@laposte.net>
  *
  * This program is free software; you can redistribute it and/or modify
  * it under the terms of the GNU General Public License as published by
@@ -26,72 +27,376 @@
  *****************************************************************************/
 #include "config.h"
 
-#include <vlc/vlc.h>
-
 #ifdef HAVE_MOZILLA_CONFIG_H
 #   include <mozilla-config.h>
 #endif
-#include <nsISupports.h>
-#include <nsMemory.h>
-#include <npapi.h>
-
-#if !defined(XP_MACOSX) && !defined(XP_UNIX) && !defined(XP_WIN)
-#define XP_UNIX 1
-#elif defined(XP_MACOSX)
-#undef XP_UNIX
-#endif
 
 #include "vlcplugin.h"
+#include "control/npovlc.h"
+#include "control/npolibvlc.h"
 
 /*****************************************************************************
  * VlcPlugin constructor and destructor
  *****************************************************************************/
-VlcPlugin::VlcPlugin( NPP instance )
+VlcPlugin::VlcPlugin( NPP instance, uint16 mode ) :
+    i_npmode(mode),
+    b_stream(0),
+    b_autoplay(0),
+    psz_target(NULL),
+    libvlc_instance(NULL),
+    scriptClass(NULL),
+    p_browser(instance),
+    psz_baseURL(NULL)
+#if XP_WIN
+    ,pf_wndproc(NULL)
+#endif
+#if XP_UNIX
+    ,i_width((unsigned)-1)
+    ,i_height((unsigned)-1)
+#endif
 {
-    p_instance = instance;
-    p_peer = NULL;
+    memset(&npwindow, 0, sizeof(NPWindow));
 }
 
+static int boolValue(const char *value) {
+    return ( !strcmp(value, "1") || 
+             !strcasecmp(value, "true") ||
+             !strcasecmp(value, "yes") );
+}
 
-VlcPlugin::~VlcPlugin()
+NPError VlcPlugin::init(int argc, char* const argn[], char* const argv[])
 {
-    if( p_peer )
+    /* prepare VLC command line */
+    char *ppsz_argv[32] = { "vlc" };
+    int ppsz_argc = 1;
+
+    /* locate VLC module path */
+#ifdef XP_MACOSX
+    ppsz_argv[ppsz_argc++] = "--plugin-path";
+    ppsz_argv[ppsz_argc++] = "/Library/Internet Plug-Ins/VLC Plugin.plugin/"
+                             "Contents/MacOS/modules";
+#elif defined(XP_WIN)
+    HKEY h_key;
+    DWORD i_type, i_data = MAX_PATH + 1;
+    char p_data[MAX_PATH + 1];
+    if( RegOpenKeyEx( HKEY_LOCAL_MACHINE, "Software\\VideoLAN\\VLC",
+                      0, KEY_READ, &h_key ) == ERROR_SUCCESS )
     {
-        p_peer->Disable();
-        p_peer->Release();
+         if( RegQueryValueEx( h_key, "InstallDir", 0, &i_type,
+                              (LPBYTE)p_data, &i_data ) == ERROR_SUCCESS )
+         {
+             if( i_type == REG_SZ )
+             {
+                 strcat( p_data, "\\plugins" );
+                 ppsz_argv[ppsz_argc++] = "--plugin-path";
+                 ppsz_argv[ppsz_argc++] = p_data;
+             }
+         }
+         RegCloseKey( h_key );
+    }
+    ppsz_argv[ppsz_argc++] = "--no-one-instance";
+    if( IsDebuggerPresent() )
+    {
+        /*
+        ** VLC default threading mechanism is designed to be as compatible
+        ** with POSIX as possible. However when debugged on win32, threads
+        ** lose signals and eventually VLC get stuck during initialization.
+        ** threading support can be configured to be more debugging friendly
+        ** but it will be less compatible with POSIX.
+        ** This is done by initializing with the following options:
+        */
+        ppsz_argv[ppsz_argc++] = "--fast-mutex";
+        ppsz_argv[ppsz_argc++] = "--win9x-cv-method=1";
     }
-}
 
 
-/*****************************************************************************
- * VlcPlugin methods
- *****************************************************************************/
-void VlcPlugin::SetInstance( NPP instance )
-{
-    p_instance = instance;
+#if 0
+    ppsz_argv[0] = "C:\\Cygwin\\home\\damienf\\vlc-trunk\\vlc";
+#endif
+
+#endif /* XP_MACOSX */
+
+    /* common settings */
+    ppsz_argv[ppsz_argc++] = "-vv";
+    ppsz_argv[ppsz_argc++] = "--no-stats";
+    ppsz_argv[ppsz_argc++] = "--intf";
+    ppsz_argv[ppsz_argc++] = "dummy";
+
+    const char *version = NULL;
+
+    /* parse plugin arguments */
+    for( int i = 0; i < argc ; i++ )
+    {
+        fprintf(stderr, "argn=%s, argv=%s\n", argn[i], argv[i]);
+
+        if( !strcmp( argn[i], "target" )
+         || !strcmp( argn[i], "mrl")
+         || !strcmp( argn[i], "filename")
+         || !strcmp( argn[i], "src") )
+        {
+            psz_target = argv[i];
+        }
+        else if( !strcmp( argn[i], "autoplay")
+              || !strcmp( argn[i], "autostart") )
+        {
+            b_autoplay = boolValue(argv[i]);
+        }
+        else if( !strcmp( argn[i], "fullscreen" ) )
+        {
+            if( boolValue(argv[i]) )
+            {
+                ppsz_argv[ppsz_argc++] = "--fullscreen";
+            }
+            else
+            {
+                ppsz_argv[ppsz_argc++] = "--no-fullscreen";
+            }
+        }
+        else if( !strcmp( argn[i], "mute" ) )
+        {
+            if( boolValue(argv[i]) )
+            {
+                ppsz_argv[ppsz_argc++] = "--volume";
+                ppsz_argv[ppsz_argc++] = "0";
+            }
+        }
+        else if( !strcmp( argn[i], "loop")
+              || !strcmp( argn[i], "autoloop") )
+        {
+            if( boolValue(argv[i]) )
+            {
+                ppsz_argv[ppsz_argc++] = "--loop";
+            }
+            else {
+                ppsz_argv[ppsz_argc++] = "--no-loop";
+            }
+        }
+        else if( !strcmp( argn[i], "version") )
+        {
+            version = argv[i];
+        }
+    }
+
+    libvlc_instance = libvlc_new(ppsz_argc, ppsz_argv, NULL);
+    if( ! libvlc_instance )
+    {
+        return NPERR_GENERIC_ERROR;
+    }
+
+    /*
+    ** fetch plugin base URL, which is the URL of the page containing the plugin
+    ** this URL is used for making absolute URL from relative URL that may be
+    ** passed as an MRL argument
+    */
+    NPObject *plugin;
+
+    if( NPERR_NO_ERROR == NPN_GetValue(p_browser, NPNVWindowNPObject, &plugin) )
+    {
+        /*
+        ** is there a better way to get that info ?
+        */
+        static const char docLocHref[] = "document.location.href";
+        NPString script;
+        NPVariant result;
+
+        script.utf8characters = docLocHref;
+        script.utf8length = sizeof(docLocHref)-1;
+
+        if( NPN_Evaluate(p_browser, plugin, &script, &result) )
+        {
+            if( NPVARIANT_IS_STRING(result) )
+            {
+                NPString &location = NPVARIANT_TO_STRING(result);
+
+                psz_baseURL = new char[location.utf8length+1];
+                if( psz_baseURL )
+                {
+                    strncpy(psz_baseURL, location.utf8characters, location.utf8length);
+                    psz_baseURL[location.utf8length] = '\0';
+                }
+            }
+            NPN_ReleaseVariantValue(&result);
+        }
+        NPN_ReleaseObject(plugin);
+    }
+
+    if( psz_target )
+    {
+        // get absolute URL from src
+        psz_target = getAbsoluteURL(psz_target);
+    }
+
+    /* assign plugin script root class */
+    if( (NULL != version) && (!strcmp(version, "VideoLAN.VLCPlugin.2")) )
+    {
+        /* new APIs */
+        scriptClass = RuntimeNPClass<LibvlcRootNPObject>::getClass();
+    }
+    else
+    {
+        /* legacy APIs */
+        scriptClass = RuntimeNPClass<VlcNPObject>::getClass();
+    }
+
+    return NPERR_NO_ERROR;
 }
 
+#if 0
+#ifdef XP_WIN
+/* This is really ugly but there is a deadlock when stopping a stream
+ * (in VLC_CleanUp()) because the video output is a child of the drawable but
+ * is in a different thread. */
+static void HackStopVout( VlcPlugin* p_plugin )
+{
+    MSG msg;
+    HWND hwnd;
+    vlc_value_t value;
+
+    int i_vlc = libvlc_get_vlc_id(p_plugin->libvlc_instance);
+    VLC_VariableGet( i_vlc, "drawable", &value );
+
+    hwnd = FindWindowEx( (HWND)value.i_int, 0, 0, 0 );
+    if( !hwnd ) return;
+
+    PostMessage( hwnd, WM_CLOSE, 0, 0 );
 
-NPP VlcPlugin::GetInstance()
+    do
+    {
+        while( PeekMessage( &msg, (HWND)value.i_int, 0, 0, PM_REMOVE ) )
+        {
+            TranslateMessage(&msg);
+            DispatchMessage(&msg);
+        }
+        if( FindWindowEx( (HWND)value.i_int, 0, 0, 0 ) ) Sleep( 10 );
+    }
+    while( (hwnd = FindWindowEx( (HWND)value.i_int, 0, 0, 0 )) );
+}
+#endif /* XP_WIN */
+#endif
+
+VlcPlugin::~VlcPlugin()
 {
-    return p_instance;
+    delete psz_baseURL;
+    delete psz_target;
+    if( libvlc_instance )
+        libvlc_destroy(libvlc_instance);
 }
 
+/*****************************************************************************
+ * VlcPlugin methods
+ *****************************************************************************/
 
-VlcIntf* VlcPlugin::GetPeer()
+char *VlcPlugin::getAbsoluteURL(const char *url)
 {
-    if( !p_peer )
+    if( NULL != url )
     {
-        p_peer = new VlcPeer( this );
-        if( p_peer == NULL )
+        // check whether URL is already absolute
+        const char *end=strchr(url, ':');
+        if( (NULL != end) && (end != url) )
         {
-            return NULL;
+            // validate protocol header
+            const char *start = url;
+            while( start != end ) {
+                char c = *start | 0x20;
+                if( (c < 'a') || (c > 'z') )
+                    // not valid protocol header, assume relative URL
+                    break;
+                ++start;
+            }
+            /* we have a protocol header, therefore URL is absolute */
+            return strdup(url);
         }
 
-        NS_ADDREF( p_peer );
+        if( psz_baseURL )
+        {
+            size_t baseLen = strlen(psz_baseURL);
+            char *href = new char[baseLen+strlen(url)];
+            if( href )
+            {
+                /* prepend base URL */
+                strcpy(href, psz_baseURL);
+
+                /*
+                ** relative url could be empty,
+                ** in which case return base URL
+                */
+                if( '\0' == *url )
+                    return href;
+
+                /*
+                ** locate pathname part of base URL
+                */
+
+                /* skip over protocol part  */
+                char *pathstart = strchr(href, ':');
+                char *pathend;
+                if( '/' == *(++pathstart) )
+                {
+                    if( '/' == *(++pathstart) )
+                    {
+                        ++pathstart;
+                    }
+                }
+                /* skip over host part */
+                pathstart = strchr(pathstart, '/');
+                pathend = href+baseLen;
+                if( ! pathstart )
+                {
+                    // no path, add a / past end of url (over '\0')
+                    pathstart = pathend;
+                    *pathstart = '/';
+                }
+
+                /* relative URL made of an absolute path ? */
+                if( '/' == *url )
+                {
+                    /* replace path completely */
+                    strcpy(pathstart, url);
+                    return href;
+                }
+
+                /* find last path component and replace it */ 
+                while( '/' != *pathend) --pathend;
+
+                /*
+                ** if relative url path starts with one or more '../',
+                ** factor them out of href so that we return a
+                ** normalized URL
+                */
+                while( pathend != pathstart )
+                {
+                    const char *p = url;
+                    if( '.' != *p )
+                        break;
+                    ++p;
+                    if( '.' != *p ) 
+                        break;
+                    ++p;
+                    if( '/' != *p ) 
+                        break;
+                    ++p;
+                    url = p;
+                    while( '/' != *pathend ) --pathend;
+                }
+                /* concatenate remaining base URL and relative URL */
+                strcpy(pathend+1, url);
+            }
+            return href;
+        }
     }
+    return NULL;
+}
 
-    NS_ADDREF( p_peer );
-    return p_peer;
+#if XP_UNIX
+int  VlcPlugin::setSize(unsigned width, unsigned height)
+{
+    int diff = (width != i_width) || (height != i_height);
+
+    i_width = width;
+    i_height = height;
+
+    /* return size */
+    return diff;
 }
+#endif
 
diff -uNr vlc-0.8.6-svn20060918.debian/mozilla/vlcplugin.h vlc-0.8.6-svn20061008.debian/mozilla/vlcplugin.h
--- vlc-0.8.6-svn20060918.debian/mozilla/vlcplugin.h	2006-09-18 06:28:50.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/mozilla/vlcplugin.h	2006-10-04 09:47:09.000000000 -0400
@@ -1,10 +1,11 @@
 /*****************************************************************************
  * vlcplugin.h: a VLC plugin for Mozilla
  *****************************************************************************
- * Copyright (C) 2002-2005 the VideoLAN team
- * $Id: vlcplugin.h 15273 2006-04-19 09:13:26Z damienf $
+ * Copyright (C) 2002-2006 the VideoLAN team
+ * $Id: vlcplugin.h 16931 2006-10-03 09:04:50Z damienf $
  *
  * Authors: Samuel Hocevar <sam@zoy.org>
+            Damien Fouilleul <damienf@videolan.org>
  *
  * This program is free software; you can redistribute it and/or modify
  * it under the terms of the GNU General Public License as published by
@@ -27,7 +28,9 @@
 #ifndef __VLCPLUGIN_H__
 #define __VLCPLUGIN_H__
 
-#include "vlcpeer.h"
+#include <vlc/libvlc.h>
+#include <npapi.h>
+#include "control/nporuntime.h"
 
 #if !defined(XP_MACOSX) && !defined(XP_UNIX) && !defined(XP_WIN)
 #define XP_UNIX 1
@@ -54,45 +57,58 @@
 class VlcPlugin
 {
 public:
-             VlcPlugin( NPP ); 
+             VlcPlugin( NPP, uint16 ); 
     virtual ~VlcPlugin();
 
-    void     SetInstance( NPP );
-    NPP      GetInstance();
-    VlcIntf* GetPeer();
-
-    /* Window settings */
-    NPWindow* p_npwin;
-    uint16    i_npmode;
-    uint32    i_width, i_height;
-
-#ifdef XP_WIN
-    /* Windows data members */
-    HWND     p_hwnd;
-    WNDPROC  pf_wndproc;
-#endif
-
-#ifdef XP_UNIX
-    /* UNIX data members */
-    Window   window;
-    Display *p_display;
+    NPError             init(int argc, char* const argn[], char* const argv[]);
+    libvlc_instance_t*  getVLC() 
+                            { return libvlc_instance; };
+    NPP                 getBrowser()
+                            { return p_browser; };
+    char*               getAbsoluteURL(const char *url);
+    const NPWindow*     getWindow()
+                            { return &npwindow; };
+    void                setWindow(const NPWindow *window)
+                            { npwindow = *window; };
+
+    NPClass*            getScriptClass()
+                            { return scriptClass; };
+
+#if XP_WIN
+    WNDPROC             getWindowProc()
+                            { return pf_wndproc; };
+    void                setWindowProc(WNDPROC wndproc)
+                            { pf_wndproc = wndproc; };
 #endif
 
-#ifdef XP_MACOSX
-    /* MACOS data members */
-    NPWindow *window;
+#if XP_UNIX
+    int                 setSize(unsigned width, unsigned height);
 #endif
 
+    uint16    i_npmode; /* either NP_EMBED or NP_FULL */
 
-    /* vlc data members */
-    int      i_vlc;
+    /* plugin properties */
     int      b_stream;
     int      b_autoplay;
     char *   psz_target;
 
 private:
-    NPP      p_instance;
-    VlcPeer* p_peer;
+    /* VLC reference */
+    libvlc_instance_t *libvlc_instance;
+    NPClass           *scriptClass;
+
+    /* browser reference */
+    NPP     p_browser;
+    char*   psz_baseURL;
+
+    /* display settings */
+    NPWindow  npwindow;
+#if XP_WIN
+    WNDPROC   pf_wndproc;
+#endif
+#if XP_UNIX
+    unsigned int     i_width, i_height;
+#endif
 };
 
 /*******************************************************************************
diff -uNr vlc-0.8.6-svn20060918.debian/mozilla/vlc.r vlc-0.8.6-svn20061008.debian/mozilla/vlc.r
--- vlc-0.8.6-svn20060918.debian/mozilla/vlc.r	2006-09-18 06:28:50.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/mozilla/vlc.r	2006-10-04 09:47:09.000000000 -0400
@@ -70,7 +70,7 @@
         "video/x-ms-asf-plugin", "",
         "video/x-ms-asf", "",
         "application/x-mplayer2", "",
-        "video/x-ms-wmv", "",
+        "video/x-ms-wmv", "wmv",
         "video/x-google-vlc-plugin", "",
         "audio/wav", "wav",
         "audio/x-wav", "wav",
diff -uNr vlc-0.8.6-svn20060918.debian/mozilla/vlcruntime.cpp vlc-0.8.6-svn20061008.debian/mozilla/vlcruntime.cpp
--- vlc-0.8.6-svn20060918.debian/mozilla/vlcruntime.cpp	2006-09-18 06:28:50.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/mozilla/vlcruntime.cpp	1969-12-31 19:00:00.000000000 -0500
@@ -1,381 +0,0 @@
-/*****************************************************************************
- * vlcruntime.cpp: support for NPRuntime API for Netscape Script-able plugins
- *                 FYI: http://www.mozilla.org/projects/plugins/npruntime.html
- *****************************************************************************
- * Copyright (C) 2005 the VideoLAN team
- *
- * Authors: Damien Fouilleul <Damien.Fouilleul@laposte.net>
- *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 2 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
- *****************************************************************************/
-
-#include "config.h"
-
-#include <stdio.h>
-#include <string.h>
-#include <stdlib.h>
-
-/* vlc stuff */
-#ifdef USE_LIBVLC
-#   include <vlc/vlc.h>
-#endif
-
-/* Mozilla stuff */
-#ifdef HAVE_MOZILLA_CONFIG_H
-#   include <mozilla-config.h>
-#endif
-#include <nsISupports.h>
-#include <nsMemory.h>
-#include <npapi.h>
-#include <npruntime.h>
-
-#include "vlcplugin.h"
-#include "vlcruntime.h"
-
-/*
-** utility functions
-*/
-
-static PRInt64 NPVariantToPRInt64(const NPVariant &v)
-{
-    switch( v.type ) {
-	case NPVariantType_Bool:
-	    return static_cast<PRInt64>(NPVARIANT_TO_BOOLEAN(v));
-	case NPVariantType_Int32:
-	    return static_cast<PRInt64>(NPVARIANT_TO_INT32(v));
-	case NPVariantType_Double:
-	    return static_cast<PRInt64>(NPVARIANT_TO_DOUBLE(v));
-	default:
-	    return 0;
-    }
-}
-
-/*
-** implementation root object
-*/
-
-const NPUTF8 * const VlcRuntimeRootObject::propertyNames[] = { };
-const NPUTF8 * const VlcRuntimeRootObject::methodNames[] =
-{
-    "play",
-    "pause",
-    "stop",
-    "fullscreen",
-    "set_volume",
-    "get_volume",
-    "mute",
-    "get_int_variable",
-    "set_int_variable",
-    "get_bool_variable",
-    "set_bool_variable",
-    "get_str_variable",
-    "set_str_variable",
-    "clear_playlist",
-    "add_item",
-    "next",
-    "previous",
-    "isplaying",
-    "get_length",
-    "get_position",
-    "get_time",
-    "seek",
-};
-
-enum VlcRuntimeRootObjectMethodIds
-{
-    ID_play = 0,
-    ID_pause,
-    ID_stop,
-    ID_fullscreen,
-    ID_set_volume,
-    ID_get_volume,
-    ID_mute,
-    ID_get_int_variable,
-    ID_set_int_variable,
-    ID_get_bool_variable,
-    ID_set_bool_variable,
-    ID_get_str_variable,
-    ID_set_str_variable,
-    ID_clear_playlist,
-    ID_add_item,
-    ID_next,
-    ID_previous,
-    ID_isplaying,
-    ID_get_length,
-    ID_get_position,
-    ID_get_time,
-    ID_seek,
-};
-
-const int VlcRuntimeRootObject::propertyCount = sizeof(VlcRuntimeRootObject::propertyNames)/sizeof(NPUTF8 *);
-const int VlcRuntimeRootObject::methodCount = sizeof(VlcRuntimeRootObject::methodNames)/sizeof(NPUTF8 *);
-
-bool VlcRuntimeRootObject::getProperty(int index, NPVariant *result)
-{
-    return false;
-}
-
-bool VlcRuntimeRootObject::setProperty(int index, const NPVariant *value)
-{
-    return false;
-}
-
-bool VlcRuntimeRootObject::removeProperty(int index)
-{
-    return false;
-}
-
-bool VlcRuntimeRootObject::invoke(int index, const NPVariant *args, uint32_t argCount, NPVariant *result)
-{
-    VlcPlugin *plugin = (VlcPlugin *)(_instance->pdata);
-    if( plugin )
-    {
-	VlcIntf *peer = plugin->GetPeer();
-	switch( index )
-	{
-	    case ID_play:
-		peer->Play();
-		VOID_TO_NPVARIANT(*result);
-		return true;
-	    case ID_pause:
-		peer->Pause();
-		VOID_TO_NPVARIANT(*result);
-		return true;
-	    case ID_stop:
-		peer->Stop();
-		VOID_TO_NPVARIANT(*result);
-		return true;
-	    case ID_fullscreen:
-		peer->Fullscreen();
-		VOID_TO_NPVARIANT(*result);
-		return true;
-	    case ID_set_volume:
-		if( argCount == 1 )
-		{
-		    peer->Set_volume(NPVariantToPRInt64(args[0]));
-		    VOID_TO_NPVARIANT(*result);
-		    return true;
-		}
-		return false;
-	    case ID_get_volume:
-		{
-		    PRInt64 val;
-		    peer->Get_volume(&val);
-		    INT32_TO_NPVARIANT(val, *result);
-		    return true;
-		}
-	    case ID_mute:
-		peer->Mute();
-		VOID_TO_NPVARIANT(*result);
-		return true;
-	    case ID_get_int_variable:
-		if( (argCount == 1)
-		    && NPVARIANT_IS_STRING(args[0]) )
-		{
-		    const NPString &name = NPVARIANT_TO_STRING(args[0]);
-		    NPUTF8 *s = new NPUTF8[name.utf8length+1];
-		    if( s )
-		    {
-			PRInt64 val;
-			strncpy(s, name.utf8characters, name.utf8length);
-			s[name.utf8length] = '\0';
-			peer->Get_int_variable(s, &val);
-			INT32_TO_NPVARIANT(val, *result);
-			delete s;
-			return true;
-		    }
-		}
-		return false;
-	    case ID_set_int_variable:
-		if( (argCount == 2)
-		    && NPVARIANT_IS_STRING(args[0]) )
-		{
-		    const NPString &name = NPVARIANT_TO_STRING(args[0]);
-		    NPUTF8 *s = new NPUTF8[name.utf8length+1];
-		    if( s )
-		    {
-			strncpy(s, name.utf8characters, name.utf8length);
-			s[name.utf8length] = '\0';
-			peer->Set_int_variable(s, NPVariantToPRInt64(args[1]));
-			delete s;
-			VOID_TO_NPVARIANT(*result);
-			return true;
-		    }
-		}
-		return false;
-	    case ID_get_bool_variable:
-		if( (argCount == 1)
-		    && NPVARIANT_IS_STRING(args[0]) )
-		{
-		    const NPString &name = NPVARIANT_TO_STRING(args[0]);
-		    NPUTF8 *s = new NPUTF8[name.utf8length+1];
-		    if( s )
-		    {
-			PRBool val;
-			strncpy(s, name.utf8characters, name.utf8length);
-			s[name.utf8length] = '\0';
-			peer->Get_bool_variable(s, &val);
-			BOOLEAN_TO_NPVARIANT(val, *result);
-			delete s;
-			return true;
-		    }
-		}
-		return false;
-	    case ID_set_bool_variable:
-		if( (argCount == 2)
-		    && NPVARIANT_IS_STRING(args[0])
-		    && NPVARIANT_IS_BOOLEAN(args[1]) )
-		{
-		    const NPString &name = NPVARIANT_TO_STRING(args[0]);
-		    NPUTF8 *s = new NPUTF8[name.utf8length+1];
-		    if( s )
-		    {
-			strncpy(s, name.utf8characters, name.utf8length);
-			s[name.utf8length] = '\0';
-			peer->Set_bool_variable(s, NPVARIANT_TO_BOOLEAN(args[1]));
-			delete s;
-			VOID_TO_NPVARIANT(*result);
-			return true;
-		    }
-		}
-		return false;
-	    case ID_get_str_variable:
-		if( (argCount == 1)
-		    && NPVARIANT_IS_STRING(args[0]) )
-		{
-		    const NPString &name = NPVARIANT_TO_STRING(args[0]);
-		    NPUTF8 *s = new NPUTF8[name.utf8length+1];
-		    if( s )
-		    {
-			char *val;
-			strncpy(s, name.utf8characters, name.utf8length);
-			s[name.utf8length] = '\0';
-			peer->Get_str_variable(s, &val);
-			delete s;
-			int len = strlen(val);
-			NPUTF8 *retval = (NPUTF8 *)NPN_MemAlloc(len);
-			if( retval )
-			{
-			    memcpy(retval, val, len);
-			    STRINGN_TO_NPVARIANT(retval, len, *result);
-			    free(val);
-			    return true;
-			}
-			free(val);
-		    }
-		}
-		return false;
-	    case ID_set_str_variable:
-		if( (argCount == 2)
-		    && NPVARIANT_IS_STRING(args[0])
-		    && NPVARIANT_IS_STRING(args[1]) )
-		{
-		    const NPString &name = NPVARIANT_TO_STRING(args[0]);
-		    NPUTF8 *s = new NPUTF8[name.utf8length+1];
-		    if( s )
-		    {
-			strncpy(s, name.utf8characters, name.utf8length);
-			s[name.utf8length] = '\0';
-			const NPString &val = NPVARIANT_TO_STRING(args[1]);
-			NPUTF8 *v = new NPUTF8[val.utf8length+1];
-			if( v )
-			{
-			    strncpy(v, val.utf8characters, val.utf8length);
-			    v[val.utf8length] = '\0';
-			    peer->Set_str_variable(s, v);
-			    delete s;
-			    delete v;
-			    VOID_TO_NPVARIANT(*result);
-			    return true;
-			}
-			delete s;
-		    }
-		}
-		return false;
-	    case ID_clear_playlist:
-		peer->Clear_playlist();
-		VOID_TO_NPVARIANT(*result);
-		return true;
-	    case ID_add_item:
-		if( (argCount == 1)
-		    && NPVARIANT_IS_STRING(args[0]) )
-		{
-		    const NPString &name = NPVARIANT_TO_STRING(args[0]);
-		    NPUTF8 *s = new NPUTF8[name.utf8length+1];
-		    if( s )
-		    {
-			strncpy(s, name.utf8characters, name.utf8length);
-			s[name.utf8length] = '\0';
-			peer->Add_item(s);
-			delete s;
-			return true;
-		    }
-		}
-		return false;
-	    case ID_next:
-		peer->Next();
-		VOID_TO_NPVARIANT(*result);
-		return true;
-	    case ID_previous:
-		peer->Previous();
-		VOID_TO_NPVARIANT(*result);
-		return true;
-	    case ID_isplaying:
-		{
-		    PRBool val;
-		    peer->Isplaying(&val);
-		    BOOLEAN_TO_NPVARIANT(val, *result);
-		    return true;
-		}
-	    case ID_get_length:
-		{
-		    PRInt64 val;
-		    peer->Get_length(&val);
-		    DOUBLE_TO_NPVARIANT(val, *result);
-		    return true;
-		}
-	    case ID_get_position:
-		{
-		    PRInt64 val;
-		    peer->Get_position(&val);
-		    INT32_TO_NPVARIANT(val, *result);
-		    return true;
-		}
-	    case ID_get_time:
-		{
-		    PRInt64 val;
-		    peer->Get_time(&val);
-		    INT32_TO_NPVARIANT(val, *result);
-		    return true;
-		}
-	    case ID_seek:
-		if( argCount == 2 )
-		{
-		    peer->Seek(NPVariantToPRInt64(args[0]), NPVariantToPRInt64(args[1]));
-		    VOID_TO_NPVARIANT(*result);
-		    return true;
-		}
-		return false;
-	}
-	NS_RELEASE(peer);
-    }
-    return false;
-}
-
-bool VlcRuntimeRootObject::invokeDefault(const NPVariant *args, uint32_t argCount, NPVariant *result)
-{
-    return false;
-}
-
diff -uNr vlc-0.8.6-svn20060918.debian/mozilla/vlcruntime.h vlc-0.8.6-svn20061008.debian/mozilla/vlcruntime.h
--- vlc-0.8.6-svn20060918.debian/mozilla/vlcruntime.h	2006-09-18 06:28:50.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/mozilla/vlcruntime.h	1969-12-31 19:00:00.000000000 -0500
@@ -1,261 +0,0 @@
-/*****************************************************************************
- * vlcruntime.h: a VLC plugin for Mozilla
- *****************************************************************************
- * Copyright (C) 2002-2005 the VideoLAN team
- * $Id: vlcruntime.h 14466 2006-02-22 23:34:54Z dionoea $
- *
- * Authors: Damien Fouilleul <damien.fouilleul@laposte.net>
- *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 2 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
- *****************************************************************************/
-
-/*
-** support framework for runtime script objects
-*/
-
-class VlcRuntimeObject : public NPObject
-{
-public:
-    VlcRuntimeObject(NPP instance, const NPClass *aClass) :
-        _instance(instance)
-    {
-        _class = const_cast<NPClass *>(aClass);
-        referenceCount = 1;
-    };
-    virtual ~VlcRuntimeObject() {};
-
-    virtual bool getProperty(int index, NPVariant *result) = 0;
-    virtual bool setProperty(int index, const NPVariant *value) = 0;
-    virtual bool removeProperty(int index) = 0;
-    virtual bool invoke(int index, const NPVariant *args, uint32_t argCount, NPVariant *result) = 0;
-    virtual bool invokeDefault(const NPVariant *args, uint32_t argCount, NPVariant *result) = 0;
-    NPP _instance;
-};
-
-template<class T> class VlcRuntimeClass : public NPClass
-{
-public:
-    VlcRuntimeClass();
-    virtual ~VlcRuntimeClass();
-
-    VlcRuntimeObject *create(NPP instance) const;
-
-    int indexOfMethod(NPIdentifier name) const;
-    int indexOfProperty(NPIdentifier name) const;
-
-private:
-    NPIdentifier *propertyIdentifiers;
-    NPIdentifier *methodIdentifiers;
-};
-
-template<class T>
-static NPObject *vlcRuntimeClassAllocate(NPP instance, NPClass *aClass)
-{
-    const VlcRuntimeClass<T> *vClass = static_cast<VlcRuntimeClass<T> *>(aClass);
-    return (NPObject *)vClass->create(instance);
-}
-
-template<class T>
-static void vlcRuntimeClassDeallocate(NPObject *npobj)
-{
-    VlcRuntimeObject *vObj = static_cast<VlcRuntimeObject *>(npobj);
-    delete vObj;
-}
-
-template<class T>
-static void vlcRuntimeClassInvalidate(NPObject *npobj)
-{
-    VlcRuntimeObject *vObj = static_cast<VlcRuntimeObject *>(npobj);
-    vObj->_instance = NULL;
-}
-
-template<class T>
-bool vlcRuntimeClassHasMethod(NPObject *npobj, NPIdentifier name)
-{
-    const VlcRuntimeClass<T> *vClass = static_cast<VlcRuntimeClass<T> *>(npobj->_class);
-    return vClass->indexOfMethod(name) != -1;
-}
-
-template<class T>
-bool vlcRuntimeClassHasProperty(NPObject *npobj, NPIdentifier name)
-{
-    const VlcRuntimeClass<T> *vClass = static_cast<VlcRuntimeClass<T> *>(npobj->_class);
-    return vClass->indexOfProperty(name) != -1;
-}
-
-template<class T>
-bool vlcRuntimeClassGetProperty(NPObject *npobj, NPIdentifier name, NPVariant *result)
-{
-    const VlcRuntimeClass<T> *vClass = static_cast<VlcRuntimeClass<T> *>(npobj->_class);
-    int index = vClass->indexOfProperty(name);
-    if( index != -1 )
-    {
-        VlcRuntimeObject *vObj = static_cast<VlcRuntimeObject *>(npobj);
-        return vObj->getProperty(index, result);
-    }
-    return false;
-}
-
-template<class T>
-bool vlcRuntimeClassSetProperty(NPObject *npobj, NPIdentifier name, const NPVariant *value)
-{
-    const VlcRuntimeClass<T> *vClass = static_cast<VlcRuntimeClass<T> *>(npobj->_class);
-    int index = vClass->indexOfProperty(name);
-    if( index != -1 )
-    {
-        VlcRuntimeObject *vObj = static_cast<VlcRuntimeObject *>(npobj);
-        return vObj->setProperty(index, value);
-    }
-    return false;
-}
-
-template<class T>
-bool vlcRuntimeClassRemoveProperty(NPObject *npobj, NPIdentifier name)
-{
-    const VlcRuntimeClass<T> *vClass = static_cast<VlcRuntimeClass<T> *>(npobj->_class);
-    int index = vClass->indexOfProperty(name);
-    if( index != -1 )
-    {
-        VlcRuntimeObject *vObj = static_cast<VlcRuntimeObject *>(npobj);
-        return vObj->removeProperty(index);
-    }
-    return false;
-}
-
-template<class T>
-static bool vlcRuntimeClassInvoke(NPObject *npobj, NPIdentifier name,
-                                    const NPVariant *args, uint32_t argCount,
-                                    NPVariant *result)
-{
-    const VlcRuntimeClass<T> *vClass = static_cast<VlcRuntimeClass<T> *>(npobj->_class);
-    int index = vClass->indexOfMethod(name);
-    if( index != -1 )
-    {
-        VlcRuntimeObject *vObj = static_cast<VlcRuntimeObject *>(npobj);
-        return vObj->invoke(index, args, argCount, result);
-    }
-    return false;
-}
-
-template<class T>
-static bool vlcRuntimeClassInvokeDefault(NPObject *npobj,
-                                           const NPVariant *args,
-                                           uint32_t argCount,
-                                           NPVariant *result)
-{
-    VlcRuntimeObject *vObj = static_cast<VlcRuntimeObject *>(npobj);
-    return vObj->invokeDefault(args, argCount, result);
-}
-
-template<class T>
-VlcRuntimeClass<T>::VlcRuntimeClass()
-{
-    // retreive property identifiers from names
-    if( T::propertyCount > 0 )
-    {
-	propertyIdentifiers = new NPIdentifier[T::propertyCount];
-	if( propertyIdentifiers )
-	    NPN_GetStringIdentifiers(const_cast<const NPUTF8**>(T::propertyNames),
-		    T::propertyCount, propertyIdentifiers);
-    }
-
-    // retreive method identifiers from names
-    if( T::methodCount > 0 )
-    {
-	methodIdentifiers = new NPIdentifier[T::methodCount];
-	if( methodIdentifiers )
-	    NPN_GetStringIdentifiers(const_cast<const NPUTF8**>(T::methodNames),
-		    T::methodCount, methodIdentifiers);
-    }
-
-    // fill in NPClass structure
-    structVersion  = NP_CLASS_STRUCT_VERSION;
-    allocate       = vlcRuntimeClassAllocate<T>;
-    deallocate     = vlcRuntimeClassDeallocate<T>;
-    invalidate     = vlcRuntimeClassInvalidate<T>;
-    hasMethod      = vlcRuntimeClassHasMethod<T>;
-    invoke         = vlcRuntimeClassInvoke<T>;
-    invokeDefault  = vlcRuntimeClassInvokeDefault<T>;
-    hasProperty    = vlcRuntimeClassHasProperty<T>;
-    getProperty    = vlcRuntimeClassGetProperty<T>;
-    setProperty    = vlcRuntimeClassSetProperty<T>;
-    removeProperty = vlcRuntimeClassRemoveProperty<T>;
-}
-
-template<class T>
-VlcRuntimeClass<T>::~VlcRuntimeClass()
-{
-    delete propertyIdentifiers;
-    delete methodIdentifiers;
-}
-
-template<class T>
-VlcRuntimeObject *VlcRuntimeClass<T>::create(NPP instance) const
-{
-    return new T(instance, this);
-}
-
-template<class T>
-int VlcRuntimeClass<T>::indexOfMethod(NPIdentifier name) const
-{
-    if( methodIdentifiers )
-    {
-        for(int c=0; c< T::methodCount; ++c )
-        {
-            if( name == methodIdentifiers[c] )
-                return c;
-        }
-    }
-    return -1;
-}
-
-template<class T>
-int VlcRuntimeClass<T>::indexOfProperty(NPIdentifier name) const
-{
-    if( propertyIdentifiers )
-    {
-        for(int c=0; c< T::propertyCount; ++c )
-        {
-            if( name == propertyIdentifiers[c] )
-                return c;
-        }
-    }
-    return -1;
-}
-
-/*
-** defined runtime script objects
-*/
-
-class VlcRuntimeRootObject: public VlcRuntimeObject
-{
-public:
-    VlcRuntimeRootObject(NPP instance, const NPClass *aClass) :
-        VlcRuntimeObject(instance, aClass) {};
-    virtual ~VlcRuntimeRootObject() {};
-
-    static const int propertyCount;
-    static const NPUTF8 * const propertyNames[];
-
-    static const int methodCount;
-    static const NPUTF8 * const methodNames[];
-
-    virtual bool getProperty(int index, NPVariant *result);
-    virtual bool setProperty(int index, const NPVariant *value);
-    virtual bool removeProperty(int index);
-    virtual bool invoke(int index, const NPVariant *args, uint32_t argCount, NPVariant *result);
-    virtual bool invokeDefault(const NPVariant *args, uint32_t argCount, NPVariant *result);
-};
-
diff -uNr vlc-0.8.6-svn20060918.debian/mozilla/vlcshell.cpp vlc-0.8.6-svn20061008.debian/mozilla/vlcshell.cpp
--- vlc-0.8.6-svn20060918.debian/mozilla/vlcshell.cpp	2006-09-18 06:28:50.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/mozilla/vlcshell.cpp	2006-10-04 09:47:09.000000000 -0400
@@ -2,7 +2,7 @@
  * vlcshell.cpp: a VLC plugin for Mozilla
  *****************************************************************************
  * Copyright (C) 2002-2005 the VideoLAN team
- * $Id: vlcshell.cpp 16460 2006-08-31 22:01:13Z hartman $
+ * $Id: vlcshell.cpp 16931 2006-10-03 09:04:50Z damienf $
  *
  * Authors: Samuel Hocevar <sam@zoy.org>
  *
@@ -21,9 +21,6 @@
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston MA 02110-1301, USA.
  *****************************************************************************/
 
-/* XXX: disable VLC here */
-#define USE_LIBVLC 1
-
 /*****************************************************************************
  * Preamble
  *****************************************************************************/
@@ -33,19 +30,10 @@
 #include <string.h>
 #include <stdlib.h>
 
-/* vlc stuff */
-#ifdef USE_LIBVLC
-#   include <vlc/vlc.h>
-#endif
-
 /* Mozilla stuff */
 #ifdef HAVE_MOZILLA_CONFIG_H
 #   include <mozilla-config.h>
 #endif
-#include <nsISupports.h>
-#include <nsMemory.h>
-#include <npapi.h>
-#include <npruntime.h>
 
 /* This is from mozilla java, do we really need it? */
 #if 0
@@ -53,50 +41,35 @@
 #endif
 
 #include "vlcplugin.h"
-#include "vlcruntime.h"
-
-#if USE_LIBVLC
-#   define WINDOW_TEXT "(no picture)"
-#else
-#   define WINDOW_TEXT "(no libvlc)"
-#endif
 
 /* Enable/disable debugging printf's for X11 resizing */
 #undef X11_RESIZE_DEBUG
 
+#define WINDOW_TEXT "(no video)"
+
 /*****************************************************************************
  * Unix-only declarations
 ******************************************************************************/
 #ifdef XP_UNIX
-#   define VOUT_PLUGINS "xvideo,x11,dummy"
-#   define AOUT_PLUGINS "esd,arts,alsa,oss,dummy"
-
-static unsigned int i_previous_height = 100000;
-static unsigned int i_previous_width = 100000;
 
 static void Redraw( Widget w, XtPointer closure, XEvent *event );
 static void Resize( Widget w, XtPointer closure, XEvent *event );
+
 #endif
 
 /*****************************************************************************
  * MacOS-only declarations
 ******************************************************************************/
 #ifdef XP_MACOSX
-#   define VOUT_PLUGINS "opengl,macosx,dummy"
-#   define AOUT_PLUGINS "auhal,macosx,dummy"
-
 #endif
 
 /*****************************************************************************
  * Windows-only declarations
  *****************************************************************************/
 #ifdef XP_WIN
-#   define VOUT_PLUGINS "directx,wingdi,dummy"
-#   define AOUT_PLUGINS "directx,waveout,dummy"
 
-#if defined(XP_WIN) && !USE_LIBVLC
-LRESULT CALLBACK Manage( HWND, UINT, WPARAM, LPARAM );
-#endif
+static LRESULT CALLBACK Manage( HWND p_hwnd, UINT i_msg, WPARAM wpar, LPARAM lpar );
+
 #endif
 
 /******************************************************************************
@@ -110,9 +83,9 @@
 NPError NPP_GetValue( NPP instance, NPPVariable variable, void *value )
 {
 
-    static nsIID nsid = VLCINTF_IID;
     static char psz_desc[1000];
 
+    /* plugin class variables */
     switch( variable )
     {
         case NPPVpluginNameString:
@@ -120,17 +93,13 @@
             return NPERR_NO_ERROR;
 
         case NPPVpluginDescriptionString:
-#if USE_LIBVLC
-            snprintf( psz_desc, 1000-1, PLUGIN_DESCRIPTION, VLC_Version() );
-#else /* USE_LIBVLC */
-            snprintf( psz_desc, 1000-1, PLUGIN_DESCRIPTION, "(disabled)" );
-#endif /* USE_LIBVLC */
-            psz_desc[1000-1] = 0;
+            snprintf( psz_desc, sizeof(psz_desc)-1, PLUGIN_DESCRIPTION, VLC_Version() );
+            psz_desc[sizeof(psz_desc)-1] = 0;
             *((char **)value) = psz_desc;
             return NPERR_NO_ERROR;
 
         default:
-            /* go on... */
+            /* move on to instance variables ... */
             break;
     }
 
@@ -139,31 +108,21 @@
         return NPERR_INVALID_INSTANCE_ERROR;
     }
 
-    VlcPlugin* p_plugin = (VlcPlugin*) instance->pdata;
+    /* plugin instance variables */
 
-    switch( variable )
+    VlcPlugin* p_plugin = reinterpret_cast<VlcPlugin*>(instance->pdata);
+    if( NULL == p_plugin )
     {
-        case NPPVpluginScriptableInstance:
-            *(nsISupports**)value = p_plugin->GetPeer();
-            if( *(nsISupports**)value == NULL )
-            {
-                return NPERR_OUT_OF_MEMORY_ERROR;
-            }
-            break;
-
-        case NPPVpluginScriptableIID:
-            *(nsIID**)value = (nsIID*)NPN_MemAlloc( sizeof(nsIID) );
-            if( *(nsIID**)value == NULL )
-            {
-                return NPERR_OUT_OF_MEMORY_ERROR;
-            }
-            **(nsIID**)value = nsid;
-            break;
+        // plugin has not been initialized yet !
+        return NPERR_INVALID_INSTANCE_ERROR;
+    }
 
+    switch( variable )
+    {
         case NPPVpluginScriptableNPObject:
-            static VlcRuntimeClass<VlcRuntimeRootObject> *rootClass = new VlcRuntimeClass<VlcRuntimeRootObject>;
-            *(NPObject**)value = NPN_CreateObject(instance, rootClass);
-            if( *(NPObject**)value == NULL )
+            /* create an instance and return it */
+            *(NPObject**)value = NPN_CreateObject(instance, p_plugin->getScriptClass());
+            if( NULL == *(NPObject**)value )
             {
                 return NPERR_OUT_OF_MEMORY_ERROR;
             }
@@ -172,7 +131,6 @@
         default:
             return NPERR_GENERIC_ERROR;
     }
-
     return NPERR_NO_ERROR;
 }
 
@@ -203,26 +161,45 @@
             return true;
         case updateEvt:
         {
-            NPWindow *npwindow = p_plugin->window;
+            int needsDisplay = TRUE;
+            libvlc_instance_t *p_vlc = p_plugin->getVLC();
+
+            if( p_vlc )
+            {
+                if( libvlc_playlist_isplaying(p_vlc, NULL) )
+                {
+                    libvlc_input_t *p_input = libvlc_playlist_get_input(p_vlc, NULL);
+                    if( p_input )
+                    {
+                        needsDisplay = ! libvlc_input_has_vout(p_input, NULL);
+                        libvlc_input_free(p_input);
+                    }
+                }
+            }
 
-            /* draw the beautiful "No Picture" */
+            const NPWindow *npwindow = p_plugin->getWindow();
+                
+            if( needsDisplay && npwindow->window )
+            {
+                /* draw the beautiful "No Picture" */
 
-            ForeColor(blackColor);
-            PenMode( patCopy );
+                ForeColor(blackColor);
+                PenMode( patCopy );
 
-            Rect rect;
-            rect.left = 0;
-            rect.top = 0;
-            rect.right = npwindow->width;
-            rect.bottom = npwindow->height;
-            PaintRect( &rect );
-
-            ForeColor(whiteColor);
-            char *text = strdup( WINDOW_TEXT );
-            MoveTo( (npwindow->width-80)/ 2  , npwindow->height / 2 );
-            DrawText( text , 0 , strlen(text) );
-            free(text);
+                /* seems that firefox forgets to set the following on occasion (reload) */
+                SetOrigin(((NP_Port *)npwindow->window)->portx, ((NP_Port *)npwindow->window)->porty);
 
+                Rect rect;
+                rect.left = 0;
+                rect.top = 0;
+                rect.right = npwindow->width;
+                rect.bottom = npwindow->height;
+                PaintRect( &rect );
+
+                ForeColor(whiteColor);
+                MoveTo( (npwindow->width-80)/ 2  , npwindow->height / 2 );
+                DrawText( WINDOW_TEXT , 0 , strlen(WINDOW_TEXT) );
+            }
             return true;
         }
         case activateEvt:
@@ -267,226 +244,29 @@
 NPError NPP_New( NPMIMEType pluginType, NPP instance, uint16 mode, int16 argc,
                  char* argn[], char* argv[], NPSavedData* saved )
 {
-    int i;
-
-#if USE_LIBVLC
-    vlc_value_t value;
-    int i_ret;
-
-#endif /* USE_LIBVLC */
+    NPError status;
 
     if( instance == NULL )
     {
         return NPERR_INVALID_INSTANCE_ERROR;
     }
 
-    VlcPlugin * p_plugin = new VlcPlugin( instance );
-
-    if( p_plugin == NULL )
+    VlcPlugin * p_plugin = new VlcPlugin( instance, mode );
+    if( NULL == p_plugin )
     {
         return NPERR_OUT_OF_MEMORY_ERROR;
     }
 
-    instance->pdata = p_plugin;
-
-#ifdef XP_WIN
-    p_plugin->p_hwnd = NULL;
-    p_plugin->pf_wndproc = NULL;
-#endif /* XP_WIN */
-
-#ifdef XP_UNIX
-    p_plugin->window = 0;
-    p_plugin->p_display = NULL;
-#endif /* XP_UNIX */
-
-    p_plugin->p_npwin = NULL;
-    p_plugin->i_npmode = mode;
-    p_plugin->i_width = 0;
-    p_plugin->i_height = 0;
-
-#if USE_LIBVLC
-    p_plugin->i_vlc = VLC_Create();
-    if( p_plugin->i_vlc < 0 )
-    {
-        p_plugin->i_vlc = 0;
-        delete p_plugin;
-        p_plugin = NULL;
-        return NPERR_GENERIC_ERROR;
-    }
-
-    {
-#ifdef XP_MACOSX
-        char *ppsz_argv[] =
-        {
-            "vlc",
-            "-vvvv",
-            "--plugin-path",
-            "/Library/Internet Plug-Ins/VLC Plugin.plugin/"
-            "Contents/MacOS/modules"
-        };
-
-#elif defined(XP_WIN)
-        char *ppsz_argv[] = { NULL, "-vv" };
-        HKEY h_key;
-        DWORD i_type, i_data = MAX_PATH + 1;
-        char p_data[MAX_PATH + 1];
-        if( RegOpenKeyEx( HKEY_LOCAL_MACHINE, "Software\\VideoLAN\\VLC",
-                          0, KEY_READ, &h_key ) == ERROR_SUCCESS )
-        {
-             if( RegQueryValueEx( h_key, "InstallDir", 0, &i_type,
-                                  (LPBYTE)p_data, &i_data ) == ERROR_SUCCESS )
-             {
-                 if( i_type == REG_SZ )
-                 {
-                     strcat( p_data, "\\vlc" );
-                     ppsz_argv[0] = p_data;
-                 }
-             }
-             RegCloseKey( h_key );
-        }
-
-        if( !ppsz_argv[0] ) ppsz_argv[0] = "vlc";
-
-#else /* XP_MACOSX */
-        char *ppsz_argv[] =
-        {
-            "vlc"
-            "-vvvv"
-            /*, "--plugin-path", ""*/
-        };
-
-#endif /* XP_MACOSX */
-
-        /* HACK: special case for loop, to have it set before playlist startup
-         */
-        for( i = 0; i < argc ; i++ )
-        {
-            if( !strcmp( argn[i], "loop" ) )
-            {
-                if( !strcmp( argv[i], "1" ) || !strcmp( argv[i], "yes" ) )
-                {
-                    value.b_bool = VLC_TRUE;
-                    VLC_VariableSet( p_plugin->i_vlc, "conf::loop", value );
-                }
-            }
-        }
-
-        i_ret = VLC_Init( p_plugin->i_vlc, sizeof(ppsz_argv)/sizeof(char*),
-                          ppsz_argv );
-
+    status = p_plugin->init(argc, argn, argv);
+    if( NPERR_NO_ERROR == status ) {
+        instance->pdata = reinterpret_cast<void*>(p_plugin);
     }
-
-    if( i_ret )
-    {
-        VLC_Destroy( p_plugin->i_vlc );
-        p_plugin->i_vlc = 0;
+    else {
         delete p_plugin;
-        p_plugin = NULL;
-        return NPERR_GENERIC_ERROR;
-    }
-
-    value.psz_string = "dummy";
-    VLC_VariableSet( p_plugin->i_vlc, "conf::intf", value );
-    value.psz_string = VOUT_PLUGINS;
-    VLC_VariableSet( p_plugin->i_vlc, "conf::vout", value );
-    value.psz_string = AOUT_PLUGINS;
-    VLC_VariableSet( p_plugin->i_vlc, "conf::aout", value );
-
-#else /* USE_LIBVLC */
-    p_plugin->i_vlc = 1;
-
-#endif /* USE_LIBVLC */
-
-    p_plugin->b_stream = VLC_FALSE;
-    p_plugin->b_autoplay = VLC_FALSE;
-    p_plugin->psz_target = NULL;
-
-    for( i = 0; i < argc ; i++ )
-    {
-        if( !strcmp( argn[i], "target" ) )
-        {
-            p_plugin->psz_target = argv[i];
-        }
-        else if( !strcmp( argn[i], "autoplay" ) )
-        {
-            if( !strcmp( argv[i], "1" ) || !strcmp( argv[i], "yes" ) )
-            {
-                p_plugin->b_autoplay = 1;
-            }
-        }
-        else if( !strcmp( argn[i], "autostart" ) )
-        {
-            if( !strcmp( argv[i], "1" ) || !strcmp( argv[i], "true" ) )
-            {
-                p_plugin->b_autoplay = 1;
-            }
-        }
-        else if( !strcmp( argn[i], "filename" ) )
-        {
-            p_plugin->psz_target = argv[i];
-        }
-        else if( !strcmp( argn[i], "src" ) )
-        {
-            p_plugin->psz_target = argv[i];
-        }
-
-#if USE_LIBVLC
-        else if( !strcmp( argn[i], "fullscreen" ) )
-        {
-            if( !strcmp( argv[i], "1" ) || !strcmp( argv[i], "yes" ) )
-            {
-                value.b_bool = VLC_TRUE;
-                VLC_VariableSet( p_plugin->i_vlc, "conf::fullscreen", value );
-            }
-        }
-        else if( !strcmp( argn[i], "mute" ) )
-        {
-            if( !strcmp( argv[i], "1" ) || !strcmp( argv[i], "yes" ) )
-            {
-                VLC_VolumeMute( p_plugin->i_vlc );
-            }
-        }
-#endif /* USE_LIBVLC */
-    }
-
-    if( p_plugin->psz_target )
-    {
-        p_plugin->psz_target = strdup( p_plugin->psz_target );
     }
-
-    return NPERR_NO_ERROR;
+    return status;
 }
 
-#ifdef XP_WIN
-/* This is really ugly but there is a deadlock when stopping a stream
- * (in VLC_CleanUp()) because the video output is a child of the drawable but
- * is in a different thread. */
-static void HackStopVout( VlcPlugin* p_plugin )
-{
-    MSG msg;
-    HWND hwnd;
-    vlc_value_t value;
-
-    VLC_VariableGet( p_plugin->i_vlc, "drawable", &value );
-
-    hwnd = FindWindowEx( (HWND)value.i_int, 0, 0, 0 );
-    if( !hwnd ) return;
-
-    PostMessage( hwnd, WM_CLOSE, 0, 0 );
-
-    do
-    {
-        while( PeekMessage( &msg, (HWND)value.i_int, 0, 0, PM_REMOVE ) )
-        {
-            TranslateMessage(&msg);
-            DispatchMessage(&msg);
-        }
-        if( FindWindowEx( (HWND)value.i_int, 0, 0, 0 ) ) Sleep( 10 );
-    }
-    while( (hwnd = FindWindowEx( (HWND)value.i_int, 0, 0, 0 )) );
-}
-#endif /* XP_WIN */
-
 NPError NPP_Destroy( NPP instance, NPSavedData** save )
 {
     if( instance == NULL )
@@ -494,30 +274,20 @@
         return NPERR_INVALID_INSTANCE_ERROR;
     }
 
-    VlcPlugin* p_plugin = (VlcPlugin*)instance->pdata;
+    VlcPlugin* p_plugin = reinterpret_cast<VlcPlugin*>(instance->pdata);
 
-    if( p_plugin != NULL )
+#if XP_WIN
+    HWND win = (HWND)p_plugin->getWindow()->window;
+    WNDPROC winproc = p_plugin->getWindowProc();
+    if( winproc )
     {
-        if( p_plugin->i_vlc )
-        {
-#if USE_LIBVLC
-#   ifdef XP_WIN
-            HackStopVout( p_plugin );
-#   endif /* XP_WIN */
-            VLC_CleanUp( p_plugin->i_vlc );
-            VLC_Destroy( p_plugin->i_vlc );
-#endif /* USE_LIBVLC */
-            p_plugin->i_vlc = 0;
-        }
-
-        if( p_plugin->psz_target )
-        {
-            free( p_plugin->psz_target );
-            p_plugin->psz_target = NULL;
-        }
+        /* reset WNDPROC */
+        SetWindowLong( win, GWL_WNDPROC, (LONG)winproc );
+    }
+#endif
 
+    if( p_plugin )
         delete p_plugin;
-    }
 
     instance->pdata = NULL;
 
@@ -526,71 +296,20 @@
 
 NPError NPP_SetWindow( NPP instance, NPWindow* window )
 {
-    vlc_value_t value;
-#ifdef XP_MACOSX
-    vlc_value_t valuex;
-    vlc_value_t valuey;
-    vlc_value_t valuew;
-    vlc_value_t valueh;
-    vlc_value_t valuet;
-    vlc_value_t valuel;
-    vlc_value_t valueb;
-    vlc_value_t valuer;
-    vlc_value_t valueportx;
-    vlc_value_t valueporty;
-    vlc_value_t valueredraw;
-#endif /* XP_MACOSX */
-
-    if( instance == NULL )
+    if( ! instance )
     {
         return NPERR_INVALID_INSTANCE_ERROR;
     }
 
-    VlcPlugin* p_plugin = (VlcPlugin*)instance->pdata;
-
-    /* Write the window ID for vlc */
-#if USE_LIBVLC
-
-#ifdef XP_MACOSX
-    value.i_int = (int)(((NP_Port*) (window->window))->port);
-    VLC_VariableSet( p_plugin->i_vlc, "drawable", value );
-
-    valueportx.i_int = ((NP_Port*) (window->window))->portx;
-    valueporty.i_int = ((NP_Port*) (window->window))->porty;
-    VLC_VariableSet( p_plugin->i_vlc, "drawableportx", valueportx );
-    VLC_VariableSet( p_plugin->i_vlc, "drawableporty", valueporty );
-
-    valuex.i_int = window->x;
-    valuey.i_int = window->y;
-    valuew.i_int = window->width;
-    valueh.i_int = window->height;
-    valuet.i_int = window->clipRect.top;
-    valuel.i_int = window->clipRect.left;
-    valueb.i_int = window->clipRect.bottom;
-    valuer.i_int = window->clipRect.right;
-
-    VLC_VariableSet( p_plugin->i_vlc, "drawablet", valuet );
-    VLC_VariableSet( p_plugin->i_vlc, "drawablel", valuel );
-    VLC_VariableSet( p_plugin->i_vlc, "drawableb", valueb );
-    VLC_VariableSet( p_plugin->i_vlc, "drawabler", valuer );
-    VLC_VariableSet( p_plugin->i_vlc, "drawablex", valuex );
-    VLC_VariableSet( p_plugin->i_vlc, "drawabley", valuey );
-    VLC_VariableSet( p_plugin->i_vlc, "drawablew", valuew );
-    VLC_VariableSet( p_plugin->i_vlc, "drawableh", valueh );
-
-    p_plugin->window = window;
-
-    valueredraw.i_int = 1;
-    VLC_VariableSet( p_plugin->i_vlc, "drawableredraw", valueredraw );
-
-#else /* XP_MACOSX */
-    /* FIXME: this cast sucks */
-    value.i_int = (int) (ptrdiff_t) (void *) window->window;
-    VLC_VariableSet( p_plugin->i_vlc, "drawable", value );
-
-#endif /* XP_MACOSX */
+    /* NPP_SetWindow may be called before NPP_New (Opera) */
+    VlcPlugin* p_plugin = reinterpret_cast<VlcPlugin*>(instance->pdata);
+    if( ! p_plugin )
+    {
+        /* we should probably show a splash screen here */
+        return NPERR_NO_ERROR;
+    }
 
-#endif /* USE_LIBVLC */
+    libvlc_instance_t *p_vlc = p_plugin->getVLC();
 
     /*
      * PLUGIN DEVELOPERS:
@@ -600,168 +319,172 @@
      *  size changes, etc.
      */
 
+    const NPWindow *curwin = p_plugin->getWindow();
+
+#ifdef XP_MACOSX
+    if( window && window->window )
+    {
+        /* check if plugin has a new parent window */
+        CGrafPtr drawable = (((NP_Port*) (window->window))->port);
+        if( !curwin->window || drawable != (((NP_Port*) (curwin->window))->port) )
+        {
+            /* set/change parent window */
+            libvlc_video_set_parent(p_vlc, (libvlc_drawable_t)drawable, NULL);
+        }
+
+        /* as MacOS X video output is windowless, set viewport */
+        libvlc_rectangle_t view, clip;
+
+        /*
+        ** browser sets port origin to top-left location of plugin relative to GrafPort
+        ** window origin is set relative to document, which of little use for drawing
+        */
+        view.top     = ((NP_Port*) (window->window))->porty;
+        view.left    = ((NP_Port*) (window->window))->portx;
+        view.bottom  = window->height+view.top;
+        view.right   = window->width+view.left;
+        /* clipRect coordinates are also relative to GrafPort */
+        clip.top     = window->clipRect.top;
+        clip.left    = window->clipRect.left;
+        clip.bottom  = window->clipRect.bottom;
+        clip.right   = window->clipRect.right;
+
+        libvlc_video_set_viewport(p_vlc, &view, &clip, NULL);
+
+        /* remember window details */
+        p_plugin->setWindow(window);
+    }
+#endif /* XP_MACOSX */
+
 #ifdef XP_WIN
-    if( !window || !window->window )
+    if( window && window->window )
     {
-        /* Window was destroyed. Invalidate everything. */
-        if( p_plugin->p_npwin )
-        {
-#if !USE_LIBVLC
-            SetWindowLong( p_plugin->p_hwnd, GWL_WNDPROC,
-                           (LONG)p_plugin->pf_wndproc );
-#endif /* !USE_LIBVLC */
-            p_plugin->pf_wndproc = NULL;
-            p_plugin->p_hwnd = NULL;
+        /* check if plugin has a new parent window */
+        HWND drawable = (HWND) (window->window);
+        if( !curwin->window || drawable != curwin->window )
+        {
+            /* reset previous window settings */
+            HWND oldwin = (HWND)p_plugin->getWindow()->window;
+            WNDPROC oldproc = p_plugin->getWindowProc();
+            if( oldproc )
+            {
+                /* reset WNDPROC */
+                SetWindowLong( oldwin, GWL_WNDPROC, (LONG)oldproc );
+            }
+            /* attach our plugin object */
+            SetWindowLongPtr((HWND)drawable, GWLP_USERDATA, reinterpret_cast<LONG_PTR>(p_plugin));
+
+            /* install our WNDPROC */
+            p_plugin->setWindowProc( (WNDPROC)SetWindowLong( drawable,
+                                                           GWL_WNDPROC, (LONG)Manage ) );
+
+            /* change window style to our liking */
+            LONG style = GetWindowLong((HWND)drawable, GWL_STYLE);
+            style |= WS_CLIPCHILDREN|WS_CLIPSIBLINGS;
+            SetWindowLong((HWND)drawable, GWL_STYLE, style);
+
+            /* change/set parent */
+            libvlc_video_set_parent(p_vlc, (libvlc_drawable_t)drawable, NULL);
         }
 
-        p_plugin->p_npwin = window;
-        return NPERR_NO_ERROR;
+        /* remember window details */
+        p_plugin->setWindow(window);
+
+        /* Redraw window */
+        InvalidateRect( (HWND)drawable, NULL, TRUE );
+        UpdateWindow( (HWND)drawable );
     }
+    else
+    {
+        /* reset WNDPROC */
+        HWND oldwin = (HWND)curwin->window;
+        SetWindowLong( oldwin, GWL_WNDPROC, (LONG)(p_plugin->getWindowProc()) );
+        p_plugin->setWindowProc(NULL);
+        /* change/set parent */
+        libvlc_video_set_parent(p_vlc, 0, NULL);
+    }
+#endif /* XP_WIN */
 
-    if( p_plugin->p_npwin )
+#ifdef XP_UNIX
+    if( window && window->window )
     {
-        if( p_plugin->p_hwnd == (HWND)window->window )
+        Window  drawable   = (Window) window->window;
+        if( !curwin->window || drawable != (Window)curwin->window )
         {
-            /* Same window, but something may have changed. First we
-             * update the plugin structure, then we redraw the window */
-            p_plugin->i_width = window->width;
-            p_plugin->i_height = window->height;
-            p_plugin->p_npwin = window;
-#if !USE_LIBVLC
-            InvalidateRect( p_plugin->p_hwnd, NULL, TRUE );
-            UpdateWindow( p_plugin->p_hwnd );
-#endif /* !USE_LIBVLC */
-            return NPERR_NO_ERROR;
-        }
+            Display *p_display = ((NPSetWindowCallbackStruct *)window->ws_info)->display;
 
-        /* Window has changed. Destroy the one we have, and go
-         * on as if it was a real initialization. */
-#if !USE_LIBVLC
-        SetWindowLong( p_plugin->p_hwnd, GWL_WNDPROC,
-                       (LONG)p_plugin->pf_wndproc );
-#endif /* !USE_LIBVLC */
-        p_plugin->pf_wndproc = NULL;
-        p_plugin->p_hwnd = NULL;
-    }
-
-#if !USE_LIBVLC
-    p_plugin->pf_wndproc = (WNDPROC)SetWindowLong( (HWND)window->window,
-                                                   GWL_WNDPROC, (LONG)Manage );
-#endif /* !USE_LIBVLC */
-
-    p_plugin->p_hwnd = (HWND)window->window;
-    SetProp( p_plugin->p_hwnd, "w00t", (HANDLE)p_plugin );
-    InvalidateRect( p_plugin->p_hwnd, NULL, TRUE );
-    UpdateWindow( p_plugin->p_hwnd );
-#endif /* XP_WIN */
+            XResizeWindow( p_display, drawable, window->width, window->height );
+            Widget w = XtWindowToWidget( p_display, drawable );
 
-    p_plugin->i_width = window->width;
-    p_plugin->i_height = window->height;
-    p_plugin->p_npwin = window;
+            XtAddEventHandler( w, ExposureMask, FALSE, (XtEventHandler)Redraw, p_plugin );
+            XtAddEventHandler( w, StructureNotifyMask, FALSE, (XtEventHandler)Resize, p_plugin );
 
-#ifdef XP_UNIX
-    p_plugin->window = (Window) window->window;
-    p_plugin->p_display =
-        ((NPSetWindowCallbackStruct *)window->ws_info)->display;
-
-    XResizeWindow( p_plugin->p_display, p_plugin->window,
-                   p_plugin->i_width, p_plugin->i_height );
-    Widget w = XtWindowToWidget( p_plugin->p_display, p_plugin->window );
-
-    XtAddEventHandler( w, ExposureMask, FALSE,
-                       (XtEventHandler)Redraw, p_plugin );
-    XtAddEventHandler( w, StructureNotifyMask, FALSE,
-                       (XtEventHandler)Resize, p_plugin );
-    Redraw( w, (XtPointer)p_plugin, NULL );
-#endif /* XP_UNIX */
+            /* set/change parent window */
+            libvlc_video_set_parent(p_vlc, (libvlc_drawable_t)drawable, NULL);
 
-    if( !p_plugin->b_stream )
-    {
-        int i_mode = PLAYLIST_APPEND;
+            /* remember window */
+            p_plugin->setWindow(window);
 
-        if( p_plugin->b_autoplay )
-        {
-            i_mode |= PLAYLIST_GO;
+            Redraw( w, (XtPointer)p_plugin, NULL );
         }
+    }
+#endif /* XP_UNIX */
 
+    if( !p_plugin->b_stream )
+    {
         if( p_plugin->psz_target )
         {
-#if USE_LIBVLC
-            VLC_AddTarget( p_plugin->i_vlc, p_plugin->psz_target,
-                           0, 0, i_mode, -666 );
-#endif
-            p_plugin->b_stream = VLC_TRUE;
+            if( VLC_SUCCESS == libvlc_playlist_add( p_vlc, p_plugin->psz_target, NULL, NULL ) )
+            {
+                if( p_plugin->b_autoplay )
+                {
+                    libvlc_playlist_play(p_vlc, 0, 0, NULL, NULL);
+                }
+                p_plugin->b_stream = VLC_TRUE;
+            }
         }
     }
-
     return NPERR_NO_ERROR;
 }
 
 NPError NPP_NewStream( NPP instance, NPMIMEType type, NPStream *stream,
                        NPBool seekable, uint16 *stype )
 {
-    if( instance == NULL )
+    if( NULL == instance  )
     {
         return NPERR_INVALID_INSTANCE_ERROR;
     }
 
-#if 0
-    VlcPlugin* p_plugin = (VlcPlugin*)instance->pdata;
-#endif
-
-    /* fprintf(stderr, "NPP_NewStream - FILE mode !!\n"); */
-
-    /* We want a *filename* ! */
-    *stype = NP_ASFILE;
+    VlcPlugin *p_plugin = reinterpret_cast<VlcPlugin *>(instance->pdata);
 
-#if 0
-    if( !p_plugin->b_stream )
+   /*
+   ** Firefox/Mozilla may decide to open a stream from the URL specified
+   ** in the SRC parameter of the EMBED tag and pass it to us
+   **
+   ** since VLC will open the SRC URL as well, we're not interested in
+   ** that stream. Otherwise, we'll take it and queue it up in the playlist
+   */
+    if( !p_plugin->psz_target || strcmp(stream->url, p_plugin->psz_target) )
     {
-        p_plugin->psz_target = strdup( stream->url );
-        p_plugin->b_stream = VLC_TRUE;
+        /* TODO: use pipes !!!! */
+        *stype = NP_ASFILEONLY;
+        return NPERR_NO_ERROR;
     }
-#endif
-
-    return NPERR_NO_ERROR;
+    return NPERR_GENERIC_ERROR;
 }
 
-int32 STREAMBUFSIZE = 0X0FFFFFFF; /* If we are reading from a file in NPAsFile
-                   * mode so we can take any size stream in our
-                   * write call (since we ignore it) */
-
-#define SARASS_SIZE (1024*1024)
-
 int32 NPP_WriteReady( NPP instance, NPStream *stream )
 {
-    VlcPlugin* p_plugin;
-
-    /* fprintf(stderr, "NPP_WriteReady\n"); */
-
-    if (instance != NULL)
-    {
-        p_plugin = (VlcPlugin*) instance->pdata;
-        /* Muahahahahahahaha */
-        return STREAMBUFSIZE;
-        /*return SARASS_SIZE;*/
-    }
-
-    /* Number of bytes ready to accept in NPP_Write() */
-    return STREAMBUFSIZE;
-    /*return 0;*/
+    /* TODO */
+    return 8*1024;
 }
 
 
 int32 NPP_Write( NPP instance, NPStream *stream, int32 offset,
                  int32 len, void *buffer )
 {
-    /* fprintf(stderr, "NPP_Write %i\n", (int)len); */
-
-    if( instance != NULL )
-    {
-        /*VlcPlugin* p_plugin = (VlcPlugin*) instance->pdata;*/
-    }
-
-    return len;         /* The number of bytes accepted */
+    /* TODO */
+    return len;
 }
 
 
@@ -771,7 +494,6 @@
     {
         return NPERR_INVALID_INSTANCE_ERROR;
     }
-
     return NPERR_NO_ERROR;
 }
 
@@ -783,14 +505,15 @@
         return;
     }
 
-    /* fprintf(stderr, "NPP_StreamAsFile %s\n", fname); */
-
-#if USE_LIBVLC
-    VlcPlugin* p_plugin = (VlcPlugin*)instance->pdata;
+    VlcPlugin *p_plugin = reinterpret_cast<VlcPlugin *>(instance->pdata);
 
-    VLC_AddTarget( p_plugin->i_vlc, fname, 0, 0,
-                   PLAYLIST_APPEND | PLAYLIST_GO, PLAYLIST_END );
-#endif /* USE_LIBVLC */
+    if( VLC_SUCCESS == libvlc_playlist_add( p_plugin->getVLC(), fname, stream->url, NULL ) )
+    {
+        if( p_plugin->b_autoplay )
+        {
+            libvlc_playlist_play( p_plugin->getVLC(), 0, 0, NULL, NULL);
+        }
+    }
 }
 
 
@@ -875,13 +598,16 @@
 /******************************************************************************
  * Windows-only methods
  *****************************************************************************/
-#if defined(XP_WIN) && !USE_LIBVLC
-LRESULT CALLBACK Manage( HWND p_hwnd, UINT i_msg, WPARAM wpar, LPARAM lpar )
+#if XP_WIN
+static LRESULT CALLBACK Manage( HWND p_hwnd, UINT i_msg, WPARAM wpar, LPARAM lpar )
 {
-    VlcPlugin* p_plugin = (VlcPlugin*) GetProp( p_hwnd, "w00t" );
+    VlcPlugin* p_plugin = reinterpret_cast<VlcPlugin*>(GetWindowLongPtr(p_hwnd, GWLP_USERDATA));
 
     switch( i_msg )
     {
+        case WM_ERASEBKGND:
+            return 1L;
+
         case WM_PAINT:
         {
             PAINTSTRUCT paintstruct;
@@ -891,18 +617,19 @@
             hdc = BeginPaint( p_hwnd, &paintstruct );
 
             GetClientRect( p_hwnd, &rect );
-            FillRect( hdc, &rect, (HBRUSH)GetStockObject(WHITE_BRUSH) );
-            TextOut( hdc, p_plugin->i_width / 2 - 40, p_plugin->i_height / 2,
-                     WINDOW_TEXT, strlen(WINDOW_TEXT) );
+
+            FillRect( hdc, &rect, (HBRUSH)GetStockObject(BLACK_BRUSH) );
+            SetTextColor(hdc, RGB(255, 255, 255));
+            SetBkColor(hdc, RGB(0, 0, 0));
+            DrawText( hdc, WINDOW_TEXT, strlen(WINDOW_TEXT), &rect, DT_CENTER|DT_VCENTER|DT_SINGLELINE); 
 
             EndPaint( p_hwnd, &paintstruct );
-            break;
+            return 0L;
         }
         default:
-            p_plugin->pf_wndproc( p_hwnd, i_msg, wpar, lpar );
-            break;
+            /* delegate to default handler */
+            return p_plugin->getWindowProc()( p_hwnd, i_msg, wpar, lpar );
     }
-    return 0;
 }
 #endif /* XP_WIN */
 
@@ -912,29 +639,37 @@
 #ifdef XP_UNIX
 static void Redraw( Widget w, XtPointer closure, XEvent *event )
 {
-    VlcPlugin* p_plugin = (VlcPlugin*)closure;
+    VlcPlugin* p_plugin = reinterpret_cast<VlcPlugin*>(closure);
+    const NPWindow *window = p_plugin->getWindow();
     GC gc;
     XGCValues gcv;
 
-    gcv.foreground = BlackPixel( p_plugin->p_display, 0 );
-    gc = XCreateGC( p_plugin->p_display, p_plugin->window, GCForeground, &gcv );
+    Window  drawable   = (Window) window->window;
+    Display *p_display = ((NPSetWindowCallbackStruct *)window->ws_info)->display;
+
+    gcv.foreground = BlackPixel( p_display, 0 );
+    gc = XCreateGC( p_display, drawable, GCForeground, &gcv );
 
-    XFillRectangle( p_plugin->p_display, p_plugin->window, gc,
-                    0, 0, p_plugin->i_width, p_plugin->i_height );
+    XFillRectangle( p_display, drawable, gc,
+                    0, 0, window->width, window->height );
 
-    gcv.foreground = WhitePixel( p_plugin->p_display, 0 );
-    XChangeGC( p_plugin->p_display, gc, GCForeground, &gcv );
+    gcv.foreground = WhitePixel( p_display, 0 );
+    XChangeGC( p_display, gc, GCForeground, &gcv );
 
-    XDrawString( p_plugin->p_display, p_plugin->window, gc,
-                 p_plugin->i_width / 2 - 40, p_plugin->i_height / 2,
+    XDrawString( p_display, drawable, gc,
+                 window->width / 2 - 40, window->height / 2,
                  WINDOW_TEXT, strlen(WINDOW_TEXT) );
 
-    XFreeGC( p_plugin->p_display, gc );
+    XFreeGC( p_display, gc );
 }
 
 static void Resize ( Widget w, XtPointer closure, XEvent *event )
 {
-    VlcPlugin* p_plugin = (VlcPlugin*)closure;
+    VlcPlugin* p_plugin = reinterpret_cast<VlcPlugin*>(closure);
+    const NPWindow *window = p_plugin->getWindow();
+    Window  drawable   = (Window) window->window;
+    Display *p_display = ((NPSetWindowCallbackStruct *)window->ws_info)->display;
+
     int i_ret;
     Window root_return, parent_return, * children_return;
     Window base_window;
@@ -952,23 +687,20 @@
     }
 #endif /* X11_RESIZE_DEBUG */
 
-    if( p_plugin->i_height == i_previous_height &&
-        p_plugin->i_width == i_previous_width )
+    if( ! p_plugin->setSize(window->width, window->height) )
     {
+        /* size already set */
         return;
     }
-    i_previous_height = p_plugin->i_height;
-    i_previous_width  = p_plugin->i_width;
 
 
-    i_ret = XResizeWindow( p_plugin->p_display, p_plugin->window,
-            p_plugin->i_width, p_plugin->i_height );
+    i_ret = XResizeWindow( p_display, drawable, window->width, window->height );
 
 #ifdef X11_RESIZE_DEBUG
     fprintf( stderr,
              "vlcshell::Resize() XResizeWindow(owner) returned %d\n", i_ret );
 
-    XGetWindowAttributes ( p_plugin->p_display, p_plugin->window, &attr );
+    XGetWindowAttributes ( p_display, drawable, &attr );
 
     /* X is asynchronous, so the current size reported here is not
        necessarily the requested size as the Resize request may not
@@ -977,7 +709,7 @@
              attr.width, attr.height );
 #endif /* X11_RESIZE_DEBUG */
 
-    XQueryTree( p_plugin->p_display, p_plugin->window,
+    XQueryTree( p_display, drawable,
                 &root_return, &parent_return, &children_return,
                 &i_nchildren );
 
@@ -993,15 +725,15 @@
                  base_window );
 #endif /* X11_RESIZE_DEBUG */
 
-        i_ret = XResizeWindow( p_plugin->p_display, base_window,
-                p_plugin->i_width, p_plugin->i_height );
+        i_ret = XResizeWindow( p_display, base_window,
+                window->width, window->height );
 
 #ifdef X11_RESIZE_DEBUG
         fprintf( stderr,
                  "vlcshell::Resize() XResizeWindow(base) returned %d\n",
                  i_ret );
 
-        XGetWindowAttributes( p_plugin->p_display, base_window, &attr );
+        XGetWindowAttributes( p_display, base_window, &attr );
 
         fprintf( stderr, "vlcshell::Resize() new size %d x %d\n",
                  attr.width, attr.height );
diff -uNr vlc-0.8.6-svn20060918.debian/po/POTFILES.in vlc-0.8.6-svn20061008.debian/po/POTFILES.in
--- vlc-0.8.6-svn20060918.debian/po/POTFILES.in	2006-09-18 06:28:44.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/po/POTFILES.in	2006-10-01 11:34:37.000000000 -0400
@@ -23,18 +23,26 @@
 include/stream_output.h
 include/variables.h
 include/video_output.h
+include/vlc/aout.h
+include/vlc/decoder.h
+include/vlc/input.h
+include/vlc/intf.h
+include/vlc/libvlc.h
+include/vlc/mediacontrol.h
+include/vlc/mediacontrol_structures.h
+include/vlc/sout.h
+include/vlc/vlc.h
+include/vlc/vout.h
 include/vlc_access.h
 include/vlc_acl.h
-include/vlc/aout.h
 include/vlc_bits.h
 include/vlc_block.h
 include/vlc_block_helper.h
 include/vlc_codec.h
 include/vlc_common.h
-include/vlc_config_cat.h
 include/vlc_config.h
+include/vlc_config_cat.h
 include/vlc_cpu.h
-include/vlc/decoder.h
 include/vlc_demux.h
 include/vlc_error.h
 include/vlc_es.h
@@ -43,34 +51,26 @@
 include/vlc_httpd.h
 include/vlc_image.h
 include/vlc_input.h
-include/vlc/input.h
 include/vlc_interaction.h
 include/vlc_interface.h
-include/vlc/intf.h
 include/vlc_keys.h
-include/vlc/libvlc.h
 include/vlc_md5.h
-include/vlc/mediacontrol.h
-include/vlc/mediacontrol_structures.h
 include/vlc_messages.h
 include/vlc_meta.h
 include/vlc_objects.h
 include/vlc_osd.h
 include/vlc_playlist.h
-include/vlc/sout.h
 include/vlc_spu.h
 include/vlc_stream.h
 include/vlc_strings.h
-include/vlc_threads_funcs.h
 include/vlc_threads.h
+include/vlc_threads_funcs.h
 include/vlc_tls.h
 include/vlc_update.h
 include/vlc_url.h
 include/vlc_video.h
-include/vlc/vlc.h
 include/vlc_vlm.h
 include/vlc_vod.h
-include/vlc/vout.h
 include/vlc_xml.h
 include/vout_synchro.h
 include/win32_specific.h
@@ -93,9 +93,9 @@
 src/control/video.c
 src/control/vlm.c
 src/extras/dirent.c
-src/extras/getopt1.c
 src/extras/getopt.c
 src/extras/getopt.h
+src/extras/getopt1.c
 src/extras/libc.c
 src/input/access.c
 src/input/clock.c
@@ -152,8 +152,8 @@
 src/osd/osd_parser.c
 src/osd/osd_text.c
 src/osd/osd_widgets.c
-src/playlist/item.c
 src/playlist/item-ext.c
+src/playlist/item.c
 src/playlist/loadsave.c
 src/playlist/playlist.c
 src/playlist/services_discovery.c
@@ -175,9 +175,9 @@
 src/vlc.c
 
 # modules
+modules/access/cdda.c
 modules/access/cdda/access.c
 modules/access/cdda/access.h
-modules/access/cdda.c
 modules/access/cdda/callback.c
 modules/access/cdda/callback.h
 modules/access/cdda/cdda.c
@@ -190,18 +190,16 @@
 modules/access/dshow/dshow.cpp
 modules/access/dshow/filter.cpp
 modules/access/dshow/filter.h
+modules/access/dv.c
 modules/access/dvb/access.c
 modules/access/dvb/dvb.h
 modules/access/dvb/en50221.c
 modules/access/dvb/http.c
 modules/access/dvb/linux_dvb.c
-modules/access/dv.c
 modules/access/dvdnav.c
 modules/access/dvdread.c
 modules/access/fake.c
 modules/access/file.c
-modules/access_filter/record.c
-modules/access_filter/timeshift.c
 modules/access/ftp.c
 modules/access/gnomevfs.c
 modules/access/http.c
@@ -215,19 +213,12 @@
 modules/access/mms/mmsh.h
 modules/access/mms/mmstu.c
 modules/access/mms/mmstu.h
-modules/access_output/bonjour.c
-modules/access_output/bonjour.h
-modules/access_output/dummy.c
-modules/access_output/file.c
-modules/access_output/http.c
-modules/access_output/shout.c
-modules/access_output/udp.c
 modules/access/pvr/pvr.c
 modules/access/pvr/videodev2.h
 modules/access/rtsp/access.c
-modules/access/rtsp/real_asmrp.c
 modules/access/rtsp/real.c
 modules/access/rtsp/real.h
+modules/access/rtsp/real_asmrp.c
 modules/access/rtsp/real_rmff.c
 modules/access/rtsp/real_rmff.h
 modules/access/rtsp/real_sdpplin.c
@@ -259,6 +250,15 @@
 modules/access/vcdx/vcd.h
 modules/access/vcdx/vcdplayer.c
 modules/access/vcdx/vcdplayer.h
+modules/access_filter/record.c
+modules/access_filter/timeshift.c
+modules/access_output/bonjour.c
+modules/access_output/bonjour.h
+modules/access_output/dummy.c
+modules/access_output/file.c
+modules/access_output/http.c
+modules/access_output/shout.c
+modules/access_output/udp.c
 modules/audio_filter/channel_mixer/dolby.c
 modules/audio_filter/channel_mixer/headphone.c
 modules/audio_filter/channel_mixer/simple.c
@@ -393,7 +393,6 @@
 modules/demux/dts.c
 modules/demux/flac.c
 modules/demux/live555.cpp
-modules/demux/livedotcom.cpp
 modules/demux/m3u.c
 modules/demux/mjpeg.c
 modules/demux/mkv.cpp
@@ -463,10 +462,10 @@
 modules/gui/beos/TransportButton.h
 modules/gui/beos/VideoOutput.cpp
 modules/gui/beos/VideoWindow.h
-modules/gui/macosx/about.h
-modules/gui/macosx/about.m
 modules/gui/macosx/AppleRemote.h
 modules/gui/macosx/AppleRemote.m
+modules/gui/macosx/about.h
+modules/gui/macosx/about.m
 modules/gui/macosx/applescript.h
 modules/gui/macosx/applescript.m
 modules/gui/macosx/bookmarks.h
@@ -491,26 +490,26 @@
 modules/gui/macosx/output.h
 modules/gui/macosx/output.m
 modules/gui/macosx/playlist.h
+modules/gui/macosx/playlist.m
 modules/gui/macosx/playlistinfo.h
 modules/gui/macosx/playlistinfo.m
-modules/gui/macosx/playlist.m
 modules/gui/macosx/prefs.h
 modules/gui/macosx/prefs.m
 modules/gui/macosx/prefs_widgets.h
 modules/gui/macosx/prefs_widgets.m
 modules/gui/macosx/update.h
 modules/gui/macosx/update.m
-modules/gui/macosx/voutgl.m
 modules/gui/macosx/vout.h
 modules/gui/macosx/vout.m
+modules/gui/macosx/voutgl.m
 modules/gui/macosx/voutqt.m
 modules/gui/macosx/wizard.h
 modules/gui/macosx/wizard.m
 modules/gui/ncurses.c
 modules/gui/pda/pda.c
+modules/gui/pda/pda.h
 modules/gui/pda/pda_callbacks.c
 modules/gui/pda/pda_callbacks.h
-modules/gui/pda/pda.h
 modules/gui/pda/pda_interface.c
 modules/gui/pda/pda_interface.h
 modules/gui/pda/pda_support.c
@@ -615,8 +614,8 @@
 modules/gui/skins2/macosx/macosx_window.cpp
 modules/gui/skins2/macosx/macosx_window.hpp
 modules/gui/skins2/parser/builder.cpp
-modules/gui/skins2/parser/builder_data.hpp
 modules/gui/skins2/parser/builder.hpp
+modules/gui/skins2/parser/builder_data.hpp
 modules/gui/skins2/parser/expr_evaluator.cpp
 modules/gui/skins2/parser/expr_evaluator.hpp
 modules/gui/skins2/parser/interpreter.cpp
@@ -699,7 +698,6 @@
 modules/gui/skins2/utils/ustring.hpp
 modules/gui/skins2/utils/var_bool.cpp
 modules/gui/skins2/utils/var_bool.hpp
-modules/gui/skins2/utils/variable.hpp
 modules/gui/skins2/utils/var_list.cpp
 modules/gui/skins2/utils/var_list.hpp
 modules/gui/skins2/utils/var_percent.cpp
@@ -708,6 +706,7 @@
 modules/gui/skins2/utils/var_text.hpp
 modules/gui/skins2/utils/var_tree.cpp
 modules/gui/skins2/utils/var_tree.hpp
+modules/gui/skins2/utils/variable.hpp
 modules/gui/skins2/vars/equalizer.cpp
 modules/gui/skins2/vars/equalizer.hpp
 modules/gui/skins2/vars/playlist.cpp
@@ -768,9 +767,9 @@
 modules/gui/wince/video.cpp
 modules/gui/wince/wince.cpp
 modules/gui/wince/wince.h
+modules/gui/wxwidgets/dialogs.cpp
 modules/gui/wxwidgets/dialogs/bookmarks.cpp
 modules/gui/wxwidgets/dialogs/bookmarks.hpp
-modules/gui/wxwidgets/dialogs.cpp
 modules/gui/wxwidgets/dialogs/fileinfo.cpp
 modules/gui/wxwidgets/dialogs/fileinfo.hpp
 modules/gui/wxwidgets/dialogs/infopanels.cpp
@@ -839,8 +838,8 @@
 modules/misc/gtk_main.c
 modules/misc/logger.c
 modules/misc/memcpy/fastmemcpy.h
-modules/misc/memcpy/memcpyaltivec.c
 modules/misc/memcpy/memcpy.c
+modules/misc/memcpy/memcpyaltivec.c
 modules/misc/msn.c
 modules/misc/network/ipv4.c
 modules/misc/network/ipv6.c
@@ -910,11 +909,11 @@
 modules/stream_out/transrate/putvlc.h
 modules/stream_out/transrate/transrate.c
 modules/stream_out/transrate/transrate.h
+modules/video_chroma/i420_rgb.c
+modules/video_chroma/i420_rgb.h
 modules/video_chroma/i420_rgb16.c
 modules/video_chroma/i420_rgb8.c
-modules/video_chroma/i420_rgb.c
 modules/video_chroma/i420_rgb_c.h
-modules/video_chroma/i420_rgb.h
 modules/video_chroma/i420_rgb_mmx.h
 modules/video_chroma/i420_ymga.c
 modules/video_chroma/i420_yuy2.c
@@ -945,13 +944,13 @@
 modules/video_filter/swscale/rgb2rgb.c
 modules/video_filter/swscale/rgb2rgb.h
 modules/video_filter/swscale/rgb2rgb_template.c
-modules/video_filter/swscale/swscale_altivec_template.c
 modules/video_filter/swscale/swscale.c
 modules/video_filter/swscale/swscale.h
+modules/video_filter/swscale/swscale_altivec_template.c
 modules/video_filter/swscale/swscale_internal.h
 modules/video_filter/swscale/swscale_template.c
-modules/video_filter/swscale/yuv2rgb_altivec.c
 modules/video_filter/swscale/yuv2rgb.c
+modules/video_filter/swscale/yuv2rgb_altivec.c
 modules/video_filter/swscale/yuv2rgb_mlib.c
 modules/video_filter/swscale/yuv2rgb_template.c
 modules/video_filter/time.c
@@ -982,6 +981,8 @@
 modules/video_output/x11/xcommon.c
 modules/video_output/x11/xcommon.h
 modules/video_output/x11/xvideo.c
+modules/visualization/galaktos/PCM.c
+modules/visualization/galaktos/PCM.h
 modules/visualization/galaktos/beat_detect.c
 modules/visualization/galaktos/beat_detect.h
 modules/visualization/galaktos/builtin_funcs.c
@@ -1016,8 +1017,6 @@
 modules/visualization/galaktos/param_types.h
 modules/visualization/galaktos/parser.c
 modules/visualization/galaktos/parser.h
-modules/visualization/galaktos/PCM.c
-modules/visualization/galaktos/PCM.h
 modules/visualization/galaktos/per_frame_eqn.c
 modules/visualization/galaktos/per_frame_eqn.h
 modules/visualization/galaktos/per_frame_eqn_types.h
diff -uNr vlc-0.8.6-svn20060918.debian/po/vlc.pot vlc-0.8.6-svn20061008.debian/po/vlc.pot
--- vlc-0.8.6-svn20060918.debian/po/vlc.pot	2006-10-09 15:37:11.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/po/vlc.pot	2006-10-08 12:45:58.000000000 -0400
@@ -8,7 +8,7 @@
 msgstr ""
 "Project-Id-Version: PACKAGE VERSION\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2006-09-18 12:33+0200\n"
+"POT-Creation-Date: 2006-10-08 18:45+0200\n"
 "PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
 "Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
 "Language-Team: LANGUAGE <LL@li.org>\n"
@@ -16,6 +16,14 @@
 "Content-Type: text/plain; charset=CHARSET\n"
 "Content-Transfer-Encoding: 8bit\n"
 
+#: include/vlc/vlc.h:578
+msgid ""
+"This program comes with NO WARRANTY, to the extent permitted by law.\n"
+"You may redistribute it under the terms of the GNU General Public License;\n"
+"see the file named COPYING for details.\n"
+"Written by the VideoLAN team; see the AUTHORS file.\n"
+msgstr ""
+
 #: include/vlc_config_cat.h:32
 msgid "VLC preferences"
 msgstr ""
@@ -25,7 +33,7 @@
 msgstr ""
 
 #: include/vlc_config_cat.h:36 include/vlc_config_cat.h:127
-#: src/input/input.c:1889 src/input/input.c:1949 src/playlist/item.c:369
+#: src/input/input.c:1883 src/input/input.c:1943 src/playlist/item.c:369
 #: src/playlist/playlist.c:163 modules/gui/macosx/playlistinfo.m:62
 #: modules/gui/wince/playlist.cpp:674
 #: modules/gui/wxwidgets/dialogs/fileinfo.cpp:82
@@ -53,7 +61,7 @@
 msgid "Settings for the main interface"
 msgstr ""
 
-#: include/vlc_config_cat.h:47 src/libvlc.h:78
+#: include/vlc_config_cat.h:47 src/libvlc.h:79
 msgid "Control interfaces"
 msgstr ""
 
@@ -65,7 +73,7 @@
 msgid "Hotkeys settings"
 msgstr ""
 
-#: include/vlc_config_cat.h:54 src/input/es_out.c:1592 src/libvlc.h:1177
+#: include/vlc_config_cat.h:54 src/input/es_out.c:1592 src/libvlc.h:1178
 #: modules/gui/beos/InterfaceWindow.cpp:280 modules/gui/macosx/extended.m:81
 #: modules/gui/macosx/intf.m:553 modules/gui/macosx/output.m:170
 #: modules/gui/macosx/playlistinfo.m:96 modules/gui/macosx/wizard.m:421
@@ -109,9 +117,9 @@
 msgid "These are general settings for audio output modules."
 msgstr ""
 
-#: include/vlc_config_cat.h:71 src/libvlc.h:1507
+#: include/vlc_config_cat.h:71 src/libvlc.h:1508
 #: modules/gui/wxwidgets/dialogs/streamout.cpp:578
-#: modules/gui/wxwidgets/menus.cpp:279 modules/stream_out/transcode.c:279
+#: modules/gui/wxwidgets/menus.cpp:280 modules/stream_out/transcode.c:279
 msgid "Miscellaneous"
 msgstr ""
 
@@ -119,7 +127,7 @@
 msgid "Miscellaneous audio settings and modules."
 msgstr ""
 
-#: include/vlc_config_cat.h:75 src/input/es_out.c:1620 src/libvlc.h:1212
+#: include/vlc_config_cat.h:75 src/input/es_out.c:1620 src/libvlc.h:1213
 #: modules/gui/macosx/extended.m:80 modules/gui/macosx/intf.m:566
 #: modules/gui/macosx/output.m:160 modules/gui/macosx/playlistinfo.m:86
 #: modules/gui/macosx/wizard.m:422
@@ -223,7 +231,7 @@
 msgid "General input settings. Use with care."
 msgstr ""
 
-#: include/vlc_config_cat.h:131 src/libvlc.h:1444
+#: include/vlc_config_cat.h:131 src/libvlc.h:1445
 #: modules/gui/wxwidgets/dialogs/streamout.cpp:152
 msgid "Stream output"
 msgstr ""
@@ -309,10 +317,10 @@
 msgid "VLC's implementation of Video On Demand"
 msgstr ""
 
-#: include/vlc_config_cat.h:182 src/libvlc.h:1553
+#: include/vlc_config_cat.h:182 src/libvlc.h:1554
 #: modules/demux/playlist/playlist.c:53 modules/demux/playlist/playlist.c:54
 #: modules/gui/beos/InterfaceWindow.cpp:230
-#: modules/gui/beos/InterfaceWindow.cpp:322 modules/gui/macosx/intf.m:498
+#: modules/gui/beos/InterfaceWindow.cpp:323 modules/gui/macosx/intf.m:498
 #: modules/gui/macosx/intf.m:596 modules/gui/pda/pda_interface.c:1264
 #: modules/gui/wxwidgets/dialogs/playlist.cpp:202
 #: modules/gui/wxwidgets/interface.cpp:679
@@ -330,7 +338,7 @@
 msgid "General playlist behaviour"
 msgstr ""
 
-#: include/vlc_config_cat.h:188 modules/gui/macosx/playlist.m:489
+#: include/vlc_config_cat.h:188 modules/gui/macosx/playlist.m:486
 msgid "Services discovery"
 msgstr ""
 
@@ -340,7 +348,7 @@
 "playlist."
 msgstr ""
 
-#: include/vlc_config_cat.h:193 src/libvlc.h:1405
+#: include/vlc_config_cat.h:193 src/libvlc.h:1406
 #: modules/gui/macosx/prefs.m:124
 msgid "Advanced"
 msgstr ""
@@ -434,9 +442,9 @@
 "to the directory where you installed VLC and run \"vlc -I wx\"\n"
 msgstr ""
 
-#: include/vlc_meta.h:28 modules/gui/macosx/playlistinfo.m:205
-#: modules/gui/macosx/playlistinfo.m:310 modules/gui/macosx/playlist.m:318
-#: modules/gui/macosx/playlist.m:1296 modules/misc/growl.c:166
+#: include/vlc_meta.h:28 modules/gui/macosx/playlist.m:318
+#: modules/gui/macosx/playlist.m:1293 modules/gui/macosx/playlistinfo.m:205
+#: modules/gui/macosx/playlistinfo.m:310 modules/misc/growl.c:166
 #: modules/misc/growl.c:169 modules/misc/notify.c:156
 #: modules/misc/notify.c:159
 msgid "Meta-information"
@@ -451,15 +459,15 @@
 msgid "Title"
 msgstr ""
 
-#: include/vlc_meta.h:30 modules/gui/macosx/playlistinfo.m:58
-#: modules/gui/macosx/playlist.m:134 modules/gui/macosx/wizard.m:393
+#: include/vlc_meta.h:30 modules/gui/macosx/playlist.m:134
+#: modules/gui/macosx/playlistinfo.m:58 modules/gui/macosx/wizard.m:393
 #: modules/gui/wince/playlist.cpp:674 modules/mux/asf.c:50
 msgid "Author"
 msgstr ""
 
-#: include/vlc_meta.h:31 modules/gui/macosx/playlistinfo.m:205
-#: modules/gui/macosx/playlistinfo.m:310 modules/gui/macosx/playlist.m:318
-#: modules/gui/macosx/playlist.m:1296
+#: include/vlc_meta.h:31 modules/gui/macosx/playlist.m:318
+#: modules/gui/macosx/playlist.m:1293 modules/gui/macosx/playlistinfo.m:205
+#: modules/gui/macosx/playlistinfo.m:310
 msgid "Artist"
 msgstr ""
 
@@ -501,7 +509,7 @@
 msgid "URL"
 msgstr ""
 
-#: include/vlc_meta.h:41 src/input/es_out.c:1584 src/libvlc.h:95
+#: include/vlc_meta.h:41 src/input/es_out.c:1584 src/libvlc.h:96
 #: modules/gui/beos/InterfaceWindow.cpp:276
 msgid "Language"
 msgstr ""
@@ -602,16 +610,8 @@
 msgid "Codec Description"
 msgstr ""
 
-#: include/vlc/vlc.h:578
-msgid ""
-"This program comes with NO WARRANTY, to the extent permitted by law.\n"
-"You may redistribute it under the terms of the GNU General Public License;\n"
-"see the file named COPYING for details.\n"
-"Written by the VideoLAN team; see the AUTHORS file.\n"
-msgstr ""
-
 #: src/audio_output/input.c:80 src/audio_output/input.c:126
-#: src/input/es_out.c:361 src/libvlc.h:407 src/video_output/video_output.c:379
+#: src/input/es_out.c:361 src/libvlc.h:408 src/video_output/video_output.c:379
 #: modules/codec/ffmpeg/postprocess.c:94
 msgid "Disable"
 msgstr ""
@@ -634,7 +634,7 @@
 msgid "Equalizer"
 msgstr ""
 
-#: src/audio_output/input.c:145 src/libvlc.h:203
+#: src/audio_output/input.c:145 src/libvlc.h:204
 #: modules/gui/macosx/extended.m:82 modules/gui/wxwidgets/extrapanel.cpp:390
 msgid "Audio filters"
 msgstr ""
@@ -655,7 +655,7 @@
 msgstr ""
 
 #: src/audio_output/output.c:107 src/audio_output/output.c:143
-#: src/libvlc.h:266 modules/codec/dvbsub.c:64 modules/codec/subsdec.c:129
+#: src/libvlc.h:267 modules/codec/dvbsub.c:64 modules/codec/subsdec.c:129
 #: modules/control/gestures.c:86 modules/video_filter/logo.c:95
 #: modules/video_filter/marq.c:107 modules/video_filter/mosaic.c:172
 #: modules/video_filter/osdmenu.c:78 modules/video_filter/rss.c:160
@@ -664,7 +664,7 @@
 msgstr ""
 
 #: src/audio_output/output.c:109 src/audio_output/output.c:145
-#: src/libvlc.h:266 modules/codec/dvbsub.c:64 modules/codec/subsdec.c:129
+#: src/libvlc.h:267 modules/codec/dvbsub.c:64 modules/codec/subsdec.c:129
 #: modules/control/gestures.c:86 modules/video_filter/logo.c:95
 #: modules/video_filter/marq.c:107 modules/video_filter/mosaic.c:172
 #: modules/video_filter/osdmenu.c:78 modules/video_filter/rss.c:160
@@ -748,12 +748,12 @@
 msgstr ""
 
 #: src/input/es_out.c:465 src/input/es_out.c:467 src/input/es_out.c:567
-#: src/input/es_out.c:574 src/input/var.c:125 src/libvlc.h:433
+#: src/input/es_out.c:574 src/input/var.c:125 src/libvlc.h:434
 #: modules/gui/macosx/intf.m:546 modules/gui/macosx/intf.m:547
 msgid "Program"
 msgstr ""
 
-#: src/input/es_out.c:1579
+#: src/input/es_out.c:1579 modules/codec/faad.c:329
 #, c-format
 msgid "Stream %d"
 msgstr ""
@@ -769,16 +769,17 @@
 msgid "Type"
 msgstr ""
 
-#: src/input/es_out.c:1595 modules/gui/macosx/output.m:176
+#: src/input/es_out.c:1595 modules/codec/faad.c:333
+#: modules/gui/macosx/output.m:176
 #: modules/gui/wxwidgets/dialogs/streamout.cpp:857
 msgid "Channels"
 msgstr ""
 
-#: src/input/es_out.c:1600
+#: src/input/es_out.c:1600 modules/codec/faad.c:335
 msgid "Sample rate"
 msgstr ""
 
-#: src/input/es_out.c:1601
+#: src/input/es_out.c:1601 modules/codec/faad.c:335
 #, c-format
 msgid "%d Hz"
 msgstr ""
@@ -813,19 +814,19 @@
 msgid "Subtitle"
 msgstr ""
 
-#: src/input/input.c:1903 src/input/input.c:1907
+#: src/input/input.c:1897 src/input/input.c:1901
 #: modules/gui/macosx/output.m:143 modules/gui/macosx/output.m:251
 #: modules/gui/macosx/output.m:391
 msgid "Stream"
 msgstr ""
 
-#: src/input/input.c:1949 src/playlist/item.c:369
+#: src/input/input.c:1943 src/playlist/item.c:369
 #: modules/access/cdda/info.c:326 modules/access/cdda/info.c:394
 #: modules/gui/macosx/playlist.m:135
 msgid "Duration"
 msgstr ""
 
-#: src/input/input.c:2128 src/input/input.c:2198
+#: src/input/input.c:2124 src/input/input.c:2196
 msgid "Errors"
 msgstr ""
 
@@ -833,7 +834,7 @@
 msgid "Bookmark"
 msgstr ""
 
-#: src/input/var.c:131 src/libvlc.h:439
+#: src/input/var.c:131 src/libvlc.h:440
 msgid "Programs"
 msgstr ""
 
@@ -918,59 +919,59 @@
 msgid "Help options"
 msgstr ""
 
-#: src/libvlc.c:2211 src/misc/configuration.c:1248
+#: src/libvlc.c:2208 src/misc/configuration.c:1248
 msgid "string"
 msgstr ""
 
-#: src/libvlc.c:2228 src/misc/configuration.c:1212
+#: src/libvlc.c:2225 src/misc/configuration.c:1212
 msgid "integer"
 msgstr ""
 
-#: src/libvlc.c:2246 src/misc/configuration.c:1237
+#: src/libvlc.c:2243 src/misc/configuration.c:1237
 msgid "float"
 msgstr ""
 
-#: src/libvlc.c:2252
+#: src/libvlc.c:2249
 msgid " (default enabled)"
 msgstr ""
 
-#: src/libvlc.c:2253
+#: src/libvlc.c:2250
 msgid " (default disabled)"
 msgstr ""
 
-#: src/libvlc.c:2435
+#: src/libvlc.c:2432
 #, c-format
 msgid "VLC version %s\n"
 msgstr ""
 
-#: src/libvlc.c:2436
+#: src/libvlc.c:2433
 #, c-format
 msgid "Compiled by %s@%s.%s\n"
 msgstr ""
 
-#: src/libvlc.c:2438
+#: src/libvlc.c:2435
 #, c-format
 msgid "Compiler: %s\n"
 msgstr ""
 
-#: src/libvlc.c:2441
+#: src/libvlc.c:2438
 #, c-format
 msgid "Based upon svn changeset [%s]\n"
 msgstr ""
 
-#: src/libvlc.c:2473
+#: src/libvlc.c:2470
 msgid ""
 "\n"
 "Dumped content to vlc-help.txt file.\n"
 msgstr ""
 
-#: src/libvlc.c:2494
+#: src/libvlc.c:2491
 msgid ""
 "\n"
 "Press the RETURN key to continue...\n"
 msgstr ""
 
-#: src/libvlc.h:37 src/libvlc.h:200
+#: src/libvlc.h:37 src/libvlc.h:201
 msgid "Auto"
 msgstr ""
 
@@ -1058,6 +1059,10 @@
 msgid "Swedish"
 msgstr ""
 
+#: src/libvlc.h:42 src/misc/iso-639_def.h:161
+msgid "Slovak"
+msgstr ""
+
 #: src/libvlc.h:42 src/misc/iso-639_def.h:187
 msgid "Turkish"
 msgstr ""
@@ -1066,32 +1071,32 @@
 msgid "Simplified Chinese"
 msgstr ""
 
-#: src/libvlc.h:42
+#: src/libvlc.h:43
 msgid "Chinese Traditional"
 msgstr ""
 
-#: src/libvlc.h:61
+#: src/libvlc.h:62
 msgid ""
 "These options allow you to configure the interfaces used by VLC. You can "
 "select the main interface, additional interface modules, and define various "
 "related options."
 msgstr ""
 
-#: src/libvlc.h:65
+#: src/libvlc.h:66
 msgid "Interface module"
 msgstr ""
 
-#: src/libvlc.h:67
+#: src/libvlc.h:68
 msgid ""
 "This is the main interface used by VLC. The default behavior is to "
 "automatically select the best module available."
 msgstr ""
 
-#: src/libvlc.h:71 modules/control/ntservice.c:53
+#: src/libvlc.h:72 modules/control/ntservice.c:53
 msgid "Extra interface modules"
 msgstr ""
 
-#: src/libvlc.h:73
+#: src/libvlc.h:74
 msgid ""
 "You can select \"additional interfaces\" for VLC. They will be launched in "
 "the background in addition to the default interface. Use a comma separated "
@@ -1099,83 +1104,83 @@
 "\", \"gestures\" ...)"
 msgstr ""
 
-#: src/libvlc.h:80
+#: src/libvlc.h:81
 msgid "You can select control interfaces for VLC."
 msgstr ""
 
-#: src/libvlc.h:82
+#: src/libvlc.h:83
 msgid "Verbosity (0,1,2)"
 msgstr ""
 
-#: src/libvlc.h:84
+#: src/libvlc.h:85
 msgid ""
 "This is the verbosity level (0=only errors and standard messages, "
 "1=warnings, 2=debug)."
 msgstr ""
 
-#: src/libvlc.h:87
+#: src/libvlc.h:88
 msgid "Be quiet"
 msgstr ""
 
-#: src/libvlc.h:89
+#: src/libvlc.h:90
 msgid "Turn off all warning and information messages."
 msgstr ""
 
-#: src/libvlc.h:91
+#: src/libvlc.h:92
 msgid "Default stream"
 msgstr ""
 
-#: src/libvlc.h:93
+#: src/libvlc.h:94
 msgid "This stream will always be opened at VLC startup."
 msgstr ""
 
-#: src/libvlc.h:96
+#: src/libvlc.h:97
 msgid ""
 "You can manually select a language for the interface. The system language is "
 "auto-detected if \"auto\" is specified here."
 msgstr ""
 
-#: src/libvlc.h:100
+#: src/libvlc.h:101
 msgid "Color messages"
 msgstr ""
 
-#: src/libvlc.h:102
+#: src/libvlc.h:103
 msgid ""
 "This enables colorization of the messages sent to the console Your terminal "
 "needs Linux color support for this to work."
 msgstr ""
 
-#: src/libvlc.h:105
+#: src/libvlc.h:106
 msgid "Show advanced options"
 msgstr ""
 
-#: src/libvlc.h:107
+#: src/libvlc.h:108
 msgid ""
 "When this is enabled, the preferences and/or interfaces will show all "
 "available options, including those that most users should never touch."
 msgstr ""
 
-#: src/libvlc.h:111 modules/control/showintf.c:68
+#: src/libvlc.h:112 modules/control/showintf.c:68
 msgid "Show interface with mouse"
 msgstr ""
 
-#: src/libvlc.h:113
+#: src/libvlc.h:114
 msgid ""
 "When this is enabled, the interface is shown when you move the mouse to the "
 "edge of the screen in fullscreen mode."
 msgstr ""
 
-#: src/libvlc.h:116
+#: src/libvlc.h:117
 msgid "Interface interaction"
 msgstr ""
 
-#: src/libvlc.h:118
+#: src/libvlc.h:119
 msgid ""
 "When this is enabled, the interface will show a dialog box each time some "
 "user input is required."
 msgstr ""
 
-#: src/libvlc.h:128
+#: src/libvlc.h:129
 msgid ""
 "These options allow you to modify the behavior of the audio subsystem, and "
 "to add audio filters which can be used for post processing or visual effects "
@@ -1183,120 +1188,120 @@
 "the \"audio filters\" modules section."
 msgstr ""
 
-#: src/libvlc.h:134
+#: src/libvlc.h:135
 msgid "Audio output module"
 msgstr ""
 
-#: src/libvlc.h:136
+#: src/libvlc.h:137
 msgid ""
 "This is the audio output method used by VLC. The default behavior is to "
 "automatically select the best method available."
 msgstr ""
 
-#: src/libvlc.h:140 modules/stream_out/display.c:37
+#: src/libvlc.h:141 modules/stream_out/display.c:37
 msgid "Enable audio"
 msgstr ""
 
-#: src/libvlc.h:142
+#: src/libvlc.h:143
 msgid ""
 "You can completely disable the audio output. The audio decoding stage will "
 "not take place, thus saving some processing power."
 msgstr ""
 
-#: src/libvlc.h:145
+#: src/libvlc.h:146
 msgid "Force mono audio"
 msgstr ""
 
-#: src/libvlc.h:146
+#: src/libvlc.h:147
 msgid "This will force a mono audio output."
 msgstr ""
 
-#: src/libvlc.h:148
+#: src/libvlc.h:149
 msgid "Default audio volume"
 msgstr ""
 
-#: src/libvlc.h:150
+#: src/libvlc.h:151
 msgid ""
 "You can set the default audio output volume here, in a range from 0 to 1024."
 msgstr ""
 
-#: src/libvlc.h:153
+#: src/libvlc.h:154
 msgid "Audio output saved volume"
 msgstr ""
 
-#: src/libvlc.h:155
+#: src/libvlc.h:156
 msgid ""
 "This saves the audio output volume when you use the mute function. You "
 "should not change this option manually."
 msgstr ""
 
-#: src/libvlc.h:158
+#: src/libvlc.h:159
 msgid "Audio output volume step"
 msgstr ""
 
-#: src/libvlc.h:160
+#: src/libvlc.h:161
 msgid ""
 "The step size of the volume is adjustable using this option, in a range from "
 "0 to 1024."
 msgstr ""
 
-#: src/libvlc.h:163
+#: src/libvlc.h:164
 msgid "Audio output frequency (Hz)"
 msgstr ""
 
-#: src/libvlc.h:165
+#: src/libvlc.h:166
 msgid ""
 "You can force the audio output frequency here. Common values are -1 "
 "(default), 48000, 44100, 32000, 22050, 16000, 11025, 8000."
 msgstr ""
 
-#: src/libvlc.h:169
+#: src/libvlc.h:170
 msgid "High quality audio resampling"
 msgstr ""
 
-#: src/libvlc.h:171
+#: src/libvlc.h:172
 msgid ""
 "This uses a high quality audio resampling algorithm. High quality audio "
 "resampling can be processor intensive so you can disable it and a cheaper "
 "resampling algorithm will be used instead."
 msgstr ""
 
-#: src/libvlc.h:176
+#: src/libvlc.h:177
 msgid "Audio desynchronization compensation"
 msgstr ""
 
-#: src/libvlc.h:178
+#: src/libvlc.h:179
 msgid ""
 "This delays the audio output. The delay must be given in milliseconds.This "
 "can be handy if you notice a lag between the video and the audio."
 msgstr ""
 
-#: src/libvlc.h:181
+#: src/libvlc.h:182
 msgid "Audio output channels mode"
 msgstr ""
 
-#: src/libvlc.h:183
+#: src/libvlc.h:184
 msgid ""
 "This sets the audio output channels mode that will be used by default when "
 "possible (ie. if your hardware supports it as well as the audio stream being "
 "played)."
 msgstr ""
 
-#: src/libvlc.h:187
+#: src/libvlc.h:188
 msgid "Use S/PDIF when available"
 msgstr ""
 
-#: src/libvlc.h:189
+#: src/libvlc.h:190
 msgid ""
 "S/PDIF can be used by default when your hardware supports it as well as the "
 "audio stream being played."
 msgstr ""
 
-#: src/libvlc.h:192
+#: src/libvlc.h:193
 msgid "Force detection of Dolby Surround"
 msgstr ""
 
-#: src/libvlc.h:194
+#: src/libvlc.h:195
 msgid ""
 "Use this when you know your stream is (or is not) encoded with Dolby "
 "Surround but fails to be detected as such. Even if the stream is not "
@@ -1304,27 +1309,27 @@
 "your experience, especially when combined with the Headphone Channel Mixer."
 msgstr ""
 
-#: src/libvlc.h:200
+#: src/libvlc.h:201
 msgid "On"
 msgstr ""
 
-#: src/libvlc.h:200
+#: src/libvlc.h:201
 msgid "Off"
 msgstr ""
 
-#: src/libvlc.h:205
+#: src/libvlc.h:206
 msgid "This adds audio post processing filters, to modify the sound rendering."
 msgstr ""
 
-#: src/libvlc.h:208
+#: src/libvlc.h:209
 msgid "Audio visualizations "
 msgstr ""
 
-#: src/libvlc.h:210
+#: src/libvlc.h:211
 msgid "This adds visualization modules (spectrum analyzer, etc.)."
 msgstr ""
 
-#: src/libvlc.h:218
+#: src/libvlc.h:219
 msgid ""
 "These options allow you to modify the behavior of the video output "
 "subsystem. You can for example enable video filters (deinterlacing, image "
@@ -1333,263 +1338,263 @@
 "options."
 msgstr ""
 
-#: src/libvlc.h:224
+#: src/libvlc.h:225
 msgid "Video output module"
 msgstr ""
 
-#: src/libvlc.h:226
+#: src/libvlc.h:227
 msgid ""
 "This is the the video output method used by VLC. The default behavior is to "
 "automatically select the best method available."
 msgstr ""
 
-#: src/libvlc.h:229 modules/stream_out/display.c:39
+#: src/libvlc.h:230 modules/stream_out/display.c:39
 msgid "Enable video"
 msgstr ""
 
-#: src/libvlc.h:231
+#: src/libvlc.h:232
 msgid ""
 "You can completely disable the video output. The video decoding stage will "
 "not take place, thus saving some processing power."
 msgstr ""
 
-#: src/libvlc.h:234 modules/codec/fake.c:48
+#: src/libvlc.h:235 modules/codec/fake.c:48
 #: modules/stream_out/mosaic_bridge.c:107 modules/stream_out/transcode.c:68
 #: modules/visualization/visual/visual.c:43
 msgid "Video width"
 msgstr ""
 
-#: src/libvlc.h:236
+#: src/libvlc.h:237
 msgid ""
 "You can enforce the video width. By default (-1) VLC will adapt to the video "
 "characteristics."
 msgstr ""
 
-#: src/libvlc.h:239 modules/codec/fake.c:51
+#: src/libvlc.h:240 modules/codec/fake.c:51
 #: modules/stream_out/mosaic_bridge.c:110 modules/stream_out/transcode.c:71
 #: modules/visualization/visual/visual.c:47
 msgid "Video height"
 msgstr ""
 
-#: src/libvlc.h:241
+#: src/libvlc.h:242
 msgid ""
 "You can enforce the video height. By default (-1) VLC will adapt to the "
 "video characteristics."
 msgstr ""
 
-#: src/libvlc.h:244
+#: src/libvlc.h:245
 msgid "Video X coordinate"
 msgstr ""
 
-#: src/libvlc.h:246
+#: src/libvlc.h:247
 msgid ""
 "You can enforce the position of the top left corner of the video window (X "
 "coordinate)."
 msgstr ""
 
-#: src/libvlc.h:249
+#: src/libvlc.h:250
 msgid "Video Y coordinate"
 msgstr ""
 
-#: src/libvlc.h:251
+#: src/libvlc.h:252
 msgid ""
 "You can enforce the position of the top left corner of the video window (Y "
 "coordinate)."
 msgstr ""
 
-#: src/libvlc.h:254
+#: src/libvlc.h:255
 msgid "Video title"
 msgstr ""
 
-#: src/libvlc.h:256
+#: src/libvlc.h:257
 msgid ""
 "Custom title for the video window (in case the video is not embedded in the "
 "interface)."
 msgstr ""
 
-#: src/libvlc.h:259
+#: src/libvlc.h:260
 msgid "Video alignment"
 msgstr ""
 
-#: src/libvlc.h:261
+#: src/libvlc.h:262
 msgid ""
 "Enforce the alignment of the video in its window. By default (0) it will be "
 "centered (0=center, 1=left, 2=right, 4=top, 8=bottom, you can also use "
 "combinations of these values, like 6=4+2 meaning top-right)."
 msgstr ""
 
-#: src/libvlc.h:266 modules/codec/dvbsub.c:64 modules/codec/subsdec.c:129
+#: src/libvlc.h:267 modules/codec/dvbsub.c:64 modules/codec/subsdec.c:129
 #: modules/video_filter/logo.c:95 modules/video_filter/marq.c:107
 #: modules/video_filter/mosaic.c:172 modules/video_filter/osdmenu.c:78
 #: modules/video_filter/rss.c:160 modules/video_filter/time.c:99
 msgid "Center"
 msgstr ""
 
-#: src/libvlc.h:266 modules/codec/dvbsub.c:64 modules/video_filter/logo.c:95
+#: src/libvlc.h:267 modules/codec/dvbsub.c:64 modules/video_filter/logo.c:95
 #: modules/video_filter/marq.c:107 modules/video_filter/mosaic.c:172
 #: modules/video_filter/osdmenu.c:78 modules/video_filter/rss.c:160
 #: modules/video_filter/time.c:99
 msgid "Top"
 msgstr ""
 
-#: src/libvlc.h:266 modules/codec/dvbsub.c:64 modules/video_filter/logo.c:95
+#: src/libvlc.h:267 modules/codec/dvbsub.c:64 modules/video_filter/logo.c:95
 #: modules/video_filter/marq.c:107 modules/video_filter/mosaic.c:172
 #: modules/video_filter/osdmenu.c:78 modules/video_filter/rss.c:160
 #: modules/video_filter/time.c:99
 msgid "Bottom"
 msgstr ""
 
-#: src/libvlc.h:267 modules/codec/dvbsub.c:65 modules/video_filter/logo.c:96
+#: src/libvlc.h:268 modules/codec/dvbsub.c:65 modules/video_filter/logo.c:96
 #: modules/video_filter/marq.c:108 modules/video_filter/mosaic.c:173
 #: modules/video_filter/osdmenu.c:79 modules/video_filter/rss.c:161
 #: modules/video_filter/time.c:100
 msgid "Top-Left"
 msgstr ""
 
-#: src/libvlc.h:267 modules/codec/dvbsub.c:65 modules/video_filter/logo.c:96
+#: src/libvlc.h:268 modules/codec/dvbsub.c:65 modules/video_filter/logo.c:96
 #: modules/video_filter/marq.c:108 modules/video_filter/mosaic.c:173
 #: modules/video_filter/osdmenu.c:79 modules/video_filter/rss.c:161
 #: modules/video_filter/time.c:100
 msgid "Top-Right"
 msgstr ""
 
-#: src/libvlc.h:267 modules/codec/dvbsub.c:65 modules/video_filter/logo.c:96
+#: src/libvlc.h:268 modules/codec/dvbsub.c:65 modules/video_filter/logo.c:96
 #: modules/video_filter/marq.c:108 modules/video_filter/mosaic.c:173
 #: modules/video_filter/osdmenu.c:79 modules/video_filter/rss.c:161
 #: modules/video_filter/time.c:100
 msgid "Bottom-Left"
 msgstr ""
 
-#: src/libvlc.h:267 modules/codec/dvbsub.c:65 modules/video_filter/logo.c:96
+#: src/libvlc.h:268 modules/codec/dvbsub.c:65 modules/video_filter/logo.c:96
 #: modules/video_filter/marq.c:108 modules/video_filter/mosaic.c:173
 #: modules/video_filter/osdmenu.c:79 modules/video_filter/rss.c:161
 #: modules/video_filter/time.c:100
 msgid "Bottom-Right"
 msgstr ""
 
-#: src/libvlc.h:269
+#: src/libvlc.h:270
 msgid "Zoom video"
 msgstr ""
 
-#: src/libvlc.h:271
+#: src/libvlc.h:272
 msgid "You can zoom the video by the specified factor."
 msgstr ""
 
-#: src/libvlc.h:273
+#: src/libvlc.h:274
 msgid "Grayscale video output"
 msgstr ""
 
-#: src/libvlc.h:275
+#: src/libvlc.h:276
 msgid ""
 "Output video in grayscale. As the color information aren't decoded, this can "
 "save some processing power."
 msgstr ""
 
-#: src/libvlc.h:278
+#: src/libvlc.h:279
 msgid "Fullscreen video output"
 msgstr ""
 
-#: src/libvlc.h:280
+#: src/libvlc.h:281
 msgid "Start video in fullscreen mode"
 msgstr ""
 
-#: src/libvlc.h:282
+#: src/libvlc.h:283
 msgid "Overlay video output"
 msgstr ""
 
-#: src/libvlc.h:284
+#: src/libvlc.h:285
 msgid ""
 "Overlay is the hardware acceleration capability of your video card (ability "
 "to render video directly). VLC will try to use it by default."
 msgstr ""
 
-#: src/libvlc.h:287 src/video_output/vout_intf.c:399
+#: src/libvlc.h:288 src/video_output/vout_intf.c:399
 msgid "Always on top"
 msgstr ""
 
-#: src/libvlc.h:289
+#: src/libvlc.h:290
 msgid "Always place the video window on top of other windows."
 msgstr ""
 
-#: src/libvlc.h:291
+#: src/libvlc.h:292
 msgid "Disable screensaver"
 msgstr ""
 
-#: src/libvlc.h:292
+#: src/libvlc.h:293
 msgid "Disable the screensaver during video playback."
 msgstr ""
 
-#: src/libvlc.h:294
+#: src/libvlc.h:295
 msgid "Window decorations"
 msgstr ""
 
-#: src/libvlc.h:296
+#: src/libvlc.h:297
 msgid ""
 "VLC can avoid creating window caption, frames, etc... around the video, "
 "giving a \"minimal\" window."
 msgstr ""
 
-#: src/libvlc.h:299
+#: src/libvlc.h:300
 msgid "Video filter module"
 msgstr ""
 
-#: src/libvlc.h:301
+#: src/libvlc.h:302
 msgid ""
 "This adds post-processing filters to enhance the picture quality, for "
 "instance deinterlacing, or to clone or distort the video window."
 msgstr ""
 
-#: src/libvlc.h:305
+#: src/libvlc.h:306
 msgid "Video snapshot directory (or filename)"
 msgstr ""
 
-#: src/libvlc.h:307
+#: src/libvlc.h:308
 msgid "Directory where the video snapshots will be stored."
 msgstr ""
 
-#: src/libvlc.h:309 src/libvlc.h:311
+#: src/libvlc.h:310 src/libvlc.h:312
 msgid "Video snapshot file prefix"
 msgstr ""
 
-#: src/libvlc.h:313
+#: src/libvlc.h:314
 msgid "Video snapshot format"
 msgstr ""
 
-#: src/libvlc.h:315
+#: src/libvlc.h:316
 msgid "Image format which will be used to store the video snapshots"
 msgstr ""
 
-#: src/libvlc.h:317
+#: src/libvlc.h:318
 msgid "Display video snapshot preview"
 msgstr ""
 
-#: src/libvlc.h:319
+#: src/libvlc.h:320
 msgid "Display the snapshot preview in the screen's top-left corner."
 msgstr ""
 
-#: src/libvlc.h:321
+#: src/libvlc.h:322
 msgid "Use sequential numbers instead of timestamps"
 msgstr ""
 
-#: src/libvlc.h:323
+#: src/libvlc.h:324
 msgid "Use sequential numbers instead of timestamps for snapshot numbering"
 msgstr ""
 
-#: src/libvlc.h:325
+#: src/libvlc.h:326
 msgid "Video cropping"
 msgstr ""
 
-#: src/libvlc.h:327
+#: src/libvlc.h:328
 msgid ""
 "This forces the cropping of the source video. Accepted formats are x:y (4:3, "
 "16:9, etc.) expressing the global image aspect."
 msgstr ""
 
-#: src/libvlc.h:331
+#: src/libvlc.h:332
 msgid "Source aspect ratio"
 msgstr ""
 
-#: src/libvlc.h:333
+#: src/libvlc.h:334
 msgid ""
 "This forces the source aspect ratio. For instance, some DVDs claim to be "
 "16:9 while they are actually 4:3. This can also be used as a hint for VLC "
@@ -1598,116 +1603,116 @@
 "(1.25, 1.3333, etc.) expressing pixel squareness."
 msgstr ""
 
-#: src/libvlc.h:340
+#: src/libvlc.h:341
 msgid "Custom crop ratios list"
 msgstr ""
 
-#: src/libvlc.h:342
+#: src/libvlc.h:343
 msgid ""
 "Comma seperated list of crop ratios which will be added in the interface's "
 "crop ratios list."
 msgstr ""
 
-#: src/libvlc.h:345
+#: src/libvlc.h:346
 msgid "Custom aspect ratios list"
 msgstr ""
 
-#: src/libvlc.h:347
+#: src/libvlc.h:348
 msgid ""
 "Comma seperated list of aspect ratios which will be added in the interface's "
 "aspect ratio list."
 msgstr ""
 
-#: src/libvlc.h:350
+#: src/libvlc.h:351
 msgid "Fix HDTV height"
 msgstr ""
 
-#: src/libvlc.h:352
+#: src/libvlc.h:353
 msgid ""
 "This allows proper handling of HDTV-1080 video format even if broken encoder "
 "incorrectly sets height to 1088 lines. You should only disable this option "
 "if your video has a non-standard format requiring all 1088 lines."
 msgstr ""
 
-#: src/libvlc.h:357
+#: src/libvlc.h:358
 msgid "Monitor pixel aspect ratio"
 msgstr ""
 
-#: src/libvlc.h:359
+#: src/libvlc.h:360
 msgid ""
 "This forces the monitor aspect ratio. Most monitors have square pixels "
 "(1:1). If you have a 16:9 screen, you might need to change this to 4:3 in "
 "order to keep proportions."
 msgstr ""
 
-#: src/libvlc.h:364
+#: src/libvlc.h:365
 msgid "Skip frames"
 msgstr ""
 
-#: src/libvlc.h:366
+#: src/libvlc.h:367
 msgid ""
 "This option enables framedropping on MPEG2 stream. Framedropping occurs when "
 "your computer is not powerful enough"
 msgstr ""
 
-#: src/libvlc.h:369
+#: src/libvlc.h:370
 msgid "Drop late frames"
 msgstr ""
 
-#: src/libvlc.h:371
+#: src/libvlc.h:372
 msgid ""
 "This drops frames that are late (arrive to the video output after their "
 "intended display date)."
 msgstr ""
 
-#: src/libvlc.h:374
+#: src/libvlc.h:375
 msgid "Quiet synchro"
 msgstr ""
 
-#: src/libvlc.h:376
+#: src/libvlc.h:377
 msgid ""
 "This avoids flooding the message log with debug output from the video output "
 "synchronization mechanism."
 msgstr ""
 
-#: src/libvlc.h:385
+#: src/libvlc.h:386
 msgid ""
 "These options allow you to modify the behavior of the input subsystem, such "
 "as the DVD or VCD device, the network interface settings or the subtitle "
 "channel."
 msgstr ""
 
-#: src/libvlc.h:389
+#: src/libvlc.h:390
 msgid "Clock reference average counter"
 msgstr ""
 
-#: src/libvlc.h:391
+#: src/libvlc.h:392
 msgid ""
 "When using the PVR input (or a very irregular source), you should set this "
 "to 10000."
 msgstr ""
 
-#: src/libvlc.h:394
+#: src/libvlc.h:395
 msgid "Clock synchronisation"
 msgstr ""
 
-#: src/libvlc.h:396
+#: src/libvlc.h:397
 msgid ""
 "It is possible to disable the input clock synchronisation for real-time "
 "sources. Use this if you experience jerky playback of network streams."
 msgstr ""
 
-#: src/libvlc.h:400 modules/control/netsync.c:71
+#: src/libvlc.h:401 modules/control/netsync.c:71
 msgid "Network synchronisation"
 msgstr ""
 
-#: src/libvlc.h:401
+#: src/libvlc.h:402
 msgid ""
 "This allows you to remotely synchronise clocks for server and client. The "
 "detailed settings are available in Advanced / Network Sync."
 msgstr ""
 
-#: src/libvlc.h:407 src/video_output/vout_intf.c:261
+#: src/libvlc.h:408 src/video_output/vout_intf.c:261
 #: src/video_output/vout_intf.c:348 modules/access/dshow/dshow.cpp:73
 #: modules/access/dshow/dshow.cpp:75 modules/access/dshow/dshow.cpp:78
 #: modules/audio_output/alsa.c:101 modules/gui/macosx/prefs_widgets.m:1292
@@ -1715,11 +1720,11 @@
 #: modules/gui/wxwidgets/dialogs/preferences_widgets.cpp:275
 #: modules/gui/wxwidgets/dialogs/preferences_widgets.cpp:325
 #: modules/video_filter/marq.c:52 modules/video_filter/rss.c:63
-#: modules/video_filter/time.c:52 modules/video_output/directx/directx.c:142
+#: modules/video_filter/time.c:52 modules/video_output/directx/directx.c:157
 msgid "Default"
 msgstr ""
 
-#: src/libvlc.h:407 modules/gui/macosx/equalizer.m:145
+#: src/libvlc.h:408 modules/gui/macosx/equalizer.m:145
 #: modules/gui/macosx/extended.m:107 modules/gui/macosx/wizard.m:395
 #: modules/gui/wxwidgets/dialogs/wizard.cpp:631
 #: modules/gui/wxwidgets/extrapanel.cpp:216
@@ -1727,175 +1732,175 @@
 msgid "Enable"
 msgstr ""
 
-#: src/libvlc.h:409
+#: src/libvlc.h:410
 msgid "UDP port"
 msgstr ""
 
-#: src/libvlc.h:411
+#: src/libvlc.h:412
 msgid "This is the default port used for UDP streams. Default is 1234."
 msgstr ""
 
-#: src/libvlc.h:413
+#: src/libvlc.h:414
 msgid "MTU of the network interface"
 msgstr ""
 
-#: src/libvlc.h:415
+#: src/libvlc.h:416
 msgid ""
 "This is the maximum packet size that can be transmitted over the network "
 "interface. On Ethernet it is usually 1500 bytes."
 msgstr ""
 
-#: src/libvlc.h:418
+#: src/libvlc.h:419
 msgid "Hop limit (TTL)"
 msgstr ""
 
-#: src/libvlc.h:420
+#: src/libvlc.h:421
 msgid ""
 "This is the hop limit (also known as \"Time-To-Live\" or TTL) of the "
 "multicast packets sent by the stream output (0 = use operating system built-"
 "in default)."
 msgstr ""
 
-#: src/libvlc.h:424
+#: src/libvlc.h:425
 msgid "IPv6 multicast output interface"
 msgstr ""
 
-#: src/libvlc.h:426
+#: src/libvlc.h:427
 msgid "Default IPv6 multicast interface. This overrides the routing table."
 msgstr ""
 
-#: src/libvlc.h:428
+#: src/libvlc.h:429
 msgid "IPv4 multicast output interface address"
 msgstr ""
 
-#: src/libvlc.h:430
+#: src/libvlc.h:431
 msgid ""
 "IPv4 adress for the default multicast interface. This overrides the routing "
 "table."
 msgstr ""
 
-#: src/libvlc.h:435
+#: src/libvlc.h:436
 msgid ""
 "Choose the program to select by giving its Service ID. Only use this option "
 "if you want to read a multi-program stream (like DVB streams for example)."
 msgstr ""
 
-#: src/libvlc.h:441
+#: src/libvlc.h:442
 msgid ""
 "Choose the programs to select by giving a comma-separated list of Service "
 "IDs (SIDs). Only use this option if you want to read a multi-program stream "
 "(like DVB streams for example)."
 msgstr ""
 
-#: src/libvlc.h:447 modules/gui/wxwidgets/dialogs/open.cpp:779
+#: src/libvlc.h:448 modules/gui/wxwidgets/dialogs/open.cpp:779
 msgid "Audio track"
 msgstr ""
 
-#: src/libvlc.h:449
+#: src/libvlc.h:450
 msgid "Stream number of the audio track to use (from 0 to n)."
 msgstr ""
 
-#: src/libvlc.h:452 modules/gui/wxwidgets/dialogs/open.cpp:771
+#: src/libvlc.h:453 modules/gui/wxwidgets/dialogs/open.cpp:771
 msgid "Subtitles track"
 msgstr ""
 
-#: src/libvlc.h:454
+#: src/libvlc.h:455
 msgid "Stream number of the subtitle track to use (from 0 to n)."
 msgstr ""
 
-#: src/libvlc.h:457
+#: src/libvlc.h:458
 msgid "Audio language"
 msgstr ""
 
-#: src/libvlc.h:459
+#: src/libvlc.h:460
 msgid ""
 "Language of the audio track you want to use (comma separated, two or three "
 "letter country code)."
 msgstr ""
 
-#: src/libvlc.h:462
+#: src/libvlc.h:463
 msgid "Subtitle language"
 msgstr ""
 
-#: src/libvlc.h:464
+#: src/libvlc.h:465
 msgid ""
 "Language of the subtitle track you want to use (comma separated, two or tree "
 "letter country code)."
 msgstr ""
 
-#: src/libvlc.h:468
+#: src/libvlc.h:469
 msgid "Audio track ID"
 msgstr ""
 
-#: src/libvlc.h:470
+#: src/libvlc.h:471
 msgid "Stream ID of the audio track to use."
 msgstr ""
 
-#: src/libvlc.h:472
+#: src/libvlc.h:473
 msgid "Subtitles track ID"
 msgstr ""
 
-#: src/libvlc.h:474
+#: src/libvlc.h:475
 msgid "Stream ID of the subtitle track to use."
 msgstr ""
 
-#: src/libvlc.h:476
+#: src/libvlc.h:477
 msgid "Input repetitions"
 msgstr ""
 
-#: src/libvlc.h:478
+#: src/libvlc.h:479
 msgid "Number of time the same input will be repeated"
 msgstr ""
 
-#: src/libvlc.h:480
+#: src/libvlc.h:481
 msgid "Start time"
 msgstr ""
 
-#: src/libvlc.h:482
+#: src/libvlc.h:483
 msgid "The stream will start at this position (in seconds)."
 msgstr ""
 
-#: src/libvlc.h:484
+#: src/libvlc.h:485
 msgid "Stop time"
 msgstr ""
 
-#: src/libvlc.h:486
+#: src/libvlc.h:487
 msgid "The stream will stop at this position (in seconds)."
 msgstr ""
 
-#: src/libvlc.h:488
+#: src/libvlc.h:489
 msgid "Input list"
 msgstr ""
 
-#: src/libvlc.h:490
+#: src/libvlc.h:491
 msgid ""
 "You can give a comma-separated list of inputs that will be concatenated "
 "together after the normal one."
 msgstr ""
 
-#: src/libvlc.h:493
+#: src/libvlc.h:494
 msgid "Input slave (experimental)"
 msgstr ""
 
-#: src/libvlc.h:495
+#: src/libvlc.h:496
 msgid ""
 "This allows you to play from several inputs at the same time. This feature "
 "is experimental, not all formats are supported. Use a '#' separated list of "
 "inputs."
 msgstr ""
 
-#: src/libvlc.h:499
+#: src/libvlc.h:500
 msgid "Bookmarks list for a stream"
 msgstr ""
 
-#: src/libvlc.h:501
+#: src/libvlc.h:502
 msgid ""
 "You can manually give a list of bookmarks for a stream in the form "
 "\"{name=bookmark-name,time=optional-time-offset,bytes=optional-byte-offset},"
 "{...}\""
 msgstr ""
 
-#: src/libvlc.h:507
+#: src/libvlc.h:508
 msgid ""
 "These options allow you to modify the behavior of the subpictures subsystem. "
 "You can for example enable subpictures filters (logo, etc.). Enable these "
@@ -1903,70 +1908,70 @@
 "section. You can also set many miscellaneous subpictures options."
 msgstr ""
 
-#: src/libvlc.h:513
+#: src/libvlc.h:514
 msgid "Force subtitle position"
 msgstr ""
 
-#: src/libvlc.h:515
+#: src/libvlc.h:516
 msgid ""
 "You can use this option to place the subtitles under the movie, instead of "
 "over the movie. Try several positions."
 msgstr ""
 
-#: src/libvlc.h:518
+#: src/libvlc.h:519
 msgid "Enable sub-pictures"
 msgstr ""
 
-#: src/libvlc.h:520
+#: src/libvlc.h:521
 msgid "You can completely disable the sub-picture processing."
 msgstr ""
 
-#: src/libvlc.h:522 src/libvlc.h:1287 src/misc/iso-639_def.h:143
+#: src/libvlc.h:523 src/libvlc.h:1288 src/misc/iso-639_def.h:143
 #: modules/stream_out/transcode.c:275
 msgid "On Screen Display"
 msgstr ""
 
-#: src/libvlc.h:524
+#: src/libvlc.h:525
 msgid ""
 "VLC can display messages on the video. This is called OSD (On Screen "
 "Display)."
 msgstr ""
 
-#: src/libvlc.h:527
+#: src/libvlc.h:528
 msgid "Text rendering module"
 msgstr ""
 
-#: src/libvlc.h:529
+#: src/libvlc.h:530
 msgid ""
 "VLC normally uses Freetype for rendering, but this allows you to use svg for "
 "instance."
 msgstr ""
 
-#: src/libvlc.h:532
+#: src/libvlc.h:533
 msgid "Subpictures filter module"
 msgstr ""
 
-#: src/libvlc.h:534
+#: src/libvlc.h:535
 msgid ""
 "This adds so-called \"subpicture filters\". These filters overlay some "
 "images or text over the video (like a logo, arbitraty text...)."
 msgstr ""
 
-#: src/libvlc.h:537
+#: src/libvlc.h:538
 msgid "Autodetect subtitle files"
 msgstr ""
 
-#: src/libvlc.h:539
+#: src/libvlc.h:540
 msgid ""
 "Automatically detect a subtitle file, if no subtitle filename is specified "
 "(based on the filename of the movie)."
 msgstr ""
 
-#: src/libvlc.h:542
+#: src/libvlc.h:543
 msgid "Subtitle autodetection fuzziness"
 msgstr ""
 
-#: src/libvlc.h:544
+#: src/libvlc.h:545
 msgid ""
 "This determines how fuzzy subtitle and movie filename matching will be. "
 "Options are:\n"
@@ -1977,446 +1982,446 @@
 "4 = subtitle file matching the movie name exactly"
 msgstr ""
 
-#: src/libvlc.h:552
+#: src/libvlc.h:553
 msgid "Subtitle autodetection paths"
 msgstr ""
 
-#: src/libvlc.h:554
+#: src/libvlc.h:555
 msgid ""
 "Look for a subtitle file in those paths too, if your subtitle file was not "
 "found in the current directory."
 msgstr ""
 
-#: src/libvlc.h:557
+#: src/libvlc.h:558
 msgid "Use subtitle file"
 msgstr ""
 
-#: src/libvlc.h:559
+#: src/libvlc.h:560
 msgid ""
 "Load this subtitle file. To be used when autodetect cannot detect your "
 "subtitle file."
 msgstr ""
 
-#: src/libvlc.h:562
+#: src/libvlc.h:563
 msgid "DVD device"
 msgstr ""
 
-#: src/libvlc.h:565
+#: src/libvlc.h:566
 msgid ""
 "This is the default DVD drive (or file) to use. Don't forget the colon after "
 "the drive letter (eg. D:)"
 msgstr ""
 
-#: src/libvlc.h:569
+#: src/libvlc.h:570
 msgid "This is the default DVD device to use."
 msgstr ""
 
-#: src/libvlc.h:572
+#: src/libvlc.h:573
 msgid "VCD device"
 msgstr ""
 
-#: src/libvlc.h:575
+#: src/libvlc.h:576
 msgid ""
 "This is the default VCD device to use. If you don't specify anything, we'll "
 "scan for a suitable CD-ROM device."
 msgstr ""
 
-#: src/libvlc.h:579
+#: src/libvlc.h:580
 msgid "This is the default VCD device to use."
 msgstr ""
 
-#: src/libvlc.h:582
+#: src/libvlc.h:583
 msgid "Audio CD device"
 msgstr ""
 
-#: src/libvlc.h:585
+#: src/libvlc.h:586
 msgid ""
 "This is the default Audio CD device to use. If you don't specify anything, "
 "we'll scan for a suitable CD-ROM device."
 msgstr ""
 
-#: src/libvlc.h:589
+#: src/libvlc.h:590
 msgid "This is the default Audio CD device to use."
 msgstr ""
 
-#: src/libvlc.h:592 modules/gui/wxwidgets/dialogs/open.cpp:841
+#: src/libvlc.h:593 modules/gui/wxwidgets/dialogs/open.cpp:841
 msgid "Force IPv6"
 msgstr ""
 
-#: src/libvlc.h:594
+#: src/libvlc.h:595
 msgid "IPv6 will be used by default for all connections."
 msgstr ""
 
-#: src/libvlc.h:596
+#: src/libvlc.h:597
 msgid "Force IPv4"
 msgstr ""
 
-#: src/libvlc.h:598
+#: src/libvlc.h:599
 msgid "IPv4 will be used by default for all connections."
 msgstr ""
 
-#: src/libvlc.h:600
+#: src/libvlc.h:601
 msgid "TCP connection timeout"
 msgstr ""
 
-#: src/libvlc.h:602
+#: src/libvlc.h:603
 msgid "Default TCP connection timeout (in milliseconds). "
 msgstr ""
 
-#: src/libvlc.h:604
+#: src/libvlc.h:605
 msgid "SOCKS server"
 msgstr ""
 
-#: src/libvlc.h:606
+#: src/libvlc.h:607
 msgid ""
 "SOCKS proxy server to use. This must be of the form address:port. It will be "
 "used for all TCP connections"
 msgstr ""
 
-#: src/libvlc.h:609
+#: src/libvlc.h:610
 msgid "SOCKS user name"
 msgstr ""
 
-#: src/libvlc.h:611
+#: src/libvlc.h:612
 msgid "User name to be used for connection to the SOCKS proxy."
 msgstr ""
 
-#: src/libvlc.h:613
+#: src/libvlc.h:614
 msgid "SOCKS password"
 msgstr ""
 
-#: src/libvlc.h:615
+#: src/libvlc.h:616
 msgid "Password to be used for connection to the SOCKS proxy."
 msgstr ""
 
-#: src/libvlc.h:617
+#: src/libvlc.h:618
 msgid "Title metadata"
 msgstr ""
 
-#: src/libvlc.h:619
+#: src/libvlc.h:620
 msgid "Allows you to specify a \"title\" metadata for an input."
 msgstr ""
 
-#: src/libvlc.h:621
+#: src/libvlc.h:622
 msgid "Author metadata"
 msgstr ""
 
-#: src/libvlc.h:623
+#: src/libvlc.h:624
 msgid "Allows you to specify an \"author\" metadata for an input."
 msgstr ""
 
-#: src/libvlc.h:625
+#: src/libvlc.h:626
 msgid "Artist metadata"
 msgstr ""
 
-#: src/libvlc.h:627
+#: src/libvlc.h:628
 msgid "Allows you to specify an \"artist\" metadata for an input."
 msgstr ""
 
-#: src/libvlc.h:629
+#: src/libvlc.h:630
 msgid "Genre metadata"
 msgstr ""
 
-#: src/libvlc.h:631
+#: src/libvlc.h:632
 msgid "Allows you to specify a \"genre\" metadata for an input."
 msgstr ""
 
-#: src/libvlc.h:633
+#: src/libvlc.h:634
 msgid "Copyright metadata"
 msgstr ""
 
-#: src/libvlc.h:635
+#: src/libvlc.h:636
 msgid "Allows you to specify a \"copyright\" metadata for an input."
 msgstr ""
 
-#: src/libvlc.h:637
+#: src/libvlc.h:638
 msgid "Description metadata"
 msgstr ""
 
-#: src/libvlc.h:639
+#: src/libvlc.h:640
 msgid "Allows you to specify a \"description\" metadata for an input."
 msgstr ""
 
-#: src/libvlc.h:641
+#: src/libvlc.h:642
 msgid "Date metadata"
 msgstr ""
 
-#: src/libvlc.h:643
+#: src/libvlc.h:644
 msgid "Allows you to specify a \"date\" metadata for an input."
 msgstr ""
 
-#: src/libvlc.h:645
+#: src/libvlc.h:646
 msgid "URL metadata"
 msgstr ""
 
-#: src/libvlc.h:647
+#: src/libvlc.h:648
 msgid "Allows you to specify a \"url\" metadata for an input."
 msgstr ""
 
-#: src/libvlc.h:651
+#: src/libvlc.h:652
 msgid ""
 "This option can be used to alter the way VLC selects its codecs "
 "(decompression methods). Only advanced users should alter this option as it "
 "can break playback of all your streams."
 msgstr ""
 
-#: src/libvlc.h:655
+#: src/libvlc.h:656
 msgid "Preferred decoders list"
 msgstr ""
 
-#: src/libvlc.h:657
+#: src/libvlc.h:658
 msgid ""
 "List of codecs that VLC will use in priority. For instance, 'dummy,a52' will "
 "try the dummy and a52 codecs before trying the other ones. Only advanced "
 "users should alter this option as it can break playback of all your streams."
 msgstr ""
 
-#: src/libvlc.h:662
+#: src/libvlc.h:663
 msgid "Preferred encoders list"
 msgstr ""
 
-#: src/libvlc.h:664
+#: src/libvlc.h:665
 msgid ""
 "This allows you to select a list of encoders that VLC will use in priority."
 msgstr ""
 
-#: src/libvlc.h:673
+#: src/libvlc.h:674
 msgid ""
 "These options allow you to set default global options for the stream output "
 "subsystem."
 msgstr ""
 
-#: src/libvlc.h:676
+#: src/libvlc.h:677
 msgid "Default stream output chain"
 msgstr ""
 
-#: src/libvlc.h:678
+#: src/libvlc.h:679
 msgid ""
 "You can enter here a default stream output chain. Refer to the documentation "
 "to learn how to build such chains.Warning: this chain will be enabled for "
 "all streams."
 msgstr ""
 
-#: src/libvlc.h:682
+#: src/libvlc.h:683
 msgid "Enable streaming of all ES"
 msgstr ""
 
-#: src/libvlc.h:684
+#: src/libvlc.h:685
 msgid "Stream all elementary streams (video, audio and subtitles)"
 msgstr ""
 
-#: src/libvlc.h:686
+#: src/libvlc.h:687
 msgid "Display while streaming"
 msgstr ""
 
-#: src/libvlc.h:688
+#: src/libvlc.h:689
 msgid "Play locally the stream while streaming it."
 msgstr ""
 
-#: src/libvlc.h:690
+#: src/libvlc.h:691
 msgid "Enable video stream output"
 msgstr ""
 
-#: src/libvlc.h:692
+#: src/libvlc.h:693
 msgid ""
 "Choose whether the video stream should be redirected to the stream output "
 "facility when this last one is enabled."
 msgstr ""
 
-#: src/libvlc.h:695
+#: src/libvlc.h:696
 msgid "Enable audio stream output"
 msgstr ""
 
-#: src/libvlc.h:697
+#: src/libvlc.h:698
 msgid ""
 "Choose whether the audio stream should be redirected to the stream output "
 "facility when this last one is enabled."
 msgstr ""
 
-#: src/libvlc.h:700
+#: src/libvlc.h:701
 msgid "Enable SPU stream output"
 msgstr ""
 
-#: src/libvlc.h:702
+#: src/libvlc.h:703
 msgid ""
 "Choose whether the SPU streams should be redirected to the stream output "
 "facility when this last one is enabled."
 msgstr ""
 
-#: src/libvlc.h:705
+#: src/libvlc.h:706
 msgid "Keep stream output open"
 msgstr ""
 
-#: src/libvlc.h:707
+#: src/libvlc.h:708
 msgid ""
 "This allows you to keep an unique stream output instance across multiple "
 "playlist item (automatically insert the gather stream output if not "
 "specified)"
 msgstr ""
 
-#: src/libvlc.h:711
+#: src/libvlc.h:712
 msgid "Preferred packetizer list"
 msgstr ""
 
-#: src/libvlc.h:713
+#: src/libvlc.h:714
 msgid ""
 "This allows you to select the order in which VLC will choose its packetizers."
 msgstr ""
 
-#: src/libvlc.h:716
+#: src/libvlc.h:717
 msgid "Mux module"
 msgstr ""
 
-#: src/libvlc.h:718
+#: src/libvlc.h:719
 msgid "This is a legacy entry to let you configure mux modules"
 msgstr ""
 
-#: src/libvlc.h:720
+#: src/libvlc.h:721
 msgid "Access output module"
 msgstr ""
 
-#: src/libvlc.h:722
+#: src/libvlc.h:723
 msgid "This is a legacy entry to let you configure access output modules"
 msgstr ""
 
-#: src/libvlc.h:724
+#: src/libvlc.h:725
 msgid "Control SAP flow"
 msgstr ""
 
-#: src/libvlc.h:726
+#: src/libvlc.h:727
 msgid ""
 "If this option is enabled, the flow on the SAP multicast address will be "
 "controlled. This is needed if you want to make announcements on the MBone."
 msgstr ""
 
-#: src/libvlc.h:730
+#: src/libvlc.h:731
 msgid "SAP announcement interval"
 msgstr ""
 
-#: src/libvlc.h:732
+#: src/libvlc.h:733
 msgid ""
 "When the SAP flow control is disabled, this lets you set the fixed interval "
 "between SAP announcements."
 msgstr ""
 
-#: src/libvlc.h:742
+#: src/libvlc.h:743
 msgid ""
 "These options allow you to enable special CPU optimizations. You should "
 "always leave all these enabled."
 msgstr ""
 
-#: src/libvlc.h:745
+#: src/libvlc.h:746
 msgid "Enable FPU support"
 msgstr ""
 
-#: src/libvlc.h:747
+#: src/libvlc.h:748
 msgid ""
 "If your processor has a floating point calculation unit, VLC can take "
 "advantage of it."
 msgstr ""
 
-#: src/libvlc.h:750
+#: src/libvlc.h:751
 msgid "Enable CPU MMX support"
 msgstr ""
 
-#: src/libvlc.h:752
+#: src/libvlc.h:753
 msgid ""
 "If your processor supports the MMX instructions set, VLC can take advantage "
 "of them."
 msgstr ""
 
-#: src/libvlc.h:755
+#: src/libvlc.h:756
 msgid "Enable CPU 3D Now! support"
 msgstr ""
 
-#: src/libvlc.h:757
+#: src/libvlc.h:758
 msgid ""
 "If your processor supports the 3D Now! instructions set, VLC can take "
 "advantage of them."
 msgstr ""
 
-#: src/libvlc.h:760
+#: src/libvlc.h:761
 msgid "Enable CPU MMX EXT support"
 msgstr ""
 
-#: src/libvlc.h:762
+#: src/libvlc.h:763
 msgid ""
 "If your processor supports the MMX EXT instructions set, VLC can take "
 "advantage of them."
 msgstr ""
 
-#: src/libvlc.h:765
+#: src/libvlc.h:766
 msgid "Enable CPU SSE support"
 msgstr ""
 
-#: src/libvlc.h:767
+#: src/libvlc.h:768
 msgid ""
 "If your processor supports the SSE instructions set, VLC can take advantage "
 "of them."
 msgstr ""
 
-#: src/libvlc.h:770
+#: src/libvlc.h:771
 msgid "Enable CPU SSE2 support"
 msgstr ""
 
-#: src/libvlc.h:772
+#: src/libvlc.h:773
 msgid ""
 "If your processor supports the SSE2 instructions set, VLC can take advantage "
 "of them."
 msgstr ""
 
-#: src/libvlc.h:775
+#: src/libvlc.h:776
 msgid "Enable CPU AltiVec support"
 msgstr ""
 
-#: src/libvlc.h:777
+#: src/libvlc.h:778
 msgid ""
 "If your processor supports the AltiVec instructions set, VLC can take "
 "advantage of them."
 msgstr ""
 
-#: src/libvlc.h:782
+#: src/libvlc.h:783
 msgid ""
 "These options allow you to select default modules. Leave these alone unless "
 "you really know what you are doing."
 msgstr ""
 
-#: src/libvlc.h:785
+#: src/libvlc.h:786
 msgid "Memory copy module"
 msgstr ""
 
-#: src/libvlc.h:787
+#: src/libvlc.h:788
 msgid ""
 "You can select which memory copy module you want to use. By default VLC will "
 "select the fastest one supported by your hardware."
 msgstr ""
 
-#: src/libvlc.h:790
+#: src/libvlc.h:791
 msgid "Access module"
 msgstr ""
 
-#: src/libvlc.h:792
+#: src/libvlc.h:793
 msgid ""
 "This allows you to force an access module. You can use it if the correct "
 "access is not automatically detected. You should not set this as a global "
 "option unless you really know what you are doing."
 msgstr ""
 
-#: src/libvlc.h:796
+#: src/libvlc.h:797
 msgid "Access filter module"
 msgstr ""
 
-#: src/libvlc.h:798
+#: src/libvlc.h:799
 msgid ""
 "Access filters are used to modify the stream that is being read. This is "
 "used for instance for timeshifting."
 msgstr ""
 
-#: src/libvlc.h:801
+#: src/libvlc.h:802
 msgid "Demux module"
 msgstr ""
 
-#: src/libvlc.h:803
+#: src/libvlc.h:804
 msgid ""
 "Demultiplexers are used to separate the \"elementary\" streams (like audio "
 "and video streams). You can use it if the correct demuxer is not "
@@ -2424,11 +2429,11 @@
 "you really know what you are doing."
 msgstr ""
 
-#: src/libvlc.h:808
+#: src/libvlc.h:809
 msgid "Allow real-time priority"
 msgstr ""
 
-#: src/libvlc.h:810
+#: src/libvlc.h:811
 msgid ""
 "Running VLC in real-time priority will allow for much more precise "
 "scheduling and yield better, especially when streaming content. It can "
@@ -2436,86 +2441,86 @@
 "only activate this if you know what you're doing."
 msgstr ""
 
-#: src/libvlc.h:816
+#: src/libvlc.h:817
 msgid "Adjust VLC priority"
 msgstr ""
 
-#: src/libvlc.h:818
+#: src/libvlc.h:819
 msgid ""
 "This option adds an offset (positive or negative) to VLC default priorities. "
 "You can use it to tune VLC priority against other programs, or against other "
 "VLC instances."
 msgstr ""
 
-#: src/libvlc.h:822
+#: src/libvlc.h:823
 msgid "Minimize number of threads"
 msgstr ""
 
-#: src/libvlc.h:824
+#: src/libvlc.h:825
 msgid "This option minimizes the number of threads needed to run VLC."
 msgstr ""
 
-#: src/libvlc.h:826
+#: src/libvlc.h:827
 msgid "Modules search path"
 msgstr ""
 
-#: src/libvlc.h:828
+#: src/libvlc.h:829
 msgid "Additional path for VLC to look for its modules."
 msgstr ""
 
-#: src/libvlc.h:830
+#: src/libvlc.h:831
 msgid "VLM configuration file"
 msgstr ""
 
-#: src/libvlc.h:832
+#: src/libvlc.h:833
 msgid "Read a VLM configuration file as soon as VLM is started."
 msgstr ""
 
-#: src/libvlc.h:834
+#: src/libvlc.h:835
 msgid "Use a plugins cache"
 msgstr ""
 
-#: src/libvlc.h:836
+#: src/libvlc.h:837
 msgid "Use a plugins cache which will greatly improve the startup time of VLC."
 msgstr ""
 
-#: src/libvlc.h:838
+#: src/libvlc.h:839
 msgid "Collect statistics"
 msgstr ""
 
-#: src/libvlc.h:840
+#: src/libvlc.h:841
 msgid "Collect miscellaneous statistics."
 msgstr ""
 
-#: src/libvlc.h:842
+#: src/libvlc.h:843
 msgid "Run as daemon process"
 msgstr ""
 
-#: src/libvlc.h:844
+#: src/libvlc.h:845
 msgid "Runs VLC as a background daemon process."
 msgstr ""
 
-#: src/libvlc.h:846
+#: src/libvlc.h:847
 msgid "Log to file"
 msgstr ""
 
-#: src/libvlc.h:848
+#: src/libvlc.h:849
 msgid "Log all VLC messages to a text file."
 msgstr ""
 
-#: src/libvlc.h:850
+#: src/libvlc.h:851
 msgid "Log to syslog"
 msgstr ""
 
-#: src/libvlc.h:852
+#: src/libvlc.h:853
 msgid "Log all VLC messages to syslog (UNIX systems)."
 msgstr ""
 
-#: src/libvlc.h:854
+#: src/libvlc.h:855
 msgid "Allow only one running instance"
 msgstr ""
 
-#: src/libvlc.h:856
+#: src/libvlc.h:857
 msgid ""
 "Allowing only one running instance of VLC can sometimes be useful, for "
 "example if you associated VLC with some media types and you don't want a new "
@@ -2524,27 +2529,27 @@
 "running instance or enqueue it."
 msgstr ""
 
-#: src/libvlc.h:862
+#: src/libvlc.h:863
 msgid "VLC is started from file association"
 msgstr ""
 
-#: src/libvlc.h:864
+#: src/libvlc.h:865
 msgid "Tell VLC that it is being launched due to a file association in the OS"
 msgstr ""
 
-#: src/libvlc.h:867
+#: src/libvlc.h:868
 msgid "One instance when started from file"
 msgstr ""
 
-#: src/libvlc.h:869
+#: src/libvlc.h:870
 msgid "Allow only one running instance when started from file."
 msgstr ""
 
-#: src/libvlc.h:871
+#: src/libvlc.h:872
 msgid "Increase the priority of the process"
 msgstr ""
 
-#: src/libvlc.h:873
+#: src/libvlc.h:874
 msgid ""
 "Increasing the priority of the process will very likely improve your playing "
 "experience as it allows VLC not to be disturbed by other applications that "
@@ -2554,22 +2559,22 @@
 "machine."
 msgstr ""
 
-#: src/libvlc.h:880
+#: src/libvlc.h:881
 msgid "Fast mutex on NT/2K/XP (developers only)"
 msgstr ""
 
-#: src/libvlc.h:882
+#: src/libvlc.h:883
 msgid ""
 "On Windows NT/2K/XP we use a slow mutex implementation but which allows us "
 "to correctly implement condition variables. You can also use the faster "
 "Win9x implementation but you might experience problems with it."
 msgstr ""
 
-#: src/libvlc.h:887
+#: src/libvlc.h:888
 msgid "Condition variables implementation for Win9x (developers only)"
 msgstr ""
 
-#: src/libvlc.h:890
+#: src/libvlc.h:891
 msgid ""
 "On Windows 9x/Me you can use a fast but incorrect condition variables "
 "implementation (more precisely there is a possibility for a race condition "
@@ -2578,165 +2583,165 @@
 "fastest but slightly incorrect), 1 (default) and 2."
 msgstr ""
 
-#: src/libvlc.h:899
+#: src/libvlc.h:900
 msgid "Enqueue items to playlist when in one instance mode"
 msgstr ""
 
-#: src/libvlc.h:901
+#: src/libvlc.h:902
 msgid ""
 "When using the one instance only option, enqueue items to playlist and keep "
 "playing current item."
 msgstr ""
 
-#: src/libvlc.h:910
+#: src/libvlc.h:911
 msgid ""
 "These options define the behavior of the playlist. Some of them can be "
 "overridden in the playlist dialog box."
 msgstr ""
 
-#: src/libvlc.h:913
+#: src/libvlc.h:914
 msgid "Automatically preparse files"
 msgstr ""
 
-#: src/libvlc.h:915
+#: src/libvlc.h:916
 msgid ""
 "Automatically preparse files added to the playlist (to retrieve some "
 "metadata)."
 msgstr ""
 
-#: src/libvlc.h:918
+#: src/libvlc.h:919
 msgid "Services discovery modules"
 msgstr ""
 
-#: src/libvlc.h:920
+#: src/libvlc.h:921
 msgid ""
 "Specifies the services discovery modules to load, separated by semi-colons. "
 "Typical values are sap, hal, ..."
 msgstr ""
 
-#: src/libvlc.h:923
+#: src/libvlc.h:924
 msgid "Play files randomly forever"
 msgstr ""
 
-#: src/libvlc.h:925
+#: src/libvlc.h:926
 msgid "VLC will randomly play files in the playlist until interrupted."
 msgstr ""
 
-#: src/libvlc.h:927
+#: src/libvlc.h:928
 msgid "Repeat all"
 msgstr ""
 
-#: src/libvlc.h:929
+#: src/libvlc.h:930
 msgid "VLC will keep playing the playlist indefinitely."
 msgstr ""
 
-#: src/libvlc.h:931
+#: src/libvlc.h:932
 msgid "Repeat current item"
 msgstr ""
 
-#: src/libvlc.h:933
+#: src/libvlc.h:934
 msgid "VLC will keep playing the current playlist item."
 msgstr ""
 
-#: src/libvlc.h:935
+#: src/libvlc.h:936
 msgid "Play and stop"
 msgstr ""
 
-#: src/libvlc.h:937
+#: src/libvlc.h:938
 msgid "Stop the playlist after each played playlist item."
 msgstr ""
 
-#: src/libvlc.h:944
+#: src/libvlc.h:945
 msgid "These settings are the global VLC key bindings, known as \"hotkeys\"."
 msgstr ""
 
-#: src/libvlc.h:947 src/video_output/vout_intf.c:408
+#: src/libvlc.h:948 src/video_output/vout_intf.c:408
 #: modules/gui/beos/VideoOutput.cpp:1057 modules/gui/macosx/applescript.m:121
-#: modules/gui/macosx/controls.m:338 modules/gui/macosx/controls.m:754
-#: modules/gui/macosx/controls.m:784 modules/gui/macosx/embeddedwindow.m:44
+#: modules/gui/macosx/controls.m:344 modules/gui/macosx/controls.m:760
+#: modules/gui/macosx/controls.m:790 modules/gui/macosx/embeddedwindow.m:44
 #: modules/gui/macosx/intf.m:495 modules/gui/macosx/intf.m:571
 #: modules/gui/macosx/intf.m:626
 msgid "Fullscreen"
 msgstr ""
 
-#: src/libvlc.h:948
+#: src/libvlc.h:949
 msgid "Select the hotkey to use to swap fullscreen state."
 msgstr ""
 
-#: src/libvlc.h:949 modules/gui/wxwidgets/dialogs/vlm/vlm_streampanel.cpp:82
+#: src/libvlc.h:950 modules/gui/wxwidgets/dialogs/vlm/vlm_streampanel.cpp:82
 #: modules/gui/wxwidgets/interface.cpp:1510
 msgid "Play/Pause"
 msgstr ""
 
-#: src/libvlc.h:950
+#: src/libvlc.h:951
 msgid "Select the hotkey to use to swap paused state."
 msgstr ""
 
-#: src/libvlc.h:951
+#: src/libvlc.h:952
 msgid "Pause only"
 msgstr ""
 
-#: src/libvlc.h:952
+#: src/libvlc.h:953
 msgid "Select the hotkey to use to pause."
 msgstr ""
 
-#: src/libvlc.h:953
+#: src/libvlc.h:954
 msgid "Play only"
 msgstr ""
 
-#: src/libvlc.h:954
+#: src/libvlc.h:955
 msgid "Select the hotkey to use to play."
 msgstr ""
 
-#: src/libvlc.h:955 modules/control/hotkeys.c:684
-#: modules/gui/macosx/controls.m:687 modules/gui/macosx/intf.m:536
+#: src/libvlc.h:956 modules/control/hotkeys.c:684
+#: modules/gui/macosx/controls.m:693 modules/gui/macosx/intf.m:536
 #: modules/gui/wxwidgets/interface.cpp:695
 msgid "Faster"
 msgstr ""
 
-#: src/libvlc.h:956
+#: src/libvlc.h:957
 msgid "Select the hotkey to use for fast forward playback."
 msgstr ""
 
-#: src/libvlc.h:957 modules/control/hotkeys.c:692
-#: modules/gui/macosx/controls.m:688 modules/gui/macosx/intf.m:537
+#: src/libvlc.h:958 modules/control/hotkeys.c:692
+#: modules/gui/macosx/controls.m:694 modules/gui/macosx/intf.m:537
 #: modules/gui/wxwidgets/interface.cpp:694
 msgid "Slower"
 msgstr ""
 
-#: src/libvlc.h:958
+#: src/libvlc.h:959
 msgid "Select the hotkey to use for slow motion playback."
 msgstr ""
 
-#: src/libvlc.h:959 modules/control/hotkeys.c:651
-#: modules/gui/macosx/controls.m:708 modules/gui/macosx/intf.m:494
+#: src/libvlc.h:960 modules/control/hotkeys.c:651
+#: modules/gui/macosx/controls.m:714 modules/gui/macosx/intf.m:494
 #: modules/gui/macosx/intf.m:539 modules/gui/macosx/intf.m:614
 #: modules/gui/macosx/intf.m:622 modules/gui/macosx/wizard.m:313
 #: modules/gui/macosx/wizard.m:364 modules/gui/macosx/wizard.m:1604
 #: modules/gui/wxwidgets/interface.cpp:693
 #: modules/gui/wxwidgets/interface.cpp:1515
-#: modules/gui/wxwidgets/menus.cpp:258
+#: modules/gui/wxwidgets/menus.cpp:259
 msgid "Next"
 msgstr ""
 
-#: src/libvlc.h:960
+#: src/libvlc.h:961
 msgid "Select the hotkey to use to skip to the next item in the playlist."
 msgstr ""
 
-#: src/libvlc.h:961 modules/control/hotkeys.c:663
-#: modules/gui/macosx/controls.m:707 modules/gui/macosx/intf.m:489
+#: src/libvlc.h:962 modules/control/hotkeys.c:663
+#: modules/gui/macosx/controls.m:713 modules/gui/macosx/intf.m:489
 #: modules/gui/macosx/intf.m:538 modules/gui/macosx/intf.m:615
 #: modules/gui/macosx/intf.m:621 modules/gui/wxwidgets/interface.cpp:692
 #: modules/gui/wxwidgets/interface.cpp:1514
-#: modules/gui/wxwidgets/menus.cpp:257
+#: modules/gui/wxwidgets/menus.cpp:258
 msgid "Previous"
 msgstr ""
 
-#: src/libvlc.h:962
+#: src/libvlc.h:963
 msgid "Select the hotkey to use to skip to the previous item in the playlist."
 msgstr ""
 
-#: src/libvlc.h:963 modules/gui/macosx/controls.m:699
+#: src/libvlc.h:964 modules/gui/macosx/controls.m:705
 #: modules/gui/macosx/intf.m:492 modules/gui/macosx/intf.m:535
 #: modules/gui/macosx/intf.m:613 modules/gui/macosx/intf.m:620
 #: modules/gui/pda/pda_interface.c:274 modules/gui/pda/pda_interface.c:275
@@ -2744,530 +2749,530 @@
 #: modules/gui/wxwidgets/interface.cpp:676
 #: modules/gui/wxwidgets/interface.cpp:687
 #: modules/gui/wxwidgets/interface.cpp:1516
-#: modules/gui/wxwidgets/menus.cpp:256 modules/visualization/xosd.c:238
+#: modules/gui/wxwidgets/menus.cpp:257 modules/visualization/xosd.c:238
 msgid "Stop"
 msgstr ""
 
-#: src/libvlc.h:964
+#: src/libvlc.h:965
 msgid "Select the hotkey to stop playback."
 msgstr ""
 
-#: src/libvlc.h:965 modules/gui/macosx/bookmarks.m:101
+#: src/libvlc.h:966 modules/gui/macosx/bookmarks.m:101
 #: modules/gui/macosx/bookmarks.m:110 modules/gui/macosx/embeddedwindow.m:46
 #: modules/gui/macosx/intf.m:497 modules/video_filter/marq.c:122
 #: modules/video_filter/rss.c:174
 msgid "Position"
 msgstr ""
 
-#: src/libvlc.h:966
+#: src/libvlc.h:967
 msgid "Select the hotkey to display the position."
 msgstr ""
 
-#: src/libvlc.h:968
+#: src/libvlc.h:969
 msgid "Very short backwards jump"
 msgstr ""
 
-#: src/libvlc.h:970
+#: src/libvlc.h:971
 msgid "Select the hotkey to make a very short backwards jump."
 msgstr ""
 
-#: src/libvlc.h:971
+#: src/libvlc.h:972
 msgid "Short backwards jump"
 msgstr ""
 
-#: src/libvlc.h:973
+#: src/libvlc.h:974
 msgid "Select the hotkey to make a short backwards jump."
 msgstr ""
 
-#: src/libvlc.h:974
+#: src/libvlc.h:975
 msgid "Medium backwards jump"
 msgstr ""
 
-#: src/libvlc.h:976
+#: src/libvlc.h:977
 msgid "Select the hotkey to make a medium backwards jump."
 msgstr ""
 
-#: src/libvlc.h:977
+#: src/libvlc.h:978
 msgid "Long backwards jump"
 msgstr ""
 
-#: src/libvlc.h:979
+#: src/libvlc.h:980
 msgid "Select the hotkey to make a long backwards jump."
 msgstr ""
 
-#: src/libvlc.h:981
+#: src/libvlc.h:982
 msgid "Very short forward jump"
 msgstr ""
 
-#: src/libvlc.h:983
+#: src/libvlc.h:984
 msgid "Select the hotkey to make a very short forward jump."
 msgstr ""
 
-#: src/libvlc.h:984
+#: src/libvlc.h:985
 msgid "Short forward jump"
 msgstr ""
 
-#: src/libvlc.h:986
+#: src/libvlc.h:987
 msgid "Select the hotkey to make a short forward jump."
 msgstr ""
 
-#: src/libvlc.h:987
+#: src/libvlc.h:988
 msgid "Medium forward jump"
 msgstr ""
 
-#: src/libvlc.h:989
+#: src/libvlc.h:990
 msgid "Select the hotkey to make a medium forward jump."
 msgstr ""
 
-#: src/libvlc.h:990
+#: src/libvlc.h:991
 msgid "Long forward jump"
 msgstr ""
 
-#: src/libvlc.h:992
+#: src/libvlc.h:993
 msgid "Select the hotkey to make a long forward jump."
 msgstr ""
 
-#: src/libvlc.h:994
+#: src/libvlc.h:995
 msgid "Very short jump length"
 msgstr ""
 
-#: src/libvlc.h:995
+#: src/libvlc.h:996
 msgid "Very short jump length, in seconds."
 msgstr ""
 
-#: src/libvlc.h:996
+#: src/libvlc.h:997
 msgid "Short jump length"
 msgstr ""
 
-#: src/libvlc.h:997
+#: src/libvlc.h:998
 msgid "Short jump length, in seconds."
 msgstr ""
 
-#: src/libvlc.h:998
+#: src/libvlc.h:999
 msgid "Medium jump length"
 msgstr ""
 
-#: src/libvlc.h:999
+#: src/libvlc.h:1000
 msgid "Medium jump length, in seconds."
 msgstr ""
 
-#: src/libvlc.h:1000
+#: src/libvlc.h:1001
 msgid "Long jump length"
 msgstr ""
 
-#: src/libvlc.h:1001
+#: src/libvlc.h:1002
 msgid "Long jump length, in seconds."
 msgstr ""
 
-#: src/libvlc.h:1003 modules/control/hotkeys.c:258
+#: src/libvlc.h:1004 modules/control/hotkeys.c:258
 #: modules/gui/beos/InterfaceWindow.cpp:274
 msgid "Quit"
 msgstr ""
 
-#: src/libvlc.h:1004
+#: src/libvlc.h:1005
 msgid "Select the hotkey to quit the application."
 msgstr ""
 
-#: src/libvlc.h:1005
+#: src/libvlc.h:1006
 msgid "Navigate up"
 msgstr ""
 
-#: src/libvlc.h:1006
+#: src/libvlc.h:1007
 msgid "Select the key to move the selector up in DVD menus."
 msgstr ""
 
-#: src/libvlc.h:1007
+#: src/libvlc.h:1008
 msgid "Navigate down"
 msgstr ""
 
-#: src/libvlc.h:1008
+#: src/libvlc.h:1009
 msgid "Select the key to move the selector down in DVD menus."
 msgstr ""
 
-#: src/libvlc.h:1009
+#: src/libvlc.h:1010
 msgid "Navigate left"
 msgstr ""
 
-#: src/libvlc.h:1010
+#: src/libvlc.h:1011
 msgid "Select the key to move the selector left in DVD menus."
 msgstr ""
 
-#: src/libvlc.h:1011
+#: src/libvlc.h:1012
 msgid "Navigate right"
 msgstr ""
 
-#: src/libvlc.h:1012
+#: src/libvlc.h:1013
 msgid "Select the key to move the selector right in DVD menus."
 msgstr ""
 
-#: src/libvlc.h:1013
+#: src/libvlc.h:1014
 msgid "Activate"
 msgstr ""
 
-#: src/libvlc.h:1014
+#: src/libvlc.h:1015
 msgid "Select the key to activate selected item in DVD menus."
 msgstr ""
 
-#: src/libvlc.h:1015
+#: src/libvlc.h:1016
 msgid "Go to the DVD menu"
 msgstr ""
 
-#: src/libvlc.h:1016
+#: src/libvlc.h:1017
 msgid "Select the key to take you to the DVD menu"
 msgstr ""
 
-#: src/libvlc.h:1017
+#: src/libvlc.h:1018
 msgid "Select previous DVD title"
 msgstr ""
 
-#: src/libvlc.h:1018
+#: src/libvlc.h:1019
 msgid "Select the key to choose the previous title from the DVD"
 msgstr ""
 
-#: src/libvlc.h:1019
+#: src/libvlc.h:1020
 msgid "Select next DVD title"
 msgstr ""
 
-#: src/libvlc.h:1020
+#: src/libvlc.h:1021
 msgid "Select the key to choose the next title from the DVD"
 msgstr ""
 
-#: src/libvlc.h:1021
+#: src/libvlc.h:1022
 msgid "Select prev DVD chapter"
 msgstr ""
 
-#: src/libvlc.h:1022
+#: src/libvlc.h:1023
 msgid "Select the key to choose the previous chapter from the DVD"
 msgstr ""
 
-#: src/libvlc.h:1023
+#: src/libvlc.h:1024
 msgid "Select next DVD chapter"
 msgstr ""
 
-#: src/libvlc.h:1024
+#: src/libvlc.h:1025
 msgid "Select the key to choose the next chapter from the DVD"
 msgstr ""
 
-#: src/libvlc.h:1025
+#: src/libvlc.h:1026
 msgid "Volume up"
 msgstr ""
 
-#: src/libvlc.h:1026
+#: src/libvlc.h:1027
 msgid "Select the key to increase audio volume."
 msgstr ""
 
-#: src/libvlc.h:1027
+#: src/libvlc.h:1028
 msgid "Volume down"
 msgstr ""
 
-#: src/libvlc.h:1028
+#: src/libvlc.h:1029
 msgid "Select the key to decrease audio volume."
 msgstr ""
 
-#: src/libvlc.h:1029 modules/gui/macosx/controls.m:744
+#: src/libvlc.h:1030 modules/gui/macosx/controls.m:750
 #: modules/gui/macosx/intf.m:556 modules/gui/macosx/intf.m:616
 #: modules/gui/macosx/intf.m:625
 msgid "Mute"
 msgstr ""
 
-#: src/libvlc.h:1030
+#: src/libvlc.h:1031
 msgid "Select the key to mute audio."
 msgstr ""
 
-#: src/libvlc.h:1031
+#: src/libvlc.h:1032
 msgid "Subtitle delay up"
 msgstr ""
 
-#: src/libvlc.h:1032
+#: src/libvlc.h:1033
 msgid "Select the key to increase the subtitle delay."
 msgstr ""
 
-#: src/libvlc.h:1033
+#: src/libvlc.h:1034
 msgid "Subtitle delay down"
 msgstr ""
 
-#: src/libvlc.h:1034
+#: src/libvlc.h:1035
 msgid "Select the key to decrease the subtitle delay."
 msgstr ""
 
-#: src/libvlc.h:1035
+#: src/libvlc.h:1036
 msgid "Audio delay up"
 msgstr ""
 
-#: src/libvlc.h:1036
+#: src/libvlc.h:1037
 msgid "Select the key to increase the audio delay."
 msgstr ""
 
-#: src/libvlc.h:1037
+#: src/libvlc.h:1038
 msgid "Audio delay down"
 msgstr ""
 
-#: src/libvlc.h:1038
+#: src/libvlc.h:1039
 msgid "Select the key to decrease the audio delay."
 msgstr ""
 
-#: src/libvlc.h:1039
+#: src/libvlc.h:1040
 msgid "Play playlist bookmark 1"
 msgstr ""
 
-#: src/libvlc.h:1040
+#: src/libvlc.h:1041
 msgid "Play playlist bookmark 2"
 msgstr ""
 
-#: src/libvlc.h:1041
+#: src/libvlc.h:1042
 msgid "Play playlist bookmark 3"
 msgstr ""
 
-#: src/libvlc.h:1042
+#: src/libvlc.h:1043
 msgid "Play playlist bookmark 4"
 msgstr ""
 
-#: src/libvlc.h:1043
+#: src/libvlc.h:1044
 msgid "Play playlist bookmark 5"
 msgstr ""
 
-#: src/libvlc.h:1044
+#: src/libvlc.h:1045
 msgid "Play playlist bookmark 6"
 msgstr ""
 
-#: src/libvlc.h:1045
+#: src/libvlc.h:1046
 msgid "Play playlist bookmark 7"
 msgstr ""
 
-#: src/libvlc.h:1046
+#: src/libvlc.h:1047
 msgid "Play playlist bookmark 8"
 msgstr ""
 
-#: src/libvlc.h:1047
+#: src/libvlc.h:1048
 msgid "Play playlist bookmark 9"
 msgstr ""
 
-#: src/libvlc.h:1048
+#: src/libvlc.h:1049
 msgid "Play playlist bookmark 10"
 msgstr ""
 
-#: src/libvlc.h:1049
+#: src/libvlc.h:1050
 msgid "Select the key to play this bookmark."
 msgstr ""
 
-#: src/libvlc.h:1050
+#: src/libvlc.h:1051
 msgid "Set playlist bookmark 1"
 msgstr ""
 
-#: src/libvlc.h:1051
+#: src/libvlc.h:1052
 msgid "Set playlist bookmark 2"
 msgstr ""
 
-#: src/libvlc.h:1052
+#: src/libvlc.h:1053
 msgid "Set playlist bookmark 3"
 msgstr ""
 
-#: src/libvlc.h:1053
+#: src/libvlc.h:1054
 msgid "Set playlist bookmark 4"
 msgstr ""
 
-#: src/libvlc.h:1054
+#: src/libvlc.h:1055
 msgid "Set playlist bookmark 5"
 msgstr ""
 
-#: src/libvlc.h:1055
+#: src/libvlc.h:1056
 msgid "Set playlist bookmark 6"
 msgstr ""
 
-#: src/libvlc.h:1056
+#: src/libvlc.h:1057
 msgid "Set playlist bookmark 7"
 msgstr ""
 
-#: src/libvlc.h:1057
+#: src/libvlc.h:1058
 msgid "Set playlist bookmark 8"
 msgstr ""
 
-#: src/libvlc.h:1058
+#: src/libvlc.h:1059
 msgid "Set playlist bookmark 9"
 msgstr ""
 
-#: src/libvlc.h:1059
+#: src/libvlc.h:1060
 msgid "Set playlist bookmark 10"
 msgstr ""
 
-#: src/libvlc.h:1060
+#: src/libvlc.h:1061
 msgid "Select the key to set this playlist bookmark."
 msgstr ""
 
-#: src/libvlc.h:1062 modules/control/hotkeys.c:84
+#: src/libvlc.h:1063 modules/control/hotkeys.c:84
 msgid "Playlist bookmark 1"
 msgstr ""
 
-#: src/libvlc.h:1063 modules/control/hotkeys.c:85
+#: src/libvlc.h:1064 modules/control/hotkeys.c:85
 msgid "Playlist bookmark 2"
 msgstr ""
 
-#: src/libvlc.h:1064 modules/control/hotkeys.c:86
+#: src/libvlc.h:1065 modules/control/hotkeys.c:86
 msgid "Playlist bookmark 3"
 msgstr ""
 
-#: src/libvlc.h:1065 modules/control/hotkeys.c:87
+#: src/libvlc.h:1066 modules/control/hotkeys.c:87
 msgid "Playlist bookmark 4"
 msgstr ""
 
-#: src/libvlc.h:1066 modules/control/hotkeys.c:88
+#: src/libvlc.h:1067 modules/control/hotkeys.c:88
 msgid "Playlist bookmark 5"
 msgstr ""
 
-#: src/libvlc.h:1067 modules/control/hotkeys.c:89
+#: src/libvlc.h:1068 modules/control/hotkeys.c:89
 msgid "Playlist bookmark 6"
 msgstr ""
 
-#: src/libvlc.h:1068 modules/control/hotkeys.c:90
+#: src/libvlc.h:1069 modules/control/hotkeys.c:90
 msgid "Playlist bookmark 7"
 msgstr ""
 
-#: src/libvlc.h:1069 modules/control/hotkeys.c:91
+#: src/libvlc.h:1070 modules/control/hotkeys.c:91
 msgid "Playlist bookmark 8"
 msgstr ""
 
-#: src/libvlc.h:1070 modules/control/hotkeys.c:92
+#: src/libvlc.h:1071 modules/control/hotkeys.c:92
 msgid "Playlist bookmark 9"
 msgstr ""
 
-#: src/libvlc.h:1071 modules/control/hotkeys.c:93
+#: src/libvlc.h:1072 modules/control/hotkeys.c:93
 msgid "Playlist bookmark 10"
 msgstr ""
 
-#: src/libvlc.h:1073
+#: src/libvlc.h:1074
 msgid "This allows you to define playlist bookmarks."
 msgstr ""
 
-#: src/libvlc.h:1075
+#: src/libvlc.h:1076
 msgid "Go back in browsing history"
 msgstr ""
 
-#: src/libvlc.h:1076
+#: src/libvlc.h:1077
 msgid ""
 "Select the key to go back (to the previous media item) in the browsing "
 "history."
 msgstr ""
 
-#: src/libvlc.h:1077
+#: src/libvlc.h:1078
 msgid "Go forward in browsing history"
 msgstr ""
 
-#: src/libvlc.h:1078
+#: src/libvlc.h:1079
 msgid ""
 "Select the key to go forward (to the next media item) in the browsing "
 "history."
 msgstr ""
 
-#: src/libvlc.h:1080
+#: src/libvlc.h:1081
 msgid "Cycle audio track"
 msgstr ""
 
-#: src/libvlc.h:1081
+#: src/libvlc.h:1082
 msgid "Cycle through the available audio tracks(languages)."
 msgstr ""
 
-#: src/libvlc.h:1082
+#: src/libvlc.h:1083
 msgid "Cycle subtitle track"
 msgstr ""
 
-#: src/libvlc.h:1083
+#: src/libvlc.h:1084
 msgid "Cycle through the available subtitle tracks."
 msgstr ""
 
-#: src/libvlc.h:1084
+#: src/libvlc.h:1085
 msgid "Cycle source aspect ratio"
 msgstr ""
 
-#: src/libvlc.h:1085
+#: src/libvlc.h:1086
 msgid "Cycle through a predefined list of source aspect ratios."
 msgstr ""
 
-#: src/libvlc.h:1086
+#: src/libvlc.h:1087
 msgid "Cycle video crop"
 msgstr ""
 
-#: src/libvlc.h:1087
+#: src/libvlc.h:1088
 msgid "Cycle through a predefined list of crop formats."
 msgstr ""
 
-#: src/libvlc.h:1088
+#: src/libvlc.h:1089
 msgid "Cycle deinterlace modes"
 msgstr ""
 
-#: src/libvlc.h:1089
+#: src/libvlc.h:1090
 msgid "Cycle through deinterlace modes."
 msgstr ""
 
-#: src/libvlc.h:1090
+#: src/libvlc.h:1091
 msgid "Show interface"
 msgstr ""
 
-#: src/libvlc.h:1091
+#: src/libvlc.h:1092
 msgid "Raise the interface above all other windows."
 msgstr ""
 
-#: src/libvlc.h:1092
+#: src/libvlc.h:1093
 msgid "Hide interface"
 msgstr ""
 
-#: src/libvlc.h:1093
+#: src/libvlc.h:1094
 msgid "Lower the interface below all other windows."
 msgstr ""
 
-#: src/libvlc.h:1094
+#: src/libvlc.h:1095
 msgid "Take video snapshot"
 msgstr ""
 
-#: src/libvlc.h:1095
+#: src/libvlc.h:1096
 msgid "Takes a video snapshot and writes it to disk."
 msgstr ""
 
-#: src/libvlc.h:1097 modules/access_filter/record.c:51
+#: src/libvlc.h:1098 modules/access_filter/record.c:51
 #: modules/access_filter/record.c:52
 msgid "Record"
 msgstr ""
 
-#: src/libvlc.h:1098
+#: src/libvlc.h:1099
 msgid "Record access filter start/stop."
 msgstr ""
 
-#: src/libvlc.h:1100 src/libvlc.h:1101
+#: src/libvlc.h:1101 src/libvlc.h:1102
 msgid "Un-Zoom"
 msgstr ""
 
-#: src/libvlc.h:1103 src/libvlc.h:1104
+#: src/libvlc.h:1104 src/libvlc.h:1105
 msgid "Crop one pixel from the top of the video"
 msgstr ""
 
-#: src/libvlc.h:1105 src/libvlc.h:1106
+#: src/libvlc.h:1106 src/libvlc.h:1107
 msgid "Uncrop one pixel from the top of the video"
 msgstr ""
 
-#: src/libvlc.h:1108 src/libvlc.h:1109
+#: src/libvlc.h:1109 src/libvlc.h:1110
 msgid "Crop one pixel from the left of the video"
 msgstr ""
 
-#: src/libvlc.h:1110 src/libvlc.h:1111
+#: src/libvlc.h:1111 src/libvlc.h:1112
 msgid "Uncrop one pixel from the left of the video"
 msgstr ""
 
-#: src/libvlc.h:1113 src/libvlc.h:1114
+#: src/libvlc.h:1114 src/libvlc.h:1115
 msgid "Crop one pixel from the bottom of the video"
 msgstr ""
 
-#: src/libvlc.h:1115 src/libvlc.h:1116
+#: src/libvlc.h:1116 src/libvlc.h:1117
 msgid "Uncrop one pixel from the bottom of the video"
 msgstr ""
 
-#: src/libvlc.h:1118 src/libvlc.h:1119
+#: src/libvlc.h:1119 src/libvlc.h:1120
 msgid "Crop one pixel from the right of the video"
 msgstr ""
 
-#: src/libvlc.h:1120 src/libvlc.h:1121
+#: src/libvlc.h:1121 src/libvlc.h:1122
 msgid "Uncrop one pixel from the right of the video"
 msgstr ""
 
-#: src/libvlc.h:1125
+#: src/libvlc.h:1126
 #, c-format
 msgid ""
 "Usage: %s [options] [stream] ...\n"
@@ -3304,139 +3309,139 @@
 "  vlc:quit                       Special item to quit VLC\n"
 msgstr ""
 
-#: src/libvlc.h:1235 src/video_output/vout_intf.c:420
-#: modules/gui/macosx/controls.m:322 modules/gui/macosx/controls.m:753
+#: src/libvlc.h:1236 src/video_output/vout_intf.c:420
+#: modules/gui/macosx/controls.m:328 modules/gui/macosx/controls.m:759
 #: modules/gui/macosx/intf.m:573 modules/gui/macosx/intf.m:627
 #: modules/video_output/snapshot.c:76
 msgid "Snapshot"
 msgstr ""
 
-#: src/libvlc.h:1248
+#: src/libvlc.h:1249
 msgid "Window properties"
 msgstr ""
 
-#: src/libvlc.h:1288
+#: src/libvlc.h:1289
 msgid "Subpictures"
 msgstr ""
 
-#: src/libvlc.h:1295 modules/codec/subsdec.c:144 modules/demux/subtitle.c:63
+#: src/libvlc.h:1296 modules/codec/subsdec.c:144 modules/demux/subtitle.c:63
 #: modules/gui/beos/InterfaceWindow.cpp:277
 msgid "Subtitles"
 msgstr ""
 
-#: src/libvlc.h:1312 modules/stream_out/transcode.c:148
+#: src/libvlc.h:1313 modules/stream_out/transcode.c:148
 msgid "Overlays"
 msgstr ""
 
-#: src/libvlc.h:1320
+#: src/libvlc.h:1321
 msgid "Track settings"
 msgstr ""
 
-#: src/libvlc.h:1342
+#: src/libvlc.h:1343
 msgid "Playback control"
 msgstr ""
 
-#: src/libvlc.h:1357
+#: src/libvlc.h:1358
 msgid "Default devices"
 msgstr ""
 
-#: src/libvlc.h:1366
+#: src/libvlc.h:1367
 msgid "Network settings"
 msgstr ""
 
-#: src/libvlc.h:1378
+#: src/libvlc.h:1379
 msgid "Socks proxy"
 msgstr ""
 
-#: src/libvlc.h:1387
+#: src/libvlc.h:1388
 msgid "Metadata"
 msgstr ""
 
-#: src/libvlc.h:1417
+#: src/libvlc.h:1418
 msgid "Decoders"
 msgstr ""
 
-#: src/libvlc.h:1424 modules/gui/macosx/playlistinfo.m:80
+#: src/libvlc.h:1425 modules/gui/macosx/playlistinfo.m:80
 #: modules/gui/wxwidgets/dialogs/infopanels.cpp:264
 #: modules/gui/wxwidgets/dialogs/vlm/vlm_panel.cpp:378
 #: modules/gui/wxwidgets/dialogs/wizard.cpp:106
 msgid "Input"
 msgstr ""
 
-#: src/libvlc.h:1460 modules/gui/wxwidgets/dialogs/vlm/vlm_panel.cpp:522
+#: src/libvlc.h:1461 modules/gui/wxwidgets/dialogs/vlm/vlm_panel.cpp:522
 msgid "VLM"
 msgstr ""
 
-#: src/libvlc.h:1491
+#: src/libvlc.h:1492
 msgid "CPU"
 msgstr ""
 
-#: src/libvlc.h:1506
+#: src/libvlc.h:1507
 msgid "Special modules"
 msgstr ""
 
-#: src/libvlc.h:1512
+#: src/libvlc.h:1513
 msgid "Plugins"
 msgstr ""
 
-#: src/libvlc.h:1518
+#: src/libvlc.h:1519
 msgid "Performance options"
 msgstr ""
 
-#: src/libvlc.h:1624
+#: src/libvlc.h:1625
 msgid "Hot keys"
 msgstr ""
 
-#: src/libvlc.h:1927
+#: src/libvlc.h:1928
 msgid "Jump sizes"
 msgstr ""
 
-#: src/libvlc.h:2006
+#: src/libvlc.h:2007
 msgid "main program"
 msgstr ""
 
-#: src/libvlc.h:2013
+#: src/libvlc.h:2014
 msgid "print help for VLC (can be combined with --advanced)"
 msgstr ""
 
-#: src/libvlc.h:2015
+#: src/libvlc.h:2016
 msgid ""
 "print help for VLC and all its modules (can be combined with --advanced)"
 msgstr ""
 
-#: src/libvlc.h:2017
+#: src/libvlc.h:2018
 msgid "print help for the advanced options"
 msgstr ""
 
-#: src/libvlc.h:2019
+#: src/libvlc.h:2020
 msgid "ask for extra verbosity when displaying help"
 msgstr ""
 
-#: src/libvlc.h:2021
+#: src/libvlc.h:2022
 msgid "print a list of available modules"
 msgstr ""
 
-#: src/libvlc.h:2023
+#: src/libvlc.h:2024
 msgid "print help on a specific module (can be combined with --advanced)"
 msgstr ""
 
-#: src/libvlc.h:2025
+#: src/libvlc.h:2026
 msgid "save the current command line options in the config"
 msgstr ""
 
-#: src/libvlc.h:2027
+#: src/libvlc.h:2028
 msgid "reset the current config to the default values"
 msgstr ""
 
-#: src/libvlc.h:2029
+#: src/libvlc.h:2030
 msgid "use alternate config file"
 msgstr ""
 
-#: src/libvlc.h:2031
+#: src/libvlc.h:2032
 msgid "resets the current plugins cache"
 msgstr ""
 
-#: src/libvlc.h:2033
+#: src/libvlc.h:2034
 msgid "print version information"
 msgstr ""
 
@@ -3880,10 +3885,6 @@
 msgid "Sinhalese"
 msgstr ""
 
-#: src/misc/iso-639_def.h:161
-msgid "Slovak"
-msgstr ""
-
 #: src/misc/iso-639_def.h:162
 msgid "Slovenian"
 msgstr ""
@@ -4117,7 +4118,7 @@
 msgstr ""
 
 #: modules/access/cdda.c:52 modules/access/dshow/dshow.cpp:80
-#: modules/access/dvb/access.c:72 modules/access/dv.c:68
+#: modules/access/dv.c:68 modules/access/dvb/access.c:72
 #: modules/access/dvdnav.c:63 modules/access/dvdread.c:61
 #: modules/access/fake.c:40 modules/access/file.c:79 modules/access/ftp.c:42
 #: modules/access/gnomevfs.c:44 modules/access/http.c:53
@@ -4173,8 +4174,8 @@
 msgid "Audio CD - Track %i"
 msgstr ""
 
-#: modules/access/cdda/cdda.c:42 modules/access/directory.c:77
-#: modules/codec/x264.c:280 modules/codec/x264.c:287 modules/codec/x264.c:292
+#: modules/access/cdda/cdda.c:42 modules/access/directory.c:78
+#: modules/codec/x264.c:306 modules/codec/x264.c:313 modules/codec/x264.c:318
 msgid "none"
 msgstr ""
 
@@ -4419,11 +4420,11 @@
 msgid "Track Number"
 msgstr ""
 
-#: modules/access/directory.c:69
+#: modules/access/directory.c:70
 msgid "Subdirectory behavior"
 msgstr ""
 
-#: modules/access/directory.c:71
+#: modules/access/directory.c:72
 msgid ""
 "Select whether subdirectories must be expanded.\n"
 "none: subdirectories do not appear in the playlist.\n"
@@ -4431,19 +4432,19 @@
 "expand: all subdirectories are expanded.\n"
 msgstr ""
 
-#: modules/access/directory.c:77
+#: modules/access/directory.c:78
 msgid "collapse"
 msgstr ""
 
-#: modules/access/directory.c:78
+#: modules/access/directory.c:79
 msgid "expand"
 msgstr ""
 
-#: modules/access/directory.c:80
+#: modules/access/directory.c:81
 msgid "Ignored extensions"
 msgstr ""
 
-#: modules/access/directory.c:82
+#: modules/access/directory.c:83
 msgid ""
 "Files with these extensions will not be added to playlist when opening a "
 "directory.\n"
@@ -4451,11 +4452,11 @@
 "instance. Use a comma-separated list of extensions."
 msgstr ""
 
-#: modules/access/directory.c:89
+#: modules/access/directory.c:90
 msgid "Directory"
 msgstr ""
 
-#: modules/access/directory.c:91
+#: modules/access/directory.c:92
 msgid "Standard filesystem directory input"
 msgstr ""
 
@@ -4618,7 +4619,7 @@
 msgstr ""
 
 #: modules/access/dshow/dshow.cpp:161 modules/access/dshow/dshow.cpp:166
-#: modules/audio_output/alsa.c:110 modules/video_output/directx/directx.c:158
+#: modules/audio_output/alsa.c:110 modules/video_output/directx/directx.c:173
 msgid "Refresh list"
 msgstr ""
 
@@ -4626,6 +4627,18 @@
 msgid "Configure"
 msgstr ""
 
+#: modules/access/dv.c:70
+msgid "Caching value for DV streams. Thisvalue should be set in milliseconds."
+msgstr ""
+
+#: modules/access/dv.c:74
+msgid "Digital Video (Firewire/ieee1394)  input"
+msgstr ""
+
+#: modules/access/dv.c:75
+msgid "dv"
+msgstr ""
+
 #: modules/access/dvb/access.c:74
 msgid ""
 "Caching value for DVB streams. This value should be set in milliseconds."
@@ -4857,18 +4870,6 @@
 msgid "HTTP server"
 msgstr ""
 
-#: modules/access/dv.c:70
-msgid "Caching value for DV streams. Thisvalue should be set in milliseconds."
-msgstr ""
-
-#: modules/access/dv.c:74
-msgid "Digital Video (Firewire/ieee1394)  input"
-msgstr ""
-
-#: modules/access/dv.c:75
-msgid "dv"
-msgstr ""
-
 #: modules/access/dvdnav.c:59 modules/access/dvdread.c:57
 msgid "DVD angle"
 msgstr ""
@@ -5008,57 +5009,17 @@
 msgid "File"
 msgstr ""
 
-#: modules/access_filter/record.c:43
-msgid "Record directory"
+#: modules/access/ftp.c:44
+msgid ""
+"Caching value for FTP streams. This value should be set in milliseconds."
 msgstr ""
 
-#: modules/access_filter/record.c:45
-msgid "Directory where the record will be stored."
+#: modules/access/ftp.c:46
+msgid "FTP user name"
 msgstr ""
 
-#: modules/access_filter/timeshift.c:44
-msgid "Timeshift granularity"
-msgstr ""
-
-#: modules/access_filter/timeshift.c:46
-msgid ""
-"This is the size of the temporary files tha will be used to store the "
-"timeshifted streams."
-msgstr ""
-
-#: modules/access_filter/timeshift.c:48
-msgid "Timeshift directory"
-msgstr ""
-
-#: modules/access_filter/timeshift.c:49
-msgid "Directory used to store the timeshift temporary files."
-msgstr ""
-
-#: modules/access_filter/timeshift.c:51
-msgid "Force use of the timeshift module"
-msgstr ""
-
-#: modules/access_filter/timeshift.c:52
-msgid ""
-"Force use of the timeshift module even if the access declares that it can "
-"control pace or pause."
-msgstr ""
-
-#: modules/access_filter/timeshift.c:56 modules/access_filter/timeshift.c:57
-msgid "Timeshift"
-msgstr ""
-
-#: modules/access/ftp.c:44
-msgid ""
-"Caching value for FTP streams. This value should be set in milliseconds."
-msgstr ""
-
-#: modules/access/ftp.c:46
-msgid "FTP user name"
-msgstr ""
-
-#: modules/access/ftp.c:47 modules/access/smb.c:64
-msgid "User name that will be used for the connection."
+#: modules/access/ftp.c:47 modules/access/smb.c:64
+msgid "User name that will be used for the connection."
 msgstr ""
 
 #: modules/access/ftp.c:49
@@ -5169,168 +5130,6 @@
 msgid "Microsoft Media Server (MMS) input"
 msgstr ""
 
-#: modules/access_output/dummy.c:40 modules/stream_out/dummy.c:47
-msgid "Dummy stream output"
-msgstr ""
-
-#: modules/access_output/dummy.c:41 modules/misc/dummy/dummy.c:58
-msgid "Dummy"
-msgstr ""
-
-#: modules/access_output/file.c:61
-msgid "Append to file"
-msgstr ""
-
-#: modules/access_output/file.c:62
-msgid "Append to file if it exists instead of replacing it."
-msgstr ""
-
-#: modules/access_output/file.c:66
-msgid "File stream output"
-msgstr ""
-
-#: modules/access_output/http.c:60
-msgid "Username"
-msgstr ""
-
-#: modules/access_output/http.c:61
-msgid "User name that will be requested to access the stream."
-msgstr ""
-
-#: modules/access_output/http.c:64
-msgid "Password that will be requested to access the stream."
-msgstr ""
-
-#: modules/access_output/http.c:68
-msgid "Mime"
-msgstr ""
-
-#: modules/access_output/http.c:69
-msgid "MIME returned by the server (autodetected if not specified."
-msgstr ""
-
-#: modules/access_output/http.c:73
-msgid "Path to the x509 PEM certificate file that will be used for HTTPS."
-msgstr ""
-
-#: modules/access_output/http.c:76
-msgid ""
-"Path to the x509 PEM private key file that will be used for HTTPS. Leave "
-"empty if you don't have one."
-msgstr ""
-
-#: modules/access_output/http.c:80
-msgid ""
-"Path to the x509 PEM trusted root CA certificates (certificate authority) "
-"file that will be used for HTTPS. Leave empty if you don't have one."
-msgstr ""
-
-#: modules/access_output/http.c:85
-msgid ""
-"Path to the x509 PEM Certificates Revocation List file that will be used for "
-"SSL. Leave empty if you don't have one."
-msgstr ""
-
-#: modules/access_output/http.c:88
-msgid "Advertise with Bonjour"
-msgstr ""
-
-#: modules/access_output/http.c:89
-msgid "Advertise the stream with the Bonjour protocol."
-msgstr ""
-
-#: modules/access_output/http.c:93
-msgid "HTTP stream output"
-msgstr ""
-
-#: modules/access_output/http.c:95 modules/control/http/http.c:61
-#: modules/gui/wxwidgets/dialogs/streamout.cpp:472
-msgid "HTTP"
-msgstr ""
-
-#: modules/access_output/shout.c:58
-msgid "Stream name"
-msgstr ""
-
-#: modules/access_output/shout.c:59
-msgid "Name to give to this stream/channel on the icecast server."
-msgstr ""
-
-#: modules/access_output/shout.c:62
-msgid "Stream description"
-msgstr ""
-
-#: modules/access_output/shout.c:63
-msgid "Description of the stream content or information about your channel."
-msgstr ""
-
-#: modules/access_output/shout.c:66
-msgid "Stream MP3"
-msgstr ""
-
-#: modules/access_output/shout.c:67
-msgid ""
-"You normally have to feed the shoutcast module with Ogg streams. It is also "
-"possible to stream MP3 instead, so you can forward MP3 streams to the "
-"icecast server."
-msgstr ""
-
-#: modules/access_output/shout.c:73
-msgid "IceCAST output"
-msgstr ""
-
-#: modules/access_output/udp.c:75 modules/access/rtsp/access.c:40
-#: modules/demux/live555.cpp:61 modules/demux/livedotcom.cpp:61
-msgid "Caching value (ms)"
-msgstr ""
-
-#: modules/access_output/udp.c:77
-msgid ""
-"Default caching value for outbound UDP streams. This value should be set in "
-"milliseconds."
-msgstr ""
-
-#: modules/access_output/udp.c:80 modules/gui/macosx/wizard.m:442
-#: modules/gui/macosx/wizard.m:1846
-#: modules/gui/wxwidgets/dialogs/streamout.cpp:610
-#: modules/gui/wxwidgets/dialogs/wizard.cpp:1338 modules/stream_out/rtp.c:90
-msgid "Time-To-Live (TTL)"
-msgstr ""
-
-#: modules/access_output/udp.c:81
-msgid "Time-To-Live of the outgoing stream."
-msgstr ""
-
-#: modules/access_output/udp.c:84
-msgid "Group packets"
-msgstr ""
-
-#: modules/access_output/udp.c:85
-msgid ""
-"Packets can be sent one by one at the right time or by groups. You can "
-"choose the number of packets that will be sent at a time. It helps reducing "
-"the scheduling load on heavily-loaded systems."
-msgstr ""
-
-#: modules/access_output/udp.c:90
-msgid "Raw write"
-msgstr ""
-
-#: modules/access_output/udp.c:91
-msgid ""
-"Packets will be sent directly, without trying to fill the MTU (ie, without "
-"trying to make the biggest possible packets in order to improve streaming)."
-msgstr ""
-
-#: modules/access_output/udp.c:97
-msgid "UDP stream output"
-msgstr ""
-
-#: modules/access_output/udp.c:98
-#: modules/gui/wxwidgets/dialogs/streamout.cpp:475
-msgid "UDP"
-msgstr ""
-
 #: modules/access/pvr/pvr.c:49
 msgid ""
 "Default caching value for PVR streams. This value should be set in "
@@ -5487,6 +5286,11 @@
 msgid "IVTV MPEG Encoding cards input"
 msgstr ""
 
+#: modules/access/rtsp/access.c:40 modules/access_output/udp.c:75
+#: modules/demux/live555.cpp:62
+msgid "Caching value (ms)"
+msgstr ""
+
 #: modules/access/rtsp/access.c:42
 msgid ""
 "Caching value for RTSP streams. This value should be set in milliseconds."
@@ -5912,59 +5716,256 @@
 msgid "Format to use in the playlist's \"title\" field."
 msgstr ""
 
-#: modules/audio_filter/channel_mixer/dolby.c:47
-msgid "Simple decoder for Dolby Surround encoded streams"
+#: modules/access_filter/record.c:43
+msgid "Record directory"
 msgstr ""
 
-#: modules/audio_filter/channel_mixer/dolby.c:48
-msgid "Dolby Surround decoder"
+#: modules/access_filter/record.c:45
+msgid "Directory where the record will be stored."
 msgstr ""
 
-#: modules/audio_filter/channel_mixer/headphone.c:49
+#: modules/access_filter/timeshift.c:44
+msgid "Timeshift granularity"
+msgstr ""
+
+#: modules/access_filter/timeshift.c:46
 msgid ""
-"This effect gives you the feeling that you are standing in a room with a "
-"complete 7.1 speaker set when using only a headphone, providing a more "
-"realistic sound experience. It should also be more comfortable and less "
-"tiring when listening to music for long periods of time.\n"
-"It works with any source format from mono to 7.1."
+"This is the size of the temporary files tha will be used to store the "
+"timeshifted streams."
 msgstr ""
 
-#: modules/audio_filter/channel_mixer/headphone.c:56
-msgid "Characteristic dimension"
+#: modules/access_filter/timeshift.c:48
+msgid "Timeshift directory"
 msgstr ""
 
-#: modules/audio_filter/channel_mixer/headphone.c:58
-msgid "Distance between front left speaker and listener in meters."
+#: modules/access_filter/timeshift.c:49
+msgid "Directory used to store the timeshift temporary files."
 msgstr ""
 
-#: modules/audio_filter/channel_mixer/headphone.c:60
-msgid "Compensate delay"
+#: modules/access_filter/timeshift.c:51
+msgid "Force use of the timeshift module"
 msgstr ""
 
-#: modules/audio_filter/channel_mixer/headphone.c:62
+#: modules/access_filter/timeshift.c:52
 msgid ""
-"The delay which is introduced by the physical algorithm may sometimes be "
-"disturbing for the synchronization between lips-movement and speech. In "
-"case, turn this on to compensate."
+"Force use of the timeshift module even if the access declares that it can "
+"control pace or pause."
 msgstr ""
 
-#: modules/audio_filter/channel_mixer/headphone.c:66
-msgid "No decoding of Dolby Surround"
+#: modules/access_filter/timeshift.c:56 modules/access_filter/timeshift.c:57
+msgid "Timeshift"
 msgstr ""
 
-#: modules/audio_filter/channel_mixer/headphone.c:68
-msgid ""
-"Dolby Surround encoded streams won't be decoded before being processed by "
-"this filter. Enabling this setting is not recommended."
+#: modules/access_output/dummy.c:40 modules/stream_out/dummy.c:47
+msgid "Dummy stream output"
 msgstr ""
 
-#: modules/audio_filter/channel_mixer/headphone.c:72
-msgid "Headphone virtual spatialization effect"
+#: modules/access_output/dummy.c:41 modules/misc/dummy/dummy.c:58
+msgid "Dummy"
 msgstr ""
 
-#: modules/audio_filter/channel_mixer/headphone.c:73
-msgid "Headphone effect"
-msgstr ""
+#: modules/access_output/file.c:61
+msgid "Append to file"
+msgstr ""
+
+#: modules/access_output/file.c:62
+msgid "Append to file if it exists instead of replacing it."
+msgstr ""
+
+#: modules/access_output/file.c:66
+msgid "File stream output"
+msgstr ""
+
+#: modules/access_output/http.c:60
+msgid "Username"
+msgstr ""
+
+#: modules/access_output/http.c:61
+msgid "User name that will be requested to access the stream."
+msgstr ""
+
+#: modules/access_output/http.c:64
+msgid "Password that will be requested to access the stream."
+msgstr ""
+
+#: modules/access_output/http.c:68
+msgid "Mime"
+msgstr ""
+
+#: modules/access_output/http.c:69
+msgid "MIME returned by the server (autodetected if not specified."
+msgstr ""
+
+#: modules/access_output/http.c:73
+msgid "Path to the x509 PEM certificate file that will be used for HTTPS."
+msgstr ""
+
+#: modules/access_output/http.c:76
+msgid ""
+"Path to the x509 PEM private key file that will be used for HTTPS. Leave "
+"empty if you don't have one."
+msgstr ""
+
+#: modules/access_output/http.c:80
+msgid ""
+"Path to the x509 PEM trusted root CA certificates (certificate authority) "
+"file that will be used for HTTPS. Leave empty if you don't have one."
+msgstr ""
+
+#: modules/access_output/http.c:85
+msgid ""
+"Path to the x509 PEM Certificates Revocation List file that will be used for "
+"SSL. Leave empty if you don't have one."
+msgstr ""
+
+#: modules/access_output/http.c:88
+msgid "Advertise with Bonjour"
+msgstr ""
+
+#: modules/access_output/http.c:89
+msgid "Advertise the stream with the Bonjour protocol."
+msgstr ""
+
+#: modules/access_output/http.c:93
+msgid "HTTP stream output"
+msgstr ""
+
+#: modules/access_output/http.c:95 modules/control/http/http.c:61
+#: modules/gui/wxwidgets/dialogs/streamout.cpp:472
+msgid "HTTP"
+msgstr ""
+
+#: modules/access_output/shout.c:58
+msgid "Stream name"
+msgstr ""
+
+#: modules/access_output/shout.c:59
+msgid "Name to give to this stream/channel on the icecast server."
+msgstr ""
+
+#: modules/access_output/shout.c:62
+msgid "Stream description"
+msgstr ""
+
+#: modules/access_output/shout.c:63
+msgid "Description of the stream content or information about your channel."
+msgstr ""
+
+#: modules/access_output/shout.c:66
+msgid "Stream MP3"
+msgstr ""
+
+#: modules/access_output/shout.c:67
+msgid ""
+"You normally have to feed the shoutcast module with Ogg streams. It is also "
+"possible to stream MP3 instead, so you can forward MP3 streams to the "
+"icecast server."
+msgstr ""
+
+#: modules/access_output/shout.c:73
+msgid "IceCAST output"
+msgstr ""
+
+#: modules/access_output/udp.c:77
+msgid ""
+"Default caching value for outbound UDP streams. This value should be set in "
+"milliseconds."
+msgstr ""
+
+#: modules/access_output/udp.c:80 modules/gui/macosx/wizard.m:442
+#: modules/gui/macosx/wizard.m:1846
+#: modules/gui/wxwidgets/dialogs/streamout.cpp:610
+#: modules/gui/wxwidgets/dialogs/wizard.cpp:1338 modules/stream_out/rtp.c:91
+msgid "Time-To-Live (TTL)"
+msgstr ""
+
+#: modules/access_output/udp.c:81
+msgid "Time-To-Live of the outgoing stream."
+msgstr ""
+
+#: modules/access_output/udp.c:84
+msgid "Group packets"
+msgstr ""
+
+#: modules/access_output/udp.c:85
+msgid ""
+"Packets can be sent one by one at the right time or by groups. You can "
+"choose the number of packets that will be sent at a time. It helps reducing "
+"the scheduling load on heavily-loaded systems."
+msgstr ""
+
+#: modules/access_output/udp.c:90
+msgid "Raw write"
+msgstr ""
+
+#: modules/access_output/udp.c:91
+msgid ""
+"Packets will be sent directly, without trying to fill the MTU (ie, without "
+"trying to make the biggest possible packets in order to improve streaming)."
+msgstr ""
+
+#: modules/access_output/udp.c:97
+msgid "UDP stream output"
+msgstr ""
+
+#: modules/access_output/udp.c:98
+#: modules/gui/wxwidgets/dialogs/streamout.cpp:475
+msgid "UDP"
+msgstr ""
+
+#: modules/audio_filter/channel_mixer/dolby.c:47
+msgid "Simple decoder for Dolby Surround encoded streams"
+msgstr ""
+
+#: modules/audio_filter/channel_mixer/dolby.c:48
+msgid "Dolby Surround decoder"
+msgstr ""
+
+#: modules/audio_filter/channel_mixer/headphone.c:49
+msgid ""
+"This effect gives you the feeling that you are standing in a room with a "
+"complete 7.1 speaker set when using only a headphone, providing a more "
+"realistic sound experience. It should also be more comfortable and less "
+"tiring when listening to music for long periods of time.\n"
+"It works with any source format from mono to 7.1."
+msgstr ""
+
+#: modules/audio_filter/channel_mixer/headphone.c:56
+msgid "Characteristic dimension"
+msgstr ""
+
+#: modules/audio_filter/channel_mixer/headphone.c:58
+msgid "Distance between front left speaker and listener in meters."
+msgstr ""
+
+#: modules/audio_filter/channel_mixer/headphone.c:60
+msgid "Compensate delay"
+msgstr ""
+
+#: modules/audio_filter/channel_mixer/headphone.c:62
+msgid ""
+"The delay which is introduced by the physical algorithm may sometimes be "
+"disturbing for the synchronization between lips-movement and speech. In "
+"case, turn this on to compensate."
+msgstr ""
+
+#: modules/audio_filter/channel_mixer/headphone.c:66
+msgid "No decoding of Dolby Surround"
+msgstr ""
+
+#: modules/audio_filter/channel_mixer/headphone.c:68
+msgid ""
+"Dolby Surround encoded streams won't be decoded before being processed by "
+"this filter. Enabling this setting is not recommended."
+msgstr ""
+
+#: modules/audio_filter/channel_mixer/headphone.c:72
+msgid "Headphone virtual spatialization effect"
+msgstr ""
+
+#: modules/audio_filter/channel_mixer/headphone.c:73
+msgid "Headphone effect"
+msgstr ""
 
 #: modules/audio_filter/channel_mixer/simple.c:46
 msgid "Audio filter for simple channel mixing"
@@ -6303,8 +6304,8 @@
 msgid "Trivial audio mixer"
 msgstr ""
 
-#: modules/audio_output/alsa.c:84 modules/codec/x264.c:274
-#: modules/codec/x264.c:280 modules/codec/x264.c:287 modules/codec/x264.c:292
+#: modules/audio_output/alsa.c:84 modules/codec/x264.c:300
+#: modules/codec/x264.c:306 modules/codec/x264.c:313 modules/codec/x264.c:318
 msgid "default"
 msgstr ""
 
@@ -6610,10 +6611,14 @@
 msgid "DVB subtitles encoder"
 msgstr ""
 
-#: modules/codec/faad.c:38
+#: modules/codec/faad.c:39
 msgid "AAC audio decoder (using libfaad2)"
 msgstr ""
 
+#: modules/codec/faad.c:331
+msgid "AAC extension"
+msgstr ""
+
 #: modules/codec/fake.c:45 modules/video_output/image.c:79
 msgid "Image file"
 msgstr ""
@@ -6844,6 +6849,51 @@
 msgid "FFmpeg post processing filter chains"
 msgstr ""
 
+#: modules/codec/ffmpeg/ffmpeg.h:152
+msgid ""
+"<filterName>[:<option>[:<option>...]][[,|/][-]<filterName>[:"
+"<option>...]]...\n"
+"long form example:\n"
+"vdeblock:autoq/hdeblock:autoq/linblenddeint    default,-vdeblock\n"
+"short form example:\n"
+"vb:a/hb:a/lb de,-vb\n"
+"more examples:\n"
+"tn:64:128:256\n"
+"Filters                        Options\n"
+"short  long name       short   long option     Description\n"
+"*      *               a       autoq           cpu power dependant enabler\n"
+"                       c       chrom           chrominance filtring enabled\n"
+"                       y       nochrom         chrominance filtring "
+"disabled\n"
+"hb     hdeblock        (2 Threshold)           horizontal deblocking filter\n"
+"       1. difference factor: default=64, higher -> more deblocking\n"
+"       2. flatness threshold: default=40, lower -> more deblocking\n"
+"                       the h & v deblocking filters share these\n"
+"                       so u cant set different thresholds for h / v\n"
+"vb     vdeblock        (2 Threshold)           vertical deblocking filter\n"
+"h1     x1hdeblock                              Experimental h deblock filter "
+"1\n"
+"v1     x1vdeblock                              Experimental v deblock filter "
+"1\n"
+"dr     dering                                  Deringing filter\n"
+"al     autolevels                              automatic brightness / "
+"contrast\n"
+"                       f       fullyrange      stretch luminance to "
+"(0..255)\n"
+"lb     linblenddeint                           linear blend deinterlacer\n"
+"li     linipoldeint                            linear interpolating "
+"deinterlace\n"
+"ci     cubicipoldeint                          cubic interpolating "
+"deinterlacer\n"
+"md     mediandeint                             median deinterlacer\n"
+"fd     ffmpegdeint                             ffmpeg deinterlacer\n"
+"de     default                                 hb:a,vb:a,dr:a,al\n"
+"fa     fast                                    h1:a,v1:a,dr:a,al\n"
+"tn     tmpnoise        (3 Thresholds)          Temporal Noise Reducer\n"
+"                       1. <= 2. <= 3.          larger -> stronger filtering\n"
+"fq     forceQuant      <quantizer>             Force quantizer\n"
+msgstr ""
+
 #: modules/codec/ffmpeg/ffmpeg.h:191
 msgid "Ratio of key frames"
 msgstr ""
@@ -6928,7 +6978,7 @@
 "same qscale for I and P frames)."
 msgstr ""
 
-#: modules/codec/ffmpeg/ffmpeg.h:232 modules/codec/x264.c:247
+#: modules/codec/ffmpeg/ffmpeg.h:232 modules/codec/x264.c:263
 #: modules/demux/mod.c:73
 msgid "Noise reduction"
 msgstr ""
@@ -7213,6 +7263,13 @@
 "Try manually setting a character-encoding before you open the file."
 msgstr ""
 
+#: modules/codec/svcdsub.c:46
+msgid ""
+"This integer when viewed in binary is a debugging mask\n"
+"calls                 1\n"
+"packet assembly info  2\n"
+msgstr ""
+
 #: modules/codec/svcdsub.c:51
 msgid "Philips OGT (SVCD subtitle) decoder"
 msgstr ""
@@ -7454,135 +7511,143 @@
 "beta parameters. -6 means light filter, 6 means strong."
 msgstr ""
 
-#: modules/codec/x264.c:108
+#: modules/codec/x264.c:110
+msgid "Interlaced mode"
+msgstr ""
+
+#: modules/codec/x264.c:111
+msgid "Pure-interlaced mode."
+msgstr ""
+
+#: modules/codec/x264.c:116
 msgid "Set QP"
 msgstr ""
 
-#: modules/codec/x264.c:109
+#: modules/codec/x264.c:117
 msgid ""
 "This selects the quantizer to use. Lower values result in better fidelity, "
 "but higher bitrates. 26 is a good default value. Range 0 (lossless) to 51."
 msgstr ""
 
-#: modules/codec/x264.c:113
+#: modules/codec/x264.c:121
 msgid "Quality-based VBR"
 msgstr ""
 
-#: modules/codec/x264.c:114
+#: modules/codec/x264.c:122
 msgid "1-pass Quality-based VBR. Range 0 to 51."
 msgstr ""
 
-#: modules/codec/x264.c:116
+#: modules/codec/x264.c:124
 msgid "Min QP"
 msgstr ""
 
-#: modules/codec/x264.c:117
+#: modules/codec/x264.c:125
 msgid "Minimum quantizer parameter. 15 to 35 seems to be a useful range."
 msgstr ""
 
-#: modules/codec/x264.c:120
+#: modules/codec/x264.c:128
 msgid "Max QP"
 msgstr ""
 
-#: modules/codec/x264.c:121
+#: modules/codec/x264.c:129
 msgid "Maximum quantizer parameter."
 msgstr ""
 
-#: modules/codec/x264.c:123
+#: modules/codec/x264.c:131
 msgid "Max QP step"
 msgstr ""
 
-#: modules/codec/x264.c:124
+#: modules/codec/x264.c:132
 msgid "Max QP step between frames."
 msgstr ""
 
-#: modules/codec/x264.c:126
+#: modules/codec/x264.c:134
 msgid "Average bitrate tolerance"
 msgstr ""
 
-#: modules/codec/x264.c:127
+#: modules/codec/x264.c:135
 msgid "Allowed variance in average bitrate (in kbits/s)."
 msgstr ""
 
-#: modules/codec/x264.c:130
+#: modules/codec/x264.c:138
 msgid "Max local bitrate"
 msgstr ""
 
-#: modules/codec/x264.c:131
+#: modules/codec/x264.c:139
 msgid "Sets a maximum local bitrate (in kbits/s)."
 msgstr ""
 
-#: modules/codec/x264.c:133
+#: modules/codec/x264.c:141
 msgid "VBV buffer"
 msgstr ""
 
-#: modules/codec/x264.c:134
+#: modules/codec/x264.c:142
 msgid "Averaging period for the maximum local bitrate (in kbits)."
 msgstr ""
 
-#: modules/codec/x264.c:137
+#: modules/codec/x264.c:145
 msgid "Initial VBV buffer occupancy"
 msgstr ""
 
-#: modules/codec/x264.c:138
+#: modules/codec/x264.c:146
 msgid ""
 "Sets the initial buffer occupancy as a fraction of the buffer size. Range "
 "0.0 to 1.0."
 msgstr ""
 
-#: modules/codec/x264.c:142
+#: modules/codec/x264.c:150
 msgid "QP factor between I and P"
 msgstr ""
 
-#: modules/codec/x264.c:143
+#: modules/codec/x264.c:151
 msgid "QP factor between I and P. Range 1.0 to 2.0."
 msgstr ""
 
-#: modules/codec/x264.c:146
+#: modules/codec/x264.c:154
 msgid "QP factor between P and B"
 msgstr ""
 
-#: modules/codec/x264.c:147
+#: modules/codec/x264.c:155
 msgid "QP factor between P and B. Range 1.0 to 2.0."
 msgstr ""
 
-#: modules/codec/x264.c:149
+#: modules/codec/x264.c:157
 msgid "QP difference between chroma and luma"
 msgstr ""
 
-#: modules/codec/x264.c:150
+#: modules/codec/x264.c:158
 msgid "QP difference between chroma and luma."
 msgstr ""
 
-#: modules/codec/x264.c:152
+#: modules/codec/x264.c:160
 msgid "QP curve compression"
 msgstr ""
 
-#: modules/codec/x264.c:153
+#: modules/codec/x264.c:161
 msgid "QP curve compression. Range 0.0 (CBR) to 1.0 (QCP)."
 msgstr ""
 
-#: modules/codec/x264.c:155 modules/codec/x264.c:159
+#: modules/codec/x264.c:163 modules/codec/x264.c:167
 msgid "Reduce fluctuations in QP"
 msgstr ""
 
-#: modules/codec/x264.c:156
+#: modules/codec/x264.c:164
 msgid ""
 "This reduces the fluctuations in QP before curve compression. Temporally "
 "blurs complexity."
 msgstr ""
 
-#: modules/codec/x264.c:160
+#: modules/codec/x264.c:168
 msgid ""
 "This reduces the fluctations in QP after curve compression. Temporally blurs "
 "quants."
 msgstr ""
 
-#: modules/codec/x264.c:165
+#: modules/codec/x264.c:173
 msgid "Partitions to consider"
 msgstr ""
 
-#: modules/codec/x264.c:166
+#: modules/codec/x264.c:174
 msgid ""
 "Partitions to consider in analyse mode: \n"
 " - none  : \n"
@@ -7593,27 +7658,38 @@
 "(p4x4 requires p8x8. i8x8 requires 8x8dct)."
 msgstr ""
 
-#: modules/codec/x264.c:174
+#: modules/codec/x264.c:182
 msgid "Direct MV prediction mode"
 msgstr ""
 
-#: modules/codec/x264.c:175
+#: modules/codec/x264.c:183
 msgid "Direct MV prediction mode."
 msgstr ""
 
-#: modules/codec/x264.c:177
+#: modules/codec/x264.c:186
+msgid "Direct prediction size"
+msgstr ""
+
+#: modules/codec/x264.c:187
+msgid ""
+"Direct prediction size:  -  0: 4x4\n"
+" -  1: 8x8\n"
+" - -1: smallest possible according to level\n"
+msgstr ""
+
+#: modules/codec/x264.c:193
 msgid "Weighted prediction for B-frames"
 msgstr ""
 
-#: modules/codec/x264.c:178
+#: modules/codec/x264.c:194
 msgid "Weighted prediction for B-frames."
 msgstr ""
 
-#: modules/codec/x264.c:180
+#: modules/codec/x264.c:196
 msgid "Integer pixel motion estimation method"
 msgstr ""
 
-#: modules/codec/x264.c:181
+#: modules/codec/x264.c:197
 msgid ""
 "Selects the motion estimation algorithm:  - dia: diamond search, radius 1 "
 "(fast)\n"
@@ -7622,89 +7698,89 @@
 " - esa: exhaustive search (extremely slow, primarily for testing)\n"
 msgstr ""
 
-#: modules/codec/x264.c:187
+#: modules/codec/x264.c:203
 msgid "Maximum motion vector search range"
 msgstr ""
 
-#: modules/codec/x264.c:188
+#: modules/codec/x264.c:204
 msgid ""
 "Maximum distance to search for motion estimation, measured from predicted "
 "position(s). Default of 16 is good for most footage, high motion sequences "
 "may benefit from settings between 24 and 32. Range 0 to 64."
 msgstr ""
 
-#: modules/codec/x264.c:193
+#: modules/codec/x264.c:209
 msgid "Subpixel motion estimation and partition decision quality"
 msgstr ""
 
-#: modules/codec/x264.c:197
+#: modules/codec/x264.c:213
 msgid ""
 "This parameter controls quality versus speed tradeoffs involved in the "
 "motion estimation decision process (lower = quicker and higher = better "
 "quality). Range 1 to 7."
 msgstr ""
 
-#: modules/codec/x264.c:202
+#: modules/codec/x264.c:218
 msgid ""
 "This parameter controls quality versus speed tradeoffs involved in the "
 "motion estimation decision process (lower = quicker and higher = better "
 "quality). Range 1 to 6."
 msgstr ""
 
-#: modules/codec/x264.c:207
+#: modules/codec/x264.c:223
 msgid ""
 "This parameter controls quality versus speed tradeoffs involved in the "
 "motion estimation decision process (lower = quicker and higher = better "
 "quality). Range 1 to 5."
 msgstr ""
 
-#: modules/codec/x264.c:212
+#: modules/codec/x264.c:228
 msgid "RD based mode decision for B-frames"
 msgstr ""
 
-#: modules/codec/x264.c:213
+#: modules/codec/x264.c:229
 msgid "RD based mode decision for B-frames. This requires subme 6 (or higher)."
 msgstr ""
 
-#: modules/codec/x264.c:216
+#: modules/codec/x264.c:232
 msgid "Decide references on a per partition basis"
 msgstr ""
 
-#: modules/codec/x264.c:217
+#: modules/codec/x264.c:233
 msgid ""
 "Allows each 8x8 or 16x8 partition to independently select a reference frame, "
 "as opposed to only one ref per macroblock."
 msgstr ""
 
-#: modules/codec/x264.c:221
+#: modules/codec/x264.c:237
 msgid "Ignore chroma in motion estimation"
 msgstr ""
 
-#: modules/codec/x264.c:222
+#: modules/codec/x264.c:238
 msgid "Chroma ME for subpel and mode decision in P-frames."
 msgstr ""
 
-#: modules/codec/x264.c:225
+#: modules/codec/x264.c:241
 msgid "Jointly optimize both MVs in B-frames"
 msgstr ""
 
-#: modules/codec/x264.c:226
+#: modules/codec/x264.c:242
 msgid "Joint bidirectional motion refinement."
 msgstr ""
 
-#: modules/codec/x264.c:228
+#: modules/codec/x264.c:244
 msgid "Adaptive spatial transform size"
 msgstr ""
 
-#: modules/codec/x264.c:230
+#: modules/codec/x264.c:246
 msgid "SATD-based decision for 8x8 transform in inter-MBs."
 msgstr ""
 
-#: modules/codec/x264.c:232
+#: modules/codec/x264.c:248
 msgid "Trellis RD quantization"
 msgstr ""
 
-#: modules/codec/x264.c:233
+#: modules/codec/x264.c:249
 msgid ""
 "Trellis RD quantization: \n"
 " - 0: disabled\n"
@@ -7713,121 +7789,137 @@
 "This requires CABAC."
 msgstr ""
 
-#: modules/codec/x264.c:239
+#: modules/codec/x264.c:255
 msgid "Early SKIP detection on P-frames"
 msgstr ""
 
-#: modules/codec/x264.c:240
+#: modules/codec/x264.c:256
 msgid "Early SKIP detection on P-frames."
 msgstr ""
 
-#: modules/codec/x264.c:242
+#: modules/codec/x264.c:258
 msgid "Coefficient thresholding on P-frames"
 msgstr ""
 
-#: modules/codec/x264.c:243
+#: modules/codec/x264.c:259
 msgid ""
 "Coefficient thresholding on P-frames.Eliminate dct blocks containing only a "
 "small single coefficient."
 msgstr ""
 
-#: modules/codec/x264.c:248
+#: modules/codec/x264.c:264
 msgid ""
 "Dct-domain noise reduction. Adaptive pseudo-deadzone. 10 to 1000 seems to be "
 "a useful range."
 msgstr ""
 
-#: modules/codec/x264.c:253
+#: modules/codec/x264.c:268
+msgid "Inter luma quantization deadzone"
+msgstr ""
+
+#: modules/codec/x264.c:269
+msgid "Set the size of the inter luma quantization deadzone. Range 0 to 32."
+msgstr ""
+
+#: modules/codec/x264.c:272
+msgid "Intra luma quantization deadzone"
+msgstr ""
+
+#: modules/codec/x264.c:273
+msgid "Set the size of the intra luma quantization deadzone. Range 0 to 32."
+msgstr ""
+
+#: modules/codec/x264.c:279
 msgid "CPU optimizations"
 msgstr ""
 
-#: modules/codec/x264.c:254
+#: modules/codec/x264.c:280
 msgid "Use assembler CPU optimizations."
 msgstr ""
 
-#: modules/codec/x264.c:256
+#: modules/codec/x264.c:282
 msgid "PSNR computation"
 msgstr ""
 
-#: modules/codec/x264.c:257
+#: modules/codec/x264.c:283
 msgid ""
 "Compute and print PSNR stats. This has no effect on the actual encoding "
 "quality."
 msgstr ""
 
-#: modules/codec/x264.c:260
+#: modules/codec/x264.c:286
 msgid "SSIM computation"
 msgstr ""
 
-#: modules/codec/x264.c:261
+#: modules/codec/x264.c:287
 msgid ""
 "Compute and print SSIM stats. This has no effect on the actual encoding "
 "quality."
 msgstr ""
 
-#: modules/codec/x264.c:264
+#: modules/codec/x264.c:290
 msgid "Quiet mode"
 msgstr ""
 
-#: modules/codec/x264.c:265
+#: modules/codec/x264.c:291
 msgid "Quiet mode."
 msgstr ""
 
-#: modules/codec/x264.c:267 modules/gui/macosx/playlistinfo.m:64
+#: modules/codec/x264.c:293 modules/gui/macosx/playlistinfo.m:64
 #: modules/gui/wxwidgets/dialogs/fileinfo.cpp:85
 msgid "Statistics"
 msgstr ""
 
-#: modules/codec/x264.c:268
+#: modules/codec/x264.c:294
 msgid "Print stats for each frame."
 msgstr ""
 
-#: modules/codec/x264.c:274
+#: modules/codec/x264.c:300
 msgid "dia"
 msgstr ""
 
-#: modules/codec/x264.c:274
+#: modules/codec/x264.c:300
 msgid "hex"
 msgstr ""
 
-#: modules/codec/x264.c:274
+#: modules/codec/x264.c:300
 msgid "umh"
 msgstr ""
 
-#: modules/codec/x264.c:274
+#: modules/codec/x264.c:300
 msgid "esa"
 msgstr ""
 
-#: modules/codec/x264.c:280
+#: modules/codec/x264.c:306
 msgid "fast"
 msgstr ""
 
-#: modules/codec/x264.c:280
+#: modules/codec/x264.c:306
 msgid "normal"
 msgstr ""
 
-#: modules/codec/x264.c:281
+#: modules/codec/x264.c:307
 msgid "slow"
 msgstr ""
 
-#: modules/codec/x264.c:281
+#: modules/codec/x264.c:307
 msgid "all"
 msgstr ""
 
-#: modules/codec/x264.c:287 modules/codec/x264.c:292
+#: modules/codec/x264.c:313 modules/codec/x264.c:318
 msgid "spatial"
 msgstr ""
 
-#: modules/codec/x264.c:287 modules/codec/x264.c:292
+#: modules/codec/x264.c:313 modules/codec/x264.c:318
 msgid "temporal"
 msgstr ""
 
-#: modules/codec/x264.c:287 modules/gui/pda/pda_interface.c:743
+#: modules/codec/x264.c:313 modules/gui/pda/pda_interface.c:743
 #: modules/video_filter/mosaic.c:168
 msgid "auto"
 msgstr ""
 
-#: modules/codec/x264.c:296
+#: modules/codec/x264.c:322
 msgid "H.264/MPEG4 AVC encoder (using x264 library)"
 msgstr ""
 
@@ -8049,378 +8141,406 @@
 msgid "Windows Service interface"
 msgstr ""
 
-#: modules/control/rc.c:156
+#: modules/control/rc.c:158
 msgid "Show stream position"
 msgstr ""
 
-#: modules/control/rc.c:157
+#: modules/control/rc.c:159
 msgid ""
 "Show the current position in seconds within the stream from time to time."
 msgstr ""
 
-#: modules/control/rc.c:160
+#: modules/control/rc.c:162
 msgid "Fake TTY"
 msgstr ""
 
-#: modules/control/rc.c:161
+#: modules/control/rc.c:163
 msgid "Force the rc module to use stdin as if it was a TTY."
 msgstr ""
 
-#: modules/control/rc.c:163
+#: modules/control/rc.c:165
 msgid "UNIX socket command input"
 msgstr ""
 
-#: modules/control/rc.c:164
+#: modules/control/rc.c:166
 msgid "Accept commands over a Unix socket rather than stdin."
 msgstr ""
 
-#: modules/control/rc.c:167
+#: modules/control/rc.c:169
 msgid "TCP command input"
 msgstr ""
 
-#: modules/control/rc.c:168
+#: modules/control/rc.c:170
 msgid ""
 "Accept commands over a socket rather than stdin. You can set the address and "
 "port the interface will bind to."
 msgstr ""
 
-#: modules/control/rc.c:172 modules/misc/dummy/dummy.c:49
+#: modules/control/rc.c:174 modules/misc/dummy/dummy.c:49
 msgid "Do not open a DOS command box interface"
 msgstr ""
 
-#: modules/control/rc.c:174
+#: modules/control/rc.c:176
 msgid ""
 "By default the rc interface plugin will start a DOS command box. Enabling "
 "the quiet mode will not bring this command box but can also be pretty "
 "annoying when you want to stop VLC and no video window is open."
 msgstr ""
 
-#: modules/control/rc.c:181
+#: modules/control/rc.c:183
 msgid "RC"
 msgstr ""
 
-#: modules/control/rc.c:184
+#: modules/control/rc.c:186
 msgid "Remote control interface"
 msgstr ""
 
-#: modules/control/rc.c:337
+#: modules/control/rc.c:339
 msgid "Remote control interface initialized. Type `help' for help."
 msgstr ""
 
-#: modules/control/rc.c:849
+#: modules/control/rc.c:868
 #, c-format
 msgid "Unknown command `%s'. Type `help' for help."
 msgstr ""
 
-#: modules/control/rc.c:882
+#: modules/control/rc.c:901
 msgid "+----[ Remote control commands ]"
 msgstr ""
 
-#: modules/control/rc.c:884
+#: modules/control/rc.c:903
 msgid "| add XYZ  . . . . . . . . . . add XYZ to playlist"
 msgstr ""
 
-#: modules/control/rc.c:885
+#: modules/control/rc.c:904
+msgid "| enqueue XYZ  . . . . . . . queue XYZ to playlist"
+msgstr ""
+
+#: modules/control/rc.c:905
 msgid "| playlist . . .  show items currently in playlist"
 msgstr ""
 
-#: modules/control/rc.c:886
+#: modules/control/rc.c:906
 msgid "| play . . . . . . . . . . . . . . . . play stream"
 msgstr ""
 
-#: modules/control/rc.c:887
+#: modules/control/rc.c:907
 msgid "| stop . . . . . . . . . . . . . . . . stop stream"
 msgstr ""
 
-#: modules/control/rc.c:888
+#: modules/control/rc.c:908
 msgid "| next . . . . . . . . . . . .  next playlist item"
 msgstr ""
 
-#: modules/control/rc.c:889
+#: modules/control/rc.c:909
 msgid "| prev . . . . . . . . . .  previous playlist item"
 msgstr ""
 
-#: modules/control/rc.c:890
+#: modules/control/rc.c:910
 msgid "| goto . . . . . . . . . . . .  goto item at index"
 msgstr ""
 
-#: modules/control/rc.c:891
+#: modules/control/rc.c:911
 msgid "| clear . . . . . . . . . . .   clear the playlist"
 msgstr ""
 
-#: modules/control/rc.c:892
+#: modules/control/rc.c:912
 msgid "| status . . . . . . . . . current playlist status"
 msgstr ""
 
-#: modules/control/rc.c:893
+#: modules/control/rc.c:913
 msgid "| title [X]  . . . . set/get title in current item"
 msgstr ""
 
-#: modules/control/rc.c:894
+#: modules/control/rc.c:914
 msgid "| title_n  . . . . . .  next title in current item"
 msgstr ""
 
-#: modules/control/rc.c:895
+#: modules/control/rc.c:915
 msgid "| title_p  . . . .  previous title in current item"
 msgstr ""
 
-#: modules/control/rc.c:896
+#: modules/control/rc.c:916
 msgid "| chapter [X]  . . set/get chapter in current item"
 msgstr ""
 
-#: modules/control/rc.c:897
+#: modules/control/rc.c:917
 msgid "| chapter_n  . . . .  next chapter in current item"
 msgstr ""
 
-#: modules/control/rc.c:898
+#: modules/control/rc.c:918
 msgid "| chapter_p  . .  previous chapter in current item"
 msgstr ""
 
-#: modules/control/rc.c:900
+#: modules/control/rc.c:920
 msgid "| seek X . seek in seconds, for instance `seek 12'"
 msgstr ""
 
-#: modules/control/rc.c:901
+#: modules/control/rc.c:921
 msgid "| pause  . . . . . . . . . . . . . .  toggle pause"
 msgstr ""
 
-#: modules/control/rc.c:902
+#: modules/control/rc.c:922
 msgid "| fastforward  . . . . . .  .  set to maximum rate"
 msgstr ""
 
-#: modules/control/rc.c:903
+#: modules/control/rc.c:923
 msgid "| rewind  . . . . . . . . . .  set to minimum rate"
 msgstr ""
 
-#: modules/control/rc.c:904
+#: modules/control/rc.c:924
 msgid "| faster . . . . . . . .  faster playing of stream"
 msgstr ""
 
-#: modules/control/rc.c:905
+#: modules/control/rc.c:925
 msgid "| slower . . . . . . . .  slower playing of stream"
 msgstr ""
 
-#: modules/control/rc.c:906
+#: modules/control/rc.c:926
 msgid "| normal . . . . . . . .  normal playing of stream"
 msgstr ""
 
-#: modules/control/rc.c:907
+#: modules/control/rc.c:927
 msgid "| f [on|off] . . . . . . . . . . toggle fullscreen"
 msgstr ""
 
-#: modules/control/rc.c:908
+#: modules/control/rc.c:928
 msgid "| info . . .  information about the current stream"
 msgstr ""
 
-#: modules/control/rc.c:909
+#: modules/control/rc.c:929
 msgid "| get_time . . seconds elapsed since stream's beginning"
 msgstr ""
 
-#: modules/control/rc.c:910
+#: modules/control/rc.c:930
 msgid "| is_playing . .  1 if a stream plays, 0 otherwise"
 msgstr ""
 
-#: modules/control/rc.c:911
+#: modules/control/rc.c:931
 msgid "| get_title . . .  the title of the current stream"
 msgstr ""
 
-#: modules/control/rc.c:912
+#: modules/control/rc.c:932
 msgid "| get_length . .  the length of the current stream"
 msgstr ""
 
-#: modules/control/rc.c:914
+#: modules/control/rc.c:934
 msgid "| volume [X] . . . . . . . .  set/get audio volume"
 msgstr ""
 
-#: modules/control/rc.c:915
+#: modules/control/rc.c:935
 msgid "| volup [X]  . . . . .  raise audio volume X steps"
 msgstr ""
 
-#: modules/control/rc.c:916
+#: modules/control/rc.c:936
 msgid "| voldown [X]  . . . .  lower audio volume X steps"
 msgstr ""
 
-#: modules/control/rc.c:917
+#: modules/control/rc.c:937
 msgid "| adev [X] . . . . . . . . .  set/get audio device"
 msgstr ""
 
-#: modules/control/rc.c:918
+#: modules/control/rc.c:938
 msgid "| achan [X]. . . . . . . .  set/get audio channels"
 msgstr ""
 
-#: modules/control/rc.c:919
+#: modules/control/rc.c:939
+msgid "| atrack [X] . . . . . . . . . set/get audio track"
+msgstr ""
+
+#: modules/control/rc.c:940
+msgid "| vtrack [X] . . . . . . . . . set/get video track"
+msgstr ""
+
+#: modules/control/rc.c:941
+msgid "| vratio [X]  . . . . . set/get video aspect ratio"
+msgstr ""
+
+#: modules/control/rc.c:942
+msgid "| vcrop [X]  . . . . . . . . .  set/get video crop"
+msgstr ""
+
+#: modules/control/rc.c:943
+msgid "| vzoom [X]  . . . . . . . . .  set/get video zoom"
+msgstr ""
+
+#: modules/control/rc.c:944
+msgid "| strack [X] . . . . . . . set/get subtitles track"
+msgstr ""
+
+#: modules/control/rc.c:945
 msgid "| menu [on|off|up|down|left|right|select] use menu"
 msgstr ""
 
-#: modules/control/rc.c:924
+#: modules/control/rc.c:950
 msgid "| marq-marquee STRING  . . overlay STRING in video"
 msgstr ""
 
-#: modules/control/rc.c:925
+#: modules/control/rc.c:951
 msgid "| marq-x X . . . . . . . . . . . .offset from left"
 msgstr ""
 
-#: modules/control/rc.c:926
+#: modules/control/rc.c:952
 msgid "| marq-y Y . . . . . . . . . . . . offset from top"
 msgstr ""
 
-#: modules/control/rc.c:927
+#: modules/control/rc.c:953
 msgid "| marq-position #. . .  .relative position control"
 msgstr ""
 
-#: modules/control/rc.c:928
+#: modules/control/rc.c:954
 msgid "| marq-color # . . . . . . . . . . font color, RGB"
 msgstr ""
 
-#: modules/control/rc.c:929
+#: modules/control/rc.c:955
 msgid "| marq-opacity # . . . . . . . . . . . . . opacity"
 msgstr ""
 
-#: modules/control/rc.c:930
+#: modules/control/rc.c:956
 msgid "| marq-timeout T. . . . . . . . . . timeout, in ms"
 msgstr ""
 
-#: modules/control/rc.c:931
+#: modules/control/rc.c:957
 msgid "| marq-size # . . . . . . . . font size, in pixels"
 msgstr ""
 
-#: modules/control/rc.c:933
+#: modules/control/rc.c:959
 msgid "| time-format STRING . . . overlay STRING in video"
 msgstr ""
 
-#: modules/control/rc.c:934
+#: modules/control/rc.c:960
 msgid "| time-x X . . . . . . . . . . . .offset from left"
 msgstr ""
 
-#: modules/control/rc.c:935
+#: modules/control/rc.c:961
 msgid "| time-y Y . . . . . . . . . . . . offset from top"
 msgstr ""
 
-#: modules/control/rc.c:936
+#: modules/control/rc.c:962
 msgid "| time-position #. . . . . . . . relative position"
 msgstr ""
 
-#: modules/control/rc.c:937
+#: modules/control/rc.c:963
 msgid "| time-color # . . . . . . . . . . font color, RGB"
 msgstr ""
 
-#: modules/control/rc.c:938
+#: modules/control/rc.c:964
 msgid "| time-opacity # . . . . . . . . . . . . . opacity"
 msgstr ""
 
-#: modules/control/rc.c:939
+#: modules/control/rc.c:965
 msgid "| time-size # . . . . . . . . font size, in pixels"
 msgstr ""
 
-#: modules/control/rc.c:941
+#: modules/control/rc.c:967
 msgid "| logo-file STRING . . .the overlay file path/name"
 msgstr ""
 
-#: modules/control/rc.c:942
+#: modules/control/rc.c:968
 msgid "| logo-x X . . . . . . . . . . . .offset from left"
 msgstr ""
 
-#: modules/control/rc.c:943
+#: modules/control/rc.c:969
 msgid "| logo-y Y . . . . . . . . . . . . offset from top"
 msgstr ""
 
-#: modules/control/rc.c:944
+#: modules/control/rc.c:970
 msgid "| logo-position #. . . . . . . . relative position"
 msgstr ""
 
-#: modules/control/rc.c:945
+#: modules/control/rc.c:971
 msgid "| logo-transparency #. . . . . . . . .transparency"
 msgstr ""
 
-#: modules/control/rc.c:947
+#: modules/control/rc.c:973
 msgid "| mosaic-alpha # . . . . . . . . . . . . . . alpha"
 msgstr ""
 
-#: modules/control/rc.c:948
+#: modules/control/rc.c:974
 msgid "| mosaic-height #. . . . . . . . . . . . . .height"
 msgstr ""
 
-#: modules/control/rc.c:949
+#: modules/control/rc.c:975
 msgid "| mosaic-width # . . . . . . . . . . . . . . width"
 msgstr ""
 
-#: modules/control/rc.c:950
+#: modules/control/rc.c:976
 msgid "| mosaic-xoffset # . . . .top left corner position"
 msgstr ""
 
-#: modules/control/rc.c:951
+#: modules/control/rc.c:977
 msgid "| mosaic-yoffset # . . . .top left corner position"
 msgstr ""
 
-#: modules/control/rc.c:952
+#: modules/control/rc.c:978
 msgid "| mosaic-align 0..2,4..6,8..10. . .mosaic alignment"
 msgstr ""
 
-#: modules/control/rc.c:953
+#: modules/control/rc.c:979
 msgid "| mosaic-vborder # . . . . . . . . vertical border"
 msgstr ""
 
-#: modules/control/rc.c:954
+#: modules/control/rc.c:980
 msgid "| mosaic-hborder # . . . . . . . horizontal border"
 msgstr ""
 
-#: modules/control/rc.c:955
+#: modules/control/rc.c:981
 msgid "| mosaic-position {0=auto,1=fixed} . . . .position"
 msgstr ""
 
-#: modules/control/rc.c:956
+#: modules/control/rc.c:982
 msgid "| mosaic-rows #. . . . . . . . . . .number of rows"
 msgstr ""
 
-#: modules/control/rc.c:957
+#: modules/control/rc.c:983
 msgid "| mosaic-cols #. . . . . . . . . . .number of cols"
 msgstr ""
 
-#: modules/control/rc.c:958
+#: modules/control/rc.c:984
 msgid "| mosaic-keep-aspect-ratio {0,1} . . .aspect ratio"
 msgstr ""
 
-#: modules/control/rc.c:960
+#: modules/control/rc.c:986
 msgid ""
 "| check-updates [newer] [equal] [older]\n"
 "|               [undef] [info] [source] [binary] [plugin]"
 msgstr ""
 
-#: modules/control/rc.c:964
+#: modules/control/rc.c:990
 msgid "| help . . . . . . . . . . . . . this help message"
 msgstr ""
 
-#: modules/control/rc.c:965
+#: modules/control/rc.c:991
 msgid "| longhelp . . . . . . . . . a longer help message"
 msgstr ""
 
-#: modules/control/rc.c:966
+#: modules/control/rc.c:992
 msgid "| logout . . . . .  exit (if in socket connection)"
 msgstr ""
 
-#: modules/control/rc.c:967
+#: modules/control/rc.c:993
 msgid "| quit . . . . . . . . . . . . . . . . .  quit vlc"
 msgstr ""
 
-#: modules/control/rc.c:969
+#: modules/control/rc.c:995
 msgid "+----[ end of help ]"
 msgstr ""
 
-#: modules/control/rc.c:1076
+#: modules/control/rc.c:1102
 msgid "Press menu select or pause to continue."
 msgstr ""
 
-#: modules/control/rc.c:1244 modules/control/rc.c:1731
-#: modules/control/rc.c:1801 modules/control/rc.c:1850
-#: modules/control/rc.c:1949
+#: modules/control/rc.c:1345 modules/control/rc.c:1844
+#: modules/control/rc.c:1914 modules/control/rc.c:2083
+#: modules/control/rc.c:2182
 msgid "Type 'menu select' or 'pause' to continue."
 msgstr ""
 
-#: modules/control/rc.c:1391
+#: modules/control/rc.c:1504
 msgid "Type 'pause' to continue."
 msgstr ""
 
-#: modules/control/rc.c:1934 modules/control/rc.c:1973
+#: modules/control/rc.c:2167 modules/control/rc.c:2206
 msgid "Please provide one of the following parameters:"
 msgstr ""
 
@@ -8447,7 +8567,7 @@
 #: modules/gui/macosx/open.m:180 modules/gui/macosx/output.m:147
 #: modules/gui/wxwidgets/dialogs/open.cpp:830
 #: modules/gui/wxwidgets/dialogs/open.cpp:857
-#: modules/gui/wxwidgets/dialogs/streamout.cpp:531 modules/stream_out/rtp.c:80
+#: modules/gui/wxwidgets/dialogs/streamout.cpp:531 modules/stream_out/rtp.c:81
 msgid "Port"
 msgstr ""
 
@@ -8563,72 +8683,70 @@
 msgid "FLAC demuxer"
 msgstr ""
 
-#: modules/demux/live555.cpp:63 modules/demux/livedotcom.cpp:63
+#: modules/demux/live555.cpp:64
 msgid ""
 "Allows you to modify the default caching value for RTSP streams. This value "
 "should be set in millisecond units."
 msgstr ""
 
-#: modules/demux/live555.cpp:66 modules/demux/livedotcom.cpp:66
+#: modules/demux/live555.cpp:67
 msgid "Kasenna RTSP dialect"
 msgstr ""
 
-#: modules/demux/live555.cpp:67 modules/demux/livedotcom.cpp:67
+#: modules/demux/live555.cpp:68
 msgid ""
 "Kasenna servers use an old and unstandard dialect of RTSP. When you set this "
 "parameter, VLC will try this dialect for communication. In this mode you "
 "cannot connect to normal RTSP servers."
 msgstr ""
 
-#: modules/demux/live555.cpp:71 modules/demux/livedotcom.cpp:71
+#: modules/demux/live555.cpp:72
 msgid "RTSP user name"
 msgstr ""
 
-#: modules/demux/live555.cpp:72 modules/demux/livedotcom.cpp:72
+#: modules/demux/live555.cpp:73
 msgid ""
 "Allows you to modify the user name that will be used for authenticating the "
 "connection."
 msgstr ""
 
-#: modules/demux/live555.cpp:74 modules/demux/livedotcom.cpp:74
+#: modules/demux/live555.cpp:75
 msgid "RTSP password"
 msgstr ""
 
-#: modules/demux/live555.cpp:75 modules/demux/livedotcom.cpp:75
+#: modules/demux/live555.cpp:76
 msgid "Allows you to modify the password that will be used for the connection."
 msgstr ""
 
-#: modules/demux/live555.cpp:79 modules/demux/livedotcom.cpp:79
+#: modules/demux/live555.cpp:80
 msgid "RTP/RTSP/SDP demuxer (using Live555)"
 msgstr ""
 
-#: modules/demux/live555.cpp:89 modules/demux/livedotcom.cpp:89
+#: modules/demux/live555.cpp:90
 msgid "RTSP/RTP access and demux"
 msgstr ""
 
-#: modules/demux/live555.cpp:95 modules/demux/live555.cpp:96
-#: modules/demux/livedotcom.cpp:95 modules/demux/livedotcom.cpp:96
+#: modules/demux/live555.cpp:96 modules/demux/live555.cpp:97
 msgid "Use RTP over RTSP (TCP)"
 msgstr ""
 
-#: modules/demux/live555.cpp:98 modules/demux/livedotcom.cpp:98
+#: modules/demux/live555.cpp:99
 msgid "Client port"
 msgstr ""
 
-#: modules/demux/live555.cpp:99 modules/demux/livedotcom.cpp:99
+#: modules/demux/live555.cpp:100
 msgid "Port to use for the RTP source of the session"
 msgstr ""
 
-#: modules/demux/live555.cpp:102 modules/demux/live555.cpp:103
-#: modules/demux/livedotcom.cpp:102 modules/demux/livedotcom.cpp:103
+#: modules/demux/live555.cpp:103 modules/demux/live555.cpp:104
 msgid "Tunnel RTSP and RTP over HTTP"
 msgstr ""
 
-#: modules/demux/live555.cpp:105 modules/demux/livedotcom.cpp:105
+#: modules/demux/live555.cpp:106
 msgid "HTTP tunnel port"
 msgstr ""
 
-#: modules/demux/live555.cpp:106 modules/demux/livedotcom.cpp:106
+#: modules/demux/live555.cpp:107
 msgid "Port to use for tunneling the RTSP/RTP over HTTP."
 msgstr ""
 
@@ -8712,15 +8830,15 @@
 msgid "----- Title"
 msgstr ""
 
-#: modules/demux/mkv.cpp:4940
+#: modules/demux/mkv.cpp:4939
 msgid "Segment filename"
 msgstr ""
 
-#: modules/demux/mkv.cpp:4944
+#: modules/demux/mkv.cpp:4943
 msgid "Muxing application"
 msgstr ""
 
-#: modules/demux/mkv.cpp:4948
+#: modules/demux/mkv.cpp:4947
 msgid "Writing application"
 msgstr ""
 
@@ -8802,7 +8920,7 @@
 msgid "Surround delay (ms)"
 msgstr ""
 
-#: modules/demux/mp4/mp4.c:51
+#: modules/demux/mp4/mp4.c:52
 msgid "MP4 stream demuxer"
 msgstr ""
 
@@ -9478,28 +9596,28 @@
 
 #: modules/gui/beos/InterfaceWindow.cpp:159 modules/gui/macosx/bookmarks.m:107
 #: modules/gui/macosx/controls.m:49 modules/gui/macosx/interaction.m:121
-#: modules/gui/macosx/open.m:158 modules/gui/macosx/playlistinfo.m:60
-#: modules/gui/macosx/prefs.m:122 modules/gui/macosx/prefs.m:142
-#: modules/gui/macosx/wizard.m:363
+#: modules/gui/macosx/interaction.m:179 modules/gui/macosx/open.m:158
+#: modules/gui/macosx/playlistinfo.m:60 modules/gui/macosx/prefs.m:122
+#: modules/gui/macosx/prefs.m:142 modules/gui/macosx/wizard.m:363
 msgid "Cancel"
 msgstr ""
 
 #: modules/gui/beos/InterfaceWindow.cpp:159 modules/gui/macosx/open.m:440
 #: modules/gui/macosx/open.m:634 modules/gui/macosx/open.m:738
 #: modules/gui/macosx/open.m:784 modules/gui/wxwidgets/interface.cpp:675
-#: modules/gui/wxwidgets/interface.cpp:686 modules/gui/wxwidgets/menus.cpp:348
-#: modules/gui/wxwidgets/menus.cpp:404
+#: modules/gui/wxwidgets/interface.cpp:686 modules/gui/wxwidgets/menus.cpp:349
+#: modules/gui/wxwidgets/menus.cpp:405
 msgid "Open"
 msgstr ""
 
 #: modules/gui/beos/InterfaceWindow.cpp:225
-#: modules/gui/beos/InterfaceWindow.cpp:326 modules/gui/macosx/prefs.m:120
+#: modules/gui/beos/InterfaceWindow.cpp:328 modules/gui/macosx/prefs.m:120
 #: modules/gui/wxwidgets/dialogs/preferences.cpp:184
 msgid "Preferences"
 msgstr ""
 
 #: modules/gui/beos/InterfaceWindow.cpp:235
-#: modules/gui/beos/InterfaceWindow.cpp:324 modules/gui/macosx/intf.m:501
+#: modules/gui/beos/InterfaceWindow.cpp:326 modules/gui/macosx/intf.m:501
 #: modules/gui/macosx/intf.m:598 modules/gui/wxwidgets/dialogs/messages.cpp:47
 msgid "Messages"
 msgstr ""
@@ -9551,7 +9669,7 @@
 msgid "Window"
 msgstr ""
 
-#: modules/gui/beos/InterfaceWindow.cpp:398 modules/gui/macosx/bookmarks.m:106
+#: modules/gui/beos/InterfaceWindow.cpp:400 modules/gui/macosx/bookmarks.m:106
 #: modules/gui/macosx/bookmarks.m:233 modules/gui/macosx/bookmarks.m:241
 #: modules/gui/macosx/bookmarks.m:292 modules/gui/macosx/bookmarks.m:302
 #: modules/gui/macosx/controls.m:50 modules/gui/macosx/extended.m:602
@@ -9568,11 +9686,11 @@
 msgid "OK"
 msgstr ""
 
-#: modules/gui/beos/InterfaceWindow.cpp:406
+#: modules/gui/beos/InterfaceWindow.cpp:408
 msgid "VLC media player: Open Media Files"
 msgstr ""
 
-#: modules/gui/beos/InterfaceWindow.cpp:410
+#: modules/gui/beos/InterfaceWindow.cpp:412
 msgid "VLC media player: Open Subtitle File"
 msgstr ""
 
@@ -9596,7 +9714,7 @@
 msgstr ""
 
 #: modules/gui/beos/PlayListWindow.cpp:103 modules/gui/macosx/intf.m:531
-#: modules/gui/macosx/playlist.m:484
+#: modules/gui/macosx/playlist.m:481
 msgid "Select All"
 msgstr ""
 
@@ -9650,7 +9768,7 @@
 msgstr ""
 
 #: modules/gui/beos/PreferencesWindow.cpp:254 modules/gui/macosx/output.m:526
-#: modules/gui/macosx/playlist.m:780 modules/gui/macosx/prefs.m:121
+#: modules/gui/macosx/playlist.m:777 modules/gui/macosx/prefs.m:121
 msgid "Save"
 msgstr ""
 
@@ -9730,7 +9848,7 @@
 msgid "Time"
 msgstr ""
 
-#: modules/gui/macosx/bookmarks.m:136 modules/gui/macosx/playlist.m:776
+#: modules/gui/macosx/bookmarks.m:136 modules/gui/macosx/playlist.m:773
 msgid "Untitled"
 msgstr ""
 
@@ -9772,7 +9890,7 @@
 msgid "The stream must be playing or paused for bookmarks to work."
 msgstr ""
 
-#: modules/gui/macosx/controls.m:48 modules/gui/macosx/controls.m:735
+#: modules/gui/macosx/controls.m:48 modules/gui/macosx/controls.m:741
 msgid "Jump To Time"
 msgstr ""
 
@@ -9788,64 +9906,64 @@
 msgid "Random On"
 msgstr ""
 
-#: modules/gui/macosx/controls.m:167
+#: modules/gui/macosx/controls.m:168
 msgid "Random Off"
 msgstr ""
 
-#: modules/gui/macosx/controls.m:195 modules/gui/macosx/controls.m:719
-#: modules/gui/macosx/intf.m:541 modules/gui/macosx/playlist.m:499
-#: modules/gui/macosx/playlist.m:1243
+#: modules/gui/macosx/controls.m:197 modules/gui/macosx/controls.m:725
+#: modules/gui/macosx/intf.m:541 modules/gui/macosx/playlist.m:496
+#: modules/gui/macosx/playlist.m:1240
 #: modules/gui/wxwidgets/dialogs/playlist.cpp:54
 msgid "Repeat One"
 msgstr ""
 
-#: modules/gui/macosx/controls.m:199 modules/gui/macosx/controls.m:231
-#: modules/gui/macosx/playlist.m:1262
+#: modules/gui/macosx/controls.m:202 modules/gui/macosx/controls.m:236
+#: modules/gui/macosx/playlist.m:1259
 msgid "Repeat Off"
 msgstr ""
 
-#: modules/gui/macosx/controls.m:227 modules/gui/macosx/controls.m:726
-#: modules/gui/macosx/intf.m:542 modules/gui/macosx/playlist.m:500
-#: modules/gui/macosx/playlist.m:1251
+#: modules/gui/macosx/controls.m:231 modules/gui/macosx/controls.m:732
+#: modules/gui/macosx/intf.m:542 modules/gui/macosx/playlist.m:497
+#: modules/gui/macosx/playlist.m:1248
 #: modules/gui/wxwidgets/dialogs/playlist.cpp:53
 msgid "Repeat All"
 msgstr ""
 
-#: modules/gui/macosx/controls.m:308 modules/gui/macosx/controls.m:749
+#: modules/gui/macosx/controls.m:314 modules/gui/macosx/controls.m:755
 #: modules/gui/macosx/intf.m:567
 msgid "Half Size"
 msgstr ""
 
-#: modules/gui/macosx/controls.m:310 modules/gui/macosx/controls.m:750
+#: modules/gui/macosx/controls.m:316 modules/gui/macosx/controls.m:756
 #: modules/gui/macosx/intf.m:568
 msgid "Normal Size"
 msgstr ""
 
-#: modules/gui/macosx/controls.m:312 modules/gui/macosx/controls.m:751
+#: modules/gui/macosx/controls.m:318 modules/gui/macosx/controls.m:757
 #: modules/gui/macosx/intf.m:569
 msgid "Double Size"
 msgstr ""
 
-#: modules/gui/macosx/controls.m:314 modules/gui/macosx/controls.m:755
-#: modules/gui/macosx/controls.m:766 modules/gui/macosx/intf.m:572
+#: modules/gui/macosx/controls.m:320 modules/gui/macosx/controls.m:761
+#: modules/gui/macosx/controls.m:772 modules/gui/macosx/intf.m:572
 msgid "Float on Top"
 msgstr ""
 
-#: modules/gui/macosx/controls.m:316 modules/gui/macosx/controls.m:752
+#: modules/gui/macosx/controls.m:322 modules/gui/macosx/controls.m:758
 #: modules/gui/macosx/intf.m:570
 msgid "Fit to Screen"
 msgstr ""
 
-#: modules/gui/macosx/controls.m:712 modules/gui/macosx/intf.m:540
-#: modules/gui/macosx/playlist.m:493
+#: modules/gui/macosx/controls.m:718 modules/gui/macosx/intf.m:540
+#: modules/gui/macosx/playlist.m:490
 msgid "Random"
 msgstr ""
 
-#: modules/gui/macosx/controls.m:733 modules/gui/macosx/intf.m:543
+#: modules/gui/macosx/controls.m:739 modules/gui/macosx/intf.m:543
 msgid "Step Forward"
 msgstr ""
 
-#: modules/gui/macosx/controls.m:734 modules/gui/macosx/intf.m:544
+#: modules/gui/macosx/controls.m:740 modules/gui/macosx/intf.m:544
 msgid "Step Backward"
 msgstr ""
 
@@ -9861,26 +9979,26 @@
 #: modules/gui/macosx/embeddedwindow.m:45
 #: modules/gui/macosx/embeddedwindow.m:72 modules/gui/macosx/intf.m:491
 #: modules/gui/macosx/intf.m:534 modules/gui/macosx/intf.m:612
-#: modules/gui/macosx/intf.m:619 modules/gui/macosx/intf.m:1396
-#: modules/gui/macosx/intf.m:1397 modules/gui/macosx/intf.m:1398
-#: modules/gui/macosx/playlist.m:481 modules/gui/pda/pda_interface.c:262
-#: modules/gui/pda/pda_interface.c:263
+#: modules/gui/macosx/intf.m:619 modules/gui/macosx/intf.m:1412
+#: modules/gui/macosx/intf.m:1413 modules/gui/macosx/intf.m:1414
+#: modules/gui/macosx/intf.m:1415 modules/gui/macosx/playlist.m:478
+#: modules/gui/pda/pda_interface.c:262 modules/gui/pda/pda_interface.c:263
 #: modules/gui/wxwidgets/dialogs/playlist.cpp:274
 #: modules/gui/wxwidgets/dialogs/playlist.cpp:283
 #: modules/gui/wxwidgets/interface.cpp:677
 #: modules/gui/wxwidgets/interface.cpp:688
 #: modules/gui/wxwidgets/interface.cpp:1216
-#: modules/gui/wxwidgets/menus.cpp:263 modules/gui/wxwidgets/menus.cpp:274
+#: modules/gui/wxwidgets/menus.cpp:264 modules/gui/wxwidgets/menus.cpp:275
 msgid "Play"
 msgstr ""
 
-#: modules/gui/macosx/embeddedwindow.m:66 modules/gui/macosx/intf.m:1388
-#: modules/gui/macosx/intf.m:1389 modules/gui/macosx/intf.m:1390
-#: modules/gui/pda/pda_interface.c:250 modules/gui/pda/pda_interface.c:251
-#: modules/gui/wxwidgets/interface.cpp:678
+#: modules/gui/macosx/embeddedwindow.m:66 modules/gui/macosx/intf.m:1403
+#: modules/gui/macosx/intf.m:1404 modules/gui/macosx/intf.m:1405
+#: modules/gui/macosx/intf.m:1406 modules/gui/pda/pda_interface.c:250
+#: modules/gui/pda/pda_interface.c:251 modules/gui/wxwidgets/interface.cpp:678
 #: modules/gui/wxwidgets/interface.cpp:689
 #: modules/gui/wxwidgets/interface.cpp:1210
-#: modules/gui/wxwidgets/menus.cpp:265 modules/visualization/xosd.c:243
+#: modules/gui/wxwidgets/menus.cpp:266 modules/visualization/xosd.c:243
 msgid "Pause"
 msgstr ""
 
@@ -10022,12 +10140,25 @@
 "can be set in the Preferences, Video / Filters section."
 msgstr ""
 
+#: modules/gui/macosx/interaction.m:125 modules/gui/macosx/intf.m:630
+#: modules/gui/wxwidgets/dialogs/wizard.cpp:81
+msgid "Error"
+msgstr ""
+
+#: modules/gui/macosx/interaction.m:178
+msgid "Yes"
+msgstr ""
+
+#: modules/gui/macosx/interaction.m:178
+msgid "No"
+msgstr ""
+
 #: modules/gui/macosx/intf.m:485
 msgid "VLC - Controller"
 msgstr ""
 
-#: modules/gui/macosx/intf.m:486 modules/gui/macosx/intf.m:975
-#: modules/gui/macosx/intf.m:1297 modules/gui/pda/pda_interface.c:212
+#: modules/gui/macosx/intf.m:486 modules/gui/macosx/intf.m:990
+#: modules/gui/macosx/intf.m:1312 modules/gui/pda/pda_interface.c:212
 #: modules/gui/pda/pda_interface.c:1355
 msgid "VLC media player"
 msgstr ""
@@ -10088,7 +10219,7 @@
 msgid "Open Recent"
 msgstr ""
 
-#: modules/gui/macosx/intf.m:523 modules/gui/macosx/intf.m:1936
+#: modules/gui/macosx/intf.m:523 modules/gui/macosx/intf.m:1953
 msgid "Clear Menu"
 msgstr ""
 
@@ -10142,8 +10273,8 @@
 msgstr ""
 
 #: modules/gui/macosx/intf.m:597 modules/gui/macosx/intf.m:639
-#: modules/gui/macosx/playlistinfo.m:55 modules/gui/macosx/playlistinfo.m:371
-#: modules/gui/macosx/playlist.m:485
+#: modules/gui/macosx/playlist.m:482 modules/gui/macosx/playlistinfo.m:55
+#: modules/gui/macosx/playlistinfo.m:371
 msgid "Information"
 msgstr ""
 
@@ -10183,10 +10314,6 @@
 msgid "Online Forum"
 msgstr ""
 
-#: modules/gui/macosx/intf.m:630 modules/gui/wxwidgets/dialogs/wizard.cpp:81
-msgid "Error"
-msgstr ""
-
 #: modules/gui/macosx/intf.m:631
 msgid ""
 "An error has occurred which probably prevented the proper execution of the "
@@ -10209,16 +10336,16 @@
 msgid "Do not display further errors"
 msgstr ""
 
-#: modules/gui/macosx/intf.m:1152
+#: modules/gui/macosx/intf.m:1167
 #, c-format
 msgid "Volume: %d%%"
 msgstr ""
 
-#: modules/gui/macosx/intf.m:1803
+#: modules/gui/macosx/intf.m:1820
 msgid "No CrashLog found"
 msgstr ""
 
-#: modules/gui/macosx/intf.m:1803
+#: modules/gui/macosx/intf.m:1820
 msgid "Couldn't find any trace of a previous crash."
 msgstr ""
 
@@ -10492,6 +10619,84 @@
 msgid "Save File"
 msgstr ""
 
+#: modules/gui/macosx/playlist.m:477
+msgid "Save Playlist..."
+msgstr ""
+
+#: modules/gui/macosx/playlist.m:479 modules/gui/pda/pda_interface.c:1254
+#: modules/gui/wxwidgets/dialogs/playlist.cpp:278
+#: modules/gui/wxwidgets/dialogs/playlist.cpp:285
+#: modules/gui/wxwidgets/dialogs/vlm/vlm_streampanel.cpp:105
+msgid "Delete"
+msgstr ""
+
+#: modules/gui/macosx/playlist.m:480
+msgid "Expand Node"
+msgstr ""
+
+#: modules/gui/macosx/playlist.m:483
+msgid "Get Stream Information"
+msgstr ""
+
+#: modules/gui/macosx/playlist.m:484
+msgid "Sort Node by Name"
+msgstr ""
+
+#: modules/gui/macosx/playlist.m:485
+msgid "Sort Node by Author"
+msgstr ""
+
+#: modules/gui/macosx/playlist.m:488 modules/gui/macosx/playlist.m:538
+#: modules/gui/macosx/playlist.m:1587
+msgid "No items in the playlist"
+msgstr ""
+
+#: modules/gui/macosx/playlist.m:492
+#: modules/gui/wxwidgets/dialogs/playlist.cpp:323
+msgid "Search"
+msgstr ""
+
+#: modules/gui/macosx/playlist.m:494
+msgid "Search in Playlist"
+msgstr ""
+
+#: modules/gui/macosx/playlist.m:495
+msgid "Standard Play"
+msgstr ""
+
+#: modules/gui/macosx/playlist.m:498
+msgid "Add Folder to Playlist"
+msgstr ""
+
+#: modules/gui/macosx/playlist.m:500
+msgid "File Format:"
+msgstr ""
+
+#: modules/gui/macosx/playlist.m:501
+msgid "Extended M3U"
+msgstr ""
+
+#: modules/gui/macosx/playlist.m:502
+msgid "XML Shareable Playlist Format (XSPF)"
+msgstr ""
+
+#: modules/gui/macosx/playlist.m:532 modules/gui/macosx/playlist.m:1581
+#, c-format
+msgid "%i items in the playlist"
+msgstr ""
+
+#: modules/gui/macosx/playlist.m:542 modules/gui/macosx/playlist.m:1591
+msgid "1 item in the playlist"
+msgstr ""
+
+#: modules/gui/macosx/playlist.m:776
+msgid "Save Playlist"
+msgstr ""
+
+#: modules/gui/macosx/playlist.m:1556
+msgid "Empty Folder"
+msgstr ""
+
 #: modules/gui/macosx/playlistinfo.m:56
 #: modules/gui/wxwidgets/dialogs/infopanels.cpp:63
 #: modules/gui/wxwidgets/dialogs/wizard.cpp:591
@@ -10557,118 +10762,40 @@
 msgid "Lost buffers"
 msgstr ""
 
-#: modules/gui/macosx/playlist.m:480
-msgid "Save Playlist..."
+#: modules/gui/macosx/prefs.m:123
+#: modules/gui/wxwidgets/dialogs/preferences.cpp:213
+msgid "Reset All"
 msgstr ""
 
-#: modules/gui/macosx/playlist.m:482 modules/gui/pda/pda_interface.c:1254
-#: modules/gui/wxwidgets/dialogs/playlist.cpp:278
-#: modules/gui/wxwidgets/dialogs/playlist.cpp:285
-#: modules/gui/wxwidgets/dialogs/vlm/vlm_streampanel.cpp:105
-msgid "Delete"
+#: modules/gui/macosx/prefs.m:142
+#: modules/gui/wxwidgets/dialogs/preferences.cpp:296
+msgid "Reset Preferences"
 msgstr ""
 
-#: modules/gui/macosx/playlist.m:483
-msgid "Expand Node"
+#: modules/gui/macosx/prefs.m:143
+msgid "Continue"
 msgstr ""
 
-#: modules/gui/macosx/playlist.m:486
-msgid "Get Stream Information"
+#: modules/gui/macosx/prefs.m:145
+msgid ""
+"Beware this will reset the VLC media player preferences.\n"
+"Are you sure you want to continue?"
 msgstr ""
 
-#: modules/gui/macosx/playlist.m:487
-msgid "Sort Node by Name"
+#: modules/gui/macosx/prefs.m:715
+msgid "Some options are hidden. Check \"Advanced\" to display them."
 msgstr ""
 
-#: modules/gui/macosx/playlist.m:488
-msgid "Sort Node by Author"
+#: modules/gui/macosx/prefs_widgets.m:1222
+msgid "Select a directory"
 msgstr ""
 
-#: modules/gui/macosx/playlist.m:491 modules/gui/macosx/playlist.m:541
-#: modules/gui/macosx/playlist.m:1590
-msgid "No items in the playlist"
+#: modules/gui/macosx/prefs_widgets.m:1222
+msgid "Select a file"
 msgstr ""
 
-#: modules/gui/macosx/playlist.m:495
-#: modules/gui/wxwidgets/dialogs/playlist.cpp:323
-msgid "Search"
-msgstr ""
-
-#: modules/gui/macosx/playlist.m:497
-msgid "Search in Playlist"
-msgstr ""
-
-#: modules/gui/macosx/playlist.m:498
-msgid "Standard Play"
-msgstr ""
-
-#: modules/gui/macosx/playlist.m:501
-msgid "Add Folder to Playlist"
-msgstr ""
-
-#: modules/gui/macosx/playlist.m:503
-msgid "File Format:"
-msgstr ""
-
-#: modules/gui/macosx/playlist.m:504
-msgid "Extended M3U"
-msgstr ""
-
-#: modules/gui/macosx/playlist.m:505
-msgid "XML Shareable Playlist Format (XSPF)"
-msgstr ""
-
-#: modules/gui/macosx/playlist.m:535 modules/gui/macosx/playlist.m:1584
-#, c-format
-msgid "%i items in the playlist"
-msgstr ""
-
-#: modules/gui/macosx/playlist.m:545 modules/gui/macosx/playlist.m:1594
-msgid "1 item in the playlist"
-msgstr ""
-
-#: modules/gui/macosx/playlist.m:779
-msgid "Save Playlist"
-msgstr ""
-
-#: modules/gui/macosx/playlist.m:1559
-msgid "Empty Folder"
-msgstr ""
-
-#: modules/gui/macosx/prefs.m:123
-#: modules/gui/wxwidgets/dialogs/preferences.cpp:213
-msgid "Reset All"
-msgstr ""
-
-#: modules/gui/macosx/prefs.m:142
-#: modules/gui/wxwidgets/dialogs/preferences.cpp:296
-msgid "Reset Preferences"
-msgstr ""
-
-#: modules/gui/macosx/prefs.m:143
-msgid "Continue"
-msgstr ""
-
-#: modules/gui/macosx/prefs.m:145
-msgid ""
-"Beware this will reset the VLC media player preferences.\n"
-"Are you sure you want to continue?"
-msgstr ""
-
-#: modules/gui/macosx/prefs.m:715
-msgid "Some options are hidden. Check \"Advanced\" to display them."
-msgstr ""
-
-#: modules/gui/macosx/prefs_widgets.m:1222
-msgid "Select a directory"
-msgstr ""
-
-#: modules/gui/macosx/prefs_widgets.m:1222
-msgid "Select a file"
-msgstr ""
-
-#: modules/gui/macosx/prefs_widgets.m:1223
-msgid "Select"
+#: modules/gui/macosx/prefs_widgets.m:1223
+msgid "Select"
 msgstr ""
 
 #: modules/gui/macosx/update.m:84
@@ -10958,7 +11085,7 @@
 msgstr ""
 
 #: modules/gui/macosx/wizard.m:407 modules/gui/macosx/wizard.m:462
-#: modules/gui/wxwidgets/dialogs/wizard.cpp:1052 modules/stream_out/rtp.c:49
+#: modules/gui/wxwidgets/dialogs/wizard.cpp:1052 modules/stream_out/rtp.c:50
 msgid "Destination"
 msgstr ""
 
@@ -11702,59 +11829,59 @@
 msgid "M3U file|*.m3u|XSPF playlist|*.xspf"
 msgstr ""
 
-#: modules/gui/skins2/src/skin_main.cpp:418
+#: modules/gui/skins2/src/skin_main.cpp:427
 msgid "Skin to use"
 msgstr ""
 
-#: modules/gui/skins2/src/skin_main.cpp:419
+#: modules/gui/skins2/src/skin_main.cpp:428
 msgid "Path to the skin to use."
 msgstr ""
 
-#: modules/gui/skins2/src/skin_main.cpp:420
+#: modules/gui/skins2/src/skin_main.cpp:429
 msgid "Config of last used skin"
 msgstr ""
 
-#: modules/gui/skins2/src/skin_main.cpp:421
+#: modules/gui/skins2/src/skin_main.cpp:430
 msgid ""
 "Windows configuration of the last skin used. This option is updated "
 "automatically, do not touch it."
 msgstr ""
 
-#: modules/gui/skins2/src/skin_main.cpp:423
+#: modules/gui/skins2/src/skin_main.cpp:432
 #: modules/gui/wxwidgets/wxwidgets.cpp:101
 msgid "Systray icon"
 msgstr ""
 
-#: modules/gui/skins2/src/skin_main.cpp:424
+#: modules/gui/skins2/src/skin_main.cpp:433
 #: modules/gui/wxwidgets/wxwidgets.cpp:102
 msgid "Show a systray icon for VLC"
 msgstr ""
 
-#: modules/gui/skins2/src/skin_main.cpp:425
-#: modules/gui/skins2/src/skin_main.cpp:426
+#: modules/gui/skins2/src/skin_main.cpp:434
+#: modules/gui/skins2/src/skin_main.cpp:435
 #: modules/gui/wxwidgets/wxwidgets.cpp:95
 msgid "Show VLC on the taskbar"
 msgstr ""
 
-#: modules/gui/skins2/src/skin_main.cpp:427
+#: modules/gui/skins2/src/skin_main.cpp:436
 msgid "Enable transparency effects"
 msgstr ""
 
-#: modules/gui/skins2/src/skin_main.cpp:428
+#: modules/gui/skins2/src/skin_main.cpp:437
 msgid ""
 "You can disable all transparency effects if you want. This is mainly useful "
 "when moving windows does not behave correctly."
 msgstr ""
 
-#: modules/gui/skins2/src/skin_main.cpp:452
+#: modules/gui/skins2/src/skin_main.cpp:461
 msgid "Skins"
 msgstr ""
 
-#: modules/gui/skins2/src/skin_main.cpp:453
+#: modules/gui/skins2/src/skin_main.cpp:462
 msgid "Skinnable Interface"
 msgstr ""
 
-#: modules/gui/skins2/src/skin_main.cpp:460
+#: modules/gui/skins2/src/skin_main.cpp:469
 msgid "Skins loader demux"
 msgstr ""
 
@@ -11835,6 +11962,11 @@
 msgid "WinCE dialogs provider"
 msgstr ""
 
+#: modules/gui/wxwidgets/dialogs.cpp:433
+#: modules/gui/wxwidgets/dialogs/open.cpp:1267
+msgid "All Files (*.*)|*|Sound Files (*.mp3, *.ogg, etc.)|"
+msgstr ""
+
 #: modules/gui/wxwidgets/dialogs/bookmarks.cpp:75
 msgid "Edit bookmark"
 msgstr ""
@@ -11876,6 +12008,29 @@
 msgid "&Clear"
 msgstr ""
 
+#: modules/gui/wxwidgets/dialogs/bookmarks.cpp:169
+msgid "Adds a bookmark at the current position in the stream"
+msgstr ""
+
+#: modules/gui/wxwidgets/dialogs/bookmarks.cpp:170
+msgid "Removes the selected bookmarks"
+msgstr ""
+
+#: modules/gui/wxwidgets/dialogs/bookmarks.cpp:171
+msgid "Removes all the bookmarks for that stream"
+msgstr ""
+
+#: modules/gui/wxwidgets/dialogs/bookmarks.cpp:172
+msgid "Edit the properties of a bookmark"
+msgstr ""
+
+#: modules/gui/wxwidgets/dialogs/bookmarks.cpp:173
+msgid ""
+"If you select two or more bookmarks, this will launch the streaming/"
+"transcoding wizard to allow you to stream or save the part of the stream "
+"between these bookmarks"
+msgstr ""
+
 #: modules/gui/wxwidgets/dialogs/bookmarks.cpp:347
 msgid "You must select two bookmarks"
 msgstr ""
@@ -11899,11 +12054,6 @@
 msgid "Input has changed "
 msgstr ""
 
-#: modules/gui/wxwidgets/dialogs.cpp:433
-#: modules/gui/wxwidgets/dialogs/open.cpp:1267
-msgid "All Files (*.*)|*|Sound Files (*.mp3, *.ogg, etc.)|"
-msgstr ""
-
 #: modules/gui/wxwidgets/dialogs/fileinfo.cpp:54
 msgid "Stream and Media Info"
 msgstr ""
@@ -11912,6 +12062,14 @@
 msgid "Advanced information"
 msgstr ""
 
+#: modules/gui/wxwidgets/dialogs/fileinfo.cpp:93
+#: modules/gui/wxwidgets/dialogs/interaction.cpp:198
+#: modules/gui/wxwidgets/dialogs/messages.cpp:72
+#: modules/gui/wxwidgets/dialogs/playlist.cpp:246
+#: modules/gui/wxwidgets/dialogs/vlm/vlm_panel.cpp:76
+msgid "&Close"
+msgstr ""
+
 #: modules/gui/wxwidgets/dialogs/interaction.cpp:116
 msgid ""
 "The following errors occurred. More details might be available in the "
@@ -11930,13 +12088,6 @@
 msgid "Don't show further errors"
 msgstr ""
 
-#: modules/gui/wxwidgets/dialogs/interaction.cpp:198
-#: modules/gui/wxwidgets/dialogs/messages.cpp:72
-#: modules/gui/wxwidgets/dialogs/playlist.cpp:246
-#: modules/gui/wxwidgets/dialogs/vlm/vlm_panel.cpp:76
-msgid "&Close"
-msgstr ""
-
 #: modules/gui/wxwidgets/dialogs/iteminfo.cpp:58
 msgid "Playlist item info"
 msgstr ""
@@ -12318,7 +12469,7 @@
 msgstr ""
 
 #: modules/gui/wxwidgets/dialogs/streamout.cpp:474
-#: modules/stream_out/rtp.c:104
+#: modules/stream_out/rtp.c:105
 msgid "RTP"
 msgstr ""
 
@@ -12816,7 +12967,7 @@
 msgid "&Preferences..."
 msgstr ""
 
-#: modules/gui/wxwidgets/menus.cpp:572 modules/gui/wxwidgets/menus.cpp:599
+#: modules/gui/wxwidgets/menus.cpp:573 modules/gui/wxwidgets/menus.cpp:600
 msgid "Empty"
 msgstr ""
 
@@ -13245,56 +13396,56 @@
 msgid "Freetype2 font renderer"
 msgstr ""
 
-#: modules/misc/gnutls.c:67
+#: modules/misc/gnutls.c:62
 msgid "Diffie-Hellman prime bits"
 msgstr ""
 
-#: modules/misc/gnutls.c:69
+#: modules/misc/gnutls.c:64
 msgid ""
 "This allows you to modify the Diffie-Hellman prime's number of bits, used "
 "for TLS or SSL-based server-side encryption. This is generally not needed."
 msgstr ""
 
-#: modules/misc/gnutls.c:73
+#: modules/misc/gnutls.c:68
 msgid "Expiration time for resumed TLS sessions"
 msgstr ""
 
-#: modules/misc/gnutls.c:75
+#: modules/misc/gnutls.c:70
 msgid ""
 "It is possible to cache the resumed TLS sessions. This is the expiration "
 "time of the sessions stored in this cache, in seconds."
 msgstr ""
 
-#: modules/misc/gnutls.c:78
+#: modules/misc/gnutls.c:73
 msgid "Number of resumed TLS sessions"
 msgstr ""
 
-#: modules/misc/gnutls.c:80
+#: modules/misc/gnutls.c:75
 msgid ""
 "This is the maximum number of resumed TLS sessions that the cache will hold."
 msgstr ""
 
-#: modules/misc/gnutls.c:83
+#: modules/misc/gnutls.c:78
 msgid "Check TLS/SSL server certificate validity"
 msgstr ""
 
-#: modules/misc/gnutls.c:85
+#: modules/misc/gnutls.c:80
 msgid ""
 "This ensures that the server certificate is valid (i.e. signed by an "
 "approved Certification Authority)."
 msgstr ""
 
-#: modules/misc/gnutls.c:88
+#: modules/misc/gnutls.c:83
 msgid "Check TLS/SSL server hostname in certificate"
 msgstr ""
 
-#: modules/misc/gnutls.c:90
+#: modules/misc/gnutls.c:85
 msgid ""
 "This ensures that the server hostname in certificate matches the requested "
 "host name."
 msgstr ""
 
-#: modules/misc/gnutls.c:95
+#: modules/misc/gnutls.c:90
 msgid "GnuTLS TLS encryption layer"
 msgstr ""
 
@@ -13392,10 +13543,6 @@
 msgid "Output data for RRDTool in this file."
 msgstr ""
 
-#: modules/misc/memcpy/memcpyaltivec.c:56
-msgid "AltiVec memcpy"
-msgstr ""
-
 #: modules/misc/memcpy/memcpy.c:83
 msgid "libc memcpy"
 msgstr ""
@@ -13412,6 +13559,10 @@
 msgid "MMX EXT memcpy"
 msgstr ""
 
+#: modules/misc/memcpy/memcpyaltivec.c:56
+msgid "AltiVec memcpy"
+msgstr ""
+
 #: modules/misc/msn.c:64
 msgid "MSN Title format string"
 msgstr ""
@@ -14059,9 +14210,9 @@
 
 #: modules/stream_out/bridge.c:42
 msgid ""
-"Pictures coming from the picture video outputs will be delayed accord to thi "
-"value (in milliseconds, should be >= 100 ms). For high values, you will need "
-"to raise caching values."
+"Pictures coming from the picture video outputs will be delayed according to "
+"this value (in milliseconds, should be >= 100 ms). For high values, you will "
+"need to raise caching values."
 msgstr ""
 
 #: modules/stream_out/bridge.c:46
@@ -14218,15 +14369,15 @@
 msgid "Mosaic bridge stream output"
 msgstr ""
 
-#: modules/stream_out/rtp.c:51
+#: modules/stream_out/rtp.c:52
 msgid "This is the output URL that will be used."
 msgstr ""
 
-#: modules/stream_out/rtp.c:52
+#: modules/stream_out/rtp.c:53
 msgid "SDP"
 msgstr ""
 
-#: modules/stream_out/rtp.c:54
+#: modules/stream_out/rtp.c:55
 msgid ""
 "This allows you to specify how the SDP (Session Descriptor) for this RTP "
 "session will be made available. You must use an url: http://location to "
@@ -14234,92 +14385,92 @@
 "SDP to be announced via SAP."
 msgstr ""
 
-#: modules/stream_out/rtp.c:58
+#: modules/stream_out/rtp.c:59
 msgid "Muxer"
 msgstr ""
 
-#: modules/stream_out/rtp.c:60
+#: modules/stream_out/rtp.c:61
 msgid ""
 "This allows you to specify the muxer used for the streaming output. Default "
 "is to use no muxer (standard RTP stream)."
 msgstr ""
 
-#: modules/stream_out/rtp.c:63 modules/stream_out/standard.c:51
+#: modules/stream_out/rtp.c:64 modules/stream_out/standard.c:51
 msgid "Session name"
 msgstr ""
 
-#: modules/stream_out/rtp.c:65
+#: modules/stream_out/rtp.c:66
 msgid ""
 "This is the name of the session that will be announced in the SDP (Session "
 "Descriptor)."
 msgstr ""
 
-#: modules/stream_out/rtp.c:67
+#: modules/stream_out/rtp.c:68
 msgid "Session description"
 msgstr ""
 
-#: modules/stream_out/rtp.c:69
+#: modules/stream_out/rtp.c:70
 msgid ""
 "This allows you to give a broader description of the stream, that will be "
 "announced in the SDP (Session Descriptor)."
 msgstr ""
 
-#: modules/stream_out/rtp.c:71
+#: modules/stream_out/rtp.c:72
 msgid "Session URL"
 msgstr ""
 
-#: modules/stream_out/rtp.c:73
+#: modules/stream_out/rtp.c:74
 msgid ""
 "This allows you to give an URL with more details about the stream (often the "
 "website of the streaming organization), that will be announced in the SDP "
 "(Session Descriptor)."
 msgstr ""
 
-#: modules/stream_out/rtp.c:76
+#: modules/stream_out/rtp.c:77
 msgid "Session email"
 msgstr ""
 
-#: modules/stream_out/rtp.c:78
+#: modules/stream_out/rtp.c:79
 msgid ""
 "This allows you to give a contact mail address for the stream, that will be "
 "announced in the SDP (Session Descriptor)."
 msgstr ""
 
-#: modules/stream_out/rtp.c:82
+#: modules/stream_out/rtp.c:83
 msgid "This allows you to specify the base port for the RTP streaming."
 msgstr ""
 
-#: modules/stream_out/rtp.c:83
+#: modules/stream_out/rtp.c:84
 msgid "Audio port"
 msgstr ""
 
-#: modules/stream_out/rtp.c:85
+#: modules/stream_out/rtp.c:86
 msgid ""
 "This allows you to specify the default audio port for the RTP streaming."
 msgstr ""
 
-#: modules/stream_out/rtp.c:86
+#: modules/stream_out/rtp.c:87
 msgid "Video port"
 msgstr ""
 
-#: modules/stream_out/rtp.c:88
+#: modules/stream_out/rtp.c:89
 msgid ""
 "This allows you to specify the default video port for the RTP streaming."
 msgstr ""
 
-#: modules/stream_out/rtp.c:92
+#: modules/stream_out/rtp.c:93
 msgid "This allows you to specify the Time-To-Live for the output stream."
 msgstr ""
 
-#: modules/stream_out/rtp.c:94
+#: modules/stream_out/rtp.c:95
 msgid "MP4A LATM"
 msgstr ""
 
-#: modules/stream_out/rtp.c:96
+#: modules/stream_out/rtp.c:97
 msgid "This allows you to stream MPEG4 LATM audio streams (see RFC3016)."
 msgstr ""
 
-#: modules/stream_out/rtp.c:105
+#: modules/stream_out/rtp.c:106
 msgid "RTP stream output"
 msgstr ""
 
@@ -14371,71 +14522,71 @@
 msgid "Standard stream output"
 msgstr ""
 
-#: modules/stream_out/switcher.c:82
+#: modules/stream_out/switcher.c:81
 msgid "Files"
 msgstr ""
 
-#: modules/stream_out/switcher.c:84
+#: modules/stream_out/switcher.c:83
 msgid "Full paths of the files separated by colons."
 msgstr ""
 
-#: modules/stream_out/switcher.c:85
+#: modules/stream_out/switcher.c:84
 msgid "Sizes"
 msgstr ""
 
-#: modules/stream_out/switcher.c:87
+#: modules/stream_out/switcher.c:86
 msgid "List of sizes separated by colons (720x576:480x576)."
 msgstr ""
 
-#: modules/stream_out/switcher.c:88
+#: modules/stream_out/switcher.c:87
 msgid "Aspect ratio"
 msgstr ""
 
-#: modules/stream_out/switcher.c:90
+#: modules/stream_out/switcher.c:89
 msgid "Aspect ratio (4:3, 16:9)."
 msgstr ""
 
-#: modules/stream_out/switcher.c:91
+#: modules/stream_out/switcher.c:90
 msgid "Command UDP port"
 msgstr ""
 
-#: modules/stream_out/switcher.c:93
+#: modules/stream_out/switcher.c:92
 msgid "UDP port to listen to for commands."
 msgstr ""
 
-#: modules/stream_out/switcher.c:94
+#: modules/stream_out/switcher.c:93
 msgid "Command"
 msgstr ""
 
-#: modules/stream_out/switcher.c:96
+#: modules/stream_out/switcher.c:95
 msgid "Initial command to execute."
 msgstr ""
 
-#: modules/stream_out/switcher.c:97
+#: modules/stream_out/switcher.c:96
 msgid "GOP size"
 msgstr ""
 
-#: modules/stream_out/switcher.c:99
+#: modules/stream_out/switcher.c:98
 msgid "Number of P frames between two I frames."
 msgstr ""
 
-#: modules/stream_out/switcher.c:100
+#: modules/stream_out/switcher.c:99
 msgid "Quantizer scale"
 msgstr ""
 
-#: modules/stream_out/switcher.c:102
+#: modules/stream_out/switcher.c:101
 msgid "Fixed quantizer scale to use."
 msgstr ""
 
-#: modules/stream_out/switcher.c:103
+#: modules/stream_out/switcher.c:102
 msgid "Mute audio"
 msgstr ""
 
-#: modules/stream_out/switcher.c:105
+#: modules/stream_out/switcher.c:104
 msgid "Mute audio when command is not 0."
 msgstr ""
 
-#: modules/stream_out/switcher.c:108
+#: modules/stream_out/switcher.c:107
 msgid "MPEG2 video switcher stream output"
 msgstr ""
 
@@ -15624,21 +15775,21 @@
 msgid "DirectFB video output http://www.directfb.org/"
 msgstr ""
 
-#: modules/video_output/directx/directx.c:112
+#: modules/video_output/directx/directx.c:127
 msgid "Use hardware YUV->RGB conversions"
 msgstr ""
 
-#: modules/video_output/directx/directx.c:114
+#: modules/video_output/directx/directx.c:129
 msgid ""
 "Try to use hardware acceleration for YUV->RGB conversions. This option "
 "doesn't have any effect when using overlays."
 msgstr ""
 
-#: modules/video_output/directx/directx.c:117
+#: modules/video_output/directx/directx.c:132
 msgid "Use video buffers in system memory"
 msgstr ""
 
-#: modules/video_output/directx/directx.c:119
+#: modules/video_output/directx/directx.c:134
 msgid ""
 "Create video buffers in system memory instead of video memory. This isn't "
 "recommended as usually using video memory allows to benefit from more "
@@ -15646,43 +15797,43 @@
 "doesn't have any effect when using overlays."
 msgstr ""
 
-#: modules/video_output/directx/directx.c:124
+#: modules/video_output/directx/directx.c:139
 msgid "Use triple buffering for overlays"
 msgstr ""
 
-#: modules/video_output/directx/directx.c:126
+#: modules/video_output/directx/directx.c:141
 msgid ""
 "Try to use triple buffering when using YUV overlays. That results in much "
 "better video quality (no flickering)."
 msgstr ""
 
-#: modules/video_output/directx/directx.c:129
+#: modules/video_output/directx/directx.c:144
 msgid "Name of desired display device"
 msgstr ""
 
-#: modules/video_output/directx/directx.c:130
+#: modules/video_output/directx/directx.c:145
 msgid ""
 "In a multiple monitor configuration, you can specify the Windows device name "
 "of the display that you want the video window to open on. For example, \"\\"
 "\\.\\DISPLAY1\" or \"\\\\.\\DISPLAY2\"."
 msgstr ""
 
-#: modules/video_output/directx/directx.c:135
+#: modules/video_output/directx/directx.c:150
 msgid "Enable wallpaper mode "
 msgstr ""
 
-#: modules/video_output/directx/directx.c:137
+#: modules/video_output/directx/directx.c:152
 msgid ""
 "The wallpaper mode allows you to display the video as the desktop "
 "background. Note that this feature only works in overlay mode and the "
 "desktop must not already have a wallpaper."
 msgstr ""
 
-#: modules/video_output/directx/directx.c:163
+#: modules/video_output/directx/directx.c:178
 msgid "DirectX video output"
 msgstr ""
 
-#: modules/video_output/directx/directx.c:303
+#: modules/video_output/directx/directx.c:318
 msgid "Wallpaper"
 msgstr ""
 
@@ -16245,903 +16396,3 @@
 #: modules/visualization/xosd.c:84
 msgid "XOSD interface"
 msgstr ""
-
-#: include/vlc_config_cat.h:89
-msgid "Filters (v2)"
-msgstr ""
-
-#: include/vlc_meta.h:44
-msgid "Encoded by"
-msgstr ""
-
-#: src/audio_output/filters.c:154 src/audio_output/filters.c:201
-#: src/audio_output/filters.c:224
-msgid "Audio filtering failed"
-msgstr ""
-
-#: src/audio_output/filters.c:155 src/audio_output/filters.c:202
-#: src/audio_output/filters.c:225
-#, c-format
-msgid "The maximum number of filters (%d) was reached."
-msgstr ""
-
-#: src/input/decoder.c:113 src/input/decoder.c:125
-#: modules/codec/ffmpeg/encoder.c:228 modules/codec/ffmpeg/encoder.c:236
-#: modules/codec/ffmpeg/encoder.c:248 modules/codec/ffmpeg/encoder.c:619
-#: modules/codec/ffmpeg/encoder.c:628 modules/stream_out/es.c:365
-#: modules/stream_out/es.c:379
-msgid "Streaming / Transcoding failed"
-msgstr ""
-
-#: src/input/decoder.c:114
-msgid "VLC could not open the packetizer module."
-msgstr ""
-
-#: src/input/decoder.c:126
-msgid "VLC could not open the decoder module."
-msgstr ""
-
-#: src/input/decoder.c:136
-msgid "No suitable decoder module for FOURCC \"4.4s\" found"
-msgstr ""
-
-#: src/input/decoder.c:137
-msgid ""
-"VLC probably does not support this audio or video format. Regrettably, there "
-"is no way for you to fix this."
-msgstr ""
-
-#: src/input/input.c:2029
-msgid "Your input can't be opened"
-msgstr ""
-
-#: src/input/input.c:2030
-#, c-format
-msgid "VLC is unable to open the MRL '%s'. Check the log for details."
-msgstr ""
-
-#: src/input/input.c:2102
-msgid "Can't recognize the input's format"
-msgstr ""
-
-#: src/input/input.c:2103
-#, c-format
-msgid "The format of '%s' can't be detected. Have a look the log for details."
-msgstr ""
-
-#: src/libvlc.h:299
-msgid "Video output filter module"
-msgstr ""
-
-#: src/libvlc.h:307
-msgid ""
-"This adds post-processing filters to enhance the picture quality, for "
-"instance deinterlacing, or distortthe video."
-msgstr ""
-
-#: src/libvlc.h:396
-msgid ""
-"If you live in France, it is not allowed to workaround any Digital "
-"Restrictions Management measure."
-msgstr ""
-
-#: src/libvlc.h:856
-msgid "Write process id to file"
-msgstr ""
-
-#: src/libvlc.h:858
-msgid "Writes process id into specified file."
-msgstr ""
-
-#: src/libvlc.h:953
-msgid "Use media library"
-msgstr ""
-
-#: src/libvlc.h:955
-msgid ""
-"The media library is automatically saved and reloaded each time you start "
-"VLC."
-msgstr ""
-
-#: src/libvlc.h:958
-msgid "Use playlist tree"
-msgstr ""
-
-#: src/libvlc.h:960
-msgid ""
-"The playlist can use a tree to categorize some items, like the contents of a "
-"directory. \"Default\" means that the tree will only be used when really "
-"needed."
-msgstr ""
-
-#: src/libvlc.h:964
-msgid "Always"
-msgstr ""
-
-#: src/libvlc.h:964
-msgid "Never"
-msgstr ""
-
-#: src/playlist/engine.c:92 src/playlist/engine.c:94
-msgid "Media Library"
-msgstr ""
-
-#: modules/access/cdda/access.c:293
-msgid "CD reading failed"
-msgstr ""
-
-#: modules/access/cdda/access.c:294
-#, c-format
-msgid "VLC could not get a new block of size: %i."
-msgstr ""
-
-#: modules/access/dshow/dshow.cpp:86
-msgid "TV"
-msgstr ""
-
-#: modules/access/dshow/dshow.cpp:87
-msgid "FM radio"
-msgstr ""
-
-#: modules/access/dshow/dshow.cpp:88
-msgid "AM radio"
-msgstr ""
-
-#: modules/access/dshow/dshow.cpp:89
-msgid "DSS"
-msgstr ""
-
-#: modules/access/dshow/dshow.cpp:153
-msgid "AM Tuner mode"
-msgstr ""
-
-#: modules/access/dshow/dshow.cpp:155
-msgid "AM Tuner mode. Can be one of DEFAULT, TV, AM_RADIO, FM_RADIO or DSS."
-msgstr ""
-
-#: modules/access/dshow/dshow.cpp:894 modules/access/dshow/dshow.cpp:944
-msgid "Capturing failed"
-msgstr ""
-
-#: modules/access/dshow/dshow.cpp:895
-#, c-format
-msgid ""
-"VLC cannot use the device \"%s\", because its device type is not supported."
-msgstr ""
-
-#: modules/access/dshow/dshow.cpp:945
-#, c-format
-msgid "The capture device \"%s\" does not support the required parameters."
-msgstr ""
-
-#: modules/access/dvb/access.c:716
-msgid "Input syntax is deprecated"
-msgstr ""
-
-#: modules/access/dvb/access.c:717
-msgid ""
-"The given syntax is deprecated. Run \"vlc -p dvb\" to see an explanation of "
-"the new syntax."
-msgstr ""
-
-#: modules/access/dvb/access.c:763
-msgid "Illegal Polarization"
-msgstr ""
-
-#: modules/access/dvb/access.c:764
-#, c-format
-msgid "The provided polarization \"%c\" is not valid."
-msgstr ""
-
-#: modules/access/dvdnav.c:296 modules/access/dvdread.c:236
-#: modules/access/dvdread.c:495 modules/access/dvdread.c:557
-msgid "Playback failure"
-msgstr ""
-
-#: modules/access/dvdnav.c:297
-msgid ""
-"VLC cannot set the DVD's title. It possibly cannot decrypt the entire disk."
-msgstr ""
-
-#: modules/access/dvdread.c:237
-#, c-format
-msgid "DVDRead could not open disk \"%s\"."
-msgstr ""
-
-#: modules/access/dvdread.c:496
-#, c-format
-msgid "DVDRead could not read block %d."
-msgstr ""
-
-#: modules/access/dvdread.c:558
-#, c-format
-msgid "DVDRead could not read %d/%d blocks at 0x%02x."
-msgstr ""
-
-#: modules/access/file.c:248 modules/access/file.c:417
-#: modules/access/file.c:519 modules/access/file.c:606
-#: modules/access/file.c:631
-msgid "File reading failed"
-msgstr ""
-
-#: modules/access/file.c:249
-#, c-format
-msgid "\"%s\"'s file type is unknown."
-msgstr ""
-
-#: modules/access/file.c:418
-#, c-format
-msgid "VLC could not read file \"%s\"."
-msgstr ""
-
-#: modules/access/file.c:520
-msgid ""
-"VLC seeked in the file too far. This usually means that your file is broken "
-"and therefore cannot be played."
-msgstr ""
-
-#: modules/access/file.c:607
-#, c-format
-msgid "VLC could not open file \"%s\"."
-msgstr ""
-
-#: modules/access/file.c:632
-#, c-format
-msgid "VLC could not open file \"%s\" (%s)."
-msgstr ""
-
-#: modules/access/ftp.c:109 modules/access/ftp.c:124 modules/access/ftp.c:185
-#: modules/access/ftp.c:195 modules/access/ftp.c:203
-msgid "Network interaction failed"
-msgstr ""
-
-#: modules/access/ftp.c:110
-msgid "VLC could not connect with the given server."
-msgstr ""
-
-#: modules/access/ftp.c:125
-msgid "VLC's connection to the given server was rejected."
-msgstr ""
-
-#: modules/access/ftp.c:186
-msgid "Your account was rejected."
-msgstr ""
-
-#: modules/access/ftp.c:196
-msgid "Your password was rejected."
-msgstr ""
-
-#: modules/access/ftp.c:204
-msgid "Your connection attemp to the server was rejected."
-msgstr ""
-
-#: modules/access/http.c:284
-msgid "HTTP authentication"
-msgstr ""
-
-#: modules/access/http.c:285 modules/demux/live555.cpp:753
-msgid "Please enter a valid login name and a password."
-msgstr ""
-
-#: modules/access/rtsp/access.c:93
-msgid "Connection failed"
-msgstr ""
-
-#: modules/access/rtsp/access.c:94
-#, c-format
-msgid "VLC could not connect to \"%s:%d\"."
-msgstr ""
-
-#: modules/access/rtsp/access.c:221
-msgid "Session failed"
-msgstr ""
-
-#: modules/access/rtsp/access.c:222
-msgid "The requested RTSP session could not be established."
-msgstr ""
-
-#: modules/access_output/shout.c:59
-msgid "Name to give to this stream/channel on the shoutcast/icecast server."
-msgstr ""
-
-#: modules/access_output/shout.c:67
-msgid ""
-"You normally have to feed the shoutcast module with Ogg streams. It is also "
-"possible to stream MP3 instead, so you can forward MP3 streams to the "
-"shoutcast/icecast server."
-msgstr ""
-
-#: modules/access_output/shout.c:76
-msgid "Genre description"
-msgstr ""
-
-#: modules/access_output/shout.c:77
-msgid "Genre of the content. "
-msgstr ""
-
-#: modules/access_output/shout.c:79
-msgid "URL description"
-msgstr ""
-
-#: modules/access_output/shout.c:80
-msgid "URL with information about the stream or your channel. "
-msgstr ""
-
-#: modules/access_output/shout.c:87
-msgid "Bitrate information of the transcoded stream. "
-msgstr ""
-
-#: modules/access_output/shout.c:90
-msgid "Samplerate information of the transcoded stream. "
-msgstr ""
-
-#: modules/access_output/shout.c:92
-msgid "Number of channels"
-msgstr ""
-
-#: modules/access_output/shout.c:93
-msgid "Number of channels information of the transcoded stream. "
-msgstr ""
-
-#: modules/access_output/shout.c:95
-msgid "Ogg Vorbis Quality"
-msgstr ""
-
-#: modules/access_output/shout.c:96
-msgid "Ogg Vorbis Quality information of the transcoded stream. "
-msgstr ""
-
-#: modules/access_output/shout.c:98
-msgid "Stream public"
-msgstr ""
-
-#: modules/access_output/shout.c:99
-msgid ""
-"Make the server publicly available on the 'Yellow Pages' (directory listing "
-"of streams) on the icecast/shoutcast website. Requires the bitrate "
-"information specified for shoutcast. Requires Ogg streaming for icecast."
-msgstr ""
-
-#: modules/audio_filter/converter/mono.c:75
-msgid "Left rear"
-msgstr ""
-
-#: modules/audio_filter/converter/mono.c:75
-msgid "Right rear"
-msgstr ""
-
-#: modules/audio_filter/converter/mono.c:76
-msgid "Left front"
-msgstr ""
-
-#: modules/audio_filter/converter/mono.c:88
-msgid "Audio filter for stereo to mono conversion"
-msgstr ""
-
-#: modules/audio_output/alsa.c:326
-msgid "No Audio Device"
-msgstr ""
-
-#: modules/audio_output/alsa.c:327
-msgid "No audio device name was given. You might want to enter \"default\"."
-msgstr ""
-
-#: modules/audio_output/alsa.c:434 modules/audio_output/alsa.c:473
-#: modules/audio_output/alsa.c:485 modules/audio_output/auhal.c:244
-msgid "Audio output failed"
-msgstr ""
-
-#: modules/audio_output/alsa.c:435 modules/audio_output/alsa.c:486
-#, c-format
-msgid "VLC could not open the ALSA device \"%s\" (%s)."
-msgstr ""
-
-#: modules/audio_output/alsa.c:474
-#, c-format
-msgid "The audio device \"%s\" is already in use."
-msgstr ""
-
-#: modules/audio_output/auhal.c:245
-msgid ""
-"The selected audio output device is exclusively in use by another program."
-msgstr ""
-
-#: modules/audio_output/auhal.c:429
-msgid "Audio device is not configured"
-msgstr ""
-
-#: modules/audio_output/auhal.c:430
-msgid ""
-"You should configure your speaker layout with the \"Audio Midi Setup Utility"
-"\" in /Applications/Utilities. Stereo mode is being used now."
-msgstr ""
-
-#: modules/codec/ffmpeg/encoder.c:229
-#, c-format
-msgid "\"%s\" is no video encoder."
-msgstr ""
-
-#: modules/codec/ffmpeg/encoder.c:237
-#, c-format
-msgid "\"%s\" is no audio encoder."
-msgstr ""
-
-#: modules/codec/ffmpeg/encoder.c:249
-#, c-format
-msgid "VLC could not find encoder \"%s\"."
-msgstr ""
-
-#: modules/codec/ffmpeg/encoder.c:620 modules/codec/ffmpeg/encoder.c:629
-msgid "VLC could not open the encoder."
-msgstr ""
-
-#: modules/control/hotkeys.c:625
-#, c-format
-msgid "Zoom mode: %s"
-msgstr ""
-
-#: modules/control/motion.c:62
-msgid "motion"
-msgstr ""
-
-#: modules/control/motion.c:64
-msgid "motion control interface"
-msgstr ""
-
-#: modules/control/rc.c:877
-msgid "| enqueue XYZ  . . . . . . . queue XYZ to playlist"
-msgstr ""
-
-#: modules/control/rc.c:951
-msgid "| mosaic-order id(,id)* . . . . order of pictures "
-msgstr ""
-
-#: modules/demux/asf/asf.c:168
-msgid "Could not demux ASF stream"
-msgstr ""
-
-#: modules/demux/asf/asf.c:169
-msgid "VLC failed to load the ASF header."
-msgstr ""
-
-#: modules/demux/avi/avi.c:561
-msgid "Repair"
-msgstr ""
-
-#: modules/demux/avi/avi.c:561
-msgid "Don't repair"
-msgstr ""
-
-#: modules/demux/avi/avi.c:2278 modules/demux/avi/avi.c:2301
-msgid "Fixing AVI Index..."
-msgstr ""
-
-#: modules/demux/gme.cpp:52
-msgid "GME demuxer (Game_Music_Emu)"
-msgstr ""
-
-#: modules/demux/live555.cpp:752
-msgid "RTSP authentication"
-msgstr ""
-
-#: modules/demux/playlist/gvp.c:193
-msgid "Google Video"
-msgstr ""
-
-#: modules/demux/playlist/playlist.c:100
-msgid "ASX playlist import"
-msgstr ""
-
-#: modules/demux/playlist/playlist.c:110
-msgid "QuickTime Media Link importer"
-msgstr ""
-
-#: modules/demux/playlist/playlist.c:115
-msgid "Google Video Playlist importer"
-msgstr ""
-
-#: modules/gui/macosx/extended.m:90
-msgid "General editing filters"
-msgstr ""
-
-#: modules/gui/macosx/extended.m:91
-msgid "Distortion filters"
-msgstr ""
-
-#: modules/gui/macosx/extended.m:92
-msgid "Blur"
-msgstr ""
-
-#: modules/gui/macosx/extended.m:99
-msgid "Invert colors"
-msgstr ""
-
-#: modules/gui/macosx/extended.m:103
-msgid "Interactive Zoom"
-msgstr ""
-
-#: modules/gui/macosx/extended.m:104
-msgid "Enables an interactive Zoom feature"
-msgstr ""
-
-#: modules/gui/macosx/extended.m:621
-msgid ""
-"This panel allows to select video effects filters to apply.\n"
-"The filters can be configured individually in the Preferences, in the "
-"subsections of Video/Filters.\n"
-"To choose the order in which the filter are applied, a filter option string "
-"can be set in the Preferences, Video / Filters section."
-msgstr ""
-
-#: modules/gui/macosx/interaction.m:130
-msgid "Login:"
-msgstr ""
-
-#: modules/gui/macosx/interaction.m:131
-msgid "Password:"
-msgstr ""
-
-#: modules/gui/macosx/interaction.m:219 modules/gui/macosx/interaction.m:285
-#, c-format
-msgid "Remaining time: %i seconds"
-msgstr ""
-
-#: modules/gui/macosx/interaction.m:389 modules/gui/macosx/intf.m:601
-msgid "Errors and Warnings"
-msgstr ""
-
-#: modules/gui/macosx/interaction.m:390
-msgid "Clean up"
-msgstr ""
-
-#: modules/gui/macosx/interaction.m:391
-msgid "Show Details"
-msgstr ""
-
-#: modules/gui/macosx/playlist.m:1483
-msgid "New Node"
-msgstr ""
-
-#: modules/gui/macosx/playlist.m:1484
-msgid "Please enter a name for the new node."
-msgstr ""
-
-#: modules/gui/macosx/sfilters.m:70
-msgid "Subpicture Filters"
-msgstr ""
-
-#: modules/gui/macosx/sfilters.m:71
-msgid "Logo"
-msgstr ""
-
-#: modules/gui/macosx/sfilters.m:74
-msgid "Save settings"
-msgstr ""
-
-#: modules/gui/macosx/sfilters.m:77
-msgid "Image:"
-msgstr ""
-
-#: modules/gui/macosx/sfilters.m:78 modules/gui/macosx/sfilters.m:85
-#: modules/gui/macosx/sfilters.m:93
-msgid "Position:"
-msgstr ""
-
-#: modules/gui/macosx/sfilters.m:81
-msgid "Timestamp:"
-msgstr ""
-
-#: modules/gui/macosx/sfilters.m:83 modules/gui/macosx/sfilters.m:88
-msgid "Color:"
-msgstr ""
-
-#: modules/gui/macosx/sfilters.m:84
-msgid "Opaqueness:"
-msgstr ""
-
-#: modules/gui/macosx/sfilters.m:86 modules/gui/macosx/sfilters.m:95
-msgid "(in pixels)"
-msgstr ""
-
-#: modules/gui/macosx/sfilters.m:89
-msgid "Marquee:"
-msgstr ""
-
-#: modules/gui/macosx/sfilters.m:91
-msgid "Timeout:"
-msgstr ""
-
-#: modules/gui/macosx/sfilters.m:92
-msgid "ms"
-msgstr ""
-
-#: modules/gui/qt4/dialogs/streaminfo.cpp:35
-msgid "Stream information"
-msgstr ""
-
-#: modules/gui/qt4/qt4.cpp:43
-msgid "QT interface"
-msgstr ""
-
-#: modules/gui/wxwidgets/dialogs/playlist.cpp:1418
-msgid "One level"
-msgstr ""
-
-#: modules/misc/notify.c:158
-msgid "no artist"
-msgstr ""
-
-#: modules/misc/notify.c:161
-msgid "no album"
-msgstr ""
-
-#: modules/misc/rtsp.c:60
-msgid "MUX for RAW RTSP transport"
-msgstr ""
-
-#: modules/services_discovery/sap.c:316
-msgid "SAP sessions"
-msgstr ""
-
-#: modules/services_discovery/shout.c:205
-msgid "Connecting..."
-msgstr ""
-
-#: modules/stream_out/bridge.c:42
-msgid ""
-"Pictures coming from the picture video outputs will be delayed according to "
-"this value (in milliseconds, should be >= 100 ms). For high values, you will "
-"need to raise caching values."
-msgstr ""
-
-#: modules/stream_out/es.c:366 modules/stream_out/es.c:380
-#, c-format
-msgid "There is no suitable stream-output access module for \"%s/%s://%s\"."
-msgstr ""
-
-#: modules/stream_out/transcode.c:138
-msgid "Audio filter"
-msgstr ""
-
-#: modules/stream_out/transcode.c:140
-msgid ""
-"Audio filters will be applied to the audio streams (after conversion filters "
-"are applied). You must enter a comma-separated list of filters."
-msgstr ""
-
-#: modules/stream_out/transcode.c:149
-msgid "This is the subtitles coded that will be used."
-msgstr ""
-
-#: modules/video_filter/crop.c:267 modules/video_filter/crop.c:346
-msgid "Cropping failed"
-msgstr ""
-
-#: modules/video_filter/crop.c:268 modules/video_filter/crop.c:347
-msgid "VLC could not open the video output module."
-msgstr ""
-
-#: modules/video_filter/gradient.c:57
-msgid "Distort mode, one of \"gradient\", \"edge\" and \"hough\"."
-msgstr ""
-
-#: modules/video_filter/gradient.c:73
-msgid "Gradient video filter"
-msgstr ""
-
-#: modules/video_filter/psychedelic.c:51
-msgid "Psychedelic video filter"
-msgstr ""
-
-#: modules/video_filter/ripple.c:50
-msgid "Ripple video filter"
-msgstr ""
-
-#: modules/video_filter/wave.c:50
-msgid "Wave video filter"
-msgstr ""
-
-#: modules/video_output/directx/direct3d.c:88
-msgid "DirectX 3D video output"
-msgstr ""
-
-#: src/libvlc.h:297
-msgid "Video snapshot directory"
-msgstr ""
-
-#: src/libvlc.h:841 src/libvlc.h:843
-msgid "Allow only on running instance when started from file"
-msgstr ""
-
-#: src/libvlc.h:1918
-msgid ""
-"print help for VLC and all it's modules (can be combined with --advanced)"
-msgstr ""
-
-#: modules/access_output/http.c:76
-msgid ""
-"Path to the x509 PEM private key file that will  be used for HTTPS. Leave "
-"empty if you don't have one."
-msgstr ""
-
-#: modules/access_output/http.c:80
-msgid ""
-"Path to the x509 PEM trusted root CA certificates (certificate authority) "
-"file that will be used forHTTPS. Leave empty if you don't have one."
-msgstr ""
-
-#: modules/codec/x264.c:50
-msgid ""
-"Sets minimum interval between IDR-frames. In H.264, I-frames do not "
-"necessarily bound a closed GOP because it is allowable for a P-frame to be "
-"predicted from more frames than just the one frame before it (also see "
-"frameref). Therefore, I-frames are not necessarily seekable. IDR-Frames "
-"restrict subsequent P-frames from referring to any frame prior to the IDR-"
-"Frame. \n"
-"If scenecuts appear within this interval, they are still encoded as I-"
-"frames, but do not start a new GOP."
-msgstr ""
-
-#: modules/codec/x264.c:59
-msgid "Extra I-Frames aggressivity"
-msgstr ""
-
-#: modules/codec/x264.c:60
-msgid ""
-"Scene-cut detection. Controls how aggressively to insert extra I-frames. "
-"With small values of scenecut, the codec often has to force an I-frame when "
-"it would exceed keyint. Good values of scenecut may find a better location "
-"for the I-frame. Large values use more I-frames than necessary, thus wasting "
-"bits. -1 disables scene-cut detection, so I-frames are be inserted only "
-"every other keyint frames, which probably leads to ugly encoding artifacts. "
-"(1-100)."
-msgstr ""
-
-#: modules/codec/x264.c:71
-msgid "Number of consecutive B-frames between I and P-frames. (1 to 16)"
-msgstr ""
-
-#: modules/codec/x264.c:76
-msgid ""
-"Force the specified number of consecutive B-frames to be used, except "
-"possibly before an I-frame. "
-msgstr ""
-
-#: modules/codec/x264.c:81
-msgid ""
-"Bias the choice to use B-frames. Positive values cause more B-frames, "
-"negative values cause less B-frames. "
-msgstr ""
-
-#: modules/codec/x264.c:90
-msgid ""
-"CABAC (Context-Adaptive Binary Arithmetic Coding). Slightly slows down "
-"encoding and decoding, but should save 10-15% bitrate."
-msgstr ""
-
-#: modules/codec/x264.c:95
-msgid ""
-"Number of previous frames used as predictors. This is effective in Anime, "
-"but seems to make little difference in live-action source material. Some "
-"decoders are unable to deal with large frameref values. From 1 to 16"
-msgstr ""
-
-#: modules/codec/x264.c:106
-msgid ""
-"This selects the quantizer to use. Lower values result in better fidelity, "
-"but higher bitrates. 26 is a good default value. From 0 to 51. 0 means "
-"lossless"
-msgstr ""
-
-#: modules/codec/x264.c:112
-msgid "1-pass Quality-based VBR. From 0 to 51"
-msgstr ""
-
-#: modules/codec/x264.c:115
-msgid "Minimum quantizer, 15/35 seems to be a useful range."
-msgstr ""
-
-#: modules/codec/x264.c:126
-msgid "Allowed variance in average. bitrate (in kbits/s)."
-msgstr ""
-
-#: modules/codec/x264.c:130
-msgid "Sets a maximum local bitrate in kbits/s."
-msgstr ""
-
-#: modules/codec/x264.c:133
-msgid "Averaging period for the maximum local bitrate in kbits."
-msgstr ""
-
-#: modules/codec/x264.c:137
-msgid "Sets the initial buffer occupancy as a fraction of the buffer size."
-msgstr ""
-
-#: modules/codec/x264.c:141
-msgid "QP factor between I and P."
-msgstr ""
-
-#: modules/codec/x264.c:144
-msgid "QP factor between P and B."
-msgstr ""
-
-#: modules/codec/x264.c:150
-msgid "QP curve compression. (0.0=CBR to 1.0=QCP)"
-msgstr ""
-
-#: modules/codec/x264.c:173
-msgid "Direct MV prediction mode. "
-msgstr ""
-
-#: modules/codec/x264.c:186
-msgid ""
-"Maximum distance to search for motion estimation, measured from predicted "
-"position(s). Default of 16 is good for most footage, high motion sequences "
-"may benefit from settings between 24-32. From 0 to 64."
-msgstr ""
-
-#: modules/codec/x264.c:194
-msgid ""
-"This parameter controls quality versus speed tradeoffs involved in the "
-"motion estimation decision process (lower = quicker and higher = better "
-"quality). From 1 to 6."
-msgstr ""
-
-#: modules/codec/x264.c:198
-msgid "RD based mode decision for B-frames."
-msgstr ""
-
-#: modules/codec/x264.c:199
-msgid "RD based mode decision for B-frames. This requires subme 6."
-msgstr ""
-
-#: modules/codec/x264.c:229
-msgid "Dct-domain noise reduction. Adaptive pseudo-deadzone."
-msgstr ""
-
-#: modules/codec/x264.c:236
-msgid "PSNR calculation"
-msgstr ""
-
-#: modules/codec/x264.c:237
-msgid ""
-"This has no effect on actual encoding quality, it just prevents the stats "
-"from being calculated (for speed)."
-msgstr ""
-
-#: modules/demux/livedotcom.cpp:73
-msgid "RTP/RTSP/SDP demuxer (using Live555.com)"
-msgstr ""
-
-#: modules/demux/livedotcom.cpp:100
-msgid "Port to use for tunneling the RTSP/RTP over HTTP"
-msgstr ""
-
-#: modules/gui/skins2/src/skin_main.cpp:347
-msgid ""
-"Windows configuration of the last used. This option is updated automatically "
-"by the skins module."
-msgstr ""
-
-#: modules/gui/wxwidgets/dialogs/vlm/vlm_panel.cpp:415
-msgid "Create"
-msgstr ""
-
-#: modules/misc/freetype.c:113
-msgid ""
-"It is possible to apply effects to the renderedtext to improve its "
-"readability."
-msgstr ""
-
-#: modules/mux/mpeg/ts.c:115
-msgid ""
-"Enforces alignment of all access units on PES boundaries. This is a waste of "
-"bandwidth."
-msgstr ""
-
-#: modules/video_chroma/i420_ymga.c:48 modules/video_chroma/i420_ymga.c:51
-#: modules/video_chroma/i420_yuy2.c:75 modules/video_chroma/i420_yuy2.c:78
-#: modules/video_chroma/i420_yuy2.c:86 modules/video_chroma/i422_yuy2.c:63
-#: modules/video_chroma/i422_yuy2.c:66
-msgid " to "
-msgstr ""
diff -uNr vlc-0.8.6-svn20060918.debian/share/http/index.html vlc-0.8.6-svn20061008.debian/share/http/index.html
--- vlc-0.8.6-svn20060918.debian/share/http/index.html	2006-09-18 06:28:00.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/share/http/index.html	2006-09-21 11:50:20.000000000 -0400
@@ -4,7 +4,7 @@
 <  index.html: VLC media player web interface
 < - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - >
 <  Copyright (C) 2005-2006 the VideoLAN team
-<  $Id: index.html 14907 2006-03-24 14:17:28Z dionoea $
+<  $Id: index.html 16767 2006-09-21 14:32:45Z hartman $
 < 
 <  Authors: Antoine Cellerier <dionoea -at- videolan -dot- org>
 < 
@@ -38,6 +38,7 @@
   <!-- in case people had scripts that sent commands to the default
        index.html page -->
   <vlc id="control" param1="stop,pause,previous,next,add,sout,play,delete,empty,seek,fullscreen,keep,volume,sort,move" />
+  <vlc id="set" param1="sout" param2="string" />
 
 </head>
 
diff -uNr vlc-0.8.6-svn20060918.debian/share/Makefile.in vlc-0.8.6-svn20061008.debian/share/Makefile.in
--- vlc-0.8.6-svn20060918.debian/share/Makefile.in	2006-09-18 06:31:06.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/share/Makefile.in	2006-10-08 12:43:11.000000000 -0400
@@ -116,12 +116,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -129,6 +130,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -153,9 +156,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -232,7 +232,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -247,7 +249,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
@@ -802,9 +803,11 @@
 
 skins2/default.vlt: $(skins2_default_vlt_FILES)
 
-skins2/%.vlt:
+skins2/default.vlt:
 	mkdir -p skins2
-	tar cvvzf $@ --exclude .svn -C $(srcdir)/skins2 $*/
+	tar cvvzf skins2/default.vlt --exclude .svn -C $(srcdir)/skins2 default/
+
+.PHONY: $(nobase_pkgdata_DATA)
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
 .NOEXPORT:
diff -uNr vlc-0.8.6-svn20060918.debian/share/skins2/skin.dtd vlc-0.8.6-svn20061008.debian/share/skins2/skin.dtd
--- vlc-0.8.6-svn20060918.debian/share/skins2/skin.dtd	2006-09-18 06:28:01.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/share/skins2/skin.dtd	2006-09-22 11:14:27.000000000 -0400
@@ -114,6 +114,8 @@
         y           CDATA   "0"
         lefttop     CDATA   "lefttop"
         rightbottom CDATA   "lefttop"
+        xkeepratio  CDATA   "false"
+        ykeepratio  CDATA   "false"
         image       CDATA   #REQUIRED
         action      CDATA   "none"
         action2     CDATA   "none"
@@ -128,6 +130,8 @@
         y           CDATA   "0"
         lefttop     CDATA   "lefttop"
         rightbottom CDATA   "lefttop"
+        xkeepratio  CDATA   "false"
+        ykeepratio  CDATA   "false"
         up          CDATA   #REQUIRED
         down        CDATA   "none"
         over        CDATA   "none"
@@ -143,6 +147,8 @@
         y            CDATA   "0"
         lefttop      CDATA   "lefttop"
         rightbottom  CDATA   "lefttop"
+        xkeepratio  CDATA   "false"
+        ykeepratio  CDATA   "false"
         up1          CDATA   #REQUIRED
         down1        CDATA   "none"
         over1        CDATA   "none"
@@ -164,6 +170,8 @@
         y           CDATA   "0"
         lefttop     CDATA   "lefttop"
         rightbottom CDATA   "lefttop"
+        xkeepratio  CDATA   "false"
+        ykeepratio  CDATA   "false"
         up          CDATA   #REQUIRED
         down        CDATA   "none"
         over        CDATA   "none"
@@ -191,6 +199,8 @@
         y           CDATA   "0"
         lefttop     CDATA   "lefttop"
         rightbottom CDATA   "lefttop"
+        xkeepratio  CDATA   "false"
+        ykeepratio  CDATA   "false"
         sequence    CDATA   #REQUIRED
         nbimages    CDATA   #REQUIRED
         minangle    CDATA   "0"
@@ -208,6 +218,8 @@
         width       CDATA   "0"
         lefttop     CDATA   "lefttop"
         rightbottom CDATA   "lefttop"
+        xkeepratio  CDATA   "false"
+        ykeepratio  CDATA   "false"
         text        CDATA   ""
         font        CDATA   #REQUIRED
         color       CDATA   "#000000"
@@ -225,6 +237,8 @@
         height      CDATA   "0"
         lefttop     CDATA   "lefttop"
         rightbottom CDATA   "lefttop"
+        xkeepratio  CDATA   "false"
+        ykeepratio  CDATA   "false"
         font        CDATA   #REQUIRED
         bgimage     CDATA   "none"
         fgcolor     CDATA   "#000000"
@@ -244,6 +258,8 @@
         height      CDATA   "0"
         lefttop     CDATA   "lefttop"
         rightbottom CDATA   "lefttop"
+        xkeepratio  CDATA   "false"
+        ykeepratio  CDATA   "false"
         font        CDATA   #REQUIRED
         bgimage     CDATA   "none"
         itemimage   CDATA   "none"
@@ -267,6 +283,8 @@
         height      CDATA   "0"
         lefttop     CDATA   "lefttop"
         rightbottom CDATA   "lefttop"
+        xkeepratio  CDATA   "false"
+        ykeepratio  CDATA   "false"
         autoresize  CDATA   "true"
         help        CDATA   ""
     >
diff -uNr vlc-0.8.6-svn20060918.debian/src/control/audio.c vlc-0.8.6-svn20061008.debian/src/control/audio.c
--- vlc-0.8.6-svn20060918.debian/src/control/audio.c	2006-09-18 06:27:55.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/control/audio.c	2006-09-21 11:50:20.000000000 -0400
@@ -2,7 +2,7 @@
  * libvlc_audio.c: New libvlc audio control API
  *****************************************************************************
  * Copyright (C) 2006 the VideoLAN team
- * $Id: audio.c 16457 2006-08-31 20:51:12Z hartman $
+ * $Id: audio.c 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Filippo Carone <filippo@carone.org>
  *
@@ -31,59 +31,49 @@
  * libvlc_audio_get_mute : Get the volume state, true if muted
  *****************************************************************************/
 void libvlc_audio_toggle_mute( libvlc_instance_t *p_instance,
-                               libvlc_exception_t *p_exception )
+                               libvlc_exception_t *p_e )
 {
     aout_VolumeMute( p_instance->p_vlc, NULL );
 }
 
 vlc_bool_t libvlc_audio_get_mute( libvlc_instance_t *p_instance,
-                                  libvlc_exception_t *p_exception )
+                                  libvlc_exception_t *p_e )
 {
     /*
      * If the volume level is 0, then the channel is muted
      */
     audio_volume_t i_volume;
 
-    i_volume = libvlc_audio_get_volume(p_instance, p_exception);
+    i_volume = libvlc_audio_get_volume(p_instance, p_e);
     if ( i_volume == 0 )
         return VLC_TRUE;
-
     return VLC_FALSE;
 }
 
 void libvlc_audio_set_mute( libvlc_instance_t *p_instance, vlc_bool_t status,
-                            libvlc_exception_t *p_exception )
+                            libvlc_exception_t *p_e )
 {
     if ( status )
     {
-        /*
-         * Check if the volume is already muted
-         */
-        if (! libvlc_audio_get_volume( p_instance, p_exception ) )
+        /* Check if the volume is already muted */
+        if (! libvlc_audio_get_volume( p_instance, p_e ) )
         {
             return;
         }
-        
         aout_VolumeMute( p_instance->p_vlc, NULL );
-        return;
-        
     }
     else
     {
-        /*
-         * the aout_VolumeMute is a toggle function, so this is enough.
-         */
+        /* the aout_VolumeMute is a toggle function, so this is enough. */
         aout_VolumeMute( p_instance->p_vlc, NULL );
-        return;
     }
 }
 
-
 /*****************************************************************************
  * libvlc_audio_get_volume : Get the current volume (range 0-200 %)
  *****************************************************************************/
 int libvlc_audio_get_volume( libvlc_instance_t *p_instance,
-                             libvlc_exception_t *p_exception )
+                             libvlc_exception_t *p_e )
 {
     audio_volume_t i_volume;
 
@@ -97,7 +87,7 @@
  * libvlc_audio_set_volume : Set the current volume
  *****************************************************************************/
 void libvlc_audio_set_volume( libvlc_instance_t *p_instance, int i_volume,
-                              libvlc_exception_t *p_exception )
+                              libvlc_exception_t *p_e )
 {
     if( i_volume >= 0 && i_volume <= 200 )
     {
@@ -106,7 +96,7 @@
     }
     else
     {
-        libvlc_exception_raise( p_exception, "Volume out of range" );
+        libvlc_exception_raise( p_e, "Volume out of range" );
     }
 }
 
diff -uNr vlc-0.8.6-svn20060918.debian/src/control/core.c vlc-0.8.6-svn20061008.debian/src/control/core.c
--- vlc-0.8.6-svn20060918.debian/src/control/core.c	2006-09-18 06:27:55.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/control/core.c	2006-09-21 11:50:20.000000000 -0400
@@ -2,7 +2,7 @@
  * core.c: Core libvlc new API functions : initialization, exceptions handling
  *****************************************************************************
  * Copyright (C) 2005 the VideoLAN team
- * $Id: core.c 14706 2006-03-10 17:21:33Z courmisch $
+ * $Id: core.c 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Clent Stenac <zorglub@videolan.org>
  *
@@ -61,6 +61,17 @@
                                     char *psz_format, ... )
 {
     va_list args;
+
+    /* does caller care about exceptions ? */
+    if( p_exception == NULL ) return;
+
+    /* remove previous exception if it wasn't cleared */
+    if( p_exception->b_raised && p_exception->psz_message )
+    {
+        free(p_exception->psz_message);
+        p_exception->psz_message = NULL;
+    }
+
     va_start( args, psz_format );
     vasprintf( &p_exception->psz_message, psz_format, args );
     va_end( args );
@@ -70,7 +81,7 @@
 }
 
 libvlc_instance_t * libvlc_new( int argc, char **argv,
-                                libvlc_exception_t *p_exception )
+                                libvlc_exception_t *p_e )
 {
     int i_vlc_id;
     libvlc_instance_t *p_new;
@@ -79,21 +90,14 @@
     i_vlc_id = VLC_Create();
     p_vlc = (vlc_t* ) vlc_current_object( i_vlc_id );
 
-    if( !p_vlc )
-    {
-        libvlc_exception_raise( p_exception, "VLC initialization failed" );
-        return NULL;
-    }
+    if( !p_vlc ) RAISENULL( "VLC initialization failed" );
+
     p_new = (libvlc_instance_t *)malloc( sizeof( libvlc_instance_t ) );
+    if( !p_new ) RAISENULL( "Out of memory" );
 
     /** \todo Look for interface settings. If we don't have any, add -I dummy */
     /* Because we probably don't want a GUI by default */
 
-    if( !p_new )
-    {
-        libvlc_exception_raise( p_exception, "Out of memory" );
-        return NULL;
-    }
 
     VLC_Init( i_vlc_id, argc, argv );
 
@@ -102,13 +106,9 @@
                                 VLC_OBJECT_PLAYLIST, FIND_CHILD );
     p_new->p_vlm = NULL;
 
-    if( !p_new->p_playlist )
-    {
-        libvlc_exception_raise( p_exception, "Playlist creation failed" );
-        return NULL;
-    }
+    if( !p_new->p_playlist ) RAISENULL( "Playlist creation failed" );
+    
     p_new->i_vlc_id = i_vlc_id;
-
     return p_new;
 }
 
@@ -120,3 +120,9 @@
     VLC_CleanUp( p_instance->i_vlc_id );
     VLC_Destroy( p_instance->i_vlc_id );
 }
+
+int libvlc_get_vlc_id( libvlc_instance_t *p_instance )
+{
+    return p_instance->i_vlc_id;
+}
+
diff -uNr vlc-0.8.6-svn20060918.debian/src/control/input.c vlc-0.8.6-svn20061008.debian/src/control/input.c
--- vlc-0.8.6-svn20060918.debian/src/control/input.c	2006-09-18 06:27:55.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/control/input.c	2006-10-04 09:47:05.000000000 -0400
@@ -2,7 +2,7 @@
  * input.c: Libvlc new API input management functions
  *****************************************************************************
  * Copyright (C) 2005 the VideoLAN team
- * $Id: input.c 16457 2006-08-31 20:51:12Z hartman $
+ * $Id: input.c 16931 2006-10-03 09:04:50Z damienf $
  *
  * Authors: Clment Stenac <zorglub@videolan.org>
  *
@@ -29,8 +29,7 @@
 
 void libvlc_input_free( libvlc_input_t *p_input )
 {
-    if( p_input )
-        free( p_input );
+    if( p_input ) free( p_input );
 }
 
 /*
@@ -42,20 +41,12 @@
 {
     input_thread_t *p_input_thread;
 
-    if( !p_input )
-    {
-        libvlc_exception_raise( p_e, "Input is NULL" );
-        return NULL;
-    }
+    if( !p_input ) RAISENULL( "Input is NULL" );
 
     p_input_thread = (input_thread_t*)vlc_object_get(
-                                 p_input->p_instance->p_vlc,
-                                 p_input->i_input_id );
-    if( !p_input_thread )
-    {
-        libvlc_exception_raise( p_e, "Input does not exist" );
-        return NULL;
-    }
+                                                    p_input->p_instance->p_vlc,
+                                                    p_input->i_input_id );
+    if( !p_input_thread ) RAISENULL( "Input does not exist" );
 
     return p_input_thread;
 }
@@ -66,50 +57,70 @@
  * Getters for stream information
  **************************************************************************/
 vlc_int64_t libvlc_input_get_length( libvlc_input_t *p_input,
-                             libvlc_exception_t *p_exception )
+                             libvlc_exception_t *p_e )
 {
     input_thread_t *p_input_thread;
     vlc_value_t val;
 
-    p_input_thread = libvlc_get_input_thread ( p_input, p_exception);
-
-    if ( libvlc_exception_raised( p_exception ) )
-        return -1.0;
+    p_input_thread = libvlc_get_input_thread ( p_input, p_e);
+    if( libvlc_exception_raised( p_e ) )  return -1;
        
     var_Get( p_input_thread, "length", &val );
     vlc_object_release( p_input_thread );
 
-    return val.i_time / 1000;
+    return val.i_time / 1000LL;
 }
 
 vlc_int64_t libvlc_input_get_time( libvlc_input_t *p_input,
-                           libvlc_exception_t *p_exception )
+                                   libvlc_exception_t *p_e )
 {
     input_thread_t *p_input_thread;
     vlc_value_t val;
 
+    p_input_thread = libvlc_get_input_thread ( p_input, p_e );
+    if( libvlc_exception_raised( p_e ) )  return -1;
 
-    p_input_thread = libvlc_get_input_thread ( p_input, p_exception);
+    var_Get( p_input_thread , "time", &val );
+    vlc_object_release( p_input_thread );
+    return val.i_time / 1000LL;
+}
 
-    if ( libvlc_exception_raised( p_exception ) )
-        return -1.0;
+void libvlc_input_set_time( libvlc_input_t *p_input, vlc_int64_t time,
+                            libvlc_exception_t *p_e )
+{
+    input_thread_t *p_input_thread;
+    vlc_value_t value;
 
-    var_Get( p_input_thread , "time", &val );
+    p_input_thread = libvlc_get_input_thread ( p_input, p_e );
+    if( libvlc_exception_raised( p_e ) )  return;
+    
+    value.i_time = time*1000LL;
+    var_Set( p_input_thread, "time", value );
     vlc_object_release( p_input_thread );
+}
 
-    return val.i_time / 1000;
+void libvlc_input_set_position( libvlc_input_t *p_input, float position,
+                                libvlc_exception_t *p_e ) 
+{
+    input_thread_t *p_input_thread;
+    vlc_value_t val;
+    val.f_float = position;
+    
+    p_input_thread = libvlc_get_input_thread ( p_input, p_e);
+    if ( libvlc_exception_raised( p_e ) ) return;
+
+    var_Set( p_input_thread, "position", val );
+    vlc_object_release( p_input_thread );
 }
 
 float libvlc_input_get_position( libvlc_input_t *p_input,
-                                 libvlc_exception_t *p_exception )
+                                 libvlc_exception_t *p_e )
 {
     input_thread_t *p_input_thread;
     vlc_value_t val;
 
-    p_input_thread = libvlc_get_input_thread ( p_input, p_exception);
-
-    if ( libvlc_exception_raised( p_exception ) )
-        return -1.0;
+    p_input_thread = libvlc_get_input_thread ( p_input, p_e);
+    if ( libvlc_exception_raised( p_e ) )  return -1.0;
 
     var_Get( p_input_thread, "position", &val );
     vlc_object_release( p_input_thread );
@@ -118,17 +129,19 @@
 }
 
 float libvlc_input_get_fps( libvlc_input_t *p_input,
-                            libvlc_exception_t *p_exception) 
+                            libvlc_exception_t *p_e) 
 {
     double f_fps;
     input_thread_t *p_input_thread;
 
-    p_input_thread = libvlc_get_input_thread ( p_input, p_exception);
+    p_input_thread = libvlc_get_input_thread ( p_input, p_e );
+    if ( libvlc_exception_raised( p_e ) )  return 0.0;
 
-    if( demux2_Control( p_input_thread->input.p_demux, DEMUX_GET_FPS, &f_fps ) || f_fps < 0.1 ) 
+    if( demux2_Control( p_input_thread->input.p_demux, DEMUX_GET_FPS, &f_fps )
+        || f_fps < 0.1 ) 
     {
         vlc_object_release( p_input_thread );
-        return 0;
+        return 0.0;
     }
     else
     {
@@ -138,21 +151,66 @@
 }
 
 vlc_bool_t libvlc_input_will_play( libvlc_input_t *p_input,
-                                   libvlc_exception_t *p_exception) 
+                                   libvlc_exception_t *p_e) 
 {
-    input_thread_t *p_input_thread;
-
-    p_input_thread = libvlc_get_input_thread ( p_input, p_exception);
-
-    if ( libvlc_exception_raised( p_exception ) )
-        return VLC_FALSE;
+    input_thread_t *p_input_thread =
+                            libvlc_get_input_thread ( p_input, p_e);
+    if ( libvlc_exception_raised( p_e ) ) return VLC_FALSE;
 
     if ( !p_input_thread->b_die && !p_input_thread->b_dead ) 
     {
         vlc_object_release( p_input_thread );
         return VLC_TRUE;
     }
-    
     vlc_object_release( p_input_thread );
     return VLC_FALSE;
 }
+
+void libvlc_input_set_rate( libvlc_input_t *p_input, float rate,
+                                libvlc_exception_t *p_e ) 
+{
+    input_thread_t *p_input_thread;
+    vlc_value_t val;
+
+    if( rate <= 0 )
+        RAISEVOID( "Rate value is invalid" );
+
+    val.i_int = 1000.0f/rate;
+    
+    p_input_thread = libvlc_get_input_thread ( p_input, p_e);
+    if ( libvlc_exception_raised( p_e ) ) return;
+
+    var_Set( p_input_thread, "rate", val );
+    vlc_object_release( p_input_thread );
+}
+
+float libvlc_input_get_rate( libvlc_input_t *p_input,
+                                 libvlc_exception_t *p_e )
+{
+    input_thread_t *p_input_thread;
+    vlc_value_t val;
+
+    p_input_thread = libvlc_get_input_thread ( p_input, p_e);
+    if ( libvlc_exception_raised( p_e ) )  return -1.0;
+
+    var_Get( p_input_thread, "rate", &val );
+    vlc_object_release( p_input_thread );
+
+    return (float)1000.0f/val.i_int;
+}
+
+int libvlc_input_get_state( libvlc_input_t *p_input,
+                                 libvlc_exception_t *p_e )
+{
+    input_thread_t *p_input_thread;
+    vlc_value_t val;
+
+    p_input_thread = libvlc_get_input_thread ( p_input, p_e);
+    if ( libvlc_exception_raised( p_e ) )  return 0;
+
+    var_Get( p_input_thread, "state", &val );
+    vlc_object_release( p_input_thread );
+
+    return val.i_int;
+}
+
diff -uNr vlc-0.8.6-svn20060918.debian/src/control/playlist.c vlc-0.8.6-svn20061008.debian/src/control/playlist.c
--- vlc-0.8.6-svn20060918.debian/src/control/playlist.c	2006-09-18 06:27:55.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/control/playlist.c	2006-09-21 11:50:20.000000000 -0400
@@ -2,7 +2,7 @@
  * playlist.c: libvlc new API playlist handling functions
  *****************************************************************************
  * Copyright (C) 2005 the VideoLAN team
- * $Id: playlist.c 16457 2006-08-31 20:51:12Z hartman $
+ * $Id: playlist.c 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Clment Stenac <zorglub@videolan.org>
  *
@@ -26,17 +26,16 @@
 
 #include <vlc/intf.h>
 
+#include <assert.h>
+
 void libvlc_playlist_play( libvlc_instance_t *p_instance, int i_id,
                            int i_options, char **ppsz_options,
-                           libvlc_exception_t *p_exception )
+                           libvlc_exception_t *p_e )
 {
+    assert( p_instance->p_playlist );
     ///\todo Handle additionnal options
 
-    if( p_instance->p_playlist->i_size == 0 )
-    {
-        libvlc_exception_raise( p_exception, "Empty playlist" );
-        return;
-    }
+    if( p_instance->p_playlist->i_size == 0 ) RAISEVOID( "Empty playlist" );
     if( i_id > 0 )
     {
         /* Always use the current view when using libvlc */
@@ -52,7 +51,7 @@
                                     p_instance->p_playlist->status.i_view );
         if( !p_view )
         {
-             libvlc_exception_raise( p_exception,
+             libvlc_exception_raise( p_e,
                                      "Unable to find current playlist view ");
              return;
         }
@@ -61,7 +60,7 @@
 
         if( !p_item )
         {
-            libvlc_exception_raise( p_exception, "Unable to find item " );
+            libvlc_exception_raise( p_e, "Unable to find item " );
             return;
         }
         playlist_LockControl( p_instance->p_playlist, PLAYLIST_VIEWPLAY,
@@ -75,103 +74,94 @@
 }
 
 void libvlc_playlist_pause( libvlc_instance_t *p_instance,
-                           libvlc_exception_t *p_exception )
+                           libvlc_exception_t *p_e )
 {
+    assert( p_instance->p_playlist );
     if( playlist_Pause( p_instance->p_playlist ) != VLC_SUCCESS )
-    {
-        libvlc_exception_raise( p_exception, "Empty playlist" );
-    }
+        RAISEVOID( "Empty playlist" );
 }
 
 
 void libvlc_playlist_stop( libvlc_instance_t *p_instance,
-                           libvlc_exception_t *p_exception )
+                           libvlc_exception_t *p_e )
 {
+    assert( p_instance->p_playlist );
     if( playlist_Stop( p_instance->p_playlist ) != VLC_SUCCESS )
-    {
-        libvlc_exception_raise( p_exception, "Empty playlist" );
-    }
+        RAISEVOID( "Empty playlist" );
 }
 
 void libvlc_playlist_clear( libvlc_instance_t *p_instance,
-                           libvlc_exception_t *p_exception )
+                           libvlc_exception_t *p_e )
 {
+    assert( p_instance->p_playlist );
     playlist_Clear( p_instance->p_playlist );
 }
 
 void libvlc_playlist_next( libvlc_instance_t *p_instance,
-                           libvlc_exception_t *p_exception )
+                           libvlc_exception_t *p_e )
 {
+    assert( p_instance->p_playlist );
     if( playlist_Next( p_instance->p_playlist ) != VLC_SUCCESS )
-    {
-        libvlc_exception_raise( p_exception, "Empty playlist" );
-    }
+        RAISEVOID( "Empty playlist" );
 }
 
 void libvlc_playlist_prev( libvlc_instance_t *p_instance,
-                           libvlc_exception_t *p_exception )
+                           libvlc_exception_t *p_e )
 {
     if( playlist_Prev( p_instance->p_playlist ) != VLC_SUCCESS )
-    {
-        libvlc_exception_raise( p_exception, "Empty playlist" );
-    }
+        RAISEVOID( "Empty playlist" );
 }
 
 int libvlc_playlist_add( libvlc_instance_t *p_instance, const char *psz_uri,
-                         const char *psz_name, libvlc_exception_t *p_exception )
+                         const char *psz_name, libvlc_exception_t *p_e )
 {
     return libvlc_playlist_add_extended( p_instance, psz_uri, psz_name,
-                                         0, NULL, p_exception );
+                                         0, NULL, p_e );
 }
 
 int libvlc_playlist_add_extended( libvlc_instance_t *p_instance,
                                   const char *psz_uri, const char *psz_name,
                                   int i_options, const char **ppsz_options,
-                                  libvlc_exception_t *p_exception )
+                                  libvlc_exception_t *p_e )
 {
+    assert( p_instance->p_playlist );
     return playlist_AddExt( p_instance->p_playlist, psz_uri, psz_name,
                             PLAYLIST_INSERT, PLAYLIST_END, -1, ppsz_options,
                             i_options );
 }
 
 int libvlc_playlist_delete_item( libvlc_instance_t *p_instance, int i_id,
-                                 libvlc_exception_t *p_exception )
+                                 libvlc_exception_t *p_e )
 {
+    assert( p_instance->p_playlist );
     return playlist_Delete( p_instance->p_playlist, i_id );
 }
 
 
 int libvlc_playlist_isplaying( libvlc_instance_t *p_instance,
-                               libvlc_exception_t *p_exception )
+                               libvlc_exception_t *p_e )
 {
-    if( !p_instance->p_playlist )
-    {
-        libvlc_exception_raise( p_exception, "No playlist" );
-        return 0;
-    }
+    assert( p_instance->p_playlist );
     return playlist_IsPlaying( p_instance->p_playlist );
 }
 
 int libvlc_playlist_items_count( libvlc_instance_t *p_instance,
-                                 libvlc_exception_t *p_exception )
+                                 libvlc_exception_t *p_e )
 {
-    if( !p_instance->p_playlist )
-    {
-        libvlc_exception_raise( p_exception, "No playlist" );
-        return 0;
-    }
+    assert( p_instance->p_playlist );
     return p_instance->p_playlist->i_size;
 }
 
 libvlc_input_t * libvlc_playlist_get_input( libvlc_instance_t *p_instance,
-                                            libvlc_exception_t *p_exception )
+                                            libvlc_exception_t *p_e )
 {
     libvlc_input_t *p_input;
+    assert( p_instance->p_playlist );
 
     vlc_mutex_lock( &p_instance->p_playlist->object_lock );
     if( p_instance->p_playlist->p_input == NULL )
     {
-        libvlc_exception_raise( p_exception, "No active input" );
+        libvlc_exception_raise( p_e, "No active input" );
         vlc_mutex_unlock( &p_instance->p_playlist->object_lock );
         return NULL;
     }
diff -uNr vlc-0.8.6-svn20060918.debian/src/control/video.c vlc-0.8.6-svn20061008.debian/src/control/video.c
--- vlc-0.8.6-svn20060918.debian/src/control/video.c	2006-09-18 06:27:55.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/control/video.c	2006-10-04 09:47:05.000000000 -0400
@@ -1,10 +1,12 @@
 /*****************************************************************************
- * video.c: ibvlc new API video functions
+ * video.c: libvlc new API video functions
  *****************************************************************************
  * Copyright (C) 2005 the VideoLAN team
+ *
  * $Id: core.c 14187 2006-02-07 16:37:40Z courmisch $
  *
  * Authors: Clment Stenac <zorglub@videolan.org>
+ *          Filippo Carone <littlejohn@videolan.org>
  *
  * This program is free software; you can redistribute it and/or modify
  * it under the terms of the GNU General Public License as published by
@@ -27,6 +29,10 @@
 #include <vlc/vout.h>
 #include <vlc/intf.h>
 
+/*
+ * Remember to release the returned vout_thread_t since it is locked at
+ * the end of this function.
+ */
 static vout_thread_t *GetVout( libvlc_input_t *p_input,
                                libvlc_exception_t *p_exception )
 {
@@ -208,3 +214,125 @@
     
     return VLC_TRUE;
 }
+
+
+int libvlc_video_reparent( libvlc_input_t *p_input, libvlc_drawable_t d,
+                           libvlc_exception_t *p_e )
+{
+    vout_thread_t *p_vout = GetVout( p_input, p_e );
+    vout_Control( p_vout , VOUT_REPARENT, d);
+    vlc_object_release( p_vout );
+    
+    return 0;
+    
+}
+
+void libvlc_video_resize( libvlc_input_t *p_input, int width, int height, libvlc_exception_t *p_e )
+{
+    vout_thread_t *p_vout = GetVout( p_input, p_e );
+    vout_Control( p_vout, VOUT_SET_SIZE, width, height );
+    vlc_object_release( p_vout );
+}
+
+/* global video settings */
+
+void libvlc_video_set_parent( libvlc_instance_t *p_instance, libvlc_drawable_t d,
+                           libvlc_exception_t *p_e )
+{
+    /* set as default for future vout instances */
+    var_SetInteger(p_instance->p_vlc, "drawable", (int)d);
+
+    if( libvlc_playlist_isplaying(p_instance, p_e) )
+    {
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_instance, p_e);
+        if( p_input )
+        {
+            vout_thread_t *p_vout = GetVout( p_input, p_e );
+            if( p_vout )
+            {
+                /* tell running vout to re-parent */
+                vout_Control( p_vout , VOUT_REPARENT, d);
+                vlc_object_release( p_vout );
+            }
+            libvlc_input_free(p_input);
+        }
+    }
+}
+
+void libvlc_video_set_size( libvlc_instance_t *p_instance, int width, int height,
+                           libvlc_exception_t *p_e )
+{
+    /* set as default for future vout instances */
+    config_PutInt(p_instance->p_vlc, "width", width);
+    config_PutInt(p_instance->p_vlc, "height", height);
+
+    if( libvlc_playlist_isplaying(p_instance, p_e) )
+    {
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_instance, p_e);
+        if( p_input )
+        {
+            vout_thread_t *p_vout = GetVout( p_input, p_e );
+            if( p_vout )
+            {
+                /* tell running vout to re-size */
+                vout_Control( p_vout , VOUT_SET_SIZE, width, height);
+                vlc_object_release( p_vout );
+            }
+            libvlc_input_free(p_input);
+        }
+    }
+}
+
+void libvlc_video_set_viewport( libvlc_instance_t *p_instance,
+                            const libvlc_rectangle_t *view, const libvlc_rectangle_t *clip,
+                           libvlc_exception_t *p_e )
+{
+    if( NULL == view )
+    {
+        libvlc_exception_raise( p_e, "viewport is NULL" );
+    }
+
+    /* if clip is NULL, then use view rectangle as clip */
+    if( NULL == clip )
+        clip = view;
+
+    /* set as default for future vout instances */
+    var_SetInteger( p_instance->p_vlc, "drawable-view-top", view->top );
+    var_SetInteger( p_instance->p_vlc, "drawable-view-left", view->left );
+    var_SetInteger( p_instance->p_vlc, "drawable-view-bottom", view->bottom );
+    var_SetInteger( p_instance->p_vlc, "drawable-view-right", view->right );
+    var_SetInteger( p_instance->p_vlc, "drawable-clip-top", clip->top );
+    var_SetInteger( p_instance->p_vlc, "drawable-clip-left", clip->left );
+    var_SetInteger( p_instance->p_vlc, "drawable-clip-bottom", clip->bottom );
+    var_SetInteger( p_instance->p_vlc, "drawable-clip-right", clip->right );
+
+    if( libvlc_playlist_isplaying(p_instance, p_e) )
+    {
+        libvlc_input_t *p_input = libvlc_playlist_get_input(p_instance, p_e);
+        if( p_input )
+        {
+           vout_thread_t *p_vout = GetVout( p_input, p_e );
+            if( p_vout )
+            {
+                /* change viewport for running vout */
+                vout_Control( p_vout , VOUT_SET_VIEWPORT,
+                                   view->top, view->left, view->bottom, view->right,
+                                   clip->top, clip->left, clip->bottom, clip->right );
+                vlc_object_release( p_vout );
+            }
+            libvlc_input_free(p_input);
+        }
+    }
+}
+
+int libvlc_video_destroy( libvlc_input_t *p_input,
+                          libvlc_exception_t *p_e )
+{
+    vout_thread_t *p_vout = GetVout( p_input, p_e );
+    vlc_object_detach( p_vout ); 
+    vlc_object_release( p_vout );
+    vout_Destroy( p_vout );
+    
+    return 0;
+    
+}
diff -uNr vlc-0.8.6-svn20060918.debian/src/input/decoder.c vlc-0.8.6-svn20061008.debian/src/input/decoder.c
--- vlc-0.8.6-svn20060918.debian/src/input/decoder.c	2006-09-18 06:27:56.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/input/decoder.c	2006-09-21 11:50:44.000000000 -0400
@@ -2,7 +2,7 @@
  * decoder.c: Functions for the management of decoders
  *****************************************************************************
  * Copyright (C) 1999-2004 the VideoLAN team
- * $Id: decoder.c 16457 2006-08-31 20:51:12Z hartman $
+ * $Id: decoder.c 16771 2006-09-21 15:52:00Z sam $
  *
  * Authors: Christophe Massiot <massiot@via.ecp.fr>
  *          Gildas Bazin <gbazin@videolan.org>
@@ -586,13 +586,13 @@
             if( p_dec->p_owner->p_sout->i_out_pace_nocontrol > 0 &&
                 p_dec->p_owner->p_input->b_out_pace_control )
             {
-                msg_Dbg( p_dec, "switching to synch mode" );
+                msg_Dbg( p_dec, "switching to sync mode" );
                 p_dec->p_owner->p_input->b_out_pace_control = VLC_FALSE;
             }
             else if( p_dec->p_owner->p_sout->i_out_pace_nocontrol <= 0 &&
                      !p_dec->p_owner->p_input->b_out_pace_control )
             {
-                msg_Dbg( p_dec, "switching to asynch mode" );
+                msg_Dbg( p_dec, "switching to async mode" );
                 p_dec->p_owner->p_input->b_out_pace_control = VLC_TRUE;
             }
         }
@@ -933,10 +933,21 @@
         if( !p_dec->fmt_out.video.i_visible_width ||
             !p_dec->fmt_out.video.i_visible_height )
         {
-            p_dec->fmt_out.video.i_visible_width =
-                p_dec->fmt_out.video.i_width;
-            p_dec->fmt_out.video.i_visible_height =
-                p_dec->fmt_out.video.i_height;
+            if( p_dec->fmt_in.video.i_visible_width &&
+                p_dec->fmt_in.video.i_visible_height )
+            {
+                p_dec->fmt_out.video.i_visible_width =
+                    p_dec->fmt_in.video.i_visible_width;
+                p_dec->fmt_out.video.i_visible_height =
+                    p_dec->fmt_in.video.i_visible_height;
+            }
+            else
+            {
+                p_dec->fmt_out.video.i_visible_width =
+                    p_dec->fmt_out.video.i_width;
+                p_dec->fmt_out.video.i_visible_height =
+                    p_dec->fmt_out.video.i_height;
+            }
         }
 
         if( p_dec->fmt_out.video.i_visible_height == 1088 &&
diff -uNr vlc-0.8.6-svn20060918.debian/src/input/demux.c vlc-0.8.6-svn20061008.debian/src/input/demux.c
--- vlc-0.8.6-svn20060918.debian/src/input/demux.c	2006-09-18 06:27:56.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/input/demux.c	2006-10-08 12:40:52.000000000 -0400
@@ -2,7 +2,7 @@
  * demux.c
  *****************************************************************************
  * Copyright (C) 1999-2004 the VideoLAN team
- * $Id: demux.c 15025 2006-04-01 11:27:40Z fkuehne $
+ * $Id: demux.c 16965 2006-10-07 16:02:30Z hartman $
  *
  * Author: Laurent Aimar <fenrir@via.ecp.fr>
  *
@@ -97,6 +97,8 @@
             { "ogg",  "ogg" }, { "ogm",  "ogg" },
             { "pva",  "pva" },
             { "rm",   "rm" },
+            { "m4v",  "m4v" },
+            { "h264",  "h264" },
             { NULL,  NULL },
         };
         /* Here, we don't mind if it does not work, it must be quick */
diff -uNr vlc-0.8.6-svn20060918.debian/src/input/input.c vlc-0.8.6-svn20061008.debian/src/input/input.c
--- vlc-0.8.6-svn20060918.debian/src/input/input.c	2006-09-18 06:27:56.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/input/input.c	2006-10-08 12:40:52.000000000 -0400
@@ -2,7 +2,7 @@
  * input.c: input thread
  *****************************************************************************
  * Copyright (C) 1998-2004 the VideoLAN team
- * $Id: input.c 16460 2006-08-31 22:01:13Z hartman $
+ * $Id: input.c 16994 2006-10-08 14:40:02Z jpsaman $
  *
  * Authors: Christophe Massiot <massiot@via.ecp.fr>
  *          Laurent Aimar <fenrir@via.ecp.fr>
@@ -323,7 +323,7 @@
 
     /* Allocate descriptor */
     p_input = Create( p_parent, p_item, NULL, VLC_TRUE );
-    p_input->i_flags |= OBJECT_FLAGS_NODBG;
+    p_input->i_flags |= OBJECT_FLAGS_QUIET;
     p_input->i_flags |= OBJECT_FLAGS_NOINTERACT;
 
     /* Now we can attach our new input */
@@ -449,7 +449,7 @@
         p_input->b_eof = VLC_TRUE;
     }
 
-    /* Wait we are asked to die */
+    /* Wait until we are asked to die */
     if( !p_input->b_die )
     {
         Error( p_input );
@@ -481,7 +481,7 @@
 
     if( !p_input->b_eof && !p_input->b_error && p_input->input.b_eof )
     {
-        /* We have finish to demux data but not to play them */
+        /* We have finished demuxing data but not playing it */
         while( !p_input->b_die )
         {
             if( input_EsOutDecodersEmpty( p_input->p_es_out ) )
@@ -491,6 +491,7 @@
 
             msleep( INPUT_IDLE_SLEEP );
         }
+
         /* We have finished */
         p_input->b_eof = VLC_TRUE;
     }
@@ -997,7 +998,7 @@
             }
 
             msg_Dbg( p_input, "starting in %s mode",
-                     p_input->b_out_pace_control ? "asynch" : "synch" );
+                     p_input->b_out_pace_control ? "async" : "sync" );
         }
     }
 
@@ -1084,10 +1085,7 @@
     }
 
     /* initialization is complete */
-    p_input->i_state = PLAYING_S;
-
-    val.i_int = PLAYING_S;
-    var_Change( p_input, "state", VLC_VAR_SETVALUE, &val, NULL );
+    input_ChangeState(p_input, PLAYING_S);
 
     return VLC_SUCCESS;
 
@@ -1127,16 +1125,12 @@
  *****************************************************************************/
 static void End( input_thread_t * p_input )
 {
-    vlc_value_t val;
     int i;
 
     msg_Dbg( p_input, "closing input" );
 
     /* We are at the end */
-    p_input->i_state = END_S;
-
-    val.i_int = END_S;
-    var_Change( p_input, "state", VLC_VAR_SETVALUE, &val, NULL );
+    input_ChangeState(p_input, END_S);
 
     /* Clean control variables */
     input_ControlVarClean( p_input );
@@ -1295,7 +1289,7 @@
             }
             if( f_pos < 0.0 ) f_pos = 0.0;
             if( f_pos > 1.0 ) f_pos = 1.0;
-            /* Reset the decoders states and clock synch (before calling the demuxer */
+            /* Reset the decoders states and clock sync (before calling the demuxer */
             es_out_Control( p_input->p_es_out, ES_OUT_RESET_PCR );
             input_EsOutDiscontinuity( p_input->p_es_out, VLC_FALSE );
             if( demux2_Control( p_input->input.p_demux, DEMUX_SET_POSITION,
@@ -1333,7 +1327,7 @@
             }
             if( i_time < 0 ) i_time = 0;
 
-            /* Reset the decoders states and clock synch (before calling the demuxer */
+            /* Reset the decoders states and clock sync (before calling the demuxer */
             es_out_Control( p_input->p_es_out, ES_OUT_RESET_PCR );
             input_EsOutDiscontinuity( p_input->p_es_out, VLC_FALSE );
 
@@ -2047,8 +2041,8 @@
     {
         psz_path = psz_mrl;
         msg_Dbg( p_input, "trying to pre-parse %s",  psz_path );
-        psz_demux = strdup( "" );
-        psz_access = strdup( "file" );
+        psz_demux = "";
+        psz_access = "file";
     }
 
     if( in->p_demux )
@@ -2082,6 +2076,8 @@
     {
         int64_t i_pts_delay;
 
+        input_ChangeState( p_input, OPENING_S);
+
         /* Now try a real access */
         in->p_access = access2_New( p_input, psz_access, psz_demux, psz_path,
                                     b_quick );
@@ -2176,6 +2172,8 @@
             var_Set( p_input, "seekable", val );
         }
 
+        input_ChangeState( p_input, BUFFERING_S);
+
         /* Create the stream_t */
         in->p_stream = stream_AccessNew( in->p_access, b_quick );
         if( in->p_stream == NULL )
diff -uNr vlc-0.8.6-svn20060918.debian/src/input/input_internal.h vlc-0.8.6-svn20061008.debian/src/input/input_internal.h
--- vlc-0.8.6-svn20060918.debian/src/input/input_internal.h	2006-09-18 06:27:56.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/input/input_internal.h	2006-10-04 09:47:06.000000000 -0400
@@ -2,7 +2,7 @@
  * input_internal.h:
  *****************************************************************************
  * Copyright (C) 1998-2004 the VideoLAN team
- * $Id: input_internal.h 16457 2006-08-31 20:51:12Z hartman $
+ * $Id: input_internal.h 16931 2006-10-03 09:04:50Z damienf $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *
@@ -156,4 +156,11 @@
 
 void MRLSplit( vlc_object_t *, char *, char **, char **, char ** );
 
+static inline void input_ChangeState( input_thread_t *p_input, int state )
+{
+    vlc_value_t val;
+    val.i_int = p_input->i_state = state;
+    var_Change( p_input, "state", VLC_VAR_SETVALUE, &val, NULL );
+}
+
 #endif
diff -uNr vlc-0.8.6-svn20060918.debian/src/libvlc.c vlc-0.8.6-svn20061008.debian/src/libvlc.c
--- vlc-0.8.6-svn20060918.debian/src/libvlc.c	2006-09-18 06:27:59.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/libvlc.c	2006-10-04 09:47:06.000000000 -0400
@@ -2,7 +2,7 @@
  * libvlc.c: main libvlc source
  *****************************************************************************
  * Copyright (C) 1998-2006 the VideoLAN team
- * $Id: libvlc.c 16647 2006-09-14 14:58:57Z hartman $
+ * $Id: libvlc.c 16931 2006-10-03 09:04:50Z damienf $
  *
  * Authors: Vincent Seguin <seguin@via.ecp.fr>
  *          Samuel Hocevar <sam@zoy.org>
@@ -803,18 +803,15 @@
     /*
      * FIXME: kludge to use a p_vlc-local variable for the Mozilla plugin
      */
-    var_Create( p_vlc, "drawable", VLC_VAR_INTEGER );
-    var_Create( p_vlc, "drawableredraw", VLC_VAR_INTEGER );
-    var_Create( p_vlc, "drawablet", VLC_VAR_INTEGER );
-    var_Create( p_vlc, "drawablel", VLC_VAR_INTEGER );
-    var_Create( p_vlc, "drawableb", VLC_VAR_INTEGER );
-    var_Create( p_vlc, "drawabler", VLC_VAR_INTEGER );
-    var_Create( p_vlc, "drawablex", VLC_VAR_INTEGER );
-    var_Create( p_vlc, "drawabley", VLC_VAR_INTEGER );
-    var_Create( p_vlc, "drawablew", VLC_VAR_INTEGER );
-    var_Create( p_vlc, "drawableh", VLC_VAR_INTEGER );
-    var_Create( p_vlc, "drawableportx", VLC_VAR_INTEGER );
-    var_Create( p_vlc, "drawableporty", VLC_VAR_INTEGER );
+    var_Create( p_libvlc, "drawable", VLC_VAR_INTEGER );
+    var_Create( p_libvlc, "drawable-view-top", VLC_VAR_INTEGER );
+    var_Create( p_libvlc, "drawable-view-left", VLC_VAR_INTEGER );
+    var_Create( p_libvlc, "drawable-view-bottom", VLC_VAR_INTEGER );
+    var_Create( p_libvlc, "drawable-view-right", VLC_VAR_INTEGER );
+    var_Create( p_libvlc, "drawable-clip-top", VLC_VAR_INTEGER );
+    var_Create( p_libvlc, "drawable-clip-left", VLC_VAR_INTEGER );
+    var_Create( p_libvlc, "drawable-clip-bottom", VLC_VAR_INTEGER );
+    var_Create( p_libvlc, "drawable-clip-right", VLC_VAR_INTEGER );
 
     /* Create volume callback system. */
     var_Create( p_vlc, "volume-change", VLC_VAR_BOOL );
diff -uNr vlc-0.8.6-svn20060918.debian/src/libvlc.h vlc-0.8.6-svn20061008.debian/src/libvlc.h
--- vlc-0.8.6-svn20060918.debian/src/libvlc.h	2006-09-18 06:27:59.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/libvlc.h	2006-10-08 12:40:52.000000000 -0400
@@ -2,7 +2,7 @@
  * libvlc.h: main libvlc header
  *****************************************************************************
  * Copyright (C) 1998-2006 the VideoLAN team
- * $Id: libvlc.h 16647 2006-09-14 14:58:57Z hartman $
+ * $Id: libvlc.h 16988 2006-10-08 13:07:41Z xtophe $
  *
  * Authors: Vincent Seguin <seguin@via.ecp.fr>
  *          Samuel Hocevar <sam@zoy.org>
@@ -30,7 +30,7 @@
 #if defined (WIN32) || defined (__APPLE__)
 static char *ppsz_language[] =
 { "auto", "en", "en_GB", "ca", "cs", "da", "de", "es", "fr", "gl", "he", "hu",
-  "it", "ja", "ka", "ko", "nl", "oc", "pt_BR", "ro", "ru", "sv", "tr",
+  "it", "ja", "ka", "ko", "nl", "oc", "pt_BR", "ro", "ru", "sk", "sv", "tr",
   "zh_CN", "zh_TW" };
 
 static char *ppsz_language_text[] =
@@ -39,7 +39,8 @@
 N_("French"), N_("Galician"), N_("Hebrew"), N_("Hungarian"),N_("Italian"),
 N_("Japanese"),N_("Georgian"), N_("Korean"), N_("Dutch"), N_("Occitan"),
 N_("Brazilian Portuguese"), N_("Romanian"), N_("Russian"), N_("Swedish"),
-N_("Turkish"), N_("Simplified Chinese"), N_("Chinese Traditional") };
+N_("Slovak"), N_("Turkish"), N_("Simplified Chinese"),
+N_("Chinese Traditional") };
 #endif
 
 static char *ppsz_snap_formats[] =
diff -uNr vlc-0.8.6-svn20060918.debian/src/Makefile.in vlc-0.8.6-svn20061008.debian/src/Makefile.in
--- vlc-0.8.6-svn20060918.debian/src/Makefile.in	2006-09-18 06:31:07.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/Makefile.in	2006-10-08 12:43:13.000000000 -0400
@@ -126,12 +126,13 @@
 FILE_LIBVLC_DLL = @FILE_LIBVLC_DLL@
 FREETYPE_CONFIG = @FREETYPE_CONFIG@
 FRIBIDI_CONFIG = @FRIBIDI_CONFIG@
-GCJ_OPTS = @GCJ_OPTS@
 GENCAT = @GENCAT@
 GLIBC21 = @GLIBC21@
 GMSGFMT = @GMSGFMT@
 GNOMEVFS_CFLAGS = @GNOMEVFS_CFLAGS@
 GNOMEVFS_LIBS = @GNOMEVFS_LIBS@
+GNUTLS_CFLAGS = @GNUTLS_CFLAGS@
+GNUTLS_LIBS = @GNUTLS_LIBS@
 GREP = @GREP@
 GTK2_CFLAGS = @GTK2_CFLAGS@
 GTK2_LIBS = @GTK2_LIBS@
@@ -139,6 +140,8 @@
 HAL_LIBS = @HAL_LIBS@
 HAS_MIDL_COMPILER_FALSE = @HAS_MIDL_COMPILER_FALSE@
 HAS_MIDL_COMPILER_TRUE = @HAS_MIDL_COMPILER_TRUE@
+HAS_WIDL_COMPILER_FALSE = @HAS_WIDL_COMPILER_FALSE@
+HAS_WIDL_COMPILER_TRUE = @HAS_WIDL_COMPILER_TRUE@
 HAVE_BEOS_FALSE = @HAVE_BEOS_FALSE@
 HAVE_BEOS_TRUE = @HAVE_BEOS_TRUE@
 HAVE_BUILTINS_FALSE = @HAVE_BUILTINS_FALSE@
@@ -163,9 +166,6 @@
 INTL_LIBTOOL_SUFFIX_PREFIX = @INTL_LIBTOOL_SUFFIX_PREFIX@
 JAVA = @JAVA@
 JAVAC = @JAVAC@
-JAVA_CC = @JAVA_CC@
-JAVA_CC_FLAGS = @JAVA_CC_FLAGS@
-JAVA_CC_OPTS = @JAVA_CC_OPTS@
 LD = @LD@
 LDFLAGS = @LDFLAGS@
 LIBCDDB_CFLAGS = @LIBCDDB_CFLAGS@
@@ -242,7 +242,9 @@
 VERSION_REVISION = @VERSION_REVISION@
 VLC_CONFIG = @VLC_CONFIG@
 VLC_ENTRY = @VLC_ENTRY@
+WIDL = @WIDL@
 WINDRES = @WINDRES@
+WINE_SDK_PATH = @WINE_SDK_PATH@
 WX_CONFIG = @WX_CONFIG@
 XGETTEXT = @XGETTEXT@
 XMKMF = @XMKMF@
@@ -257,7 +259,6 @@
 ac_ct_CC = @ac_ct_CC@
 ac_ct_CXX = @ac_ct_CXX@
 ac_ct_F77 = @ac_ct_F77@
-ac_ct_JAVA_CC = @ac_ct_JAVA_CC@
 am__fastdepCC_FALSE = @am__fastdepCC_FALSE@
 am__fastdepCC_TRUE = @am__fastdepCC_TRUE@
 am__fastdepCXX_FALSE = @am__fastdepCXX_FALSE@
diff -uNr vlc-0.8.6-svn20060918.debian/src/misc/darwin_specific.m vlc-0.8.6-svn20061008.debian/src/misc/darwin_specific.m
--- vlc-0.8.6-svn20060918.debian/src/misc/darwin_specific.m	2006-09-18 06:27:56.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/misc/darwin_specific.m	2006-10-08 12:40:51.000000000 -0400
@@ -2,7 +2,7 @@
  * darwin_specific.m: Darwin specific features
  *****************************************************************************
  * Copyright (C) 2001-2004 the VideoLAN team
- * $Id: darwin_specific.m 16441 2006-08-30 21:36:35Z hartman $
+ * $Id: darwin_specific.m 16988 2006-10-08 13:07:41Z xtophe $
  *
  * Authors: Sam Hocevar <sam@zoy.org>
  *          Christophe Massiot <massiot@via.ecp.fr>
@@ -62,6 +62,7 @@
         "Brazilian Portuguese", "pt_BR",
         "Romanian", "ro",
         "Russian", "ru",
+	"Slovak", "sk",
         "Swedish", "sv",
         "Turkish", "tr",
         "Simplified Chinese", "zh_CN",
diff -uNr vlc-0.8.6-svn20060918.debian/src/misc/image.c vlc-0.8.6-svn20061008.debian/src/misc/image.c
--- vlc-0.8.6-svn20060918.debian/src/misc/image.c	2006-09-18 06:27:56.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/misc/image.c	2006-09-21 11:50:20.000000000 -0400
@@ -2,7 +2,7 @@
  * image.c : wrapper for image reading/writing facilities
  *****************************************************************************
  * Copyright (C) 2004 the VideoLAN team
- * $Id: image.c 15019 2006-04-01 00:25:58Z dionoea $
+ * $Id: image.c 16767 2006-09-21 14:32:45Z hartman $
  *
  * Author: Gildas Bazin <gbazin@videolan.org>
  *
@@ -97,6 +97,7 @@
     if( p_image->p_filter ) DeleteFilter( p_image->p_filter );
 
     free( p_image );
+    p_image = NULL;
 }
 
 /**
@@ -408,7 +409,7 @@
     {
         /* We need to restart a new filter */
         DeleteFilter( p_image->p_filter );
-        p_image->p_filter = 0;
+        p_image->p_filter = NULL;
     }
 
     /* Start a filter */
@@ -654,6 +655,7 @@
     es_format_Clean( &p_dec->fmt_out );
 
     vlc_object_destroy( p_dec );
+    p_dec = NULL;
 }
 
 static encoder_t *CreateEncoder( vlc_object_t *p_this, video_format_t *fmt_in,
@@ -736,6 +738,7 @@
     es_format_Clean( &p_enc->fmt_out );
 
     vlc_object_destroy( p_enc );
+    p_enc = NULL;
 }
 
 static filter_t *CreateFilter( vlc_object_t *p_this, es_format_t *p_fmt_in,
@@ -756,8 +759,8 @@
     p_filter->fmt_out = *p_fmt_in;
     p_filter->fmt_out.i_codec = p_fmt_out->i_chroma;
     p_filter->fmt_out.video = *p_fmt_out;
-    p_filter->p_module = module_Need( p_filter, "video filter2", psz_module,
-                                      0 );
+    p_filter->p_module = module_Need( p_filter, "video filter2",
+                                      psz_module, 0 );
 
     if( !p_filter->p_module )
     {
@@ -779,4 +782,5 @@
     es_format_Clean( &p_filter->fmt_out );
 
     vlc_object_destroy( p_filter );
+    p_filter = NULL;
 }
diff -uNr vlc-0.8.6-svn20060918.debian/src/misc/messages.c vlc-0.8.6-svn20061008.debian/src/misc/messages.c
--- vlc-0.8.6-svn20060918.debian/src/misc/messages.c	2006-09-18 06:27:56.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/misc/messages.c	2006-09-21 11:50:20.000000000 -0400
@@ -4,7 +4,7 @@
  * modules, especially intf modules. See config.h for output configuration.
  *****************************************************************************
  * Copyright (C) 1998-2005 the VideoLAN team
- * $Id: messages.c 14811 2006-03-18 17:52:31Z zorglub $
+ * $Id: messages.c 16767 2006-09-21 14:32:45Z hartman $
  *
  * Authors: Vincent Seguin <seguin@via.ecp.fr>
  *          Samuel Hocevar <sam@zoy.org>
@@ -312,8 +312,7 @@
     int i;
 
     if( p_this == NULL || p_this->i_flags & OBJECT_FLAGS_QUIET ||
-        (p_this->i_flags & OBJECT_FLAGS_NODBG &&
-         i_type == VLC_MSG_DBG ) )
+        (p_this->i_flags & OBJECT_FLAGS_NODBG && i_type == VLC_MSG_DBG) )
     {
         return;
     }
diff -uNr vlc-0.8.6-svn20060918.debian/src/misc/modules.c vlc-0.8.6-svn20061008.debian/src/misc/modules.c
--- vlc-0.8.6-svn20060918.debian/src/misc/modules.c	2006-09-18 06:27:56.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/misc/modules.c	2006-10-08 12:40:51.000000000 -0400
@@ -2,7 +2,7 @@
  * modules.c : Builtin and plugin modules management functions
  *****************************************************************************
  * Copyright (C) 2001-2004 the VideoLAN team
- * $Id: modules.c 15084 2006-04-03 14:06:19Z xtophe $
+ * $Id: modules.c 16965 2006-10-07 16:02:30Z hartman $
  *
  * Authors: Sam Hocevar <sam@zoy.org>
  *          Ethan C. Baldridge <BaldridgeE@cadmus.com>
@@ -577,7 +577,7 @@
         /* Store this new module */
         p_list[ i_index ].p_module = p_module;
         p_list[ i_index ].i_score = p_module->i_score + i_shortcut_bonus;
-        p_list[ i_index ].b_force = !!i_shortcut_bonus;
+        p_list[ i_index ].b_force = i_shortcut_bonus && b_strict;
 
         /* Add it to the modules-to-probe list */
         if( i_index == 0 )
diff -uNr vlc-0.8.6-svn20060918.debian/src/misc/unicode.c vlc-0.8.6-svn20061008.debian/src/misc/unicode.c
--- vlc-0.8.6-svn20060918.debian/src/misc/unicode.c	2006-09-18 06:27:56.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/misc/unicode.c	2006-09-22 11:14:27.000000000 -0400
@@ -2,7 +2,7 @@
  * unicode.c: Unicode <-> locale functions
  *****************************************************************************
  * Copyright (C) 2005-2006 the VideoLAN team
- * $Id: unicode.c 16707 2006-09-17 20:55:39Z thresh $
+ * $Id: unicode.c 16774 2006-09-21 19:29:10Z hartman $
  *
  * Authors: Rmi Denis-Courmont <rem # videolan.org>
  *
@@ -585,6 +585,8 @@
 {
     unsigned char *ptr, c;
 
+    assert (str != NULL);
+
     ptr = (unsigned char *)str;
     while( (c = *ptr) != '\0' )
     {
diff -uNr vlc-0.8.6-svn20060918.debian/src/misc/version.c vlc-0.8.6-svn20061008.debian/src/misc/version.c
--- vlc-0.8.6-svn20060918.debian/src/misc/version.c	2006-09-18 06:32:39.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/misc/version.c	2006-10-08 12:45:01.000000000 -0400
@@ -3,5 +3,5 @@
  * WHETHER THEY ARE BUILT BY OTHERS OR DURING DEVELOPMENT OR FOR THE
  * OFFICIAL VLC STABLE RELEASES.
  */
-const char psz_vlc_changeset[] = "16726";
+const char psz_vlc_changeset[] = "16997M";
 
diff -uNr vlc-0.8.6-svn20060918.debian/src/misc/vlm.c vlc-0.8.6-svn20061008.debian/src/misc/vlm.c
--- vlc-0.8.6-svn20060918.debian/src/misc/vlm.c	2006-09-18 06:27:56.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/misc/vlm.c	2006-10-01 11:34:20.000000000 -0400
@@ -2,7 +2,7 @@
  * vlm.c: VLM interface plugin
  *****************************************************************************
  * Copyright (C) 2000-2005 the VideoLAN team
- * $Id: vlm.c 15025 2006-04-01 11:27:40Z fkuehne $
+ * $Id: vlm.c 16906 2006-10-01 14:15:23Z jpsaman $
  *
  * Authors: Simon Latapie <garf@videolan.org>
  *          Laurent Aimar <fenrir@videolan.org>
@@ -2415,7 +2415,10 @@
                 else
                 {
                     if( vlm_MediaControl( vlm, p_media, p_instance->psz_name,
-                                          "stop", 0 ) == VLC_SUCCESS ) i--;
+                                          "stop", 0 ) == VLC_SUCCESS )
+                    {
+                        j--; /* the aray is one element smaller now. */
+                    }
                 }
             }
         }
diff -uNr vlc-0.8.6-svn20060918.debian/src/network/httpd.c vlc-0.8.6-svn20061008.debian/src/network/httpd.c
--- vlc-0.8.6-svn20060918.debian/src/network/httpd.c	2006-09-18 06:27:55.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/network/httpd.c	2006-09-22 11:14:26.000000000 -0400
@@ -2,7 +2,7 @@
  * httpd.c
  *****************************************************************************
  * Copyright (C) 2004-2006 the VideoLAN team
- * $Id: httpd.c 16439 2006-08-30 19:33:55Z hartman $
+ * $Id: httpd.c 16774 2006-09-21 19:29:10Z hartman $
  *
  * Authors: Laurent Aimar <fenrir@via.ecp.fr>
  *          Rmi Denis-Courmont <rem # videolan.org>
@@ -622,6 +622,7 @@
                                    httpd_message_t *query )
 {
     httpd_redirect_t *rdir = (httpd_redirect_t*)p_sys;
+    char *p_body;
 
     if( answer == NULL || query == NULL )
     {
@@ -633,7 +634,7 @@
     answer->i_status = 301;
     answer->psz_status = strdup( "Moved Permanently" );
 
-    answer->i_body = asprintf( (char **)&answer->p_body,
+    answer->i_body = asprintf( &p_body,
         "<?xml version=\"1.0\" encoding=\"ascii\" ?>\n"
         "<!DOCTYPE html PUBLIC \"-//W3C//DTD  XHTML 1.0 Strict//EN\" "
         "\"http://www.w3.org/TR/xhtml10/DTD/xhtml10strict.dtd\">\n"
@@ -649,6 +650,7 @@
         "<hr />\n"
         "</body>\n"
         "</html>\n", rdir->psz_dst );
+    answer->p_body = (unsigned char *)p_body;
 
     /* XXX check if it's ok or we need to set an absolute url */
     httpd_MsgAdd( answer, "Location",  "%s", rdir->psz_dst );
diff -uNr vlc-0.8.6-svn20060918.debian/src/network/rootwrap.c vlc-0.8.6-svn20061008.debian/src/network/rootwrap.c
--- vlc-0.8.6-svn20060918.debian/src/network/rootwrap.c	2006-09-18 06:27:55.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/network/rootwrap.c	2006-09-22 11:14:26.000000000 -0400
@@ -2,7 +2,7 @@
  * rootwrap.c
  *****************************************************************************
  * Copyright  2005 Rmi Denis-Courmont
- * $Id: rootwrap.c 15025 2006-04-01 11:27:40Z fkuehne $
+ * $Id: rootwrap.c 16773 2006-09-21 18:46:25Z hartman $
  *
  * Author: Rmi Denis-Courmont <rem # videolan.org>
  *
@@ -52,6 +52,11 @@
 #include <netinet/in.h>
 #include <pthread.h>
 
+#if defined (AF_INET6) && !defined (IPV6_V6ONLY)
+# warning Uho, your IPv6 support is broken and has been disabled. Fix your C library.
+# undef AF_INET6
+#endif
+
 /*#ifndef HAVE_CLEARENV
 extern char **environ;
 
diff -uNr vlc-0.8.6-svn20060918.debian/src/osd/osd_parser.c vlc-0.8.6-svn20061008.debian/src/osd/osd_parser.c
--- vlc-0.8.6-svn20060918.debian/src/osd/osd_parser.c	2006-09-18 06:27:55.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/osd/osd_parser.c	2006-09-22 11:14:26.000000000 -0400
@@ -2,7 +2,7 @@
  * osd_parser.c - The OSD Menu  parser core code.
  *****************************************************************************
  * Copyright (C) 2005 M2X
- * $Id: osd_parser.c 15025 2006-04-01 11:27:40Z fkuehne $
+ * $Id: osd_parser.c 16773 2006-09-21 18:46:25Z hartman $
  *
  * Authors: Jean-Paul Saman <jpsaman #_at_# m2x dot nl>
  *
@@ -62,7 +62,10 @@
 {
     picture_t *p_pic = NULL;
     image_handler_t *p_image;
-    video_format_t fmt_in = {0}, fmt_out = {0};
+    video_format_t fmt_in, fmt_out;
+
+    memset( &fmt_in, 0, sizeof(video_format_t) );
+    memset( &fmt_out, 0, sizeof(video_format_t) );
 
     fmt_out.i_chroma = VLC_FOURCC('Y','U','V','A');
     p_image = image_HandlerCreate( p_this );
diff -uNr vlc-0.8.6-svn20060918.debian/src/stream_output/sap.c vlc-0.8.6-svn20061008.debian/src/stream_output/sap.c
--- vlc-0.8.6-svn20060918.debian/src/stream_output/sap.c	2006-09-18 06:27:59.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/stream_output/sap.c	2006-09-22 11:14:27.000000000 -0400
@@ -2,7 +2,7 @@
  * sap.c : SAP announce handler
  *****************************************************************************
  * Copyright (C) 2002-2005 the VideoLAN team
- * $Id: sap.c 16434 2006-08-30 15:18:13Z hartman $
+ * $Id: sap.c 16774 2006-09-21 19:29:10Z hartman $
  *
  * Authors: Clment Stenac <zorglub@videolan.org>
  *          Rmi Denis-Courmont <rem # videolan.org>
@@ -619,17 +619,20 @@
                             "v=0\r\n"
                             "o=- "I64Fd" %d IN IP%c %s\r\n"
                             "s=%s\r\n"
-                            "t=0 0\r\n"
                             "c=IN IP%c %s/%d\r\n"
-                            "m=video %d %s %d\r\n"
+                            "t=0 0\r\n"
                             "a=tool:"PACKAGE_STRING"\r\n"
-                            "a=type:broadcast\r\n"
+                            "a=recvonly\r\n"
+                            "a=type:broadcast\n"
+                            "a=source-filter: incl IN IP%c * %s\r\n"
+                            "m=video %d %s %d\r\n"
                             "%s%s%s",
                             i_sdp_id, i_sdp_version,
                             ipv, p_addr->psz_machine,
                             psz_name, ipv, psz_uri,
                             /* FIXME: 1 is IPv4 default TTL, not that of IPv6 */
                             p_session->i_ttl ?: (config_GetInt( p_sap, "ttl" ) ?: 1),
+                            ipv, psz_uri,
                             p_session->i_port, 
                             p_session->b_rtp ? "RTP/AVP" : "udp",
                             p_session->i_payload,
diff -uNr vlc-0.8.6-svn20060918.debian/src/test/url.c vlc-0.8.6-svn20061008.debian/src/test/url.c
--- vlc-0.8.6-svn20060918.debian/src/test/url.c	2006-09-18 06:27:54.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/test/url.c	2006-09-22 11:14:26.000000000 -0400
@@ -2,7 +2,7 @@
  * url.c: Test for url encoding/decoding stuff
  *****************************************************************************
  * Copyright (C) 2006 Rmi Denis-Courmont
- * $Id: url.c 15178 2006-04-11 16:18:39Z courmisch $
+ * $Id: url.c 16773 2006-09-21 18:46:25Z hartman $
  *
  * This program is free software; you can redistribute it and/or modify
  * it under the terms of the GNU General Public License as published by
@@ -25,21 +25,36 @@
 #include <stdio.h>
 #include <stdlib.h>
 
-void test_decode (const char *in, const char *out)
+typedef char * (*conv_t) (const char *);
+
+static void test (conv_t f, const char *in, const char *out)
 {
     char *res;
 
     printf ("\"%s\" -> \"%s\" ?\n", in, out);
-    res = decode_URI_duplicate (in);
+    res = f (in);
     if (res == NULL)
         exit (1);
 
     if (strcmp (res, out))
+    {
+        printf (" ERROR: got \"%s\"\n", res);
         exit (2);
+    }
 
     free (res);
 }
 
+static inline void test_decode (const char *in, const char *out)
+{
+    test (decode_URI_duplicate, in, out);
+}
+
+static inline void test_b64 (const char *in, const char *out)
+{
+    test (vlc_b64_encode, in, out);
+}
+
 int main (void)
 {
     (void)setvbuf (stdout, NULL, _IONBF, 0);
@@ -64,5 +79,12 @@
     test_decode ("T%E9l%E9vision", "T?l?vision");
     test_decode ("%C1%94%C3%a9l%c3%A9vision", "??lvision"); /* overlong */
 
+    /* Base 64 tests */
+    test_b64 ("", "");
+    test_b64 ("d", "ZA==");
+    test_b64 ("ab", "YWI=");
+    test_b64 ("abc", "YWJj");
+    test_b64 ("abcd", "YWJjZA==");
+
     return 0;
 }
diff -uNr vlc-0.8.6-svn20060918.debian/src/video_output/video_output.c vlc-0.8.6-svn20061008.debian/src/video_output/video_output.c
--- vlc-0.8.6-svn20060918.debian/src/video_output/video_output.c	2006-09-18 06:27:55.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/video_output/video_output.c	2006-09-22 11:14:26.000000000 -0400
@@ -6,7 +6,7 @@
  * thread, and destroy a previously oppened video output thread.
  *****************************************************************************
  * Copyright (C) 2000-2004 the VideoLAN team
- * $Id: video_output.c 16457 2006-08-31 20:51:12Z hartman $
+ * $Id: video_output.c 16775 2006-09-21 20:35:23Z hartman $
  *
  * Authors: Vincent Seguin <seguin@via.ecp.fr>
  *          Gildas Bazin <gbazin@videolan.org>
@@ -701,6 +701,8 @@
 
     subpicture_t *  p_subpic = NULL;                   /* subpicture pointer */
 
+    input_thread_t *p_input = NULL ;           /* Parent input, if it exists */
+
     vlc_value_t     val;
     vlc_bool_t      b_drop_late;
 
@@ -895,7 +897,11 @@
          */
         if( display_date > 0 )
         {
-            p_subpic = spu_SortSubpictures( p_vout->p_spu, display_date );
+            if( !p_input )
+                p_input = vlc_object_find( p_vout, VLC_OBJECT_INPUT,
+                                           FIND_PARENT );
+            p_subpic = spu_SortSubpictures( p_vout->p_spu, display_date,
+            p_input ? var_GetBool( p_input, "state" ) == PAUSE_S : VLC_FALSE );
         }
 
         /*
@@ -1044,6 +1050,11 @@
         }
     }
 
+    if( p_input )
+    {
+        vlc_object_release( p_input );
+    }
+
     /*
      * Error loop - wait until the thread destruction is requested
      */
diff -uNr vlc-0.8.6-svn20060918.debian/src/video_output/vout_intf.c vlc-0.8.6-svn20061008.debian/src/video_output/vout_intf.c
--- vlc-0.8.6-svn20060918.debian/src/video_output/vout_intf.c	2006-09-18 06:27:55.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/video_output/vout_intf.c	2006-09-22 11:14:26.000000000 -0400
@@ -2,7 +2,7 @@
  * vout_intf.c : video output interface
  *****************************************************************************
  * Copyright (C) 2000-2006 the VideoLAN team
- * $Id: vout_intf.c 16647 2006-09-14 14:58:57Z hartman $
+ * $Id: vout_intf.c 16774 2006-09-21 19:29:10Z hartman $
  *
  * Authors: Gildas Bazin <gbazin@videolan.org>
  *
@@ -445,7 +445,7 @@
     picture_t *p_pif;
     vlc_value_t val, format;
     DIR *path;
-    
+
     int i_ret;
 
     var_Get( p_vout, "snapshot-path", &val );
diff -uNr vlc-0.8.6-svn20060918.debian/src/video_output/vout_subpictures.c vlc-0.8.6-svn20061008.debian/src/video_output/vout_subpictures.c
--- vlc-0.8.6-svn20060918.debian/src/video_output/vout_subpictures.c	2006-09-18 06:27:55.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/src/video_output/vout_subpictures.c	2006-09-22 11:14:26.000000000 -0400
@@ -2,7 +2,7 @@
  * vout_subpictures.c : subpicture management functions
  *****************************************************************************
  * Copyright (C) 2000-2005 the VideoLAN team
- * $Id: vout_subpictures.c 15203 2006-04-13 14:47:20Z hartman $
+ * $Id: vout_subpictures.c 16774 2006-09-21 19:29:10Z hartman $
  *
  * Authors: Vincent Seguin <seguin@via.ecp.fr>
  *          Samuel Hocevar <sam@zoy.org>
@@ -401,6 +401,7 @@
     memset( p_subpic, 0, sizeof(subpicture_t) );
     p_subpic->i_status   = RESERVED_SUBPICTURE;
     p_subpic->b_absolute = VLC_TRUE;
+    p_subpic->b_pausable = VLC_FALSE;
     p_subpic->b_fade     = VLC_FALSE;
     p_subpic->i_alpha    = 0xFF;
     p_subpic->p_region   = 0;
@@ -412,7 +413,7 @@
     p_subpic->pf_create_region = __spu_CreateRegion;
     p_subpic->pf_make_region = __spu_MakeRegion;
     p_subpic->pf_destroy_region = __spu_DestroyRegion;
-    
+
     return p_subpic;
 }
 
@@ -823,7 +824,8 @@
  * to be removed if a newer one is available), which makes it a lot
  * more difficult to guess if a subpicture has to be rendered or not.
  *****************************************************************************/
-subpicture_t *spu_SortSubpictures( spu_t *p_spu, mtime_t display_date )
+subpicture_t *spu_SortSubpictures( spu_t *p_spu, mtime_t display_date,
+                                   vlc_bool_t b_paused )
 {
     int i_index, i_channel;
     subpicture_t *p_subpic = NULL;
@@ -869,7 +871,9 @@
             if( display_date > p_spu->p_subpicture[i_index].i_stop &&
                 ( !p_spu->p_subpicture[i_index].b_ephemer ||
                   p_spu->p_subpicture[i_index].i_stop >
-                  p_spu->p_subpicture[i_index].i_start ) )
+                  p_spu->p_subpicture[i_index].i_start ) &&
+                !( p_spu->p_subpicture[i_index].b_pausable &&
+                   b_paused ) )
             {
                 /* Too late, destroy the subpic */
                 spu_DestroySubpicture( p_spu, &p_spu->p_subpicture[i_index] );
diff -uNr vlc-0.8.6-svn20060918.debian/toolbox vlc-0.8.6-svn20061008.debian/toolbox
--- vlc-0.8.6-svn20060918.debian/toolbox	2006-09-18 06:28:50.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/toolbox	2006-10-04 09:47:09.000000000 -0400
@@ -1,7 +1,7 @@
 #! /bin/sh
 
 ##  toolbox for the VLC media player
-##  $Id: toolbox 16441 2006-08-30 21:36:35Z hartman $
+##  $Id: toolbox 16931 2006-10-03 09:04:50Z damienf $
 ##
 ##  Copyright (C) 2002-2006  the VideoLAN team
 ##
@@ -738,7 +738,6 @@
   rm -f config.h config.log config.status
   rm -f vlc vlc-config Makefile Modules.am
   rm -Rf autom4te.cache
-  rm -f mozilla/vlcintf.h mozilla/vlcintf.xpt
   # FIXME: a lot of Makefiles are still there
 fi
 
diff -uNr vlc-0.8.6-svn20060918.debian/vlc.spec vlc-0.8.6-svn20061008.debian/vlc.spec
--- vlc-0.8.6-svn20060918.debian/vlc.spec	2006-09-18 06:28:50.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/vlc.spec	2006-10-04 09:47:09.000000000 -0400
@@ -261,7 +261,6 @@
 %{_bindir}/*vlc
 %{_libdir}/vlc
 %{_libdir}/libvlc_pic.a
-%{_libdir}/mozilla-%{mozver}/components/vlcintf.xpt
 %{_libdir}/mozilla-%{mozver}/plugins/libvlcplugin.so
 %{_datadir}/applications/gnome-%{name}.desktop
 %{_datadir}/vlc
diff -uNr vlc-0.8.6-svn20060918.debian/vlc.win32.nsi.in vlc-0.8.6-svn20061008.debian/vlc.win32.nsi.in
--- vlc-0.8.6-svn20060918.debian/vlc.win32.nsi.in	2006-09-18 06:28:50.000000000 -0400
+++ vlc-0.8.6-svn20061008.debian/vlc.win32.nsi.in	2006-10-04 09:47:09.000000000 -0400
@@ -429,7 +429,6 @@
   ;WriteRegStr HKLM ${Moz} "Product" "VLC media player"
   ;WriteRegStr HKLM ${Moz} "Vendor" "VideoLAN"
   ;WriteRegStr HKLM ${Moz} "Version" "${VERSION}"
-  ;WriteRegStr HKLM ${Moz} "XPTPath" "$INSTDIR\mozilla\vlcintf.xpt"
 
   Push $R0
   Push $R1
