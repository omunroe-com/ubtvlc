From ca13e21cc5c948908f618cc4a76443bd30e5658c Mon Sep 17 00:00:00 2001
From: Laurent Aimar <fenrir@videolan.org>
Date: Sat, 27 Feb 2010 22:57:50 +0100
Subject: [PATCH] Fixed segfault with corrupted mkv files with compressed data.
MIME-Version: 1.0
Content-Type: text/plain; charset=utf8
Content-Transfer-Encoding: 8bit

(cherry picked from commit 34500c14bf7d9e58a62ff0f0d6a98ec4a9cf4e91)
Signed-off-by: RÃ©mi Denis-Courmont <remi@remlab.net>
---
 modules/demux/mkv/mkv.cpp |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/modules/demux/mkv/mkv.cpp vlc-0.8.6.h/modules/demux/mkv/mkv.cpp
index 102a807..f2c2a75 100644
--- a/modules/demux/mkv/mkv.cpp
+++ vlc-0.8.6.h/modules/demux/mkv.cpp
@@ -549,6 +549,8 @@ static void BlockDecode( demux_t *p_demux, KaxBlock *block, KaxSimpleBlock *simp
         if( tk->i_compression_type == MATROSKA_COMPRESSION_ZLIB )
         {
             p_block = block_zlib_decompress( VLC_OBJECT(p_demux), p_block );
+            if( p_block == NULL )
+                break;
         }
         else
 #endif
-- 
1.7.2.3

